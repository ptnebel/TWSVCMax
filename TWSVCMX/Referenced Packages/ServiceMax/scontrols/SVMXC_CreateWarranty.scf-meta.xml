<?xml version="1.0" encoding="UTF-8"?>
<Scontrol xmlns="http://soap.sforce.com/2006/04/metadata">
    <contentSource>HTML</contentSource>
    <description>Select warranty template and create warranty for an IB</description>
    <encodingKey>UTF-8</encodingKey>
    <fileContent>dmFyIEluc3RQcm9kSWQgPSAiIjsNCnZhciBOZXdJbnN0UHJvZElkID0gIiI7DQp2YXIgRXJyTXNnID0gIiI7DQp2YXIgcmV0VVJMID0gIiI7DQp2YXIgTXNnTGlzdCA9IG5ldyBBcnJheSgpOw0KdmFyIFBhcmVudEliSWQgPSAiIjsNCnZhciBUb3BJYklkID0gIiI7DQp2YXIgU2l0ZUlkID0gIiI7DQp2YXIgQ29udGFjdElkID0gIiI7DQp2YXIgRGlzdENvbnRhY3RJZCA9ICIiOw0KdmFyIGlicm93Y250ID0gMDsNCnZhciBDbG9uZU1vZGUgPSBmYWxzZTsNCg0KLy8gTWFpbiBlbnRyeSBwb2ludCBmb3IgSUIgY2FsbGVkIG9uIHBhZ2UgbG9hZA0KLy8gU2V0dXAgdGhlIElCIHNjcmVlbiBmb3IgbmV3L2VkaXQgcmVjb3JkDQpmdW5jdGlvbiBTVk1YQ19JQl9TZXR1cElCU2NyZWVuKGliaWQsIHVpZCkNCnsNCiAgICBTVk1YQ19HZXRSZXR1cm5VUkwoKTsNCg0KICAgIENsb25lTW9kZSA9IGZhbHNlOw0KICAgIHZhciB1cmwgPSBwYXJlbnQud2luZG93LmxvY2F0aW9uLnRvU3RyaW5nKCk7DQogICAgaWYgKHVybC5pbmRleE9mKCJjbG9uZT0xIikgPj0gMCkNCglDbG9uZU1vZGUgPSB0cnVlOw0KDQogICAgU1ZNWENfSW5pdE1lc3NhZ2VMaXN0KCJJUFJEU0MxIik7DQoNCiAgICBTVk1YQ19JQl9TZXRMYWJlbHNBbmRMaXN0cygpOw0KDQogICAgSW5zdFByb2RJZCA9IGliaWQ7DQogICAgVXNlcklkID0gdWlkOw0KDQogICAgaWYgKCFJbnN0UHJvZElkKQkJLy8gTmV3IElCIG1vZGUNCgl7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIk5ld1RpdGxlIikuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkVkaXRUaXRsZSIpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQoJfQ0KICAgIGVsc2UJCS8vIEVkaXQgZXhpc3RpbmcgSUIgcmVjb3JkIG1vZGUNCgl7DQoJU1ZNWENfSUJfUG9wdWxhdGVJQlJlY29yZChJbnN0UHJvZElkKTsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiTmV3VGl0bGUiKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJFZGl0VGl0bGUiKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCgl9DQoNCiAgICBTVk1YQ19JQl9TZXRJQkxvb2t1cFR5cGVzKCk7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQovLyBTZXQgdGhlIGZpZWxkIGxhYmVscyBmcm9tIElCIG9iamVjdCBkZWZpbml0aW9uIGJ5IG1hdGNoaW5nIGxhYmVsJ3MgbmFtZSBhdHRyaWJ1dGUgdG8gU0ZEQyBmaWVsZCBuYW1lDQovLyBTZXQgdGhlIHBpY2tsaXN0IHZhbHVlcyBhbmQgY2hvb3NlIGRlZmF1bHQgdmFsdWUgaWYgYXZhaWxhYmxlDQpmdW5jdGlvbiBTVk1YQ19JQl9TZXRMYWJlbHNBbmRMaXN0cygpDQp7DQogICAgdmFyIHJlc3VsdCA9IHNmb3JjZS5jb25uZWN0aW9uLmRlc2NyaWJlU09iamVjdCgiU1ZNWENfX0luc3RhbGxlZF9Qcm9kdWN0X19jIik7DQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXN1bHQuZmllbGRzLmxlbmd0aDsgaSsrKQ0KCXsNCgl2YXIgZmllbGQgPSByZXN1bHQuZmllbGRzW2ldOw0KCWlmIChmaWVsZC50eXBlID09ICJwaWNrbGlzdCIpDQoJICAgIHsNCgkgICAgdmFyIHNlbGVjdGN0bDsNCgkgICAgdmFyIHNlbGVjdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2VsZWN0Jyk7DQoJICAgIGZvciAodmFyIGsgPSAwOyBrIDwgc2VsZWN0cy5sZW5ndGg7IGsrKykNCgkgICAgICAgIHsNCgkJaWYgKHNlbGVjdHNba10ubmFtZSA9PSBmaWVsZC5uYW1lKQ0KCQkgICAgc2VsZWN0Y3RsID0gc2VsZWN0c1trXTsNCgkJfQ0KCSAgICBpZiAoc2VsZWN0Y3RsKQ0KCQl7DQoJCXZhciBkZWZpbmRleCA9IC0xOw0KCQlmb3IgKHZhciBtID0gMDsgbSA8IGZpZWxkLnBpY2tsaXN0VmFsdWVzLmxlbmd0aDsgbSsrKQ0KCQkgICAgew0KCQkgICAgdmFyIHBsdiA9IGZpZWxkLnBpY2tsaXN0VmFsdWVzW21dOw0KCQkgICAgc2VsZWN0Y3RsLm9wdGlvbnNbbV0gPSBuZXcgT3B0aW9uKHBsdi5sYWJlbCwgcGx2LnZhbHVlKTsNCgkJICAgIGlmIChwbHYuZGVmYXVsdFZhbHVlID09ICJ0cnVlIikNCgkJCWRlZmluZGV4ID0gbTsNCgkJICAgIH0NCgkJc2VsZWN0Y3RsLnNlbGVjdGVkSW5kZXggPSBkZWZpbmRleDsNCgkJfQ0KCSAgICB9DQoJfQ0KICAgIHZhciBsYWJlbHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbGFiZWwnKTsNCiAgICBmb3IgKHZhciB4ID0gMDsgeCA8IGxhYmVscy5sZW5ndGg7IHgrKykNCgl7DQoJdmFyIGYgPSBsYWJlbHNbeF07DQoJaWYgKE1zZ0xpc3RbZi5uYW1lXSkNCgkgICAgZi5pbm5lclRleHQgPSBNc2dMaXN0W2YubmFtZV07DQoJfQ0KICAgIHZhciBidXR0b25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2J1dHRvbicpOw0KICAgIGZvciAodmFyIHkgPSAwOyB5IDwgYnV0dG9ucy5sZW5ndGg7IHkrKykNCgl7DQoJdmFyIGYgPSBidXR0b25zW3ldOw0KCWlmIChNc2dMaXN0W2YubmFtZV0pDQoJICAgIGYudmFsdWUgPSBNc2dMaXN0W2YubmFtZV07DQoJfQ0KICAgIHZhciBjYnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnY2hlY2tib3gnKTsNCiAgICBmb3IgKHZhciB6ID0gMDsgeiA8IGNicy5sZW5ndGg7IHorKykNCgl7DQoJdmFyIGYgPSBidXR0b25zW3pdOw0KCWlmIChNc2dMaXN0W2YubmFtZV0pDQoJICAgIGYudmFsdWUgPSBNc2dMaXN0W2YubmFtZV07DQoJfQ0KICAgIHJldHVybiB0cnVlOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLy8gV2UgdXNlIFNGREMncyBzdGFuZGFyZCBsb29rdXAgcG9wdXAgd2hpY2ggcmVxdWlyZXMgdGhlIDMtZGlnaXQgb2JqZWN0IGNvZGUgKHByZWZpeCkNCi8vIFRoZSBvYmplY3QgcHJlZml4IG1heSB3YXJ5IGluIGVhY2ggU0ZEQyBvcmcgLSBpdCBpcyBwb3B1bGF0ZWQgaW4gaGlkZGVuIGZpZWxkcyBvbiB0aGUgZm9ybQ0KLy8gZm9yIHRoZSBsb29rdXAgdG8gd29yayBwcm9wZXJseQ0KZnVuY3Rpb24gU1ZNWENfSUJfU2V0SUJMb29rdXBUeXBlcygpDQp7DQogICAgdmFyIGFjY29iaiA9IHNmb3JjZS5jb25uZWN0aW9uLmRlc2NyaWJlU09iamVjdCgiQWNjb3VudCIpOw0KICAgIHZhciBjb250b2JqID0gc2ZvcmNlLmNvbm5lY3Rpb24uZGVzY3JpYmVTT2JqZWN0KCJDb250YWN0Iik7DQogICAgdmFyIHByb2RvYmogPSBzZm9yY2UuY29ubmVjdGlvbi5kZXNjcmliZVNPYmplY3QoIlByb2R1Y3QyIik7DQogICAgdmFyIGlib2JqID0gc2ZvcmNlLmNvbm5lY3Rpb24uZGVzY3JpYmVTT2JqZWN0KCJTVk1YQ19fSW5zdGFsbGVkX1Byb2R1Y3RfX2MiKTsNCiAgICB2YXIgc2l0ZW9iaiA9IHNmb3JjZS5jb25uZWN0aW9uLmRlc2NyaWJlU09iamVjdCgiU1ZNWENfX1NpdGVfX2MiKTsNCg0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwcm9kdWN0MV9sa3RwIikudmFsdWUgPSBwcm9kb2JqLmtleVByZWZpeDsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGFyZW50X3NlcmlhbF9sa3RwIikudmFsdWUgPSBpYm9iai5rZXlQcmVmaXg7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRvcF9zZXJpYWxfbGt0cCIpLnZhbHVlID0gaWJvYmoua2V5UHJlZml4Ow0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb21wYW55X2xrdHAiKS52YWx1ZSA9IGFjY29iai5rZXlQcmVmaXg7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRpc3RfY29tcGFueV9sa3RwIikudmFsdWUgPSBhY2NvYmoua2V5UHJlZml4Ow0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb250YWN0X2xrdHAiKS52YWx1ZSA9IGNvbnRvYmoua2V5UHJlZml4Ow0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkaXN0X2NvbnRhY3RfbGt0cCIpLnZhbHVlID0gY29udG9iai5rZXlQcmVmaXg7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNpdGVfbGt0cCIpLnZhbHVlID0gc2l0ZW9iai5rZXlQcmVmaXg7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQovLyBSZXRyaWV2ZSB0aGUgZXhpc3RpbmcgSUIgcmVjb3JkIGFuZCBwb3B1bGF0ZSBmaWVsZHMgb24gdGhlIGZvcm0NCmZ1bmN0aW9uIFNWTVhDX0lCX1BvcHVsYXRlSUJSZWNvcmQoKQ0Kew0KICAgIHZhciBzb3FsMSA9ICJTRUxFQ1QgU1ZNWENfX1Byb2R1Y3RfX2MsIFNWTVhDX19Qcm9kdWN0X19yLk5hbWUsIFNWTVhDX19TZXJpYWxfTG90X051bWJlcl9fYywgIiArDQoJCSJTVk1YQ19fUGFyZW50X19jLCBTVk1YQ19fUGFyZW50X19yLlNWTVhDX19Qcm9kdWN0X19yLk5hbWUsIFNWTVhDX19QYXJlbnRfX3IuU1ZNWENfX1NlcmlhbF9Mb3RfTnVtYmVyX19jLCAiICsNCgkJIlNWTVhDX19Ub3BfTGV2ZWxfX2MsIFNWTVhDX19Ub3BfTGV2ZWxfX3IuU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSwgU1ZNWENfX1RvcF9MZXZlbF9fci5TVk1YQ19fU2VyaWFsX0xvdF9OdW1iZXJfX2MsICIgKw0KCQkiU1ZNWENfX0Fzc2V0X1RhZ19fYywgU1ZNWENfX0NvbXBhbnlfX2MsIFNWTVhDX19Db21wYW55X19yLk5hbWUsICIgKw0KCQkiU1ZNWENfX0NvbnRhY3RfX2MsIFNWTVhDX19Db250YWN0X19yLk5hbWUsIFNWTVhDX19BbHRlcm5hdGVfQ29tcGFueV9fYywgIiArDQoJCSJTVk1YQ19fRGlzdHJpYnV0b3JfQ29tcGFueV9fYywgU1ZNWENfX0Rpc3RyaWJ1dG9yX0NvbXBhbnlfX3IuTmFtZSwgIiArDQoJCSJTVk1YQ19fRGlzdHJpYnV0b3JfQ29udGFjdF9fYywgU1ZNWENfX0Rpc3RyaWJ1dG9yX0NvbnRhY3RfX3IuTmFtZSwgIiArDQoJCSJTVk1YQ19fU2FsZXNfT3JkZXJfTnVtYmVyX19jLCBTVk1YQ19fU3RhdHVzX19jLCBTVk1YQ19fRGF0ZV9TaGlwcGVkX19jLCBTVk1YQ19fTGFzdF9EYXRlX1NoaXBwZWRfX2MsICIgKw0KCQkiU1ZNWENfX0RhdGVfT3JkZXJlZF9fYywgU1ZNWENfX0RhdGVfSW5zdGFsbGVkX19jLCBTVk1YQ19fU2l0ZV9fYywgU1ZNWENfX1NpdGVfX3IuTmFtZSwgIiArDQoJCSJTVk1YQ19fU3RyZWV0X19jLCBTVk1YQ19fQ2l0eV9fYywgU1ZNWENfX1N0YXRlX19jLCBTVk1YQ19fWmlwX19jLCBTVk1YQ19fQ291bnRyeV9fYywgU1ZNWENfX0luc3RhbGxhdGlvbl9Ob3Rlc19fYyAiICsNCgkJIkZST00gU1ZNWENfX0luc3RhbGxlZF9Qcm9kdWN0X19jIFdIRVJFIElkID0gJyIgKyBJbnN0UHJvZElkICsgIiciOw0KICAgIHRyeSB7DQoJdmFyIHFyMSA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwxKTsNCgl9DQogICAgY2F0Y2ggKGVycm9yKSB7DQoJYWxlcnQoZXJyb3IpOw0KCXJldHVybjsNCgl9DQogICAgdmFyIGlicmVjID0gcXIxLmdldEFycmF5KCJyZWNvcmRzIilbMF07DQoNCiAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoInByb2R1Y3QxX2xraWQiLCBpYnJlYy5TVk1YQ19fUHJvZHVjdF9fYyk7DQogICAgaWYgKGlicmVjLlNWTVhDX19Qcm9kdWN0X19yKQ0KCXsNCglTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoInByb2R1Y3QxX2xrb2xkIiwgaWJyZWMuU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSk7DQoJU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJwcm9kdWN0MSIsIGlicmVjLlNWTVhDX19Qcm9kdWN0X19yLk5hbWUpOw0KCX0NCiAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoInNlcmlhbDEiLCBpYnJlYy5TVk1YQ19fU2VyaWFsX0xvdF9OdW1iZXJfX2MpOw0KDQogICAgaWYgKGlicmVjLlNWTVhDX19QYXJlbnRfX3IgJiYgaWJyZWMuU1ZNWENfX1BhcmVudF9fci5TVk1YQ19fUHJvZHVjdF9fcikNCglTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoInBhcmVudF9wcm9kdWN0IiwgaWJyZWMuU1ZNWENfX1BhcmVudF9fci5TVk1YQ19fUHJvZHVjdF9fci5OYW1lKTsNCg0KICAgIFNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgicGFyZW50X3NlcmlhbF9sa2lkIiwgaWJyZWMuU1ZNWENfX1BhcmVudF9fYyk7DQogICAgaWYgKGlicmVjLlNWTVhDX19QYXJlbnRfX3IpDQoJew0KCVNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgicGFyZW50X3NlcmlhbF9sa29sZCIsIGlicmVjLlNWTVhDX19QYXJlbnRfX3IuU1ZNWENfX1NlcmlhbF9Mb3RfTnVtYmVyX19jKTsNCglTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoInBhcmVudF9zZXJpYWwiLCBpYnJlYy5TVk1YQ19fUGFyZW50X19yLlNWTVhDX19TZXJpYWxfTG90X051bWJlcl9fYyk7DQoJfQ0KDQogICAgaWYgKGlicmVjLlNWTVhDX19Ub3BfTGV2ZWxfX3IgJiYgaWJyZWMuU1ZNWENfX1RvcF9MZXZlbF9fci5TVk1YQ19fUHJvZHVjdF9fcikNCglTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoInRvcF9wcm9kdWN0IiwgaWJyZWMuU1ZNWENfX1RvcF9MZXZlbF9fci5TVk1YQ19fUHJvZHVjdF9fci5OYW1lKTsNCg0KICAgIFNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgidG9wX3NlcmlhbF9sa2lkIiwgaWJyZWMuU1ZNWENfX1RvcF9MZXZlbF9fYyk7DQogICAgaWYgKGlicmVjLlNWTVhDX19Ub3BfTGV2ZWxfX3IpDQoJew0KCVNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgidG9wX3NlcmlhbF9sa29sZCIsIGlicmVjLlNWTVhDX19Ub3BfTGV2ZWxfX3IuU1ZNWENfX1NlcmlhbF9Mb3RfTnVtYmVyX19jKTsNCglTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoInRvcF9zZXJpYWwiLCBpYnJlYy5TVk1YQ19fVG9wX0xldmVsX19yLlNWTVhDX19TZXJpYWxfTG90X051bWJlcl9fYyk7DQoJfQ0KDQogICAgU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJhc3NldF90YWciLCBpYnJlYy5TVk1YQ19fQXNzZXRfVGFnX19jKTsNCiAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoImNvbXBhbnlfbGtpZCIsIGlicmVjLlNWTVhDX19Db21wYW55X19jKTsNCiAgICBpZiAoaWJyZWMuU1ZNWENfX0NvbXBhbnlfX3IpDQoJew0KCVNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgiY29tcGFueV9sa29sZCIsIGlicmVjLlNWTVhDX19Db21wYW55X19yLk5hbWUpOw0KCVNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgiY29tcGFueSIsIGlicmVjLlNWTVhDX19Db21wYW55X19yLk5hbWUpOw0KCX0NCg0KICAgIFNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgiY29udGFjdF9sa2lkIiwgaWJyZWMuU1ZNWENfX0NvbnRhY3RfX2MpOw0KICAgIGlmIChpYnJlYy5TVk1YQ19fQ29udGFjdF9fcikNCgl7DQoJU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJjb250YWN0X2xrb2xkIiwgaWJyZWMuU1ZNWENfX0NvbnRhY3RfX3IuTmFtZSk7DQoJU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJjb250YWN0IiwgaWJyZWMuU1ZNWENfX0NvbnRhY3RfX3IuTmFtZSk7DQoJfQ0KICAgIFNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgiYWx0X2NvbXBhbnkiLCBpYnJlYy5TVk1YQ19fQWx0ZXJuYXRlX0NvbXBhbnlfX2MpOw0KDQogICAgU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJkaXN0X2NvbXBhbnlfbGtpZCIsIGlicmVjLlNWTVhDX19EaXN0cmlidXRvcl9Db21wYW55X19jKTsNCiAgICBpZiAoaWJyZWMuU1ZNWENfX0Rpc3RyaWJ1dG9yX0NvbXBhbnlfX3IpDQoJew0KCVNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgiZGlzdF9jb21wYW55X2xrb2xkIiwgaWJyZWMuU1ZNWENfX0Rpc3RyaWJ1dG9yX0NvbXBhbnlfX3IuTmFtZSk7DQoJU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJkaXN0X2NvbXBhbnkiLCBpYnJlYy5TVk1YQ19fRGlzdHJpYnV0b3JfQ29tcGFueV9fci5OYW1lKTsNCgl9DQoNCiAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoImRpc3RfY29udGFjdF9sa2lkIiwgaWJyZWMuU1ZNWENfX0Rpc3RyaWJ1dG9yX0NvbnRhY3RfX2MpOw0KICAgIGlmIChpYnJlYy5TVk1YQ19fRGlzdHJpYnV0b3JfQ29udGFjdF9fcikNCgl7DQoJU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJkaXN0X2NvbnRhY3RfbGtvbGQiLCBpYnJlYy5TVk1YQ19fRGlzdHJpYnV0b3JfQ29udGFjdF9fci5OYW1lKTsNCglTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoImRpc3RfY29udGFjdCIsIGlicmVjLlNWTVhDX19EaXN0cmlidXRvcl9Db250YWN0X19yLk5hbWUpOw0KCX0NCiAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoInNhbGVzX29yZGVyIiwgaWJyZWMuU1ZNWENfX1NhbGVzX09yZGVyX051bWJlcl9fYyk7DQogICAgU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJzdGF0dXMiLCBpYnJlYy5TVk1YQ19fU3RhdHVzX19jKTsNCiAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoInNpdGVfbGtpZCIsIGlicmVjLlNWTVhDX19TaXRlX19jKTsNCiAgICBpZiAoaWJyZWMuU1ZNWENfX1NpdGVfX3IpDQoJew0KCVNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgic2l0ZV9sa29sZCIsIGlicmVjLlNWTVhDX19TaXRlX19yLk5hbWUpOw0KCVNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgic2l0ZSIsIGlicmVjLlNWTVhDX19TaXRlX19yLk5hbWUpOw0KCX0NCiAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoInN0cmVldCIsIGlicmVjLlNWTVhDX19TdHJlZXRfX2MpOw0KICAgIFNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgiY2l0eSIsIGlicmVjLlNWTVhDX19DaXR5X19jKTsNCiAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoInN0YXRlIiwgaWJyZWMuU1ZNWENfX1N0YXRlX19jKTsNCiAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoInppcCIsIGlicmVjLlNWTVhDX19aaXBfX2MpOw0KDQogICAgaWYgKGlicmVjLlNWTVhDX19Db3VudHJ5X19jKQ0KCVNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgiY291bnRyeSIsIGlicmVjLlNWTVhDX19Db3VudHJ5X19jKTsNCiAgICBlbHNlDQoJU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJjb3VudHJ5IiwgIi0tTm9uZS0tIik7DQoNCiAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoImluc3Rfbm90ZXMiLCBpYnJlYy5TVk1YQ19fSW5zdGFsbGF0aW9uX05vdGVzX19jKTsNCg0KICAgIFNWTVhDX0Fzc2lnbkZvcm1EYXRlKCJkYXRlX29yZGVyZWQiLCBpYnJlYy5TVk1YQ19fRGF0ZV9PcmRlcmVkX19jKTsNCiAgICBTVk1YQ19Bc3NpZ25Gb3JtRGF0ZSgiZGF0ZV9zaGlwcGVkIiwgaWJyZWMuU1ZNWENfX0RhdGVfU2hpcHBlZF9fYyk7DQogICAgU1ZNWENfQXNzaWduRm9ybURhdGUoImxhc3RfZGF0ZV9zaGlwcGVkIiwgaWJyZWMuU1ZNWENfX0xhc3RfRGF0ZV9TaGlwcGVkX19jKTsNCiAgICBTVk1YQ19Bc3NpZ25Gb3JtRGF0ZSgiZGF0ZV9pbnN0YWxsZWQiLCBpYnJlYy5TVk1YQ19fRGF0ZV9JbnN0YWxsZWRfX2MpOw0KDQogICAgUGFyZW50SWJJZCA9IGlicmVjLlNWTVhDX19QYXJlbnRfX2M7DQogICAgVG9wSWJJZCA9IGlicmVjLlNWTVhDX19Ub3BfTGV2ZWxfX2M7DQogICAgU2l0ZUlkID0gaWJyZWMuU1ZNWENfX1NpdGVfX2M7DQogICAgQ29udGFjdElkID0gaWJyZWMuU1ZNWENfX0NvbnRhY3RfX2M7DQogICAgRGlzdENvbnRhY3RJZCA9IGlicmVjLlNWTVhDX19EaXN0cmlidXRvcl9Db250YWN0X19jOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLy8gVmFsaWRhdGUgdGhlIElCIGZvcm0gYW5kIHNhdmUgaXQNCmZ1bmN0aW9uIFNWTVhDX0lCX1ZhbGlkYXRlQW5kU2F2ZUlCKCkNCnsNCiAgICBFcnJNc2cgPSAiIjsNCiAgICB2YXIgcmVjX3ZhbGlkID0gdHJ1ZTsNCg0KICAgIGlmIChTVk1YQ19Jc0ZpZWxkQmxhbmsoInByb2R1Y3QxX2xraWQiKSkNCiAgICAJew0KCXJlY192YWxpZCA9IGZhbHNlOw0KCWlmIChFcnJNc2cubGVuZ3RoID4gMCkgeyBFcnJNc2cgKz0gIjxicj4iOyB9DQoJRXJyTXNnICs9IFNWTVhDX0dldE1lc3NhZ2UoIk1TRzAwMyIpOw0KCX0NCiAgICBlbHNlDQoJew0KCXZhciBzb3FsMSA9ICJTRUxFQ1QgU1ZNWENfX1RyYWNraW5nX19jIEZST00gUHJvZHVjdDIgV0hFUkUgSWQgPSAnIiArIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwcm9kdWN0MV9sa2lkIikudmFsdWUgKyAiJyI7DQoJdmFyIHFyMSA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwxKTsNCgl2YXIgcmVjMSA9IHFyMS5nZXRBcnJheSgicmVjb3JkcyIpWzBdOw0KCWlmICgocmVjMS5TVk1YQ19fVHJhY2tpbmdfX2MgPT0gIlNlcmlhbGl6ZWQiIHx8IHJlYzEuU1ZNWENfX1RyYWNraW5nX19jID09ICJMb3QvQmF0Y2ggVHJhY2tlZCIpICYmIFNWTVhDX0lzRmllbGRCbGFuaygic2VyaWFsMSIpKQ0KCSAgICB7DQoJICAgIHJlY192YWxpZCA9IGZhbHNlOw0KCSAgICBpZiAoRXJyTXNnLmxlbmd0aCA+IDApIHsgRXJyTXNnICs9ICI8YnI+IjsgfQ0KCSAgICBFcnJNc2cgKz0gU1ZNWENfR2V0TWVzc2FnZSgiTVNHMDA0Iik7DQoJICAgIH0NCgl9DQoNCiAgICBpZiAoIVNWTVhDX0lzVmFsaWRMb29rdXAoInBhcmVudF9zZXJpYWwiKSkNCiAgICAJew0KCXJlY192YWxpZCA9IGZhbHNlOw0KCWlmIChFcnJNc2cubGVuZ3RoID4gMCkgeyBFcnJNc2cgKz0gIjxicj4iOyB9DQoJRXJyTXNnICs9IFNWTVhDX0dldE1lc3NhZ2UoIk1TRzAwNSIpOw0KCX0NCg0KICAgIGlmICghU1ZNWENfSXNWYWxpZExvb2t1cCgidG9wX3NlcmlhbCIpKQ0KICAgIAl7DQoJcmVjX3ZhbGlkID0gZmFsc2U7DQoJaWYgKEVyck1zZy5sZW5ndGggPiAwKSB7IEVyck1zZyArPSAiPGJyPiI7IH0NCglFcnJNc2cgKz0gU1ZNWENfR2V0TWVzc2FnZSgiTVNHMDA2Iik7DQoJfQ0KDQogICAgaWYgKFNWTVhDX0lzRmllbGRCbGFuaygiY29tcGFueV9sa2lkIikpDQogICAgCXsNCglyZWNfdmFsaWQgPSBmYWxzZTsNCglpZiAoRXJyTXNnLmxlbmd0aCA+IDApIHsgRXJyTXNnICs9ICI8YnI+IjsgfQ0KCUVyck1zZyArPSBTVk1YQ19HZXRNZXNzYWdlKCJNU0cwMDciKTsNCgl9DQoNCiAgICBpZiAoU1ZNWENfSXNGaWVsZEJsYW5rKCJzdGF0dXMiKSkNCiAgICAJew0KCXJlY192YWxpZCA9IGZhbHNlOw0KCWlmIChFcnJNc2cubGVuZ3RoID4gMCkgeyBFcnJNc2cgKz0gIjxicj4iOyB9DQoJRXJyTXNnICs9IFNWTVhDX0dldE1lc3NhZ2UoIk1TRzAwOCIpOw0KCX0NCg0KICAgIGlmICghU1ZNWENfSXNWYWxpZExvb2t1cCgiY29udGFjdCIpKQ0KICAgIAl7DQoJcmVjX3ZhbGlkID0gZmFsc2U7DQoJaWYgKEVyck1zZy5sZW5ndGggPiAwKSB7IEVyck1zZyArPSAiPGJyPiI7IH0NCglFcnJNc2cgKz0gU1ZNWENfR2V0TWVzc2FnZSgiTVNHMDA5Iik7DQoJfQ0KDQogICAgaWYgKCFTVk1YQ19Jc1ZhbGlkTG9va3VwKCJkaXN0X2NvbXBhbnkiKSkNCiAgICAJew0KCXJlY192YWxpZCA9IGZhbHNlOw0KCWlmIChFcnJNc2cubGVuZ3RoID4gMCkgeyBFcnJNc2cgKz0gIjxicj4iOyB9DQoJRXJyTXNnICs9IFNWTVhDX0dldE1lc3NhZ2UoIk1TRzAxMCIpOw0KCX0NCg0KICAgIGlmICghU1ZNWENfSXNWYWxpZExvb2t1cCgiZGlzdF9jb250YWN0IikpDQogICAgCXsNCglyZWNfdmFsaWQgPSBmYWxzZTsNCglpZiAoRXJyTXNnLmxlbmd0aCA+IDApIHsgRXJyTXNnICs9ICI8YnI+IjsgfQ0KCUVyck1zZyArPSBTVk1YQ19HZXRNZXNzYWdlKCJNU0cwMTEiKTsNCgl9DQoNCiAgICBpZiAoIVNWTVhDX0lzVmFsaWRMb29rdXAoInNpdGUiKSkNCiAgICAJew0KCXJlY192YWxpZCA9IGZhbHNlOw0KCWlmIChFcnJNc2cubGVuZ3RoID4gMCkgeyBFcnJNc2cgKz0gIjxicj4iOyB9DQoJRXJyTXNnICs9IFNWTVhDX0dldE1lc3NhZ2UoIk1TRzAxMiIpOw0KCX0NCg0KICAgIGlmICghU1ZNWENfSXNGaWVsZEJsYW5rKCJkYXRlX29yZGVyZWQiKSAmJiAhU1ZNWENfSXNWYWxpZERhdGUoImRhdGVfb3JkZXJlZCIpKQ0KICAgIAl7DQoJcmVjX3ZhbGlkID0gZmFsc2U7DQoJaWYgKEVyck1zZy5sZW5ndGggPiAwKSB7IEVyck1zZyArPSAiPGJyPiI7IH0NCglFcnJNc2cgKz0gU1ZNWENfR2V0TWVzc2FnZSgiTVNHMDEzIik7DQoJfQ0KDQogICAgaWYgKCFTVk1YQ19Jc0ZpZWxkQmxhbmsoImRhdGVfc2hpcHBlZCIpICYmICFTVk1YQ19Jc1ZhbGlkRGF0ZSgiZGF0ZV9zaGlwcGVkIikpDQogICAgCXsNCglyZWNfdmFsaWQgPSBmYWxzZTsNCglpZiAoRXJyTXNnLmxlbmd0aCA+IDApIHsgRXJyTXNnICs9ICI8YnI+IjsgfQ0KCUVyck1zZyArPSBTVk1YQ19HZXRNZXNzYWdlKCJNU0cwMTQiKTsNCgl9DQoNCiAgICBpZiAoIVNWTVhDX0lzRmllbGRCbGFuaygibGFzdF9kYXRlX3NoaXBwZWQiKSAmJiAhU1ZNWENfSXNWYWxpZERhdGUoImxhc3RfZGF0ZV9zaGlwcGVkIikpDQogICAgCXsNCglyZWNfdmFsaWQgPSBmYWxzZTsNCglpZiAoRXJyTXNnLmxlbmd0aCA+IDApIHsgRXJyTXNnICs9ICI8YnI+IjsgfQ0KCUVyck1zZyArPSBTVk1YQ19HZXRNZXNzYWdlKCJNU0cwMTUiKTsNCgl9DQoNCiAgICBpZiAoIVNWTVhDX0lzRmllbGRCbGFuaygiZGF0ZV9pbnN0YWxsZWQiKSAmJiAhU1ZNWENfSXNWYWxpZERhdGUoImRhdGVfaW5zdGFsbGVkIikpDQogICAgCXsNCglyZWNfdmFsaWQgPSBmYWxzZTsNCglpZiAoRXJyTXNnLmxlbmd0aCA+IDApIHsgRXJyTXNnICs9ICI8YnI+IjsgfQ0KCUVyck1zZyArPSBTVk1YQ19HZXRNZXNzYWdlKCJNU0cwMTYiKTsNCgl9DQoNCiAgICB2YXIgc3RySW5zdERhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGF0ZV9pbnN0YWxsZWQiKS52YWx1ZTsNCiAgICB2YXIgc3RyT3JkZXJEYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRhdGVfb3JkZXJlZCIpLnZhbHVlOw0KICAgIHZhciBzdHJTaGlwRGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkYXRlX3NoaXBwZWQiKS52YWx1ZTsNCiAgICBpZiAoc3RySW5zdERhdGUubGVuZ3RoID4gMCkNCgl2YXIgZHRJbnN0RGF0ZSA9IFNWTVhDX0dldERhdGVGcm9tRm9ybWF0KHN0ckluc3REYXRlLCBwYXJlbnQuVXNlckNvbnRleHQuZGF0ZUZvcm1hdCk7DQoNCiAgICBpZiAoc3RyT3JkZXJEYXRlLmxlbmd0aCA+IDApDQoJdmFyIGR0T3JkZXJEYXRlID0gU1ZNWENfR2V0RGF0ZUZyb21Gb3JtYXQoc3RyT3JkZXJEYXRlLCBwYXJlbnQuVXNlckNvbnRleHQuZGF0ZUZvcm1hdCk7DQoNCiAgICBpZiAoc3RyU2hpcERhdGUubGVuZ3RoID4gMCkNCgl2YXIgZHRTaGlwRGF0ZSA9IFNWTVhDX0dldERhdGVGcm9tRm9ybWF0KHN0clNoaXBEYXRlLCBwYXJlbnQuVXNlckNvbnRleHQuZGF0ZUZvcm1hdCk7DQoNCiAgICBpZiAoc3RyT3JkZXJEYXRlLmxlbmd0aCA+IDAgJiYgc3RyU2hpcERhdGUubGVuZ3RoID4gMCAmJiBkdFNoaXBEYXRlIDwgZHRPcmRlckRhdGUpDQogICAgCXsNCglyZWNfdmFsaWQgPSBmYWxzZTsNCglpZiAoRXJyTXNnLmxlbmd0aCA+IDApIHsgRXJyTXNnICs9ICI8YnI+IjsgfQ0KCUVyck1zZyArPSBTVk1YQ19HZXRNZXNzYWdlKCJNU0cwMTciKTsNCgl9DQoNCiAgICBpZiAoc3RyT3JkZXJEYXRlLmxlbmd0aCA+IDAgJiYgc3RySW5zdERhdGUubGVuZ3RoID4gMCAmJiBkdEluc3REYXRlIDwgZHRPcmRlckRhdGUpDQogICAgCXsNCglyZWNfdmFsaWQgPSBmYWxzZTsNCglpZiAoRXJyTXNnLmxlbmd0aCA+IDApIHsgRXJyTXNnICs9ICI8YnI+IjsgfQ0KCUVyck1zZyArPSBTVk1YQ19HZXRNZXNzYWdlKCJNU0cwMTgiKTsNCgl9DQoNCiAgICBpZiAoc3RyU2hpcERhdGUubGVuZ3RoID4gMCAmJiBzdHJJbnN0RGF0ZS5sZW5ndGggPiAwICYmIGR0SW5zdERhdGUgPCBkdFNoaXBEYXRlKQ0KICAgIAl7DQoJcmVjX3ZhbGlkID0gZmFsc2U7DQoJaWYgKEVyck1zZy5sZW5ndGggPiAwKSB7IEVyck1zZyArPSAiPGJyPiI7IH0NCglFcnJNc2cgKz0gU1ZNWENfR2V0TWVzc2FnZSgiTVNHMDE5Iik7DQoJfQ0KDQogICAgaWYgKCFyZWNfdmFsaWQpIA0KCXsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiRXJyTXNnIikuc3R5bGUuYm9yZGVyID0gIiNGRjAwMDAgMnB4IHNvbGlkIjsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiRXJyTXNnIikuaW5uZXJIVE1MID0gIjxzdHJvbmc+RXJyb3I6IDwvc3Ryb25nPjxicj4iICsgRXJyTXNnOw0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJFcnJNc2ciKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCglyZXR1cm4gZmFsc2U7DQoJfQ0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJFcnJNc2ciKS5zdHlsZS5ib3JkZXIgPSAiMCI7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkVyck1zZyIpLmlubmVySFRNTCA9ICIiOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJFcnJNc2ciKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIGlmIChTVk1YQ19JQl9TYXZlSUIoKSkNCgl7DQoJaWYgKE5ld0luc3RQcm9kSWQpDQoJICAgIHBhcmVudC53aW5kb3cubG9jYXRpb24gPSBwYXJlbnQud2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgIi8vIiArIHBhcmVudC53aW5kb3cubG9jYXRpb24uaG9zdCArICIvIiArIE5ld0luc3RQcm9kSWQ7DQoJZWxzZQ0KCSAgICBwYXJlbnQud2luZG93LmxvY2F0aW9uID0gcGFyZW50LndpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCArICIvLyIgKyBwYXJlbnQud2luZG93LmxvY2F0aW9uLmhvc3QgKyByZXRVUkw7DQoJcmV0dXJuIHRydWU7DQoJfQ0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWENfQXNzaWduVG9TRkRDKGZuYW1lKQ0Kew0KICAgIHZhciBmdmFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZm5hbWUpLnZhbHVlOw0KICAgIGlmIChmdmFsICYmIGZ2YWwubGVuZ3RoID4gMCkNCiAgICAJcmV0dXJuIGZ2YWw7DQogICAgZWxzZQ0KICAgIAlyZXR1cm4gbnVsbDsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCi8vIFNhdmUgKENyZWF0ZSBvciB1cGRhdGUpIHRoZSBJQiByZWNvcmQNCmZ1bmN0aW9uIFNWTVhDX0lCX1NhdmVJQigpDQp7DQogICAgdmFyIGliID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fSW5zdGFsbGVkX1Byb2R1Y3RfX2MiKTsNCiAgICBzbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzZXJpYWwxIikudmFsdWU7DQogICAgaWYgKHNuLmxlbmd0aCA+IDApDQoJaWIuTmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzZXJpYWwxIikudmFsdWU7DQogICAgZWxzZQ0KCWliLk5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicHJvZHVjdDEiKS52YWx1ZTsNCiAgICBpYi5TVk1YQ19fUHJvZHVjdF9fYyA9IFNWTVhDX0Fzc2lnblRvU0ZEQygicHJvZHVjdDFfbGtpZCIpOw0KICAgIGliLlNWTVhDX19Qcm9kdWN0X19jID0gU1ZNWENfQXNzaWduVG9TRkRDKCJwcm9kdWN0MV9sa2lkIik7DQogICAgaWIuU1ZNWENfX1NlcmlhbF9Mb3RfTnVtYmVyX19jID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNlcmlhbDEiKS52YWx1ZTsNCiAgICBpYi5TVk1YQ19fUGFyZW50X19jID0gU1ZNWENfQXNzaWduVG9TRkRDKCJwYXJlbnRfc2VyaWFsX2xraWQiKTsNCiAgICBpYi5TVk1YQ19fVG9wX0xldmVsX19jID0gU1ZNWENfQXNzaWduVG9TRkRDKCJ0b3Bfc2VyaWFsX2xraWQiKTsNCiAgICBpYi5TVk1YQ19fQXNzZXRfVGFnX19jID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFzc2V0X3RhZyIpLnZhbHVlOw0KICAgIGliLlNWTVhDX19Db21wYW55X19jID0gU1ZNWENfQXNzaWduVG9TRkRDKCJjb21wYW55X2xraWQiKTsNCiAgICBpYi5TVk1YQ19fQ29udGFjdF9fYyA9IFNWTVhDX0Fzc2lnblRvU0ZEQygiY29udGFjdF9sa2lkIik7DQogICAgaWIuU1ZNWENfX0FsdGVybmF0ZV9Db21wYW55X19jID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFsdF9jb21wYW55IikudmFsdWU7DQogICAgaWIuU1ZNWENfX0Rpc3RyaWJ1dG9yX0NvbXBhbnlfX2MgPSBTVk1YQ19Bc3NpZ25Ub1NGREMoImRpc3RfY29tcGFueV9sa2lkIik7DQogICAgaWIuU1ZNWENfX0Rpc3RyaWJ1dG9yX0NvbnRhY3RfX2MgPSBTVk1YQ19Bc3NpZ25Ub1NGREMoImRpc3RfY29udGFjdF9sa2lkIik7DQogICAgaWIuU1ZNWENfX1NhbGVzX09yZGVyX051bWJlcl9fYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzYWxlc19vcmRlciIpLnZhbHVlOw0KICAgIGliLlNWTVhDX19TdGF0dXNfX2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3RhdHVzIikudmFsdWU7DQogICAgaWIuU1ZNWENfX0RhdGVfU2hpcHBlZF9fYyA9IFNWTVhDX0NvbnZlcnRUb1NGRENEYXRlRm9ybWF0KCJkYXRlX3NoaXBwZWQiKTsNCiAgICBpYi5TVk1YQ19fTGFzdF9EYXRlX1NoaXBwZWRfX2MgPSBTVk1YQ19Db252ZXJ0VG9TRkRDRGF0ZUZvcm1hdCgibGFzdF9kYXRlX3NoaXBwZWQiKTsNCiAgICBpYi5TVk1YQ19fRGF0ZV9PcmRlcmVkX19jID0gU1ZNWENfQ29udmVydFRvU0ZEQ0RhdGVGb3JtYXQoImRhdGVfb3JkZXJlZCIpOw0KICAgIGliLlNWTVhDX19EYXRlX0luc3RhbGxlZF9fYyA9IFNWTVhDX0NvbnZlcnRUb1NGRENEYXRlRm9ybWF0KCJkYXRlX2luc3RhbGxlZCIpOw0KICAgIGliLlNWTVhDX19TaXRlX19jID0gU1ZNWENfQXNzaWduVG9TRkRDKCJzaXRlX2xraWQiKTsNCiAgICBpYi5TVk1YQ19fU3RyZWV0X19jID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInN0cmVldCIpLnZhbHVlOw0KICAgIGliLlNWTVhDX19DaXR5X19jID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNpdHkiKS52YWx1ZTsNCiAgICBpYi5TVk1YQ19fU3RhdGVfX2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3RhdGUiKS52YWx1ZTsNCiAgICBpYi5TVk1YQ19fWmlwX19jID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInppcCIpLnZhbHVlOw0KICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY291bnRyeSIpLnZhbHVlID09ICItLU5vbmUtLSIpDQoJaWIuU1ZNWENfX0NvdW50cnlfX2MgPSBudWxsOw0KICAgIGVsc2UNCglpYi5TVk1YQ19fQ291bnRyeV9fYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb3VudHJ5IikudmFsdWU7DQogICAgaWIuU1ZNWENfX0luc3RhbGxhdGlvbl9Ob3Rlc19fYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbnN0X25vdGVzIikudmFsdWU7DQogICAgdHJ5IHsNCglpZiAoSW5zdFByb2RJZCAmJiBDbG9uZU1vZGUgPT0gZmFsc2UpDQoJICAgIHsNCgkgICAgaWIuSWQgPSBJbnN0UHJvZElkOw0KCSAgICB2YXIgcmV0ID0gc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKFtpYl0pOw0KCSAgICB9DQoJZWxzZQ0KCSAgICB7DQoJICAgIHZhciByZXQgPSBzZm9yY2UuY29ubmVjdGlvbi5jcmVhdGUoW2liXSk7DQoJICAgIE5ld0luc3RQcm9kSWQgPSByZXRbMF0uaWQ7DQoJICAgIC8vLy8gTW92ZWQgdG8gQXBleCAzT2N0MDg6IGlmICghU1ZNWENfSUJfQ3JlYXRlV2FycmFudHlGb3JQcm9kcyhyZXRbMF0uaWQsIGliKSkNCgkJLy8vLwlyZXR1cm4gZmFsc2U7DQoJICAgIH0NCgl9DQogICAgY2F0Y2ggKGUpIHsNCglhbGVydChTVk1YQ19HZXRNZXNzYWdlKCJNU0cwMDEiKSArICJcbiIgKyBlKQ0KCXJldHVybiBmYWxzZTsNCiAgICAJfQ0KICAgIHJldHVybiB0cnVlOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLy8gQ3JlYXRlIHdhcnJhbnR5IGZvciB0aGUgbmV3bHkgY3JlYXRlZCBJQiByZWNvcmQNCmZ1bmN0aW9uIFNWTVhDX0lCX0NyZWF0ZVdhcnJhbnR5Rm9yUHJvZHMobmV3SWJJZCwgaWJyZWMpDQp7DQogICAgdmFyIHByb2RpZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwcm9kdWN0MV9sa2lkIikudmFsdWU7DQoNCiAgICB2YXIgc29xbDEgPSAiU0VMRUNUIFNWTVhDX19Jbmhlcml0X1BhcmVudF9XYXJyYW50eV9fYywgU1ZNWENfX1Byb2R1Y3RfTGluZV9fYywgRmFtaWx5IEZST00gUHJvZHVjdDIgV0hFUkUgSWQgPSAnIiArIHByb2RpZCArICInIjsNCiAgICB2YXIgcXIxID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDEpOw0KICAgIHZhciByZWMxID0gcXIxLmdldEFycmF5KCJyZWNvcmRzIik7DQoNCiAgICBpZiAocmVjMVswXS5TVk1YQ19fSW5oZXJpdF9QYXJlbnRfV2FycmFudHlfX2MgPT0gInRydWUiKQ0KICAgIAl7DQoJaWYgKCFTVk1YQ19JQl9Db3B5UGFyZW50V2FycmFudHkobmV3SWJJZCwgaWJyZWMpKSB7IHJldHVybiBmYWxzZTsgfQ0KCXJldHVybiB0cnVlOw0KCX0NCg0KICAgIHByb2RmYW1pbHkgPSByZWMxWzBdLkZhbWlseTsNCiAgICBwcm9kbGluZSA9IHJlYzFbMF0uU1ZNWENfX1Byb2R1Y3RfTGluZV9fYzsNCg0KCSAgICAvLyBHZXQgYWxsIHdhcnJhbnR5IHRlbXBsYXRlcyBsaW5rZWQgdG8gdGhlIHByb2R1Y3QsIHByb2R1Y3QgZmFtaWx5IGFuZCBwcm9kdWN0IGxpbmUNCiAgICB2YXIgc29xbDIgPSAiU0VMRUNUIFNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19jLCBTVk1YQ19fU2VydmljZV9UZW1wbGF0ZV9fci5OYW1lLCAiICsNCiAgICAJCSJTVk1YQ19fU2VydmljZV9UZW1wbGF0ZV9fci5TVk1YQ19fQWxsX1Byb2R1Y3RzX0NvdmVyZWRfX2MsIFNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19yLlNWTVhDX19BbGxfU2VydmljZXNfQ292ZXJlZF9fYywgIiArDQogICAgCQkiU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX3IuU1ZNWENfX0NvdmVyYWdlX0VmZmVjdGl2ZV9Gcm9tX19jLCBTVk1YQ19fU2VydmljZV9UZW1wbGF0ZV9fci5TVk1YQ19fRHVyYXRpb25fb2ZfVGltZV9Db3ZlcmFnZV9fYywgIiArDQoJCSJTVk1YQ19fU2VydmljZV9UZW1wbGF0ZV9fci5TVk1YQ19fRHVyYXRpb25fb2ZfTWF0ZXJpYWxfQ292ZXJhZ2VfX2MsIFNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19yLlNWTVhDX19EdXJhdGlvbl9vZl9FeHBlbnNlc19fYywgIiArDQoJCSJTVk1YQ19fU2VydmljZV9UZW1wbGF0ZV9fci5TVk1YQ19fRXhjbHVzaW9uc19fYywgU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX3IuU1ZNWENfX0V4cGVuc2VzX0NvdmVyZWRfX2MsICIgKw0KCQkiU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX3IuU1ZNWENfX0ludm9pY2VfUmVxdWlyZWRfX2MsIFNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19yLlNWTVhDX19Mb2FuZXJfUHJvdmlkZWRfX2MsICIgKw0KCQkiU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX3IuU1ZNWENfX01hdGVyaWFsX0NvdmVyZWRfX2MsIFNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19yLlNWTVhDX19PbnNpdGVfUmVwYWlyX19jLCAiICsNCgkJIlNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19yLlNWTVhDX19STUFfUmVxdWlyZWRfX2MsIFNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19yLlNWTVhDX19TaGlwbWVudF9BbGxvd2VkX19jLCAiICsNCgkJIlNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19yLlNWTVhDX19UZW1wbGF0ZV9UeXBlX19jLCBTVk1YQ19fU2VydmljZV9UZW1wbGF0ZV9fci5TVk1YQ19fVGltZV9Db3ZlcmVkX19jLCAiICsNCgkJIlNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19yLlNWTVhDX19UcmFuc2ZlcmFibGVfX2MsIFNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19yLlNWTVhDX19Vbml0X29mX1RpbWVfTWF0ZXJpYWxfX2MsICIgKw0KCQkiU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX3IuU1ZNWENfX1VuaXRfb2ZfVGltZV9FeHBlbnNlc19fYywgU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX3IuU1ZNWENfX1VuaXRfb2ZfVGltZV9fYywgIiArDQoJCSJTVk1YQ19fU2VydmljZV9UZW1wbGF0ZV9fci5TVk1YQ19fV2Fsa19pbl9BbGxvd2VkX19jIEZST00gU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfUHJvZHVjdHNfX2MgIiArDQoJCSJXSEVSRSBTVk1YQ19fUHJvZHVjdF9fYyA9ICciICsgcHJvZGlkICsgIiciOw0KDQogICAgaWYgKHByb2RmYW1pbHkgJiYgcHJvZGZhbWlseS5sZW5ndGggPiAwKQ0KCXNvcWwyICs9ICIgT1IgU1ZNWENfX1Byb2R1Y3RfRmFtaWx5X19jID0gJyIgKyBwcm9kZmFtaWx5ICsgIiciOw0KICAgIGlmIChwcm9kbGluZSAmJiBwcm9kbGluZS5sZW5ndGggPiAwKQ0KCXNvcWwyICs9ICIgT1IgU1ZNWENfX1Byb2R1Y3RfTGluZV9fYyA9ICciICsgcHJvZGxpbmUgKyAiJyI7DQoNCiAgICB2YXIgcXIyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDIpOw0KICAgIHZhciB3dF9yZWNzID0gbmV3IHNmb3JjZS5RdWVyeVJlc3VsdEl0ZXJhdG9yKHFyMik7DQogICAgd2hpbGUod3RfcmVjcy5oYXNOZXh0KCkpDQoJew0KCXZhciB3dCA9IHd0X3JlY3MubmV4dCgpOw0KCXZhciB3YXJyID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fV2FycmFudHlfX2MiKTsNCgl3YXJyLlNWTVhDX19JbnN0YWxsZWRfUHJvZHVjdF9fYyA9IG5ld0liSWQ7DQoJd2Fyci5TVk1YQ19fU2VydmljZV9UZW1wbGF0ZV9fYyA9IHd0LlNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19jOw0KCXdhcnIuU1ZNWENfX0FsbF9Qcm9kdWN0c19Db3ZlcmVkX19jID0gd3QuU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX3IuU1ZNWENfX0FsbF9Qcm9kdWN0c19Db3ZlcmVkX19jOw0KCXdhcnIuU1ZNWENfX0FsbF9TZXJ2aWNlc19Db3ZlcmVkX19jID0gd3QuU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX3IuU1ZNWENfX0FsbF9TZXJ2aWNlc19Db3ZlcmVkX19jOw0KCXdhcnIuU1ZNWENfX1RpbWVfQ292ZXJlZF9fYyA9IHd0LlNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19yLlNWTVhDX19UaW1lX0NvdmVyZWRfX2M7DQoJd2Fyci5TVk1YQ19fVHJhbnNmZXJhYmxlX19jID0gd3QuU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX3IuU1ZNWENfX1RyYW5zZmVyYWJsZV9fYzsNCgl3YXJyLlNWTVhDX19XYWxrX2luX0FsbG93ZWRfX2MgPSB3dC5TVk1YQ19fU2VydmljZV9UZW1wbGF0ZV9fci5TVk1YQ19fV2Fsa19pbl9BbGxvd2VkX19jOw0KCXdhcnIuU1ZNWENfX0V4cGVuc2VzX0NvdmVyZWRfX2MgPSB3dC5TVk1YQ19fU2VydmljZV9UZW1wbGF0ZV9fci5TVk1YQ19fRXhwZW5zZXNfQ292ZXJlZF9fYzsNCgl3YXJyLlNWTVhDX19JbnZvaWNlX1JlcXVpcmVkX19jID0gd3QuU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX3IuU1ZNWENfX0ludm9pY2VfUmVxdWlyZWRfX2M7DQoJd2Fyci5TVk1YQ19fTG9hbmVyX1Byb3ZpZGVkX19jID0gd3QuU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX3IuU1ZNWENfX0xvYW5lcl9Qcm92aWRlZF9fYzsNCgl3YXJyLlNWTVhDX19NYXRlcmlhbF9Db3ZlcmVkX19jID0gd3QuU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX3IuU1ZNWENfX01hdGVyaWFsX0NvdmVyZWRfX2M7DQoJd2Fyci5TVk1YQ19fT25zaXRlX1JlcGFpcl9fYyA9IHd0LlNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19yLlNWTVhDX19PbnNpdGVfUmVwYWlyX19jOw0KCXdhcnIuU1ZNWENfX1JNQV9SZXF1aXJlZF9fYyA9IHd0LlNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19yLlNWTVhDX19STUFfUmVxdWlyZWRfX2M7DQoJd2Fyci5TVk1YQ19fU2hpcG1lbnRfQWxsb3dlZF9fYyA9IHd0LlNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19yLlNWTVhDX19TaGlwbWVudF9BbGxvd2VkX19jOw0KCXdhcnIuU1ZNWENfX0V4Y2x1c2lvbnNfX2MgPSB3dC5TVk1YQ19fU2VydmljZV9UZW1wbGF0ZV9fci5TVk1YQ19fRXhjbHVzaW9uc19fYzsNCg0KCXZhciBjdXJyZGF0ZSA9IG5ldyBEYXRlKCk7DQoJaWYgKHd0LlNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19yLlNWTVhDX19Db3ZlcmFnZV9FZmZlY3RpdmVfRnJvbV9fYyA9PSAiU2hpcCBEYXRlIiAmJiBpYnJlYy5TVk1YQ19fRGF0ZV9TaGlwcGVkX19jICYmIGlicmVjLlNWTVhDX19EYXRlX1NoaXBwZWRfX2MubGVuZ3RoID4gMCkNCgkgICAgd2Fyci5TVk1YQ19fU3RhcnRfRGF0ZV9fYyA9IGlicmVjLlNWTVhDX19EYXRlX1NoaXBwZWRfX2M7DQoJZWxzZSBpZiAod3QuU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX3IuU1ZNWENfX0NvdmVyYWdlX0VmZmVjdGl2ZV9Gcm9tX19jID09ICJJbnN0YWxsIERhdGUiICYmIGlicmVjLlNWTVhDX19EYXRlX0luc3RhbGxlZF9fYyAmJiBpYnJlYy5TVk1YQ19fRGF0ZV9JbnN0YWxsZWRfX2MubGVuZ3RoID4gMCkNCgkgICAgd2Fyci5TVk1YQ19fU3RhcnRfRGF0ZV9fYyA9IGlicmVjLlNWTVhDX19EYXRlX0luc3RhbGxlZF9fYzsNCgllbHNlDQoJICAgIHdhcnIuU1ZNWENfX1N0YXJ0X0RhdGVfX2MgPSBTVk1YQ19Db252ZXJ0RGF0ZVRvU0ZEQyhjdXJyZGF0ZSk7DQoNCgl2YXIgZHRUaW1lRW5kID0gU1ZNWENfQ2FsY1dhcnJFbmREYXRlKHdhcnIuU1ZNWENfX1N0YXJ0X0RhdGVfX2MsDQoJCQkJCXd0LlNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19yLlNWTVhDX19EdXJhdGlvbl9vZl9UaW1lX0NvdmVyYWdlX19jLA0KCQkJCQl3dC5TVk1YQ19fU2VydmljZV9UZW1wbGF0ZV9fci5TVk1YQ19fVW5pdF9vZl9UaW1lX19jKTsNCgl3YXJyLlNWTVhDX19FbmRfRGF0ZV9UaW1lX0NvdmVyZWRfX2MgPSBTVk1YQ19Db252ZXJ0RGF0ZVRvU0ZEQyhkdFRpbWVFbmQpOw0KDQoJdmFyIGR0UGFydHNFbmQgPSBTVk1YQ19DYWxjV2FyckVuZERhdGUod2Fyci5TVk1YQ19fU3RhcnRfRGF0ZV9fYywNCgkJCQkJd3QuU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX3IuU1ZNWENfX0R1cmF0aW9uX29mX01hdGVyaWFsX0NvdmVyYWdlX19jLA0KCQkJCQl3dC5TVk1YQ19fU2VydmljZV9UZW1wbGF0ZV9fci5TVk1YQ19fVW5pdF9vZl9UaW1lX01hdGVyaWFsX19jKTsNCgl3YXJyLlNWTVhDX19FbmRfRGF0ZV9NYXRlcmlhbF9Db3ZlcmVkX19jID0gU1ZNWENfQ29udmVydERhdGVUb1NGREMoZHRQYXJ0c0VuZCk7DQoNCgl2YXIgZHRFeHBFbmQgPSBTVk1YQ19DYWxjV2FyckVuZERhdGUod2Fyci5TVk1YQ19fU3RhcnRfRGF0ZV9fYywNCgkJCQkJd3QuU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX3IuU1ZNWENfX0R1cmF0aW9uX29mX0V4cGVuc2VzX19jLA0KCQkJCQl3dC5TVk1YQ19fU2VydmljZV9UZW1wbGF0ZV9fci5TVk1YQ19fVW5pdF9vZl9UaW1lX0V4cGVuc2VzX19jKTsNCgl3YXJyLlNWTVhDX19FbmRfRGF0ZV9FeHBlbnNlc19Db3ZlcmVkX19jID0gU1ZNWENfQ29udmVydERhdGVUb1NGREMoZHRFeHBFbmQpOw0KDQoJLy8gT3ZlcmFsbCBlbmQgZGF0ZSBvZiB0aGUgd2FycmFudHkgaXMgdGhlIG1heGltdW0gb2YgdGltZS9wYXJ0cy9leHBlbnNlcyBjb3ZlcmFnZSBlbmQgZGF0ZXMNCglpZiAoZHRUaW1lRW5kID49IGR0UGFydHNFbmQgJiYgZHRUaW1lRW5kID49IGR0RXhwRW5kKQ0KCSAgICB3YXJyLlNWTVhDX19FbmRfRGF0ZV9fYyAgPSBTVk1YQ19Db252ZXJ0RGF0ZVRvU0ZEQyhkdFRpbWVFbmQpOyANCgllbHNlIGlmIChkdFBhcnRzRW5kID49IGR0VGltZUVuZCAmJiBkdFBhcnRzRW5kPj0gZHRFeHBFbmQpDQoJICAgIHdhcnIuU1ZNWENfX0VuZF9EYXRlX19jID0gU1ZNWENfQ29udmVydERhdGVUb1NGREMoZHRQYXJ0c0VuZCk7IA0KCWVsc2UgaWYgKGR0RXhwRW5kID49IGR0VGltZUVuZCAmJiBkdEV4cEVuZD49IGR0UGFydHNFbmQpDQoJICAgIHdhcnIuU1ZNWENfX0VuZF9EYXRlX19jID0gU1ZNWENfQ29udmVydERhdGVUb1NGREMoZHRFeHBFbmQpOyANCg0KCXRyeSB7DQoJICAgIHZhciByZXQgPSBzZm9yY2UuY29ubmVjdGlvbi5jcmVhdGUoW3dhcnJdKTsNCgkgICAgfQ0KCWNhdGNoIChlKSB7DQoJICAgIGFsZXJ0KFNWTVhDX0dldE1lc3NhZ2UoIk1TRzAwMSIpICsgIlxuIiArIGUpDQoJICAgIHJldHVybiBmYWxzZTsNCgkgICAgfQ0KCX0NCiAgICByZXR1cm4gdHJ1ZTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCi8vIENyZWF0ZSB3YXJyYW50eSBmb3IgdGhlIGNoaWxkIGZyb20gcGFyZW50J3Mgd2FycmFudHkgcmVjb3Jkcw0KZnVuY3Rpb24gU1ZNWENfSUJfQ29weVBhcmVudFdhcnJhbnR5KG5ld0liSWQsIGlicmVjKQ0Kew0KICAgIHZhciBzb3FsMSA9ICJTRUxFQ1QgU1ZNWENfX0FsbF9Qcm9kdWN0c19Db3ZlcmVkX19jLCBTVk1YQ19fQWxsX1NlcnZpY2VzX0NvdmVyZWRfX2MsICIgKw0KICAgIAkJIlNWTVhDX19FbmRfRGF0ZV9fYywgU1ZNWENfX0VuZF9EYXRlX0V4cGVuc2VzX0NvdmVyZWRfX2MsICIgKw0KCQkiU1ZNWENfX0VuZF9EYXRlX01hdGVyaWFsX0NvdmVyZWRfX2MsIFNWTVhDX19FbmRfRGF0ZV9UaW1lX0NvdmVyZWRfX2MsICIgKw0KCQkiU1ZNWENfX0V4Y2x1c2lvbnNfX2MsIFNWTVhDX19FeHBlbnNlc19Db3ZlcmVkX19jLCBTVk1YQ19fSW52b2ljZV9SZXF1aXJlZF9fYywgIiArDQoJCSJTVk1YQ19fTG9hbmVyX1Byb3ZpZGVkX19jLCBTVk1YQ19fTWF0ZXJpYWxfQ292ZXJlZF9fYywgU1ZNWENfX09uc2l0ZV9SZXBhaXJfX2MsICIgKw0KCQkiU1ZNWENfX1JNQV9SZXF1aXJlZF9fYywgU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX2MsIFNWTVhDX19TaGlwbWVudF9BbGxvd2VkX19jLCAiICsNCgkJIlNWTVhDX19TdGFydF9EYXRlX19jLCBTVk1YQ19fVGltZV9Db3ZlcmVkX19jLCBTVk1YQ19fVHJhbnNmZXJhYmxlX19jLCAiICsNCgkJIlNWTVhDX19XYWxrX2luX0FsbG93ZWRfX2MgRlJPTSBTVk1YQ19fV2FycmFudHlfX2MgV0hFUkUgU1ZNWENfX0luc3RhbGxlZF9Qcm9kdWN0X19jID0gJyIgKyBpYnJlYy5TVk1YQ19fUGFyZW50X19jICsgIiciOw0KICAgIHZhciBxcjEgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMSk7DQogICAgdmFyIHdhcnJfcmVjcyA9IG5ldyBzZm9yY2UuUXVlcnlSZXN1bHRJdGVyYXRvcihxcjEpOw0KICAgIHdoaWxlKHdhcnJfcmVjcy5oYXNOZXh0KCkpDQoJew0KCXZhciB3cmVjID0gd2Fycl9yZWNzLm5leHQoKTsNCgl2YXIgd2FyciA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1dhcnJhbnR5X19jIik7DQoJd2Fyci5TVk1YQ19fSW5zdGFsbGVkX1Byb2R1Y3RfX2MgPSBuZXdJYklkOw0KCXdhcnIuU1ZNWENfX0FsbF9Qcm9kdWN0c19Db3ZlcmVkX19jID0gd3JlYy5TVk1YQ19fQWxsX1Byb2R1Y3RzX0NvdmVyZWRfX2M7DQoJd2Fyci5TVk1YQ19fQWxsX1NlcnZpY2VzX0NvdmVyZWRfX2MgPSB3cmVjLlNWTVhDX19BbGxfU2VydmljZXNfQ292ZXJlZF9fYzsNCgl3YXJyLlNWTVhDX19FbmRfRGF0ZV9fYyA9IHdyZWMuU1ZNWENfX0VuZF9EYXRlX19jOw0KCXdhcnIuU1ZNWENfX0VuZF9EYXRlX0V4cGVuc2VzX0NvdmVyZWRfX2MgPSB3cmVjLlNWTVhDX19FbmRfRGF0ZV9FeHBlbnNlc19Db3ZlcmVkX19jOw0KCXdhcnIuU1ZNWENfX0VuZF9EYXRlX01hdGVyaWFsX0NvdmVyZWRfX2MgPSB3cmVjLlNWTVhDX19FbmRfRGF0ZV9NYXRlcmlhbF9Db3ZlcmVkX19jOw0KCXdhcnIuU1ZNWENfX0VuZF9EYXRlX1RpbWVfQ292ZXJlZF9fYyA9IHdyZWMuU1ZNWENfX0VuZF9EYXRlX1RpbWVfQ292ZXJlZF9fYzsNCgl3YXJyLlNWTVhDX19FeGNsdXNpb25zX19jID0gd3JlYy5TVk1YQ19fRXhjbHVzaW9uc19fYzsNCgl3YXJyLlNWTVhDX19FeHBlbnNlc19Db3ZlcmVkX19jID0gd3JlYy5TVk1YQ19fRXhwZW5zZXNfQ292ZXJlZF9fYzsNCgl3YXJyLlNWTVhDX19JbnZvaWNlX1JlcXVpcmVkX19jID0gd3JlYy5TVk1YQ19fSW52b2ljZV9SZXF1aXJlZF9fYzsNCgl3YXJyLlNWTVhDX19Mb2FuZXJfUHJvdmlkZWRfX2MgPSB3cmVjLlNWTVhDX19Mb2FuZXJfUHJvdmlkZWRfX2M7DQoJd2Fyci5TVk1YQ19fTWF0ZXJpYWxfQ292ZXJlZF9fYyA9IHdyZWMuU1ZNWENfX01hdGVyaWFsX0NvdmVyZWRfX2M7DQoJd2Fyci5TVk1YQ19fT25zaXRlX1JlcGFpcl9fYyA9IHdyZWMuU1ZNWENfX09uc2l0ZV9SZXBhaXJfX2M7DQoJd2Fyci5TVk1YQ19fUk1BX1JlcXVpcmVkX19jID0gd3JlYy5TVk1YQ19fUk1BX1JlcXVpcmVkX19jOw0KCXdhcnIuU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX2MgPSB3cmVjLlNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19jOw0KCXdhcnIuU1ZNWENfX1NoaXBtZW50X0FsbG93ZWRfX2MgPSB3cmVjLlNWTVhDX19TaGlwbWVudF9BbGxvd2VkX19jOw0KCXdhcnIuU1ZNWENfX1N0YXJ0X0RhdGVfX2MgPSB3cmVjLlNWTVhDX19TdGFydF9EYXRlX19jOw0KCXdhcnIuU1ZNWENfX1RpbWVfQ292ZXJlZF9fYyA9IHdyZWMuU1ZNWENfX1RpbWVfQ292ZXJlZF9fYzsNCgl3YXJyLlNWTVhDX19UcmFuc2ZlcmFibGVfX2MgPSB3cmVjLlNWTVhDX19UcmFuc2ZlcmFibGVfX2M7DQoJd2Fyci5TVk1YQ19fV2Fsa19pbl9BbGxvd2VkX19jID0gd3JlYy5TVk1YQ19fV2Fsa19pbl9BbGxvd2VkX19jOw0KCXRyeSB7DQoJICAgIHZhciByZXQgPSBzZm9yY2UuY29ubmVjdGlvbi5jcmVhdGUoW3dhcnJdKTsNCgkgICAgfQ0KCWNhdGNoIChlKQ0KCSAgICB7DQoJICAgIGFsZXJ0KFNWTVhDX0dldE1lc3NhZ2UoIk1TRzAwMSIpICsgIlxuIiArIGUpDQoJICAgIHJldHVybiBmYWxzZTsNCgkgICAgfQ0KCX0NCiAgICByZXR1cm4gdHJ1ZTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhDX0NhbGNXYXJyRW5kRGF0ZShzdHJTdGFydERhdGUsIFVuaXRzLCBVb1QpDQp7DQogICAgaWYgKCFVbml0cyB8fCAhVW9UIHx8IFVuaXRzLmxlbmd0aCA8PSAwIHx8IFVvVC5sZW5ndGggPD0gMCkgeyByZXR1cm4gbmV3IERhdGUoKTsgfQ0KDQogICAgdmFyIG1zcGQgPSAxMDAwICogNjAgKiA2MCAqIDI0Ow0KICAgIHZhciBhcnJTdGFydERhdGUgPSBzdHJTdGFydERhdGUuc3BsaXQoJy0nLCAzKTsNCiAgICB2YXIgZGF0ZVN0YXJ0ID0gbmV3IERhdGUoYXJyU3RhcnREYXRlWzBdLCBhcnJTdGFydERhdGVbMV0gLSAxLCBhcnJTdGFydERhdGVbMl0pOw0KICAgIHZhciBuWWVhciA9IGRhdGVTdGFydC5nZXRGdWxsWWVhcigpOw0KICAgIHZhciBuTW9udGggPSBkYXRlU3RhcnQuZ2V0TW9udGgoKTsNCiAgICB2YXIgZGF0ZUVuZDsNCiAgICB2YXIgbkR1cmF0aW9uID0gcGFyc2VGbG9hdChVbml0cyk7DQogICAgc3dpdGNoIChVb1QpDQoJew0KCWNhc2UgIkRheXMiOg0KCSAgICBkYXRlRW5kID0gbmV3IERhdGUoZGF0ZVN0YXJ0LmdldFRpbWUoKSArIChuRHVyYXRpb24gKiBtc3BkKSk7DQoJICAgIGJyZWFrOw0KCWNhc2UgIldlZWtzIjoNCgkgICAgZGF0ZUVuZCA9IG5ldyBEYXRlKGRhdGVTdGFydC5nZXRUaW1lKCkgKyAobkR1cmF0aW9uICogbXNwZCAqIDcpKTsNCgkgICAgYnJlYWs7DQoJY2FzZSAiTW9udGhzIjoNCgkgICAgbk1vbnRoICs9IG5EdXJhdGlvbjsNCgkgICAgZGF0ZUVuZCA9IG5ldyBEYXRlKG5ZZWFyLCBuTW9udGgsIGRhdGVTdGFydC5nZXREYXRlKCktMSk7DQoJICAgIGJyZWFrOw0KCWNhc2UgIlllYXJzIjoNCgkgICAgblllYXIgKz0gbkR1cmF0aW9uOw0KCSAgICBkYXRlRW5kID0gbmV3IERhdGUoblllYXIsIG5Nb250aCwgZGF0ZVN0YXJ0LmdldERhdGUoKS0xKTsNCgkgICAgYnJlYWs7DQoJfQ0KICAgIHJldHVybihkYXRlRW5kKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCi8vIEFjdCBvbiBDYW5jZWwgYnV0dG9uIGNsaWNrDQpmdW5jdGlvbiBTVk1YQ19JQl9DYW5jZWxJQigpDQp7DQoJcGFyZW50LndpbmRvdy5sb2NhdGlvbiA9IHBhcmVudC53aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgKyAiLy8iICsgcGFyZW50LndpbmRvdy5sb2NhdGlvbi5ob3N0ICsgcmV0VVJMOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLy8gUHJvY2VzcyB0aGUgZXZlbnQgb2YgZXhpdGluZyBwYXJlbnQgc2VyaWFsIG51bWJlcg0KLy8gMS4gUG9wdWxhdGUgcHJvZHVjdCBuYW1lDQovLyAyLiBQb3B1bGF0ZSBvdGhlciBlbXB0eSBmaWVsZHMgaWYgdGhpcyBpcyBhIG5ldyByZWNvcmQNCmZ1bmN0aW9uIFNWTVhDX0lCX0V4aXRQYXJlbnRTZXJpYWwoKQ0Kew0KICAgIHZhciBsa2lkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBhcmVudF9zZXJpYWxfbGtpZCIpLnZhbHVlOw0KICAgIGlmKGxraWQubGVuZ3RoID4gMCAmJiBsa2lkICE9IFBhcmVudEliSWQpDQogICAgCXsNCgl2YXIgc29xbDEgPSAiU0VMRUNUIFNWTVhDX19Qcm9kdWN0X19yLk5hbWUsICIgKw0KCQkgICAgIlNWTVhDX19Ub3BfTGV2ZWxfX2MsIFNWTVhDX19Ub3BfTGV2ZWxfX3IuU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSwgU1ZNWENfX1RvcF9MZXZlbF9fci5TVk1YQ19fU2VyaWFsX0xvdF9OdW1iZXJfX2MsICIgKw0KCQkgICAgIlNWTVhDX19Db21wYW55X19jLCBTVk1YQ19fQ29tcGFueV9fci5OYW1lLCAiICsNCgkJICAgICJTVk1YQ19fQ29udGFjdF9fYywgU1ZNWENfX0NvbnRhY3RfX3IuTmFtZSwgU1ZNWENfX0FsdGVybmF0ZV9Db21wYW55X19jLCAiICsNCgkJICAgICJTVk1YQ19fRGlzdHJpYnV0b3JfQ29tcGFueV9fYywgU1ZNWENfX0Rpc3RyaWJ1dG9yX0NvbXBhbnlfX3IuTmFtZSwgIiArDQoJCSAgICAiU1ZNWENfX0Rpc3RyaWJ1dG9yX0NvbnRhY3RfX2MsIFNWTVhDX19EaXN0cmlidXRvcl9Db250YWN0X19yLk5hbWUsICIgKw0KCQkgICAgIlNWTVhDX19TYWxlc19PcmRlcl9OdW1iZXJfX2MsIFNWTVhDX19TdGF0dXNfX2MsIFNWTVhDX19EYXRlX1NoaXBwZWRfX2MsIFNWTVhDX19MYXN0X0RhdGVfU2hpcHBlZF9fYywgIiArDQoJCSAgICAiU1ZNWENfX0RhdGVfT3JkZXJlZF9fYywgU1ZNWENfX0RhdGVfSW5zdGFsbGVkX19jLCBTVk1YQ19fU2l0ZV9fYywgU1ZNWENfX1NpdGVfX3IuTmFtZSwgIiArDQoJCSAgICAiU1ZNWENfX1N0cmVldF9fYywgU1ZNWENfX0NpdHlfX2MsIFNWTVhDX19TdGF0ZV9fYywgU1ZNWENfX1ppcF9fYywgU1ZNWENfX0NvdW50cnlfX2MsIFNWTVhDX19JbnN0YWxsYXRpb25fTm90ZXNfX2MgIiArDQoJCSAgICAiRlJPTSBTVk1YQ19fSW5zdGFsbGVkX1Byb2R1Y3RfX2MgV0hFUkUgSWQgPSAnIiArIGxraWQgKyAiJyI7DQoJdmFyIHFyMSA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwxKTsNCglpZiAocXIxICYmIHFyMS5zaXplID4gMCkNCgkgICAgew0KCSAgICB2YXIgaWJyZWMgPSBxcjEuZ2V0QXJyYXkoInJlY29yZHMiKVswXTsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBhcmVudF9wcm9kdWN0IikudmFsdWUgPSBpYnJlYy5TVk1YQ19fUHJvZHVjdF9fci5OYW1lOw0KDQoJCQkvLyBGb3IgbmV3IElCIGNyZWF0aW9uLCBjb3B5IGRldGFpbHMgZnJvbSBwYXJlbnQgSUIgcmVjb3JkDQoJCQkvLyB0byBtYWtlIGRhdGEgZW50cnkgZWFzaWVyDQoJICAgIGlmICghSW5zdFByb2RJZCkNCgkgICAgICAgIHsNCgkJaWYgKGlicmVjLlNWTVhDX19Ub3BfTGV2ZWxfX3IgJiYgaWJyZWMuU1ZNWENfX1RvcF9MZXZlbF9fci5TVk1YQ19fUHJvZHVjdF9fcikNCgkJICAgIFNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgidG9wX3Byb2R1Y3QiLCBpYnJlYy5TVk1YQ19fVG9wX0xldmVsX19yLlNWTVhDX19Qcm9kdWN0X19yLk5hbWUpOw0KDQoJCVNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgidG9wX3NlcmlhbF9sa2lkIiwgaWJyZWMuU1ZNWENfX1RvcF9MZXZlbF9fYyk7DQoJCWlmIChpYnJlYy5TVk1YQ19fVG9wX0xldmVsX19yKQ0KCQkgICAgew0KCQkgICAgU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJ0b3Bfc2VyaWFsX2xrb2xkIiwgaWJyZWMuU1ZNWENfX1RvcF9MZXZlbF9fci5TVk1YQ19fU2VyaWFsX0xvdF9OdW1iZXJfX2MpOw0KCQkgICAgU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJ0b3Bfc2VyaWFsIiwgaWJyZWMuU1ZNWENfX1RvcF9MZXZlbF9fci5TVk1YQ19fU2VyaWFsX0xvdF9OdW1iZXJfX2MpOw0KCQkgICAgfQ0KDQoJCWlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29tcGFueSIpLnZhbHVlLmxlbmd0aCA8PSAwKQ0KCQkgICAgew0KCQkgICAgU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJjb21wYW55X2xraWQiLCBpYnJlYy5TVk1YQ19fQ29tcGFueV9fYyk7DQoJCSAgICBpZiAoaWJyZWMuU1ZNWENfX0NvbXBhbnlfX3IpDQoJCQl7DQoJCQlTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoImNvbXBhbnlfbGtvbGQiLCBpYnJlYy5TVk1YQ19fQ29tcGFueV9fci5OYW1lKTsNCgkJCVNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgiY29tcGFueSIsIGlicmVjLlNWTVhDX19Db21wYW55X19yLk5hbWUpOw0KCQkJfQ0KCQkgICAgfQ0KDQoJCWlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29udGFjdCIpLnZhbHVlLmxlbmd0aCA8PSAwKQ0KCQkgICAgew0KCQkgICAgU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJjb250YWN0X2xraWQiLCBpYnJlYy5TVk1YQ19fQ29udGFjdF9fYyk7DQoJCSAgICBpZiAoaWJyZWMuU1ZNWENfX0NvbnRhY3RfX3IpDQoJCQl7DQoJCQlTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoImNvbnRhY3RfbGtvbGQiLCBpYnJlYy5TVk1YQ19fQ29udGFjdF9fci5OYW1lKTsNCgkJCVNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgiY29udGFjdCIsIGlicmVjLlNWTVhDX19Db250YWN0X19yLk5hbWUpOw0KCQkJfQ0KCQkgICAgfQ0KCQlpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFsdF9jb21wYW55IikudmFsdWUubGVuZ3RoIDw9IDApDQoJCSAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoImFsdF9jb21wYW55IiwgaWJyZWMuU1ZNWENfX0FsdGVybmF0ZV9Db21wYW55X19jKTsNCg0KCQlpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRpc3RfY29tcGFueSIpLnZhbHVlLmxlbmd0aCA8PSAwKQ0KCQkgICAgew0KCQkgICAgU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJkaXN0X2NvbXBhbnlfbGtpZCIsIGlicmVjLlNWTVhDX19EaXN0cmlidXRvcl9Db21wYW55X19jKTsNCgkJICAgIGlmIChpYnJlYy5TVk1YQ19fRGlzdHJpYnV0b3JfQ29tcGFueV9fcikNCgkJCXsNCgkJCVNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgiZGlzdF9jb21wYW55X2xrb2xkIiwgaWJyZWMuU1ZNWENfX0Rpc3RyaWJ1dG9yX0NvbXBhbnlfX3IuTmFtZSk7DQoJCQlTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoImRpc3RfY29tcGFueSIsIGlicmVjLlNWTVhDX19EaXN0cmlidXRvcl9Db21wYW55X19yLk5hbWUpOw0KCQkJfQ0KCQkgICAgfQ0KDQoJCWlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGlzdF9jb250YWN0IikudmFsdWUubGVuZ3RoIDw9IDApDQoJCSAgICB7DQoJCSAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoImRpc3RfY29udGFjdF9sa2lkIiwgaWJyZWMuU1ZNWENfX0Rpc3RyaWJ1dG9yX0NvbnRhY3RfX2MpOw0KCQkgICAgaWYgKGlicmVjLlNWTVhDX19EaXN0cmlidXRvcl9Db250YWN0X19yKQ0KCQkJew0KCQkJU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJkaXN0X2NvbnRhY3RfbGtvbGQiLCBpYnJlYy5TVk1YQ19fRGlzdHJpYnV0b3JfQ29udGFjdF9fci5OYW1lKTsNCgkJCVNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgiZGlzdF9jb250YWN0IiwgaWJyZWMuU1ZNWENfX0Rpc3RyaWJ1dG9yX0NvbnRhY3RfX3IuTmFtZSk7DQoJCSAgICAgICAgfQ0KCQkgICAgfQ0KDQoJCWlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic2FsZXNfb3JkZXIiKS52YWx1ZS5sZW5ndGggPD0gMCkNCgkJICAgIFNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgic2FsZXNfb3JkZXIiLCBpYnJlYy5TVk1YQ19fU2FsZXNfT3JkZXJfTnVtYmVyX19jKTsNCg0KCQlpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNpdGUiKS52YWx1ZS5sZW5ndGggPD0gMCkNCgkJICAgIHsNCgkJICAgIFNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgic2l0ZV9sa2lkIiwgaWJyZWMuU1ZNWENfX1NpdGVfX2MpOw0KCQkgICAgaWYgKGlicmVjLlNWTVhDX19TaXRlX19yKQ0KCQkJew0KCQkJU1ZNWENfQXNzaWduRm9ybVZhbHVlKCJzaXRlX2xrb2xkIiwgaWJyZWMuU1ZNWENfX1NpdGVfX3IuTmFtZSk7DQoJCQlTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoInNpdGUiLCBpYnJlYy5TVk1YQ19fU2l0ZV9fci5OYW1lKTsNCgkJCX0NCgkJICAgIH0NCgkJaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzdHJlZXQiKS52YWx1ZS5sZW5ndGggPD0gMCkNCgkJICAgIHsNCgkJICAgIFNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgic3RyZWV0IiwgaWJyZWMuU1ZNWENfX1N0cmVldF9fYyk7DQoJCSAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoImNpdHkiLCBpYnJlYy5TVk1YQ19fQ2l0eV9fYyk7DQoJCSAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoInN0YXRlIiwgaWJyZWMuU1ZNWENfX1N0YXRlX19jKTsNCgkJICAgIFNWTVhDX0Fzc2lnbkZvcm1WYWx1ZSgiemlwIiwgaWJyZWMuU1ZNWENfX1ppcF9fYyk7DQoJCSAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoImNvdW50cnkiLCBpYnJlYy5TVk1YQ19fQ291bnRyeV9fYyk7DQoJCSAgICB9DQoJCWVsc2UNCgkJICAgIFNWTVhDX0lCX0V4aXRTaXRlKCk7DQoNCgkJaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbnN0X25vdGVzIikudmFsdWUubGVuZ3RoIDw9IDApDQoJCSAgICBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoImluc3Rfbm90ZXMiLCBpYnJlYy5TVk1YQ19fSW5zdGFsbGF0aW9uX05vdGVzX19jKTsNCg0KCQlpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRhdGVfb3JkZXJlZCIpLnZhbHVlLmxlbmd0aCA8PSAwKQ0KCQkgICAgU1ZNWENfQXNzaWduRm9ybURhdGUoImRhdGVfb3JkZXJlZCIsIGlicmVjLlNWTVhDX19EYXRlX09yZGVyZWRfX2MpOw0KDQoJCWlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGF0ZV9zaGlwcGVkIikudmFsdWUubGVuZ3RoIDw9IDApDQoJCSAgICBTVk1YQ19Bc3NpZ25Gb3JtRGF0ZSgiZGF0ZV9zaGlwcGVkIiwgaWJyZWMuU1ZNWENfX0RhdGVfU2hpcHBlZF9fYyk7DQoNCgkJaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsYXN0X2RhdGVfc2hpcHBlZCIpLnZhbHVlLmxlbmd0aCA8PSAwKQ0KCQkgICAgU1ZNWENfQXNzaWduRm9ybURhdGUoImxhc3RfZGF0ZV9zaGlwcGVkIiwgaWJyZWMuU1ZNWENfX0xhc3RfRGF0ZV9TaGlwcGVkX19jKTsNCg0KCQlpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRhdGVfaW5zdGFsbGVkIikudmFsdWUubGVuZ3RoIDw9IDApDQoJCSAgICBTVk1YQ19Bc3NpZ25Gb3JtRGF0ZSgiZGF0ZV9pbnN0YWxsZWQiLCBpYnJlYy5TVk1YQ19fRGF0ZV9JbnN0YWxsZWRfX2MpOw0KCQl9DQoJICAgIH0NCgl9DQogICAgaWYgKGxraWQubGVuZ3RoID09IDApIHsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBhcmVudF9wcm9kdWN0IikudmFsdWUgPSAiIjsgfQ0KICAgIFBhcmVudEliSWQgPSBsa2lkOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLy8gUHJvY2VzcyB0aGUgZXZlbnQgb2YgZXhpdGluZyB0b3AtbGV2ZWwgc2VyaWFsIG51bWJlcg0KLy8gUG9wdWxhdGUgcHJvZHVjdCBuYW1lDQpmdW5jdGlvbiBTVk1YQ19JQl9FeGl0VG9wU2VyaWFsKCkNCnsNCiAgICB2YXIgbGtpZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0b3Bfc2VyaWFsX2xraWQiKS52YWx1ZTsNCiAgICBpZihsa2lkLmxlbmd0aCA+IDAgJiYgbGtpZCAhPSBUb3BJYklkKQ0KICAgIAl7DQoJdmFyIHNvcWwxID0gIlNFTEVDVCBTVk1YQ19fUHJvZHVjdF9fci5OYW1lIEZST00gU1ZNWENfX0luc3RhbGxlZF9Qcm9kdWN0X19jIFdIRVJFIElkID0gJyIgKyBsa2lkICsgIiciOw0KCXZhciBxcjEgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMSk7DQoJaWYgKHFyMSAmJiBxcjEuc2l6ZSA+IDApDQoJICAgIHsNCgkgICAgdmFyIHJlYzEgPSBxcjEuZ2V0QXJyYXkoInJlY29yZHMiKVswXTsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRvcF9wcm9kdWN0IikudmFsdWUgPSByZWMxLlNWTVhDX19Qcm9kdWN0X19yLk5hbWU7DQoJICAgIH0NCgl9DQogICAgaWYgKGxraWQubGVuZ3RoID09IDApIHsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRvcF9wcm9kdWN0IikudmFsdWUgPSAiIjsgfQ0KICAgIFRvcEliSWQgPSBsa2lkOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLy8gUHJvY2VzcyB0aGUgZXZlbnQgb2YgZXhpdGluZyBjb250YWN0DQovLyBQb3B1bGF0ZSBjb21wYW55IGlmIGJsYW5rDQpmdW5jdGlvbiBTVk1YQ19JQl9FeGl0Q29udGFjdCgpDQp7DQogICAgdmFyIGNvbXBpZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb21wYW55X2xraWQiKS52YWx1ZTsNCg0KICAgIHZhciBsa2lkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvbnRhY3RfbGtpZCIpLnZhbHVlOw0KICAgIGlmKGxraWQubGVuZ3RoID4gMCAmJiBsa2lkICE9IENvbnRhY3RJZCAmJiBjb21waWQubGVuZ3RoIDw9IDApDQogICAgCXsNCgl2YXIgc29xbDEgPSAiU0VMRUNUIEFjY291bnRJZCwgQWNjb3VudC5OYW1lIEZST00gQ29udGFjdCBXSEVSRSBJZCA9ICciICsgbGtpZCArICInIjsNCgl2YXIgcXIxID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDEpOw0KCWlmIChxcjEgJiYgcXIxLnNpemUgPiAwKQ0KCSAgICB7DQoJICAgIHZhciByZWMxID0gcXIxLmdldEFycmF5KCJyZWNvcmRzIilbMF07DQoJICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb21wYW55X2xraWQiKS52YWx1ZSA9IHJlYzEuQWNjb3VudElkOw0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29tcGFueSIpLnZhbHVlID0gcmVjMS5BY2NvdW50Lk5hbWU7DQoJICAgIH0NCgl9DQogICAgQ29udGFjdElkID0gbGtpZDsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCi8vIFByb2Nlc3MgdGhlIGV2ZW50IG9mIGV4aXRpbmcgZGlzdHJpYnV0b3IgY29udGFjdA0KLy8gUG9wdWxhdGUgY29tcGFueSBpZiBibGFuaw0KZnVuY3Rpb24gU1ZNWENfSUJfRXhpdERpc3RDb250YWN0KCkNCnsNCiAgICB2YXIgY29tcGlkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRpc3RfY29tcGFueV9sa2lkIikudmFsdWU7DQoNCiAgICB2YXIgbGtpZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkaXN0X2NvbnRhY3RfbGtpZCIpLnZhbHVlOw0KICAgIGlmKGxraWQubGVuZ3RoID4gMCAmJiBsa2lkICE9IERpc3RDb250YWN0SWQgJiYgY29tcGlkLmxlbmd0aCA8PSAwKQ0KICAgIAl7DQoJdmFyIHNvcWwxID0gIlNFTEVDVCBBY2NvdW50SWQsIEFjY291bnQuTmFtZSBGUk9NIENvbnRhY3QgV0hFUkUgSWQgPSAnIiArIGxraWQgKyAiJyI7DQoJdmFyIHFyMSA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwxKTsNCglpZiAocXIxICYmIHFyMS5zaXplID4gMCkNCgkgICAgew0KCSAgICB2YXIgcmVjMSA9IHFyMS5nZXRBcnJheSgicmVjb3JkcyIpWzBdOw0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGlzdF9jb21wYW55X2xraWQiKS52YWx1ZSA9IHJlYzEuQWNjb3VudElkOw0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGlzdF9jb21wYW55IikudmFsdWUgPSByZWMxLkFjY291bnQuTmFtZTsNCgkgICAgfQ0KCX0NCiAgICBEaXN0Q29udGFjdElkID0gbGtpZDsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCi8vIFByb2Nlc3MgdGhlIGV2ZW50IG9mIGV4aXRpbmcgU2l0ZQ0KLy8gUG9wdWxhdGUgYWRkcmVzcyBmaWVsZHMgZnJvbSBzaXRlDQpmdW5jdGlvbiBTVk1YQ19JQl9FeGl0U2l0ZSgpDQp7DQogICAgdmFyIGxraWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic2l0ZV9sa2lkIikudmFsdWU7DQogICAgaWYobGtpZC5sZW5ndGggPiAwICYmIGxraWQgIT0gU2l0ZUlkKQ0KICAgIAl7DQoJdmFyIHNvcWwxID0gIlNFTEVDVCBTVk1YQ19fU3RyZWV0X19jLCBTVk1YQ19fQ2l0eV9fYywgU1ZNWENfX1N0YXRlX19jLCBTVk1YQ19fWmlwX19jLCBTVk1YQ19fQ291bnRyeV9fYyAiICsNCgkJICAgICJGUk9NIFNWTVhDX19TaXRlX19jIFdIRVJFIElkID0gJyIgKyBsa2lkICsgIiciOw0KCXZhciBxcjEgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMSk7DQoJaWYgKHFyMSAmJiBxcjEuc2l6ZSA+IDApDQoJICAgIHsNCgkgICAgdmFyIHJlYzEgPSBxcjEuZ2V0QXJyYXkoInJlY29yZHMiKVswXTsNCgkgICAgaWYgKHJlYzEuU1ZNWENfX1N0cmVldF9fYykNCgkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInN0cmVldCIpLnZhbHVlID0gcmVjMS5TVk1YQ19fU3RyZWV0X19jOw0KCSAgICBpZiAocmVjMS5TVk1YQ19fQ2l0eV9fYykNCgkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNpdHkiKS52YWx1ZSA9IHJlYzEuU1ZNWENfX0NpdHlfX2M7DQoJICAgIGlmIChyZWMxLlNWTVhDX19TdGF0ZV9fYykNCgkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInN0YXRlIikudmFsdWUgPSByZWMxLlNWTVhDX19TdGF0ZV9fYzsNCgkgICAgaWYgKHJlYzEuU1ZNWENfX1ppcF9fYykNCgkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInppcCIpLnZhbHVlID0gcmVjMS5TVk1YQ19fWmlwX19jOw0KCSAgICBpZiAocmVjMS5TVk1YQ19fQ291bnRyeV9fYykNCgkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvdW50cnkiKS52YWx1ZSA9IHJlYzEuU1ZNWENfX0NvdW50cnlfX2M7DQoJICAgIH0NCgl9DQogICAgU2l0ZUlkID0gbGtpZDsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCi8vIFByb2Nlc3MgdGhlIGV2ZW50IG9mIGV4aXRpbmcgZGF0ZSBzaGlwcGVkDQovLyBDb3B5IGRhdGUgc2hpcHBlZCB0byBsYXN0LWRhdGUtc2hpcHBlZCBpZiBpdCBpcyBlbXB0eQ0KZnVuY3Rpb24gU1ZNWENfSUJfRXhpdERhdGVTaGlwcGVkKCkNCnsNCiAgICB2YXIgZHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGF0ZV9zaGlwcGVkIikudmFsdWU7DQogICAgdmFyIGxkcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsYXN0X2RhdGVfc2hpcHBlZCIpLnZhbHVlOw0KICAgIGlmKGxkcy5sZW5ndGggPD0gMCAmJiBkcyAhPSBsZHMpDQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxhc3RfZGF0ZV9zaGlwcGVkIikudmFsdWUgPSBkczsNCn0NCi8qKioqPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qKioqKi8NCmZ1bmN0aW9uIFNWTVhDX0lCX1Nob3dJQkNvbmZpZ3VyYXRpb24oaWJpZCkNCnsNCiAgICB2YXIgSGFzUGFyZW50ID0gdHJ1ZTsNCg0KICAgIGlmICghaWJpZCkgeyByZXR1cm47IH0NCg0KICAgIEluc3RQcm9kSWQgPSBpYmlkOw0KDQogICAgeGJEZXRlY3RCcm93c2VyKCk7DQoNCiAgICBTVk1YQ19Jbml0TWVzc2FnZUxpc3QoIklQUkRTQzEiKTsNCg0KICAgIHdoaWxlKEhhc1BhcmVudCkNCiAgICAJew0KCXZhciBzb3FsMSA9ICJTRUxFQ1QgSWQsIFNWTVhDX19Qcm9kdWN0X19yLk5hbWUsIFNWTVhDX19TZXJpYWxfTG90X051bWJlcl9fYywgU1ZNWENfX1BhcmVudF9fYywgIiArDQoJCSAgICAiU1ZNWENfX1N0YXR1c19fYywgU1ZNWENfX0RhdGVfU2hpcHBlZF9fYywgU1ZNWENfX0RhdGVfSW5zdGFsbGVkX19jLCAiICsNCgkJICAgICJTVk1YQ19fU2l0ZV9fYywgU1ZNWENfX1NpdGVfX3IuTmFtZSwgU1ZNWENfX1NpdGVfX3IuU1ZNWENfX0NpdHlfX2MsICIgKw0KCQkgICAgIlNWTVhDX19TaXRlX19yLlNWTVhDX19Db3VudHJ5X19jLCBTVk1YQ19fQ2l0eV9fYywgU1ZNWENfX0NvdW50cnlfX2MgIiArDQoJCSAgICAiRlJPTSBTVk1YQ19fSW5zdGFsbGVkX1Byb2R1Y3RfX2MgV0hFUkUgSWQgPSAnIiArIGliaWQgKyAiJyI7DQoJdmFyIHFyMSA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwxKTsNCglpZiAocXIxLnNpemUgPD0gMCkNCgkgICAgew0KCSAgICBhbGVydChTVk1YQ19HZXRNZXNzYWdlKCJNU0cwMDIiKSk7DQoJICAgIHJldHVybiBmYWxzZTsNCgkgICAgfQ0KCWlicmVjID0gcXIxLmdldEFycmF5KCJyZWNvcmRzIilbMF07DQoJaWYgKGlicmVjLlNWTVhDX19QYXJlbnRfX2MgJiYgaWJyZWMuU1ZNWENfX1BhcmVudF9fYy5sZW5ndGggPiAwKQ0KCSAgICBpYmlkID0gaWJyZWMuU1ZNWENfX1BhcmVudF9fYzsNCgllbHNlDQoJICAgIEhhc1BhcmVudCA9IGZhbHNlOw0KCX0NCg0KICAgIHZhciB0cmVlRGF0YSA9IGlicmVjLlNWTVhDX19Qcm9kdWN0X19yLk5hbWU7DQoNCiAgICBpZiAoaWJyZWMuU1ZNWENfX1NlcmlhbF9Mb3RfTnVtYmVyX19jICYmIGlicmVjLlNWTVhDX19TZXJpYWxfTG90X051bWJlcl9fYy5sZW5ndGggPiAwKSB0cmVlRGF0YSArPSAiLCAiICsgaWJyZWMuU1ZNWENfX1NlcmlhbF9Mb3RfTnVtYmVyX19jOw0KICAgIGlmIChpYnJlYy5TVk1YQ19fU3RhdHVzX19jICYmIGlicmVjLlNWTVhDX19TdGF0dXNfX2MubGVuZ3RoID4gMCkgdHJlZURhdGEgKz0gIiwgIiArIGlicmVjLlNWTVhDX19TdGF0dXNfX2M7DQoNCiAgICBpZiAoaWJyZWMuU1ZNWENfX1NpdGVfX3IpDQoJew0KCWlmIChpYnJlYy5TVk1YQ19fU2l0ZV9fci5TVk1YQ19fQ2l0eV9fYykgdHJlZURhdGEgKz0gIiwgIiArIGlicmVjLlNWTVhDX19TaXRlX19yLlNWTVhDX19DaXR5X19jOw0KCWlmIChpYnJlYy5TVk1YQ19fU2l0ZV9fci5TVk1YQ19fQ291bnRyeV9fYykgdHJlZURhdGEgKz0gIiwgIiArIGlicmVjLlNWTVhDX19TaXRlX19yLlNWTVhDX19Db3VudHJ5X19jOw0KCX0NCiAgICBlbHNlDQoJew0KCWlmIChpYnJlYy5TVk1YQ19fQ2l0eV9fYykgdHJlZURhdGEgKz0gIiwgIiArIGlicmVjLlNWTVhDX19DaXR5X19jOw0KCWlmIChpYnJlYy5TVk1YQ19fQ291bnRyeV9fYykgdHJlZURhdGEgKz0gIiwgIiArIGlicmVjLlNWTVhDX19Db3VudHJ5X19jOw0KCX0NCg0KICAgIGZvbGRlcnNUcmVlID0gZ0ZsZCgiPGI+IiArIHRyZWVEYXRhICsgIjwvYj4iLCAiIik7DQogICAgZm9sZGVyc1RyZWUudHJlZUlEID0gIklCVHJlZSIgOw0KDQogICAgCSAgICAvLyBHZXQgY2hpbGRyZW4gZm9yIHRoZSB0b3AtbGV2ZWwgbm9kZQ0KICAgIFNWTVhDX0lCX0dldElCQ2hpbGRyZW4oaWJyZWMuSWQsIGZvbGRlcnNUcmVlKTsNCg0KICAgIGluaXRpYWxpemVEb2N1bWVudCgpOwkvLyBUaGlzIGlzIHRoZSBmdW5jdGlvbiB0aGF0IHJlbmRlcnMgdGhlIHRyZWUgb24gdGhlIEhUTUwgZGl2DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWENfSUJfR2V0SUJDaGlsZHJlbihpYmlkLCBwYXJlbnROb2RlKQ0Kew0KICAgIHZhciBzb3FsMiA9ICJTRUxFQ1QgSWQsIFNWTVhDX19Qcm9kdWN0X19yLk5hbWUsIFNWTVhDX19TZXJpYWxfTG90X051bWJlcl9fYywgIiArDQoJCSJTVk1YQ19fU3RhdHVzX19jLCBTVk1YQ19fRGF0ZV9TaGlwcGVkX19jLCBTVk1YQ19fRGF0ZV9JbnN0YWxsZWRfX2MsICIgKw0KCQkiU1ZNWENfX1NpdGVfX2MsIFNWTVhDX19TaXRlX19yLk5hbWUsIFNWTVhDX19TaXRlX19yLlNWTVhDX19DaXR5X19jLCAiICsNCgkJIlNWTVhDX19TaXRlX19yLlNWTVhDX19Db3VudHJ5X19jLCBTVk1YQ19fQ2l0eV9fYywgU1ZNWENfX0NvdW50cnlfX2MgIiArDQoJCSJGUk9NIFNWTVhDX19JbnN0YWxsZWRfUHJvZHVjdF9fYyBXSEVSRSBTVk1YQ19fUGFyZW50X19jID0gJyIgKyBpYmlkICsgIiciOw0KICAgIHZhciBxcjIgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMik7DQoNCiAgICBpZiAocXIyLnNpemUgPD0gMCkgeyByZXR1cm47IH0NCg0KICAgIHZhciBpYnJlY3MgPSBuZXcgc2ZvcmNlLlF1ZXJ5UmVzdWx0SXRlcmF0b3IocXIyKTsNCg0KICAgIHdoaWxlIChpYnJlY3MuaGFzTmV4dCgpKQ0KICAgIAl7DQoJdmFyIGlicmVjID0gaWJyZWNzLm5leHQoKTsNCg0KCXZhciB0cmVlRGF0YSA9IGlicmVjLlNWTVhDX19Qcm9kdWN0X19yLk5hbWU7DQoNCglpZiAoaWJyZWMuU1ZNWENfX1NlcmlhbF9Mb3RfTnVtYmVyX19jICYmIGlicmVjLlNWTVhDX19TZXJpYWxfTG90X051bWJlcl9fYy5sZW5ndGggPiAwKSB0cmVlRGF0YSArPSAiLCAiICsgaWJyZWMuU1ZNWENfX1NlcmlhbF9Mb3RfTnVtYmVyX19jOw0KCWlmIChpYnJlYy5TVk1YQ19fU3RhdHVzX19jICYmIGlicmVjLlNWTVhDX19TdGF0dXNfX2MubGVuZ3RoID4gMCkgdHJlZURhdGEgKz0gIiwgIiArIGlicmVjLlNWTVhDX19TdGF0dXNfX2M7DQoNCglpZiAoaWJyZWMuU1ZNWENfX1NpdGVfX3IpDQoJICAgIHsNCgkgICAgaWYgKGlicmVjLlNWTVhDX19TaXRlX19yLlNWTVhDX19DaXR5X19jKSB0cmVlRGF0YSArPSAiLCAiICsgaWJyZWMuU1ZNWENfX1NpdGVfX3IuU1ZNWENfX0NpdHlfX2M7DQoJICAgIGlmIChpYnJlYy5TVk1YQ19fU2l0ZV9fci5TVk1YQ19fQ291bnRyeV9fYykgdHJlZURhdGEgKz0gIiwgIiArIGlicmVjLlNWTVhDX19TaXRlX19yLlNWTVhDX19Db3VudHJ5X19jOw0KCSAgICB9DQoJZWxzZQ0KCSAgICB7DQoJICAgIGlmIChpYnJlYy5TVk1YQ19fQ2l0eV9fYykgdHJlZURhdGEgKz0gIiwgIiArIGlicmVjLlNWTVhDX19DaXR5X19jOw0KCSAgICBpZiAoaWJyZWMuU1ZNWENfX0NvdW50cnlfX2MpIHRyZWVEYXRhICs9ICIsICIgKyBpYnJlYy5TVk1YQ19fQ291bnRyeV9fYzsNCgkgICAgfQ0KDQoJdmFyIHRyZWVDaGlsZCA9IGluc0ZsZChwYXJlbnROb2RlLCBnRmxkKHRyZWVEYXRhLCAiLyIgKyBpYnJlYy5JZCkpOw0KDQoJU1ZNWENfSUJfR2V0SUJDaGlsZHJlbihpYnJlYy5JZCwgdHJlZUNoaWxkKTsNCgl9DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQovKioqKioqKioqKioqKjw8PDw8PDw8PDw8PCBHRU5FUklDIFVUSUxJVElFUyA+Pj4+Pj4+Pj4+Pj4+Pj4+PiAqKioqKioqKioqKioqKioqKi8NCi8vIEdldCB0aGUgcmV0VVJMIHBhcmFtZXRlciBmcm9tIHRoZSB3aW5kb3cgVVJMDQovLyBJdCBpcyByZXF1aXJlZCBpbiBzYXZlIG9yIGNhbmNlbCBldmVudHMNCmZ1bmN0aW9uIFNWTVhDX0dldFJldHVyblVSTCgpDQp7DQogICAgdmFyIHRoZUFyZ05hbWUgPSAncmV0VVJMJzsNCiAgICB2YXIgc0FyZ3MgPSBwYXJlbnQud2luZG93LmxvY2F0aW9uLnNlYXJjaC5zbGljZSgxKS5zcGxpdCgnJicpOw0KICAgIHIgPSAnJzsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNBcmdzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgIGlmIChzQXJnc1tpXS5zbGljZSgwLHNBcmdzW2ldLmluZGV4T2YoJz0nKSkgPT0gdGhlQXJnTmFtZSkgew0KICAgICAgICAgICAgciA9IHNBcmdzW2ldLnNsaWNlKHNBcmdzW2ldLmluZGV4T2YoJz0nKSsxKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfQ0KICAgIHJldFVSTCA9IHIubGVuZ3RoID4gMCA/IHVuZXNjYXBlKHIpLnNwbGl0KCcsJykgOiAnJzsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCi8vIEFzc2lnbiBhIGdpdmVuIHRleHQgdmFsdWUgdG8gYSBmb3JtIGZpZWxkDQpmdW5jdGlvbiBTVk1YQ19Bc3NpZ25Gb3JtVmFsdWUoY3RsbmFtZSwgZnJvbXZhbCkNCnsNCiAgICBpZihmcm9tdmFsKSB7IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGN0bG5hbWUpLnZhbHVlID0gZnJvbXZhbDsgfQ0KICAgIGVsc2UgeyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjdGxuYW1lKS52YWx1ZSA9ICIiOyB9DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQovLyBBc3NpZ24gYSBnaXZlbiBkYXRlIHZhbHVlIHRvIGEgZm9ybSBmaWVsZCBhZnRlciBjb252ZXJ0aW5nIGl0IHRvIHRoZSB1c2VyJ3MgbG9jYWxlIGZvcm1hdA0KZnVuY3Rpb24gU1ZNWENfQXNzaWduRm9ybURhdGUoY3RsbmFtZSwgZnJvbWRhdGUpDQp7DQogICAgaWYgKGZyb21kYXRlKQ0KICAgICAgICB7DQoJdmFyIGRjID0gZnJvbWRhdGUuc3BsaXQoJy0nLCAzKTsNCgl2YXIgZCA9IG5ldyBEYXRlKGRjWzBdLCBkY1sxXSAtIDEsIGRjWzJdKTsNCgl2YXIgZGZtdCA9IHBhcmVudC5Vc2VyQ29udGV4dC5kYXRlRm9ybWF0Ow0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGN0bG5hbWUpLnZhbHVlID0gRGF0ZVV0aWwuZm9ybWF0RGF0ZShkLCBkZm10KTsNCgl9DQogICAgZWxzZQ0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGN0bG5hbWUpLnZhbHVlID0gIiI7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQovLyBDb252ZXJ0IGEgZGF0ZSBmcm9tIHVzZXIncyBsb2NhbCBmb3JtYXQgdG8gU0ZEQydzIGZvcm1hdCAoWVlZWS1NTS1ERCkNCmZ1bmN0aW9uIFNWTVhDX0NvbnZlcnRUb1NGRENEYXRlRm9ybWF0KGN0bG5hbWUpDQp7DQogICAgdmFyIGR0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY3RsbmFtZSkudmFsdWU7DQogICAgaWYgKGR0Lmxlbmd0aCA8PSAwKSByZXR1cm4gbnVsbDsNCg0KICAgIHZhciBkID0gU1ZNWENfR2V0RGF0ZUZyb21Gb3JtYXQoZHQsIHBhcmVudC5Vc2VyQ29udGV4dC5kYXRlRm9ybWF0KTsNCg0KICAgIHZhciBtb24gPSBwYXJzZUludChkLmdldE1vbnRoKCkpICsgMTsNCiAgICBpZiAobW9uIDwgMTApIHsgbW9uID0gIjAiICsgbW9uOyB9DQoNCiAgICB2YXIgZGF5ID0gcGFyc2VJbnQoZC5nZXREYXRlKCkpOw0KICAgIGlmIChkYXkgPCAxMCkgeyBkYXkgPSAiMCIgKyBkYXk7IH0NCg0KICAgIHZhciBkdHMgPSBkLmdldEZ1bGxZZWFyKCkgKyAiLSIgKyBtb24gKyAiLSIgKyBkYXk7DQoNCiAgICByZXR1cm4gZHRzOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLy8gQ29udmVydCBhIERhdGUgdmFyaWFibGUgdG8gU0ZEQyBkYXRlIGZvcm1hdA0KZnVuY3Rpb24gU1ZNWENfQ29udmVydERhdGVUb1NGREMoZGF0ZXZhbCkNCnsNCiAgICB2YXIgbW9uID0gcGFyc2VJbnQoZGF0ZXZhbC5nZXRNb250aCgpKSArIDE7DQogICAgaWYgKG1vbiA8IDEwKSB7IG1vbiA9ICIwIiArIG1vbjsgfQ0KDQogICAgdmFyIGRheSA9IHBhcnNlSW50KGRhdGV2YWwuZ2V0RGF0ZSgpKTsNCiAgICBpZiAoZGF5IDwgMTApIHsgZGF5ID0gIjAiICsgZGF5OyB9DQoNCiAgICB2YXIgZHRzID0gZGF0ZXZhbC5nZXRGdWxsWWVhcigpICsgIi0iICsgbW9uICsgIi0iICsgZGF5Ow0KDQogICAgcmV0dXJuIGR0czsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCi8vIFRoaXMgZnVuY3Rpb24gaXMgYSBoYWNrIGZyb20gU0ZEQyBsaWJyYXJ5LiBJdCByZXR1cm5zIGEgamF2YXNjcmlwdCBEYXRlIHZhcmlhYmxlDQovLyBmb3IgYSBkYXRlIHZhbHVlIGluIHRoZSBnaXZlbiBmb3JtYXQuIFRoZSBTRkRDIHJvdXRpbmUgcmV0dXJucyB0aGUgdGltZSBwYXJ0IHdoaWNoIHdlIGRvbid0IHdhbnQuDQpmdW5jdGlvbiBTVk1YQ19HZXREYXRlRnJvbUZvcm1hdCh2YWwsZm9ybWF0KQ0Kew0KCXZhbD12YWwrIiI7DQoJZm9ybWF0PWZvcm1hdCsiIjsNCgl2YXIgaV92YWw9MDsNCgl2YXIgaV9mb3JtYXQ9MDsNCgl2YXIgYz0iIjsNCgl2YXIgdG9rZW49IiI7DQoJdmFyIHRva2VuMj0iIjsNCgl2YXIgeCx5Ow0KCXZhciBub3c9bmV3IERhdGUoKTsNCgl2YXIgeWVhcj1ub3cuZ2V0WWVhcigpOw0KCXZhciBtb250aD1ub3cuZ2V0TW9udGgoKSsxOw0KCXZhciBkYXRlPTE7DQoJdmFyIGhoPW5vdy5nZXRIb3VycygpOw0KCXZhciBtbT1ub3cuZ2V0TWludXRlcygpOw0KCXZhciBzcz1ub3cuZ2V0U2Vjb25kcygpOw0KCXZhciBhbXBtPSIiOw0KCQ0KCXdoaWxlIChpX2Zvcm1hdCA8IGZvcm1hdC5sZW5ndGgpIHsNCgkJLy8gR2V0IG5leHQgdG9rZW4gZnJvbSBmb3JtYXQgc3RyaW5nDQoJCWM9Zm9ybWF0LmNoYXJBdChpX2Zvcm1hdCk7DQoJCXRva2VuPSIiOw0KCQl3aGlsZSAoKGZvcm1hdC5jaGFyQXQoaV9mb3JtYXQpPT1jKSAmJiAoaV9mb3JtYXQgPCBmb3JtYXQubGVuZ3RoKSkgew0KCQkJdG9rZW4gKz0gZm9ybWF0LmNoYXJBdChpX2Zvcm1hdCsrKTsNCgkJCX0NCgkJLy8gRXh0cmFjdCBjb250ZW50cyBvZiB2YWx1ZSBiYXNlZCBvbiBmb3JtYXQgdG9rZW4NCgkJaWYgKHRva2VuPT0ieXl5eSIgfHwgdG9rZW49PSJ5eSIgfHwgdG9rZW49PSJ5Iikgew0KCQkJaWYgKHRva2VuPT0ieXl5eSIpIHsgeD0yO3k9NDsgfSAvLyB4PTIseT00IHRvIGJlIGNvbnNpc3RlbnQgd2l0aCBqYXZhLg0KCQkJaWYgKHRva2VuPT0ieXkiKSAgIHsgeD0yO3k9MjsgfQ0KCQkJaWYgKHRva2VuPT0ieSIpICAgIHsgeD0yO3k9NDsgfQ0KCQkJeWVhcj1EYXRlVXRpbC5fZ2V0SW50KHZhbCxpX3ZhbCx4LHkpOw0KCQkJaWYgKHllYXI9PW51bGwpIHsgcmV0dXJuIDA7IH0NCgkJCWlfdmFsICs9IHllYXIubGVuZ3RoOw0KCQkJaWYgKHllYXIubGVuZ3RoPT0yKSB7DQoJCQkJaWYgKHllYXIgPiA3MCkgeyB5ZWFyPTE5MDArKHllYXItMCk7IH0NCgkJCQllbHNlIHsgeWVhcj0yMDAwKyh5ZWFyLTApOyB9DQoJCQkJfQ0KCQkJfQ0KCQllbHNlIGlmICh0b2tlbj09Ik1NTSJ8fHRva2VuPT0iTk5OIil7DQoJCQltb250aD0wOw0KCQkJZm9yICh2YXIgaT0wOyBpPERhdGVVdGlsLk1PTlRIX05BTUVTLmxlbmd0aDsgaSsrKSB7DQoJCQkJdmFyIG1vbnRoX25hbWU9RGF0ZVV0aWwuTU9OVEhfTkFNRVNbaV07DQoJCQkJaWYgKHZhbC5zdWJzdHJpbmcoaV92YWwsaV92YWwrbW9udGhfbmFtZS5sZW5ndGgpLnRvTG93ZXJDYXNlKCk9PW1vbnRoX25hbWUudG9Mb3dlckNhc2UoKSkgew0KCQkJCQlpZiAodG9rZW49PSJNTU0ifHwodG9rZW49PSJOTk4iJiZpPjExKSkgew0KCQkJCQkJbW9udGg9aSsxOw0KCQkJCQkJaWYgKG1vbnRoPjEyKSB7IG1vbnRoIC09IDEyOyB9DQoJCQkJCQlpX3ZhbCArPSBtb250aF9uYW1lLmxlbmd0aDsNCgkJCQkJCWJyZWFrOw0KCQkJCQkJfQ0KCQkJCQl9DQoJCQkJfQ0KCQkJaWYgKChtb250aCA8IDEpfHwobW9udGg+MTIpKXtyZXR1cm4gMDt9DQoJCQl9DQoJCWVsc2UgaWYgKHRva2VuPT0iRUUifHx0b2tlbj09IkUiKXsNCgkJCWZvciAodmFyIGk9MDsgaTxEYXRlVXRpbC5EQVlfTkFNRVMubGVuZ3RoOyBpKyspIHsNCgkJCQl2YXIgZGF5X25hbWU9RGF0ZVV0aWwuREFZX05BTUVTW2ldOw0KCQkJCWlmICh2YWwuc3Vic3RyaW5nKGlfdmFsLGlfdmFsK2RheV9uYW1lLmxlbmd0aCkudG9Mb3dlckNhc2UoKT09ZGF5X25hbWUudG9Mb3dlckNhc2UoKSkgew0KCQkJCQlpX3ZhbCArPSBkYXlfbmFtZS5sZW5ndGg7DQoJCQkJCWJyZWFrOw0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQllbHNlIGlmICh0b2tlbj09Ik1NInx8dG9rZW49PSJNIikgew0KCQkJbW9udGg9RGF0ZVV0aWwuX2dldEludCh2YWwsaV92YWwsMSwyKTsgLy8gQWx3YXlzIHVzZSBtaW4gbGVuIDEgdG8gYmUgbGVuaWVudC4NCgkJCWlmKG1vbnRoPT1udWxsfHwobW9udGg8MSl8fChtb250aD4xMikpe3JldHVybiAwO30NCgkJCWlfdmFsKz1tb250aC5sZW5ndGg7fQ0KCQllbHNlIGlmICh0b2tlbj09ImRkInx8dG9rZW49PSJkIikgew0KCQkJZGF0ZT1EYXRlVXRpbC5fZ2V0SW50KHZhbCxpX3ZhbCwxLDIpOyAvLyBBbHdheXMgdXNlIG1pbiBsZW4gMSB0byBiZSBsZW5pZW50Lg0KCQkJaWYoZGF0ZT09bnVsbHx8KGRhdGU8MSl8fChkYXRlPjMxKSl7cmV0dXJuIDA7fQ0KCQkJaV92YWwrPWRhdGUubGVuZ3RoO30NCgkJZWxzZSBpZiAodG9rZW49PSJoaCJ8fHRva2VuPT0iaCIpIHsNCgkJCWhoPURhdGVVdGlsLl9nZXRJbnQodmFsLGlfdmFsLHRva2VuLmxlbmd0aCwyKTsNCgkJCWlmKGhoPT1udWxsfHwoaGg8MSl8fChoaD4xMikpe3JldHVybiAwO30NCgkJCWlfdmFsKz1oaC5sZW5ndGg7fQ0KCQllbHNlIGlmICh0b2tlbj09IkhIInx8dG9rZW49PSJIIikgew0KCQkJaGg9RGF0ZVV0aWwuX2dldEludCh2YWwsaV92YWwsdG9rZW4ubGVuZ3RoLDIpOw0KCQkJaWYoaGg9PW51bGx8fChoaDwwKXx8KGhoPjIzKSl7cmV0dXJuIDA7fQ0KCQkJaV92YWwrPWhoLmxlbmd0aDt9DQoJCWVsc2UgaWYgKHRva2VuPT0iS0sifHx0b2tlbj09IksiKSB7DQoJCQloaD1EYXRlVXRpbC5fZ2V0SW50KHZhbCxpX3ZhbCx0b2tlbi5sZW5ndGgsMik7DQoJCQlpZihoaD09bnVsbHx8KGhoPDApfHwoaGg+MTEpKXtyZXR1cm4gMDt9DQoJCQlpX3ZhbCs9aGgubGVuZ3RoO30NCgkJZWxzZSBpZiAodG9rZW49PSJrayJ8fHRva2VuPT0iayIpIHsNCgkJCWhoPURhdGVVdGlsLl9nZXRJbnQodmFsLGlfdmFsLHRva2VuLmxlbmd0aCwyKTsNCgkJCWlmKGhoPT1udWxsfHwoaGg8MSl8fChoaD4yNCkpe3JldHVybiAwO30NCgkJCWlfdmFsKz1oaC5sZW5ndGg7aGgtLTt9DQoJCWVsc2UgaWYgKHRva2VuPT0ibW0ifHx0b2tlbj09Im0iKSB7DQoJCQltbT1EYXRlVXRpbC5fZ2V0SW50KHZhbCxpX3ZhbCx0b2tlbi5sZW5ndGgsMik7DQoJCQlpZihtbT09bnVsbHx8KG1tPDApfHwobW0+NTkpKXtyZXR1cm4gMDt9DQoJCQlpX3ZhbCs9bW0ubGVuZ3RoO30NCgkJZWxzZSBpZiAodG9rZW49PSJzcyJ8fHRva2VuPT0icyIpIHsNCgkJCXNzPURhdGVVdGlsLl9nZXRJbnQodmFsLGlfdmFsLHRva2VuLmxlbmd0aCwyKTsNCgkJCWlmKHNzPT1udWxsfHwoc3M8MCl8fChzcz41OSkpe3JldHVybiAwO30NCgkJCWlfdmFsKz1zcy5sZW5ndGg7fQ0KCQllbHNlIGlmICh0b2tlbj09ImEiKSB7DQoJCSAgICB2YXIgYW0gPSBEYXRlVXRpbC5nZXRBTVN5bWJvbCgpOw0KCQkgICAgdmFyIHBtID0gRGF0ZVV0aWwuZ2V0UE1TeW1ib2woKTsNCgkJICAgIHZhciBzdHJhID0gdmFsLnN1YnN0cmluZyhpX3ZhbCwgaV92YWwgKyBhbS5sZW5ndGgpOw0KCQkgICAgdmFyIHN0cnAgPSB2YWwuc3Vic3RyaW5nKGlfdmFsLCBpX3ZhbCArIHBtLmxlbmd0aCk7DQoJCQlpZiAoc3RyYSA9PSBhbSB8fCBzdHJhLnRvVXBwZXJDYXNlKCkgPT0gYW0pIHsNCgkJCSAgICBhbXBtID0gYW07DQoJCQl9IGVsc2UgaWYgKHN0cnAgPT0gcG0gfHwgc3RycC50b1VwcGVyQ2FzZSgpID09IHBtKSB7DQoJCQkgICAgYW1wbSA9IHBtOw0KCQkJfSBlbHNlIHsNCgkJCSAgICByZXR1cm4gMDsNCgkJICAgIH0NCiAgICAgICAgICAgICAgICBpX3ZhbCArPSBhbXBtLmxlbmd0aDsNCgkJfQ0KCQllbHNlIHsNCgkJCWlmICh2YWwuc3Vic3RyaW5nKGlfdmFsLGlfdmFsK3Rva2VuLmxlbmd0aCkhPXRva2VuKSB7cmV0dXJuIDA7fQ0KCQkJZWxzZSB7aV92YWwrPXRva2VuLmxlbmd0aDt9DQoJCQl9DQoJCX0NCgkvLyBJZiB0aGVyZSBhcmUgYW55IHRyYWlsaW5nIGNoYXJhY3RlcnMgbGVmdCBpbiB0aGUgdmFsdWUsIGl0IGRvZXNuJ3QgbWF0Y2gNCglpZiAoaV92YWwgIT0gdmFsLmxlbmd0aCkgeyByZXR1cm4gMDsgfQ0KCS8vIElzIGRhdGUgdmFsaWQgZm9yIG1vbnRoPw0KCWlmIChtb250aD09Mikgew0KCQkvLyBDaGVjayBmb3IgbGVhcCB5ZWFyDQoJCWlmICggKCAoeWVhciU0PT0wKSYmKHllYXIlMTAwICE9IDApICkgfHwgKHllYXIlNDAwPT0wKSApIHsgLy8gbGVhcCB5ZWFyDQoJCQlpZiAoZGF0ZSA+IDI5KXsgcmV0dXJuIDA7IH0NCgkJCX0NCgkJZWxzZSB7IGlmIChkYXRlID4gMjgpIHsgcmV0dXJuIDA7IH0gfQ0KCQl9DQoJaWYgKChtb250aD09NCl8fChtb250aD09Nil8fChtb250aD09OSl8fChtb250aD09MTEpKSB7DQoJCWlmIChkYXRlID4gMzApIHsgcmV0dXJuIDA7IH0NCgkJfQ0KCS8vIENvcnJlY3QgaG91cnMgdmFsdWUNCglpZiAoaGg8MTIgJiYgYW1wbSA9PSBEYXRlVXRpbC5nZXRQTVN5bWJvbCgpKSB7IGhoPWhoLTArMTI7IH0NCgllbHNlIGlmIChoaD4xMSAmJiBhbXBtID09IERhdGVVdGlsLmdldEFNU3ltYm9sKCkpIHsgaGgtPTEyOyB9DQoJdmFyIG5ld2RhdGU9bmV3IERhdGUoeWVhcixtb250aC0xLGRhdGUsaGgsbW0sc3MpOw0KCXJldHVybiBuZXdkYXRlOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLy8gU2hvdyBhIHBvcHVwIGNhbGVuZGFyIGFkamFjZW50IHRvIHRoZSBkYXRlIGZpZWxkDQovLyBUb28gYmFkIHdlIGNhbid0IHVzZSB0aGUgc3RhbmRhcmQgZGF0ZSBwb3B1cCBTRkRDIHVzZXMNCmZ1bmN0aW9uIFNWTVhDX1Nob3dDYWwoY3RsKQ0Kew0KICAgIG9wZW5Qb3B1cCgnL2hvbWUvY2FsZW5kYXIuanNwP2Zvcm09aWJfZm9ybSYnICsgJ2ZpZWxkPScgKyBjdGwuaWQgKyAnJm1vPTAmY2FsbG9uY2hhbmdlPXRydWUnLA0KICAgIAknX2JsYW5rJywgMTg2LCAxNzAsDQoJJ3dpZHRoPTE4NixoZWlnaHQ9MTcwLHJlc2l6YWJsZT15ZXMsdG9vbGJhcj1ubyxzdGF0dXM9bm8sc2Nyb2xsYmFycz1ubyxtZW51YmFyPW5vLGRpcmVjdG9yaWVzPW5vLGxvY2F0aW9uPW5vLGRlcGVuZGFudD15ZXMnLA0KCXRydWUpOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLy8gQ2hlY2sgaWYgdGhlIGdpdmVuIGZpZWxkIGlzIGJsYW5rDQpmdW5jdGlvbiBTVk1YQ19Jc0ZpZWxkQmxhbmsoZm5hbWUpDQp7DQogICAgdmFyIGN0bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZuYW1lKTsNCg0KICAgIGlmKChjdGwudHlwZSA9PSAidGV4dCIgfHwgY3RsLnR5cGUgPT0gImhpZGRlbiIpICYmICghY3RsLnZhbHVlIHx8IGN0bC52YWx1ZS5sZW5ndGggPT0gMCkpIHsgcmV0dXJuIHRydWU7IH0NCg0KICAgIGlmKGN0bC50eXBlID09ICJzZWxlY3Qtb25lIiAmJiBjdGwuc2VsZWN0ZWRJbmRleCA9PSAtMSkgeyByZXR1cm4gdHJ1ZTsgfQ0KDQogICAgcmV0dXJuIGZhbHNlOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLy8gQ2hlY2sgaWYgdGhlIGdpdmVuIGxvb2t1cCBmaWVsZCBoYXMgYSB2YWxpZCB2YWx1ZSBsaW5rZWQgdG8gYW4gSUQNCmZ1bmN0aW9uIFNWTVhDX0lzVmFsaWRMb29rdXAoZm5hbWUpDQp7DQogICAgdmFyIGN0bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZuYW1lKTsNCiAgICB2YXIgaWRjdGwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmbmFtZSArICJfbGtpZCIpOw0KDQogICAgaWYgKGN0bC52YWx1ZSAmJiBjdGwudmFsdWUubGVuZ3RoID4gMCAmJiBpZGN0bC52YWx1ZS5sZW5ndGggPT0gMCkgeyByZXR1cm4gZmFsc2U7IH0NCg0KICAgIHJldHVybiB0cnVlOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLy8gQ2hlY2sgaWYgdGhlIGdpdmVuIGRhdGUgaXMgdmFsaWQgYXMgcGVyIHRoZSB1c2VyJ3MgbG9jYWxlDQpmdW5jdGlvbiBTVk1YQ19Jc1ZhbGlkRGF0ZShmbmFtZSkNCnsNCiAgICB2YXIgY3RsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZm5hbWUpOw0KICAgIHJldHVybihEYXRlVXRpbC5pc0RhdGUoY3RsLnZhbHVlLCBwYXJlbnQuVXNlckNvbnRleHQuZGF0ZUZvcm1hdCkpOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLy8gQnVpbGQgYSBnbG9iYWwgaGFzaCB0YWJsZSBvZiBtZXNzYWdlIG51bWJlcnMgYW5kIG1lc3NhZ2VzLg0KLy8gVGhpcyBhcnJheSB3aWxsIGJlIHVzZWQgZm9yIGRpc3BsYXlpbmcgaW5mby93YXJuaW5nL2Vycm9yIG1lc3NhZ2VzIHRvIHRoZSB1c2VyLg0KZnVuY3Rpb24gU1ZNWENfSW5pdE1lc3NhZ2VMaXN0KHN1Ym1vZHVsZWlkKQ0Kew0KICAgIHZhciBmb3VuZCA9IGZhbHNlOw0KDQogICAgdmFyIExhbmdMaXN0ID0gbmV3IEFycmF5KCk7DQoNCiAgICAJCS8vIEhhc2ggKE1hcCkgb2YgU0ZEQyBsYW5ndWFnZSBJU08gY29kZSB0byBMYW5ndWFnZSBwaWNrbGlzdCBpbiBTZXJ2aWNlTWF4IHRhZ3Mgb2JqZWN0DQogICAgTGFuZ0xpc3RbImVuX1VTIl0gPSAiRW5nbGlzaCI7DQogICAgTGFuZ0xpc3RbImRlIl0gPSAiR2VybWFuIjsNCiAgICBMYW5nTGlzdFsiZXMiXSA9ICJTcGFuaXNoIjsNCiAgICBMYW5nTGlzdFsiZnIiXSA9ICJGcmVuY2giOw0KICAgIExhbmdMaXN0WyJpdCJdID0gIkl0YWxpYW4iOw0KICAgIExhbmdMaXN0WyJqYSJdID0gIkphcGFuZXNlIjsNCiAgICBMYW5nTGlzdFsic3YiXSA9ICJTd2VkaXNoIjsNCiAgICBMYW5nTGlzdFsia28iXSA9ICJLb3JlYW4iOw0KICAgIExhbmdMaXN0WyJ6aF9UVyJdID0gIkNoaW5lc2UgKFRyYWRpdGlvbmFsKSI7DQogICAgTGFuZ0xpc3RbInpoX0NOIl0gPSAiQ2hpbmVzZSAoU2ltcGxpZmllZCkiOw0KICAgIExhbmdMaXN0WyJwdF9CUiJdID0gIlBvcnR1Z3Vlc2UgKEJyYXppbGlhbikiOw0KICAgIExhbmdMaXN0WyJubF9OTCJdID0gIkR1dGNoIjsNCiAgICBMYW5nTGlzdFsiZGEiXSA9ICJEYW5pc2giOw0KICAgIExhbmdMaXN0WyJ0aCJdID0gIlRoYWkiOw0KICAgIExhbmdMaXN0WyJmaSJdID0gIkZpbm5pc2giOw0KICAgIExhbmdMaXN0WyJydSJdID0gIlJ1c3NpYW4iOw0KDQogICAgdmFyIFVzZXJMYW5nID0gc2ZvcmNlLmNvbm5lY3Rpb24uZ2V0VXNlckluZm8oKS51c2VyTGFuZ3VhZ2U7CS8vIElTTyBjb2RlIG9mIHRoZSB1c2VyJ3MgbGFuZ3VhZ2UNCg0KICAgIGlmICghTGFuZ0xpc3RbVXNlckxhbmddKSB7IFVzZXJMYW5nID0gIkVuZ2xpc2giOyB9CQkvLyBpZiB1c2VyJ3MgbGFuZ3VhZ2UgaXMgbm90IGZvdW5kLCBkZWZhdWx0IGl0IHRvIEVuZ2xpc2gNCiAgICBlbHNlIHsgVXNlckxhbmcgPSBMYW5nTGlzdFtVc2VyTGFuZ107IH0NCg0KICAgIHZhciBzb3FsID0gIlNFTEVDVCBJZCwgTmFtZSwgU1ZNWENfX1RhZ19UZXh0X19jLCBTVk1YQ19fTGFuZ3VhZ2VfX2MgIiArDQogICAgCQkiRlJPTSBTVk1YQ19fU2VydmljZU1heF9UYWdzX19jICIgKw0KCQkiV0hFUkUgU1ZNWENfX1N1Ym1vZHVsZUlEX19jID0gJyIgKyBzdWJtb2R1bGVpZCArICInICIgKw0KCQkiQU5EIFNWTVhDX19MYW5ndWFnZV9fYyBJTiAoJ01hc3RlcicsICciICsgVXNlckxhbmcgKyAiJykiOw0KICAgIHZhciBxciA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwpOw0KICAgIHZhciB0YWdyZWNzID0gbmV3IHNmb3JjZS5RdWVyeVJlc3VsdEl0ZXJhdG9yKHFyKTsNCiAgICB3aGlsZSAodGFncmVjcy5oYXNOZXh0KCkpDQogICAgCXsNCiAgICAgICAgdmFyIHRhZ3JlYyA9IHRhZ3JlY3MubmV4dCgpOw0KCXZhciBUYWdJZCA9IHRhZ3JlYy5OYW1lOw0KCXZhciBUYWdUZXh0ID0gdGFncmVjLlNWTVhDX19UYWdfVGV4dF9fYzsNCgl2YXIgTGFuZyA9IHRhZ3JlYy5TVk1YQ19fTGFuZ3VhZ2VfX2M7DQoJaWYgKExhbmcgPT0gIk1hc3RlciIgJiYgIU1zZ0xpc3RbVGFnSWRdKQ0KCSAgICBNc2dMaXN0W1RhZ0lkXSA9IFRhZ1RleHQ7DQoJZWxzZSBpZiAoTGFuZyA9PSBVc2VyTGFuZyAmJiBUYWdUZXh0ICYmIFRhZ1RleHQubGVuZ3RoID4gMCkJLy8gVHJhbnNsYXRpb24gYXZhaWxhYmxlIGluIHRoZSBzcGVjaWZpYyBsYW5ndWFnZQ0KCSAgICBNc2dMaXN0W1RhZ0lkXSA9IFRhZ1RleHQ7DQoNCglmb3VuZCA9IHRydWU7DQoJfQ0KDQogICAgaWYgKCFmb3VuZCkNCgl7DQoJTXNnTGlzdFsnTVNHMDAxJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiBzYXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJTXNnTGlzdFsnTVNHMDAyJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiByZXRyaWV2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOw0KCU1zZ0xpc3RbJ01TRzAwMyddID0gJ0EgdmFsaWQgUHJvZHVjdCBzaG91bGQgYmUgc2VsZWN0ZWQuJzsNCglNc2dMaXN0WydNU0cwMDQnXSA9ICdUaGlzIGlzIGEgc2VyaWFsaXplZCBwcm9kdWN0LiBQbGVhc2UgZW50ZXIgYSB2YWxpZCBzZXJpYWwgbnVtYmVyLic7DQoJTXNnTGlzdFsnTVNHMDA1J10gPSAnVGhpcyBpcyBub3QgYSB2YWxpZCBzZXJpYWwgbnVtYmVyLiBVc2UgdGhlIGxvb2t1cCB0byBzZWxlY3QgYSB2YWxpZCBwYXJlbnQgc2VyaWFsIG51bWJlci4nOw0KCU1zZ0xpc3RbJ01TRzAwNiddID0gJ1RoaXMgaXMgbm90IGEgdmFsaWQgc2VyaWFsIG51bWJlci4gVXNlIHRoZSBsb29rdXAgdG8gc2VsZWN0IGEgdmFsaWQgdG9wLWxldmVsIHNlcmlhbCBudW1iZXIuJzsNCglNc2dMaXN0WydNU0cwMDcnXSA9ICdBIHZhbGlkIEFjY291bnQgc2hvdWxkIGJlIHNlbGVjdGVkLic7DQoJTXNnTGlzdFsnTVNHMDA4J10gPSAnUGxlYXNlIHNlbGVjdCBhIHZhbGlkIHN0YXR1cyBmcm9tIHRoZSBsaXN0Lic7DQoJTXNnTGlzdFsnTVNHMDA5J10gPSAnVGhpcyBpcyBub3QgYSB2YWxpZCBjb250YWN0LiBVc2UgdGhlIGxvb2t1cCB0byBzZWxlY3QgYSB2YWxpZCBjb250YWN0Lic7DQoJTXNnTGlzdFsnTVNHMDEwJ10gPSAnVGhpcyBpcyBub3QgYSB2YWxpZCBEaXN0cmlidXRvciBBY2NvdW50LiBVc2UgdGhlIGxvb2t1cCB0byBzZWxlY3QgYSB2YWxpZCBEaXN0cmlidXRvciBBY2NvdW50Lic7DQoJTXNnTGlzdFsnTVNHMDExJ10gPSAnVGhpcyBpcyBub3QgYSB2YWxpZCBkaXN0cmlidXRvciBjb250YWN0LiBVc2UgdGhlIGxvb2t1cCB0byBzZWxlY3QgYSB2YWxpZCBkaXN0cmlidXRvciBjb250YWN0Lic7DQoJTXNnTGlzdFsnTVNHMDEyJ10gPSAnVGhpcyBpcyBub3QgYSB2YWxpZCBzaXRlLiBVc2UgdGhlIGxvb2t1cCB0byBzZWxlY3QgYSB2YWxpZCBkaXN0cmlidXRvciBzaXRlLic7DQoJTXNnTGlzdFsnTVNHMDEzJ10gPSAnSW52YWxpZCBkYXRlIGZvcm1hdC4gUGxlYXNlIGVudGVyIGEgdmFsaWQgZGF0ZSBmb3IgRGF0ZSBPcmRlcmVkLic7DQoJTXNnTGlzdFsnTVNHMDE0J10gPSAnSW52YWxpZCBkYXRlIGZvcm1hdC4gUGxlYXNlIGVudGVyIGEgdmFsaWQgZGF0ZSBmb3IgRGF0ZSBTaGlwcGVkLic7DQoJTXNnTGlzdFsnTVNHMDE1J10gPSAnSW52YWxpZCBkYXRlIGZvcm1hdC4gUGxlYXNlIGVudGVyIGEgdmFsaWQgZGF0ZSBmb3IgTGFzdCBEYXRlIFNoaXBwZWQuJzsNCglNc2dMaXN0WydNU0cwMTYnXSA9ICdJbnZhbGlkIGRhdGUgZm9ybWF0LiBQbGVhc2UgZW50ZXIgYSB2YWxpZCBkYXRlIGZvciBEYXRlIEluc3RhbGxlZC4nOw0KCU1zZ0xpc3RbJ01TRzAxNyddID0gJ1NoaXAgZGF0ZSBjYW5ub3QgYmUgZWFybGllciB0aGFuIE9yZGVyIGRhdGUuJzsNCglNc2dMaXN0WydNU0cwMTgnXSA9ICdJbnN0YWxsIGRhdGUgY2Fubm90IGJlIGVhcmxpZXIgdGhhbiBPcmRlciBkYXRlLic7DQoJTXNnTGlzdFsnTVNHMDE5J10gPSAnSW5zdGFsbCBkYXRlIGNhbm5vdCBiZSBlYXJsaWVyIHRoYW4gU2hpcCBkYXRlLic7DQoJTXNnTGlzdFsnTVNHMDIwJ10gPSAnTm8gd2FycmFudHkgdGVtcGxhdGVzIGF2YWlsYWJsZSB0byBjaG9vc2UgZnJvbS4nOw0KCU1zZ0xpc3RbJ01TRzAyMSddID0gJ1BsZWFzZSBzZWxlY3QgYSB3YXJyYW50eSB0ZW1wbGF0ZSB0byBwcm9jZWVkLic7DQoJTXNnTGlzdFsnTVNHMDIyJ10gPSAnUGxlYXNlIGVudGVyIGEgdmFsaWQgc2hpcCBkYXRlIHRvIGNyZWF0ZSB3YXJyYW50eS4nOw0KCU1zZ0xpc3RbJ01TRzAyMyddID0gJ1BsZWFzZSBlbnRlciBhIHZhbGlkIGluc3RhbGwgZGF0ZSB0byBjcmVhdGUgd2FycmFudHkuJzsNCglNc2dMaXN0WydMQUIwMDEnXSA9ICdQcm9kdWN0JzsNCglNc2dMaXN0WydMQUIwMDInXSA9ICdTZXJpYWwvTG90IE51bWJlcic7DQoJTXNnTGlzdFsnTEFCMDAzJ10gPSAnUGFyZW50JzsNCglNc2dMaXN0WydMQUIwMDQnXSA9ICdTZXJpYWwvTG90IE51bWJlcic7DQoJTXNnTGlzdFsnTEFCMDA1J10gPSAnVG9wLUxldmVsJzsNCglNc2dMaXN0WydMQUIwMDYnXSA9ICdTZXJpYWwvTG90IE51bWJlcic7DQoJTXNnTGlzdFsnTEFCMDA3J10gPSAnQXNzZXQgVGFnJzsNCglNc2dMaXN0WydMQUIwMDgnXSA9ICdBY2NvdW50JzsNCglNc2dMaXN0WydMQUIwMDknXSA9ICdDb250YWN0JzsNCglNc2dMaXN0WydMQUIwMTAnXSA9ICdBbHRlcm5hdGUgQWNjb3VudCc7DQoJTXNnTGlzdFsnTEFCMDExJ10gPSAnRGlzdHJpYnV0b3IgQWNjb3VudCc7DQoJTXNnTGlzdFsnTEFCMDEyJ10gPSAnRGlzdHJpYnV0b3IgQ29udGFjdCc7DQoJTXNnTGlzdFsnTEFCMDEzJ10gPSAnU2FsZXMgT3JkZXIgTnVtYmVyJzsNCglNc2dMaXN0WydMQUIwMTQnXSA9ICdTdGF0dXMnOw0KCU1zZ0xpc3RbJ0xBQjAxNSddID0gJ0RhdGUgU2hpcHBlZCc7DQoJTXNnTGlzdFsnTEFCMDE2J10gPSAnTGFzdCBEYXRlIFNoaXBwZWQnOw0KCU1zZ0xpc3RbJ0xBQjAxNyddID0gJ0RhdGUgT3JkZXJlZCc7DQoJTXNnTGlzdFsnTEFCMDE4J10gPSAnRGF0ZSBJbnN0YWxsZWQnOw0KCU1zZ0xpc3RbJ0xBQjAxOSddID0gJ1NpdGUnOw0KCU1zZ0xpc3RbJ0xBQjAyMCddID0gJ1N0cmVldCc7DQoJTXNnTGlzdFsnTEFCMDIxJ10gPSAnQ2l0eSc7DQoJTXNnTGlzdFsnTEFCMDIyJ10gPSAnU3RhdGUnOw0KCU1zZ0xpc3RbJ0xBQjAyMyddID0gJ1ppcCc7DQoJTXNnTGlzdFsnTEFCMDI0J10gPSAnQ291bnRyeSc7DQoJTXNnTGlzdFsnTEFCMDI1J10gPSAnSW5zdGFsbGF0aW9uIE5vdGVzJzsNCglNc2dMaXN0WydMQUIwMjYnXSA9ICdTZWxlY3QnOw0KCU1zZ0xpc3RbJ0xBQjAyNyddID0gJ1dhcnJhbnR5IFRlbXBsYXRlJzsNCglNc2dMaXN0WydMQUIwMjgnXSA9ICdTdWJtaXQnOw0KCU1zZ0xpc3RbJ0xBQjAyOSddID0gJ1NhdmUnOw0KCU1zZ0xpc3RbJ0xBQjAzMCddID0gJ0NhbmNlbCc7DQoJfQ0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLy8gR2V0IHRoZSBtZXNzYWdlIGZvciB0aGUgZ2l2ZW4gbWVzc2FnZSBudW1iZXIgZnJvbSB0aGUgZ2xvYmFsIGhhc2ggdGFibGUuDQovLyBSZXR1cm4gInNldHVwLWlzc3VlIiBpZiB0aGUgbWVzc2FnZSBpcyBub3QgZm91bmQNCmZ1bmN0aW9uIFNWTVhDX0dldE1lc3NhZ2UoTXNnTnVtKQ0Kew0KICAgIGlmICghTXNnTGlzdFtNc2dOdW1dKQ0KICAgIAlyZXR1cm4gIk1lc3NhZ2UgZGVmaW5pdGlvbiBmb3IgIiArIE1zZ051bSArICIgbm90IGZvdW5kLiBUaGlzIGlzIGEgc2V0dXAgaXNzdWUuXG5QbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuIjsNCg0KICAgIHJldHVybiBNc2dMaXN0W01zZ051bV07DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YQ19JQl9TaG93V2FyclRlbXBsYXRlcygpDQp7DQogICAgdmFyIHJvd251bSA9IDA7DQogICAgU1ZNWENfR2V0UmV0dXJuVVJMKCk7DQoNCiAgICBTVk1YQ19Jbml0TWVzc2FnZUxpc3QoIklQUkRTQzEiKTsNCg0KICAgIHZhciBzb3FsMSA9ICJTRUxFQ1QgSWQsIE5hbWUgRlJPTSBTVk1YQ19fU2VydmljZV9UZW1wbGF0ZV9fYyBXSEVSRSBTVk1YQ19fVGVtcGxhdGVfVHlwZV9fYyA9ICdXYXJyYW50eSciOw0KICAgIHZhciBxcjEgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMSk7DQogICAgaWYgKHFyMS5zaXplIDw9IDApDQogICAgCXsNCglhbGVydChTVk1YQ19HZXRNZXNzYWdlKCJNU0cwMjAiKSk7DQoJU1ZNWENfSUJfQ2FuY2VsSUIoKTsNCglyZXR1cm4gZmFsc2U7DQoJfQ0KDQogICAgdmFyIHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpc3RfdGJvZHkiKTsNCg0KICAgIGNsZWFyX3RhYmxlKHRib2R5KTsNCiAgICB2YXIgdHIgPSBtYWtlUm93KHsnY2xhc3MnOidoZWFkZXJSb3cnfSk7DQogICAgdGJvZHkuYXBwZW5kQ2hpbGQodHIpOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCcsJ2FsaWduJzonY2VudGVyJ30pLmlubmVySFRNTCA9ICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IiArIFNWTVhDX0dldE1lc3NhZ2UoIkxBQjAyNiIpICsgIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPSAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIgKyBTVk1YQ19HZXRNZXNzYWdlKCJMQUIwMjciKSArICI8L2E+IjsNCg0KICAgIHZhciB3dF9yZWNzID0gbmV3IHNmb3JjZS5RdWVyeVJlc3VsdEl0ZXJhdG9yKHFyMSk7DQogICAgd2hpbGUod3RfcmVjcy5oYXNOZXh0KCkpDQoJew0KCXZhciB3dHJlYyA9IHd0X3JlY3MubmV4dCgpOw0KCXZhciB0ciA9IG1ha2VSb3cobWFrZUF0dHJzKHJvd251bSx0Ym9keSkpOw0KCXRyLnNvYmplY3QgPSB3dHJlYzsNCgl0Ym9keS5hcHBlbmRDaGlsZCh0cik7DQoNCgkJLy8gQ29sIDEuIFJhZGlvIGJ1dHRvbg0KCWNyZWF0ZVRhZyh0ciwidGQiLFtdKS5pbm5lckhUTUwgPQ0KCSAgICAiPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5hbWU9XCJyYWRpb1wiIHZhbHVlPVwiIiArIHd0cmVjLklkICsgIlwiPjwvaW5wdXQ+IjsNCg0KCQkvLyBDb2wgMi4gVGVtcGxhdGUgTmFtZQ0KCWNyZWF0ZVRhZyh0ciwidGgiLHsic2NvcGUiOiJyb3cifSkuaW5uZXJIVE1MID0NCgkJIjxhIHRhcmdldD1fYmxhbmsgaWQ9XCIiICsgd3RyZWMuSWQgKyAid3RuYW1lXCIgaHJlZj1cIi8iICsgd3RyZWMuSWQgKyAiXCI+IiArIHd0cmVjLk5hbWUgKyAiPC9hPiI7DQoNCgkJLy8gQ29sIDMuIEhpZGRlbiBUZW1wbGF0ZSBJZA0KCWNyZWF0ZVRhZyh0ciwidGQiLFtdKS5pbm5lckhUTUwgPQ0KCSAgICAiPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBpZD1cIiIgKyB3dHJlYy5JZCArICJ3dGlkXCIgdmFsdWU9XCIiICsgd3RyZWMuSWQgKyAiXCI+PC9pbnB1dD4iOw0KDQoJcm93bnVtKz0xOw0KCX0NCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBjcmVhdGVUYWcocGFyZW50LCBuYW1lLCBrZXl2YWxQYWlycykNCnsNCiAgICB2YXIgcmV0Ow0KICAgIHZhciBicm93c2VyID0gbmF2aWdhdG9yLmFwcE5hbWU7DQogICAgaWYgKGJyb3dzZXIgPT0gIk1pY3Jvc29mdCBJbnRlcm5ldCBFeHBsb3JlciIpIHsNCgkgICAgdmFyIHRyVGFnID0gIjwiK25hbWUrIiAiOw0KCSAgICBmb3IgKGtleSBpbiBrZXl2YWxQYWlycykgew0KCQkJICAgIHRyVGFnICs9IGtleSArICI9XCIiICsga2V5dmFsUGFpcnNba2V5XSArICJcIiI7DQoJICAgIH0NCgkgICAgdHJUYWcgKz0gIj4iOw0KCSAgICByZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRyVGFnKTsNCiAgICB9IGVsc2Ugew0KCSAgICByZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5hbWUpOw0KCSAgICBmb3IgKGtleSBpbiBrZXl2YWxQYWlycykgew0KCQkgICAgcmV0LnNldEF0dHJpYnV0ZShrZXksIGtleXZhbFBhaXJzW2tleV0pOw0KCSAgICB9DQogICAgfQ0KICAgIHBhcmVudC5hcHBlbmRDaGlsZChyZXQpOw0KICAgIHJldHVybiByZXQ7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWENfSUJfQ3JlYXRlV2FycmFudHlGcm9tVGVtcGxhdGUoaWJpZCkNCnsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnU3VibWl0JykuZGlzYWJsZWQgPSB0cnVlOw0KCXZhciBjaGVja2VkID0gZmFsc2U7DQogICAgdmFyIHJsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoInJhZGlvIik7DQoNCglmb3IgKHZhciBpID0gMDsgaSA8IHJsaXN0Lmxlbmd0aDsgaSsrKQ0KCXsNCgkgaWYgKHJsaXN0W2ldLmNoZWNrZWQpDQoJCXsNCgkJICBjaGVja2VkID0gdHJ1ZTsNCgkJICBicmVhazsNCgkJfQ0KCX0NCgkNCiAgICBpZiAoIWNoZWNrZWQpDQogICAgew0KCQlhbGVydChTVk1YQ19HZXRNZXNzYWdlKCJNU0cwMjEiKSArICJcbiIpDQoJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdTdWJtaXQnKS5kaXNhYmxlZCA9IGZhbHNlOw0KCQlyZXR1cm47CQ0KCX0NCg0KCSAgICAvLyBHZXQgaW5zdGFsbGVkIHByb2R1Y3QgcmVjb3JkDQogICAgdmFyIHNvcWwxID0gIlNFTEVDVCBTVk1YQ19fUHJvZHVjdF9fYywgU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSwgU1ZNWENfX1NlcmlhbF9Mb3RfTnVtYmVyX19jLCAiICsNCgkJIlNWTVhDX19QYXJlbnRfX2MsIFNWTVhDX19QYXJlbnRfX3IuU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSwgU1ZNWENfX1BhcmVudF9fci5TVk1YQ19fU2VyaWFsX0xvdF9OdW1iZXJfX2MsICIgKw0KCQkiU1ZNWENfX1RvcF9MZXZlbF9fYywgU1ZNWENfX1RvcF9MZXZlbF9fci5TVk1YQ19fUHJvZHVjdF9fci5OYW1lLCBTVk1YQ19fVG9wX0xldmVsX19yLlNWTVhDX19TZXJpYWxfTG90X051bWJlcl9fYywgIiArDQoJCSJTVk1YQ19fQXNzZXRfVGFnX19jLCBTVk1YQ19fQ29tcGFueV9fYywgU1ZNWENfX0NvbXBhbnlfX3IuTmFtZSwgIiArDQoJCSJTVk1YQ19fQ29udGFjdF9fYywgU1ZNWENfX0NvbnRhY3RfX3IuTmFtZSwgU1ZNWENfX0FsdGVybmF0ZV9Db21wYW55X19jLCAiICsNCgkJIlNWTVhDX19EaXN0cmlidXRvcl9Db21wYW55X19jLCBTVk1YQ19fRGlzdHJpYnV0b3JfQ29tcGFueV9fci5OYW1lLCAiICsNCgkJIlNWTVhDX19EaXN0cmlidXRvcl9Db250YWN0X19jLCBTVk1YQ19fRGlzdHJpYnV0b3JfQ29udGFjdF9fci5OYW1lLCAiICsNCgkJIlNWTVhDX19TYWxlc19PcmRlcl9OdW1iZXJfX2MsIFNWTVhDX19TdGF0dXNfX2MsIFNWTVhDX19EYXRlX1NoaXBwZWRfX2MsIFNWTVhDX19MYXN0X0RhdGVfU2hpcHBlZF9fYywgIiArDQoJCSJTVk1YQ19fRGF0ZV9PcmRlcmVkX19jLCBTVk1YQ19fRGF0ZV9JbnN0YWxsZWRfX2MsIFNWTVhDX19TaXRlX19jLCBTVk1YQ19fU2l0ZV9fci5OYW1lLCAiICsNCgkJIlNWTVhDX19TdHJlZXRfX2MsIFNWTVhDX19DaXR5X19jLCBTVk1YQ19fU3RhdGVfX2MsIFNWTVhDX19aaXBfX2MsIFNWTVhDX19Db3VudHJ5X19jLCBTVk1YQ19fSW5zdGFsbGF0aW9uX05vdGVzX19jICIgKw0KCQkiRlJPTSBTVk1YQ19fSW5zdGFsbGVkX1Byb2R1Y3RfX2MgV0hFUkUgSWQgPSAnIiArIGliaWQgKyAiJyI7DQogICAgdHJ5IHsNCgl2YXIgcXIxID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDEpOw0KCX0NCiAgICBjYXRjaCAoZXJyb3IpIHsJYWxlcnQoZXJyb3IpOwlyZXR1cm47CX0NCiAgICB2YXIgaWJyZWMgPSBxcjEuZ2V0QXJyYXkoInJlY29yZHMiKVswXTsNCg0KICAgIHZhciB3dGlkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmxpc3RbaV0udmFsdWUrInd0aWQiKS52YWx1ZTsNCiAgICB2YXIgd3RuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmxpc3RbaV0udmFsdWUrInd0bmFtZSIpLmlubmVySFRNTDsNCg0KCSAgICAvLyBHZXQgd2FycmFudHkgdGVtcGxhdGUgZGVmaW5pdGlvbg0KICAgIHZhciBzb3FsMiA9ICJTRUxFQ1QgTmFtZSwgU1ZNWENfX0FsbF9Qcm9kdWN0c19Db3ZlcmVkX19jLCBTVk1YQ19fQWxsX1NlcnZpY2VzX0NvdmVyZWRfX2MsICIgKw0KICAgIAkJIlNWTVhDX19Db3ZlcmFnZV9FZmZlY3RpdmVfRnJvbV9fYywgU1ZNWENfX0R1cmF0aW9uX29mX1RpbWVfQ292ZXJhZ2VfX2MsICIgKw0KCQkiU1ZNWENfX0R1cmF0aW9uX29mX01hdGVyaWFsX0NvdmVyYWdlX19jLCBTVk1YQ19fRHVyYXRpb25fb2ZfRXhwZW5zZXNfX2MsICIgKw0KCQkiU1ZNWENfX0V4Y2x1c2lvbnNfX2MsIFNWTVhDX19FeHBlbnNlc19Db3ZlcmVkX19jLCBTVk1YQ19fSW52b2ljZV9SZXF1aXJlZF9fYywgIiArDQoJCSJTVk1YQ19fTG9hbmVyX1Byb3ZpZGVkX19jLCBTVk1YQ19fTWF0ZXJpYWxfQ292ZXJlZF9fYywgU1ZNWENfX09uc2l0ZV9SZXBhaXJfX2MsICIgKw0KCQkiU1ZNWENfX1JNQV9SZXF1aXJlZF9fYywgU1ZNWENfX1NoaXBtZW50X0FsbG93ZWRfX2MsIFNWTVhDX19UZW1wbGF0ZV9UeXBlX19jLCAiICsNCgkJIlNWTVhDX19UaW1lX0NvdmVyZWRfX2MsIFNWTVhDX19UcmFuc2ZlcmFibGVfX2MsIFNWTVhDX19Vbml0X29mX1RpbWVfTWF0ZXJpYWxfX2MsICIgKw0KCQkiU1ZNWENfX1VuaXRfb2ZfVGltZV9FeHBlbnNlc19fYywgU1ZNWENfX1VuaXRfb2ZfVGltZV9fYywgU1ZNWENfX1dhbGtfaW5fQWxsb3dlZF9fYyAiICsNCgkJIkZST00gU1ZNWENfX1NlcnZpY2VfVGVtcGxhdGVfX2MgV0hFUkUgSWQgPSAnIiArIHd0aWQgKyAiJyI7DQoJDQogICAgdmFyIHFyMiA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwyKTsNCiAgICB2YXIgd3QgPSBxcjIuZ2V0QXJyYXkoInJlY29yZHMiKVswXTsNCg0KCSAgICAvLyBCdWlsZCB0aGUgd2FycmFudHkgcmVjb3JkDQogICAgdmFyIHdhcnIgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19XYXJyYW50eV9fYyIpOw0KICAgIHdhcnIuU1ZNWENfX0luc3RhbGxlZF9Qcm9kdWN0X19jID0gaWJpZDsNCiAgICB3YXJyLlNWTVhDX19TZXJ2aWNlX1RlbXBsYXRlX19jID0gd3RpZDsNCiAgICB3YXJyLlNWTVhDX19BbGxfUHJvZHVjdHNfQ292ZXJlZF9fYyA9IHd0LlNWTVhDX19BbGxfUHJvZHVjdHNfQ292ZXJlZF9fYzsNCiAgICB3YXJyLlNWTVhDX19BbGxfU2VydmljZXNfQ292ZXJlZF9fYyA9IHd0LlNWTVhDX19BbGxfU2VydmljZXNfQ292ZXJlZF9fYzsNCiAgICB3YXJyLlNWTVhDX19UaW1lX0NvdmVyZWRfX2MgPSB3dC5TVk1YQ19fVGltZV9Db3ZlcmVkX19jOw0KICAgIHdhcnIuU1ZNWENfX1RyYW5zZmVyYWJsZV9fYyA9IHd0LlNWTVhDX19UcmFuc2ZlcmFibGVfX2M7DQogICAgd2Fyci5TVk1YQ19fV2Fsa19pbl9BbGxvd2VkX19jID0gd3QuU1ZNWENfX1dhbGtfaW5fQWxsb3dlZF9fYzsNCiAgICB3YXJyLlNWTVhDX19FeHBlbnNlc19Db3ZlcmVkX19jID0gd3QuU1ZNWENfX0V4cGVuc2VzX0NvdmVyZWRfX2M7DQogICAgd2Fyci5TVk1YQ19fSW52b2ljZV9SZXF1aXJlZF9fYyA9IHd0LlNWTVhDX19JbnZvaWNlX1JlcXVpcmVkX19jOw0KICAgIHdhcnIuU1ZNWENfX0xvYW5lcl9Qcm92aWRlZF9fYyA9IHd0LlNWTVhDX19Mb2FuZXJfUHJvdmlkZWRfX2M7DQogICAgd2Fyci5TVk1YQ19fTWF0ZXJpYWxfQ292ZXJlZF9fYyA9IHd0LlNWTVhDX19NYXRlcmlhbF9Db3ZlcmVkX19jOw0KICAgIHdhcnIuU1ZNWENfX09uc2l0ZV9SZXBhaXJfX2MgPSB3dC5TVk1YQ19fT25zaXRlX1JlcGFpcl9fYzsNCiAgICB3YXJyLlNWTVhDX19STUFfUmVxdWlyZWRfX2MgPSB3dC5TVk1YQ19fUk1BX1JlcXVpcmVkX19jOw0KICAgIHdhcnIuU1ZNWENfX1NoaXBtZW50X0FsbG93ZWRfX2MgPSB3dC5TVk1YQ19fU2hpcG1lbnRfQWxsb3dlZF9fYzsNCiAgICB3YXJyLlNWTVhDX19FeGNsdXNpb25zX19jID0gd3QuU1ZNWENfX0V4Y2x1c2lvbnNfX2M7DQogDQoNCiAgICB2YXIgY3VycmRhdGUgPSBuZXcgRGF0ZSgpOw0KCS8vYWxlcnQoJ2RhdGUgc2hpcHBlZCBsZW5ndGgnICsgaWJyZWMuU1ZNWENfX0RhdGVfU2hpcHBlZF9fYy5sZW5ndGgpOw0KICAgIGlmICh3dC5TVk1YQ19fQ292ZXJhZ2VfRWZmZWN0aXZlX0Zyb21fX2MgPT0gIlNoaXAgRGF0ZSIgKQ0KCXsNCgkJaWYoaWJyZWMuU1ZNWENfX0RhdGVfU2hpcHBlZF9fYykNCgkJCXdhcnIuU1ZNWENfX1N0YXJ0X0RhdGVfX2MgPSBpYnJlYy5TVk1YQ19fRGF0ZV9TaGlwcGVkX19jOw0KCQllbHNlDQoJCQl7DQoJCQkJYWxlcnQoU1ZNWENfR2V0TWVzc2FnZSgiTVNHMDIyIikpOw0KCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdTdWJtaXQnKS5kaXNhYmxlZCA9IGZhbHNlOw0KCQkJCXJldHVybiBmYWxzZTsNCgkJCX0NCgl9DQogICAgZWxzZSBpZiAod3QuU1ZNWENfX0NvdmVyYWdlX0VmZmVjdGl2ZV9Gcm9tX19jID09ICJJbnN0YWxsIERhdGUiICkNCgl7DQoJCWlmIChpYnJlYy5TVk1YQ19fRGF0ZV9JbnN0YWxsZWRfX2MpDQoJCQl3YXJyLlNWTVhDX19TdGFydF9EYXRlX19jID0gaWJyZWMuU1ZNWENfX0RhdGVfSW5zdGFsbGVkX19jOw0KCQllbHNlDQoJCQl7DQoJCQkJYWxlcnQoU1ZNWENfR2V0TWVzc2FnZSgiTVNHMDIzIikpOw0KCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdTdWJtaXQnKS5kaXNhYmxlZCA9IGZhbHNlOw0KCQkJCXJldHVybiBmYWxzZTsNCgkJCX0NCgl9DQoJZWxzZSAJDQoJICAgIHdhcnIuU1ZNWENfX1N0YXJ0X0RhdGVfX2MgPSBTVk1YQ19Db252ZXJ0RGF0ZVRvU0ZEQyhjdXJyZGF0ZSk7DQoJDQogICAgdmFyIGR0VGltZUVuZCA9IFNWTVhDX0NhbGNXYXJyRW5kRGF0ZSh3YXJyLlNWTVhDX19TdGFydF9EYXRlX19jLCB3dC5TVk1YQ19fRHVyYXRpb25fb2ZfVGltZV9Db3ZlcmFnZV9fYywgd3QuU1ZNWENfX1VuaXRfb2ZfVGltZV9fYyk7DQogICAgd2Fyci5TVk1YQ19fRW5kX0RhdGVfVGltZV9Db3ZlcmVkX19jID0gU1ZNWENfQ29udmVydERhdGVUb1NGREMoZHRUaW1lRW5kKTsNCg0KICAgIHZhciBkdFBhcnRzRW5kID0gU1ZNWENfQ2FsY1dhcnJFbmREYXRlKHdhcnIuU1ZNWENfX1N0YXJ0X0RhdGVfX2MsIHd0LlNWTVhDX19EdXJhdGlvbl9vZl9NYXRlcmlhbF9Db3ZlcmFnZV9fYywgd3QuU1ZNWENfX1VuaXRfb2ZfVGltZV9NYXRlcmlhbF9fYyk7DQogICAgd2Fyci5TVk1YQ19fRW5kX0RhdGVfTWF0ZXJpYWxfQ292ZXJlZF9fYyA9IFNWTVhDX0NvbnZlcnREYXRlVG9TRkRDKGR0UGFydHNFbmQpOw0KDQogICAgdmFyIGR0RXhwRW5kID0gU1ZNWENfQ2FsY1dhcnJFbmREYXRlKHdhcnIuU1ZNWENfX1N0YXJ0X0RhdGVfX2MsIHd0LlNWTVhDX19EdXJhdGlvbl9vZl9FeHBlbnNlc19fYywgd3QuU1ZNWENfX1VuaXRfb2ZfVGltZV9FeHBlbnNlc19fYyk7DQogICAgd2Fyci5TVk1YQ19fRW5kX0RhdGVfRXhwZW5zZXNfQ292ZXJlZF9fYyA9IFNWTVhDX0NvbnZlcnREYXRlVG9TRkRDKGR0RXhwRW5kKTsNCg0KICAgIC8vIE92ZXJhbGwgZW5kIGRhdGUgb2YgdGhlIHdhcnJhbnR5IGlzIHRoZSBtYXhpbXVtIG9mIHRpbWUvcGFydHMvZXhwZW5zZXMgY292ZXJhZ2UgZW5kIGRhdGVzDQogICAgaWYgKGR0VGltZUVuZCA+PSBkdFBhcnRzRW5kICYmIGR0VGltZUVuZCA+PSBkdEV4cEVuZCkNCgl3YXJyLlNWTVhDX19FbmRfRGF0ZV9fYyAgPSBTVk1YQ19Db252ZXJ0RGF0ZVRvU0ZEQyhkdFRpbWVFbmQpOyANCiAgICBlbHNlIGlmIChkdFBhcnRzRW5kID49IGR0VGltZUVuZCAmJiBkdFBhcnRzRW5kPj0gZHRFeHBFbmQpDQoJd2Fyci5TVk1YQ19fRW5kX0RhdGVfX2MgPSBTVk1YQ19Db252ZXJ0RGF0ZVRvU0ZEQyhkdFBhcnRzRW5kKTsgDQogICAgZWxzZSBpZiAoZHRFeHBFbmQgPj0gZHRUaW1lRW5kICYmIGR0RXhwRW5kPj0gZHRQYXJ0c0VuZCkNCgl3YXJyLlNWTVhDX19FbmRfRGF0ZV9fYyA9IFNWTVhDX0NvbnZlcnREYXRlVG9TRkRDKGR0RXhwRW5kKTsgDQogICAgdHJ5IHsNCgl2YXIgcmV0ID0gc2ZvcmNlLmNvbm5lY3Rpb24uY3JlYXRlKFt3YXJyXSk7DQoJfQ0KICAgIGNhdGNoIChlKSB7DQoJYWxlcnQoU1ZNWENfR2V0TWVzc2FnZSgiTVNHMDAxIikgKyAiXG4iICsgZSkNCglyZXR1cm4gZmFsc2U7DQoJfQ0KDQogICAgcGFyZW50LndpbmRvdy5sb2NhdGlvbiA9IHBhcmVudC53aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgKyAiLy8iICsgcGFyZW50LndpbmRvdy5sb2NhdGlvbi5ob3N0ICsgIi8iICsgcmV0WzBdLmlkOw0KDQogICAgcmV0dXJuIHRydWU7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gZHJhd01zZyh0YSxtc2cpDQp7DQogICAgaWYgKCF0YSkgdGEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibGlzdF90Ym9keSIpOw0KICAgIGNsZWFyX3RhYmxlKCB0YSApOw0KICAgIHZhciB0ciA9IG1ha2VSb3coeydjbGFzcyc6J2hlYWRlclJvdyd9KTt0YS5hcHBlbmRDaGlsZCh0cik7DQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydjbGFzcyc6J2FjdGlvbkNvbHVtbicsJ3Njb3BlJzonY29sJ30pLmlubmVySFRNTCA9IG1zZzsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBjbGVhcl90YWJsZSh0Ym9keSkNCnsNCiAgICBpZiAoIXRib2R5KSB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsaXN0X3Rib2R5Iik7DQogICAgd2hpbGUgKHRib2R5LnJvd3MubGVuZ3RoID4gMCkgCXsgdGJvZHkuZGVsZXRlUm93KDApOyB9DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gbWFrZUF0dHJzKGksdGEpDQp7DQogICAgdmFyIGF0dHMgPSBuZXcgT2JqZWN0KCk7DQogICAgLy8gaG93IG1hbnkgcm93cyBpbiB0aGlzIHRhYmxlIHNvIGZhcg0KICAgIHRyeSB7IHRhLmV2ZW4gfSBjYXRjaCAoZSkgeyB0YS5ldmVuID0gaX07DQogICAgaWYgKGk9PTApIHsgLy8gc2tpbiBzdHVmZg0KCSAgICBhdHRzWyJjbGFzcyJdID0gImV2ZW4gZmlyc3QiOw0KICAgIH0gZWxzZSBpZiAodGEuZXZlbiA9PSB0cnVlKSB7DQoJICAgIGF0dHNbImNsYXNzIl0gPSAiZXZlbiI7DQogICAgfSBlbHNlIHsNCgkgICAgYXR0c1siY2xhc3MiXSA9ICJvZGQiOw0KICAgIH0NCiAgICB0YS5ldmVuID0gIXRhLmV2ZW47DQogICAgYXR0c1sib25tb3VzZW91dCJdID0gImlmICh0eXBlb2YoaGlPZmYpICE9ICd1bmRlZmluZWQnICYmIHRoaXMuYWN0aXZlID09IGZhbHNlKXtoaU9mZih0aGlzKTt9IjsNCiAgICBhdHRzWyJvbm1vdXNlb3ZlciJdID0gImlmICh0eXBlb2YoaGlPbikgIT0gJ3VuZGVmaW5lZCcpe2hpT24odGhpcyk7fSI7DQogICAgcmV0dXJuIGF0dHM7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gbWFrZVJvdyhhdHRzKQ0Kew0KICAgIHZhciBicm93c2VyID0gbmF2aWdhdG9yLmFwcE5hbWU7DQogICAgaWYgKGJyb3dzZXIgPT0gIk1pY3Jvc29mdCBJbnRlcm5ldCBFeHBsb3JlciIpIHsNCgkgICAgdmFyIHRyVGFnID0gIjxUUiAiOw0KCSAgICBmb3IgKGtleSBpbiBhdHRzKSB7DQoJCSAgICB0clRhZyArPSBrZXkgKyAiPVwiIiArIGF0dHNba2V5XSArICJcIiI7DQoJICAgIH0NCgkgICAgdHJUYWcgKz0gIj4iOw0KCSAgICB2YXIgcmV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0clRhZyk7DQogICAgfSBlbHNlIHsNCgkgICAgdmFyIHRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiVFIiKTsNCgkgICAgZm9yIChrZXkgaW4gYXR0cykgew0KCQkgICAgdHIuc2V0QXR0cmlidXRlKGtleSwgYXR0c1trZXldKTsNCgkgICAgfQ0KCSAgICB2YXIgcmV0ID0gdHI7DQogICAgfQ0KICAgIHJldC5hY3RpdmUgPSBmYWxzZTsNCiAgICByZXR1cm4gcmV0Ow0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCg0KdmFyIGZvbGRlcnNUcmVlOw0KDQovL1RvIGN1c3RvbWl6ZSB0aGUgdHJlZSwgb3ZlcndyaXRlIHRoZXNlIHZhcmlhYmxlcyBpbiB0aGUgY29uZmlndXJhdGlvbiBmaWxlIChkZW1vRnJhbWVzZXROb2RlLmpzLCBldGMuKQ0KdmFyIFVTRVRFWFRMSU5LUyA9IDE7DQp2YXIgU1RBUlRBTExPUEVOID0gMTsNCnZhciBVU0VGUkFNRVMgPSAwOw0KdmFyIFVTRUlDT05TID0gMDsNCnZhciBXUkFQVEVYVCA9IDE7DQp2YXIgUEVSU0VSVkVTVEFURSA9IDA7IC8vYmFja3dhcmQgY29tcGF0aWJpbGl0eQ0KdmFyIFBSRVNFUlZFU1RBVEUgPSAwOw0KdmFyIElDT05QQVRIID0gcGFyZW50LndpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCArICIvLyIgKyBwYXJlbnQud2luZG93LmxvY2F0aW9uLmhvc3QgKyAiL2ltZy90cmVlLyI7DQp2YXIgSElHSExJR0hUID0gMDsNCnZhciBISUdITElHSFRfQ09MT1IgPSAnYmx1ZSc7DQp2YXIgSElHSExJR0hUX0JHICAgID0gJ3doaXRlJzsNCnZhciBCVUlMREFMTCA9IDA7DQp2YXIgR0xPQkFMVEFSR0VUID0gIlIiOyAvLyB2YXJpYWJsZSBvbmx5IGFwcGxpY2FibGUgZm9yIGFkZENoaWxkcmVuIHVzZXMNCg0KDQovL090aGVyIHZhcmlhYmxlcw0KdmFyIGxhc3RDbGlja2VkID0gbnVsbDsNCnZhciBsYXN0Q2xpY2tlZENvbG9yOw0KdmFyIGxhc3RDbGlja2VkQmdDb2xvcjsNCnZhciBpbmRleE9mRW50cmllcyA9IG5ldyBBcnJheSANCnZhciBuRW50cmllcyA9IDAgDQp2YXIgYnJvd3NlclZlcnNpb24gPSAxIA0KdmFyIHNlbGVjdGVkRm9sZGVyPTANCnZhciBsYXN0T3BlbmVkRm9sZGVyPW51bGwNCnZhciB0PTUNCnZhciBkb2MgPSBkb2N1bWVudA0KdmFyIHN1cHBvcnRzRGVmZXJyYWwgPSBmYWxzZQ0KDQpkb2MueVBvcyA9IDANCg0KaWYodHlwZW9mIEhUTUxFbGVtZW50IT0idW5kZWZpbmVkIiAmJiAhSFRNTEVsZW1lbnQucHJvdG90eXBlLmluc2VydEFkamFjZW50RWxlbWVudCl7DQoJSFRNTEVsZW1lbnQucHJvdG90eXBlLmluc2VydEFkamFjZW50RWxlbWVudCA9IGZ1bmN0aW9uICh3aGVyZSxwYXJzZWROb2RlKQ0KCXsNCgkJc3dpdGNoICh3aGVyZSl7DQoJCWNhc2UgJ0JlZm9yZUJlZ2luJzoNCgkJCXRoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUocGFyc2VkTm9kZSx0aGlzKQ0KCQkJYnJlYWs7DQoJCWNhc2UgJ0FmdGVyQmVnaW4nOg0KCQkJdGhpcy5pbnNlcnRCZWZvcmUocGFyc2VkTm9kZSx0aGlzLmZpcnN0Q2hpbGQpOw0KCQkJYnJlYWs7DQoJCWNhc2UgJ0JlZm9yZUVuZCc6DQoJCQl0aGlzLmFwcGVuZENoaWxkKHBhcnNlZE5vZGUpOw0KCQkJYnJlYWs7DQoJCWNhc2UgJ0FmdGVyRW5kJzoNCgkJCWlmICh0aGlzLm5leHRTaWJsaW5nKSANCgkJCQl0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHBhcnNlZE5vZGUsdGhpcy5uZXh0U2libGluZyk7DQoJCQllbHNlIHRoaXMucGFyZW50Tm9kZS5hcHBlbmRDaGlsZChwYXJzZWROb2RlKTsNCgkJCWJyZWFrOw0KCQl9DQoJfQ0KDQoJSFRNTEVsZW1lbnQucHJvdG90eXBlLmluc2VydEFkamFjZW50SFRNTCA9IGZ1bmN0aW9uKHdoZXJlLGh0bWxTdHIpDQoJew0KCQl2YXIgciA9IHRoaXMub3duZXJEb2N1bWVudC5jcmVhdGVSYW5nZSgpOw0KCQlyLnNldFN0YXJ0QmVmb3JlKHRoaXMpOw0KCQl2YXIgcGFyc2VkSFRNTCA9IHIuY3JlYXRlQ29udGV4dHVhbEZyYWdtZW50KGh0bWxTdHIpOw0KCQl0aGlzLmluc2VydEFkamFjZW50RWxlbWVudCh3aGVyZSxwYXJzZWRIVE1MKQ0KCX0NCn0NCg0KZnVuY3Rpb24geGJEZXRlY3RCcm93c2VyKCkNCnsNCiAgdmFyIG9sZE9uRXJyb3IgPSB3aW5kb3cub25lcnJvcjsNCiAgdmFyIGVsZW1lbnQgPSBudWxsOw0KDQogIHdpbmRvdy5vbmVycm9yID0gbnVsbDsNCiAgDQogIC8vIHdvcmsgYXJvdW5kIGJ1ZyBpbiB4cGNkb20gTW96aWxsYSAwLjkuMQ0KICB3aW5kb3cuc2F2ZU5hdmlnYXRvciA9IHdpbmRvdy5uYXZpZ2F0b3I7DQoNCiAgbmF2aWdhdG9yLk9TICAgID0gJyc7DQogIG5hdmlnYXRvci52ZXJzaW9uICA9IHBhcnNlRmxvYXQobmF2aWdhdG9yLmFwcFZlcnNpb24pOw0KICBuYXZpZ2F0b3Iub3JnICAgID0gJyc7DQogIG5hdmlnYXRvci5mYW1pbHkgID0gJyc7DQoNCiAgdmFyIHBsYXRmb3JtOw0KICBpZiAodHlwZW9mKHdpbmRvdy5uYXZpZ2F0b3IucGxhdGZvcm0pICE9ICd1bmRlZmluZWQnKQ0KICB7DQogICAgcGxhdGZvcm0gPSB3aW5kb3cubmF2aWdhdG9yLnBsYXRmb3JtLnRvTG93ZXJDYXNlKCk7DQogICAgaWYgKHBsYXRmb3JtLmluZGV4T2YoJ3dpbicpICE9IC0xKQ0KICAgICAgbmF2aWdhdG9yLk9TID0gJ3dpbic7DQogICAgZWxzZSBpZiAocGxhdGZvcm0uaW5kZXhPZignbWFjJykgIT0gLTEpDQogICAgICBuYXZpZ2F0b3IuT1MgPSAnbWFjJzsNCiAgICBlbHNlIGlmIChwbGF0Zm9ybS5pbmRleE9mKCd1bml4JykgIT0gLTEgfHwgcGxhdGZvcm0uaW5kZXhPZignbGludXgnKSAhPSAtMSB8fCBwbGF0Zm9ybS5pbmRleE9mKCdzdW4nKSAhPSAtMSkNCiAgICAgIG5hdmlnYXRvci5PUyA9ICduaXgnOw0KICB9DQoNCiAgdmFyIGkgPSAwOw0KICB2YXIgdWEgPSB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpOw0KICANCiAgaWYgKHVhLmluZGV4T2YoJ3NhZmFyaScpICE9IC0xKQ0KICB7DQogICAgaSA9IHVhLmluZGV4T2YoJ3NhZmFyaScpOw0KICAgIG5hdmlnYXRvci5mYW1pbHkgPSAnc2FmYXJpJzsNCiAgICBuYXZpZ2F0b3Iub3JnID0gJ3NhZmFyaSc7DQogICAgbmF2aWdhdG9yLnZlcnNpb24gPSBwYXJzZUZsb2F0KCcwJyArIHVhLnN1YnN0cihpKzcpLCAxMCk7DQogIH0NCiAgZWxzZSBpZiAodWEuaW5kZXhPZignb3BlcmEnKSAhPSAtMSkNCiAgew0KICAgIGkgPSB1YS5pbmRleE9mKCdvcGVyYScpOw0KICAgIG5hdmlnYXRvci5mYW1pbHkgID0gJ29wZXJhJzsNCiAgICBuYXZpZ2F0b3Iub3JnICAgID0gJ29wZXJhJzsNCiAgICBuYXZpZ2F0b3IudmVyc2lvbiAgPSBwYXJzZUZsb2F0KCcwJyArIHVhLnN1YnN0cihpKzYpLCAxMCk7DQogIH0NCiAgZWxzZSBpZiAoKGkgPSB1YS5pbmRleE9mKCdtc2llJykpICE9IC0xKQ0KICB7DQogICAgbmF2aWdhdG9yLm9yZyAgICA9ICdtaWNyb3NvZnQnOw0KICAgIG5hdmlnYXRvci52ZXJzaW9uICA9IHBhcnNlRmxvYXQoJzAnICsgdWEuc3Vic3RyKGkrNSksIDEwKTsNCiAgICANCiAgICBpZiAobmF2aWdhdG9yLnZlcnNpb24gPCA0KQ0KICAgICAgbmF2aWdhdG9yLmZhbWlseSA9ICdpZTMnOw0KICAgIGVsc2UNCiAgICAgIG5hdmlnYXRvci5mYW1pbHkgPSAnaWU0Jw0KICB9DQogIGVsc2UgaWYgKHVhLmluZGV4T2YoJ2dlY2tvJykgIT0gLTEpDQogIHsNCiAgICBuYXZpZ2F0b3IuZmFtaWx5ID0gJ2dlY2tvJzsNCiAgICB2YXIgcnZTdGFydCA9IHVhLmluZGV4T2YoJ3J2OicpOw0KICAgIHZhciBydkVuZCAgID0gdWEuaW5kZXhPZignKScsIHJ2U3RhcnQpOw0KICAgIHZhciBydiAgICAgID0gdWEuc3Vic3RyaW5nKHJ2U3RhcnQrMywgcnZFbmQpOw0KICAgIHZhciBydlBhcnRzID0gcnYuc3BsaXQoJy4nKTsNCiAgICB2YXIgcnZWYWx1ZSA9IDA7DQogICAgdmFyIGV4cCAgICAgPSAxOw0KDQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBydlBhcnRzLmxlbmd0aDsgaSsrKQ0KICAgIHsNCiAgICAgIHZhciB2YWwgPSBwYXJzZUludChydlBhcnRzW2ldKTsNCiAgICAgIHJ2VmFsdWUgKz0gdmFsIC8gZXhwOw0KICAgICAgZXhwICo9IDEwMDsNCiAgICB9DQogICAgbmF2aWdhdG9yLnZlcnNpb24gPSBydlZhbHVlOw0KDQogICAgaWYgKHVhLmluZGV4T2YoJ25ldHNjYXBlJykgIT0gLTEpDQogICAgICBuYXZpZ2F0b3Iub3JnID0gJ25ldHNjYXBlJzsNCiAgICBlbHNlIGlmICh1YS5pbmRleE9mKCdjb21wdXNlcnZlJykgIT0gLTEpDQogICAgICBuYXZpZ2F0b3Iub3JnID0gJ2NvbXB1c2VydmUnOw0KICAgIGVsc2UNCiAgICAgIG5hdmlnYXRvci5vcmcgPSAnbW96aWxsYSc7DQogIH0NCiAgZWxzZSBpZiAoKHVhLmluZGV4T2YoJ21vemlsbGEnKSAhPS0xKSAmJiAodWEuaW5kZXhPZignc3Bvb2ZlcicpPT0tMSkgJiYgKHVhLmluZGV4T2YoJ2NvbXBhdGlibGUnKSA9PSAtMSkgJiYgKHVhLmluZGV4T2YoJ29wZXJhJyk9PS0xKSYmICh1YS5pbmRleE9mKCd3ZWJ0dicpPT0tMSkgJiYgKHVhLmluZGV4T2YoJ2hvdGphdmEnKT09LTEpKQ0KICB7DQogICAgdmFyIGlzX21ham9yID0gcGFyc2VGbG9hdChuYXZpZ2F0b3IuYXBwVmVyc2lvbik7DQogICAgDQogICAgaWYgKGlzX21ham9yIDwgNCkNCiAgICAgIG5hdmlnYXRvci52ZXJzaW9uID0gaXNfbWFqb3I7DQogICAgZWxzZQ0KICAgIHsNCiAgICAgIGkgPSB1YS5sYXN0SW5kZXhPZignLycpDQogICAgICBuYXZpZ2F0b3IudmVyc2lvbiA9IHBhcnNlRmxvYXQoJzAnICsgdWEuc3Vic3RyKGkrMSksIDEwKTsNCiAgICB9DQogICAgbmF2aWdhdG9yLm9yZyA9ICduZXRzY2FwZSc7DQogICAgbmF2aWdhdG9yLmZhbWlseSA9ICdubicgKyBwYXJzZUludChuYXZpZ2F0b3IuYXBwVmVyc2lvbik7DQogIH0NCiAgZWxzZSBpZiAoKGkgPSB1YS5pbmRleE9mKCdhb2wnKSkgIT0gLTEgKQ0KICB7DQogICAgLy8gYW9sDQogICAgbmF2aWdhdG9yLmZhbWlseSAgPSAnYW9sJzsNCiAgICBuYXZpZ2F0b3Iub3JnICAgID0gJ2FvbCc7DQogICAgbmF2aWdhdG9yLnZlcnNpb24gID0gcGFyc2VGbG9hdCgnMCcgKyB1YS5zdWJzdHIoaSs0KSwgMTApOw0KICB9DQogIGVsc2UgaWYgKChpID0gdWEuaW5kZXhPZignaG90amF2YScpKSAhPSAtMSApDQogIHsNCiAgICAvLyBob3RqYXZhDQogICAgbmF2aWdhdG9yLmZhbWlseSAgPSAnaG90amF2YSc7DQogICAgbmF2aWdhdG9yLm9yZyAgICA9ICdzdW4nOw0KICAgIG5hdmlnYXRvci52ZXJzaW9uICA9IHBhcnNlRmxvYXQobmF2aWdhdG9yLmFwcFZlcnNpb24pOw0KICB9DQoNCiAgd2luZG93Lm9uZXJyb3IgPSBvbGRPbkVycm9yOw0KfQ0KDQovLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiANCmZ1bmN0aW9uIEZvbGRlcihmb2xkZXJEZXNjcmlwdGlvbiwgaHJlZmVyZW5jZSkgLy9jb25zdHJ1Y3RvciANCnsgDQogIC8vY29uc3RhbnQgZGF0YSANCiAgdGhpcy5kZXNjID0gZm9sZGVyRGVzY3JpcHRpb247IA0KICB0aGlzLmhyZWZlcmVuY2UgPSBocmVmZXJlbmNlOw0KICB0aGlzLmlkID0gLTE7DQogIHRoaXMubmF2T2JqID0gMDsNCiAgdGhpcy5pY29uSW1nID0gMDsgDQogIHRoaXMubm9kZUltZyA9IDA7DQogIHRoaXMuaWNvblNyYyA9IElDT05QQVRIICsgImZ0djJmb2xkZXJvcGVuLmdpZiI7DQogIHRoaXMuaWNvblNyY0Nsb3NlZCA9IElDT05QQVRIICsgImZ0djJmb2xkZXJjbG9zZWQuZ2lmIjsNCiAgdGhpcy5jaGlsZHJlbiA9IG5ldyBBcnJheTsNCiAgdGhpcy5uQ2hpbGRyZW4gPSAwOw0KICB0aGlzLmxldmVsID0gMDsNCiAgdGhpcy5sZWZ0U2lkZUNvZGVkID0gIiI7DQogIHRoaXMuaXNMYXN0Tm9kZT1mYWxzZTsNCiAgdGhpcy5wYXJlbnRPYmogPSBudWxsOw0KICB0aGlzLm1heVNlbGVjdD10cnVlOw0KICB0aGlzLnByZXBlbmRIVE1MID0gIiINCiANCiAgLy9keW5hbWljIGRhdGEgDQogIHRoaXMuaXNPcGVuID0gZmFsc2UNCiAgdGhpcy5pc0xhc3RPcGVuZWRGb2xkZXIgPSBmYWxzZQ0KICB0aGlzLmlzUmVuZGVyZWQgPSAwDQogDQogIC8vbWV0aG9kcyANCiAgdGhpcy5pbml0aWFsaXplID0gaW5pdGlhbGl6ZUZvbGRlciANCiAgdGhpcy5zZXRTdGF0ZSA9IHNldFN0YXRlRm9sZGVyIA0KICB0aGlzLmFkZENoaWxkID0gYWRkQ2hpbGQgDQogIHRoaXMuYWRkQ2hpbGRyZW4gPSBhZGRDaGlsZHJlbg0KICB0aGlzLmNyZWF0ZUluZGV4ID0gY3JlYXRlRW50cnlJbmRleCANCiAgdGhpcy5lc2NvbmRlQmxvY2sgPSBlc2NvbmRlQmxvY2sNCiAgdGhpcy5lc2NvbmRlID0gZXNjb25kZUZvbGRlciANCiAgdGhpcy5mb2xkZXJNc3RyID0gZm9sZGVyTXN0ciANCiAgdGhpcy5yZW5kZXJPYiA9IGRyYXdGb2xkZXIgDQogIHRoaXMudG90YWxIZWlnaHQgPSB0b3RhbEhlaWdodCANCiAgdGhpcy5zdWJFbnRyaWVzID0gZm9sZGVyU3ViRW50cmllcyANCiAgdGhpcy5saW5rSFRNTCA9IGxpbmtGb2xkZXJIVE1MDQogIHRoaXMuYmxvY2tTdGFydEhUTUwgPSBibG9ja1N0YXJ0SFRNTA0KICB0aGlzLmJsb2NrRW5kSFRNTCA9IGJsb2NrRW5kSFRNTA0KICB0aGlzLm5vZGVJbWFnZVNyYyA9IG5vZGVJbWFnZVNyYw0KICB0aGlzLmljb25JbWFnZVNyYyA9IGljb25JbWFnZVNyYw0KICB0aGlzLmdldElEID0gZ2V0SUQNCiAgdGhpcy5mb3JjZU9wZW5pbmdPZkFuY2VzdG9yRm9sZGVycyA9IGZvcmNlT3BlbmluZ09mQW5jZXN0b3JGb2xkZXJzDQp9IA0KIA0KZnVuY3Rpb24gaW5pdGlhbGl6ZUZvbGRlcihsZXZlbCwgbGFzdE5vZGUsIGxlZnRTaWRlKSANCnsgDQogIHZhciBpPTAgICAgICAgDQogIG5jID0gdGhpcy5uQ2hpbGRyZW4gDQogICANCiAgdGhpcy5jcmVhdGVJbmRleCgpIA0KICB0aGlzLmxldmVsID0gbGV2ZWwNCiAgdGhpcy5sZWZ0U2lkZUNvZGVkID0gbGVmdFNpZGUNCg0KICBpZiAoYnJvd3NlclZlcnNpb24gPT0gMCB8fCBTVEFSVEFMTE9QRU49PTEpDQogICAgdGhpcy5pc09wZW49dHJ1ZTsNCg0KICBpZiAobGV2ZWw+MCkNCiAgICBpZiAobGFzdE5vZGUpIC8vdGhlIGxhc3QgY2hpbGQgaW4gdGhlIGNoaWxkcmVuIGFycmF5IA0KCQlsZWZ0U2lkZSA9IGxlZnRTaWRlICsgIjAiDQoJZWxzZQ0KCQlsZWZ0U2lkZSA9IGxlZnRTaWRlICsgIjEiDQoNCiAgdGhpcy5pc0xhc3ROb2RlID0gbGFzdE5vZGUNCiANCiAgaWYgKG5jID4gMCkgDQogIHsgDQogICAgbGV2ZWwgPSBsZXZlbCArIDEgDQogICAgZm9yIChpPTAgOyBpIDwgdGhpcy5uQ2hpbGRyZW47IGkrKykgIA0KICAgIHsNCiAgICAgIGlmICh0eXBlb2YgdGhpcy5jaGlsZHJlbltpXS5pbml0aWFsaXplID09ICd1bmRlZmluZWQnKSAvL2RvY3VtZW50IG5vZGUgd2FzIHNwZWNpZmllZCB1c2luZyB0aGUgYWRkQ2hpbGRyZW4gZnVuY3Rpb24NCiAgICAgIHsNCiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmNoaWxkcmVuW2ldWzBdID09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiB0aGlzLmNoaWxkcmVuW2ldID09ICdzdHJpbmcnKQ0KICAgICAgICB7DQogICAgICAgICAgdGhpcy5jaGlsZHJlbltpXSA9IFsiaXRlbSBpbmNvcnJlY3RseSBkZWZpbmVkIiwgIiJdOw0KICAgICAgICB9DQoNCiAgICAgICAgLy9CYXNpYyBpbml0aWFsaXphdGlvbiBvZiB0aGUgSXRlbSBvYmplY3QNCiAgICAgICAgLy9UaGVzZSBtZW1iZXJzIG9yIG1ldGhvZHMgYXJlIG5lZWRlZCBldmVuIGJlZm9yZSB0aGUgSXRlbSBpcyByZW5kZXJlZA0KICAgICAgICB0aGlzLmNoaWxkcmVuW2ldLmluaXRpYWxpemU9aW5pdGlhbGl6ZUl0ZW07DQogICAgICAgIHRoaXMuY2hpbGRyZW5baV0uY3JlYXRlSW5kZXg9Y3JlYXRlRW50cnlJbmRleDsNCiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmNoaWxkcmVuW2ldLm1heVNlbGVjdCA9PSAndW5kZWZpbmVkJykNCiAgICAgICAgICB0aGlzLmNoaWxkcmVuW2ldLm1heVNlbGVjdD10cnVlDQogICAgICAgIHRoaXMuY2hpbGRyZW5baV0uZm9yY2VPcGVuaW5nT2ZBbmNlc3RvckZvbGRlcnMgPSBmb3JjZU9wZW5pbmdPZkFuY2VzdG9yRm9sZGVycw0KICAgICAgfQ0KICAgICAgaWYgKGkgPT0gdGhpcy5uQ2hpbGRyZW4tMSkgDQogICAgICAgIHRoaXMuY2hpbGRyZW5baV0uaW5pdGlhbGl6ZShsZXZlbCwgMSwgbGVmdFNpZGUpDQogICAgICBlbHNlIA0KICAgICAgICB0aGlzLmNoaWxkcmVuW2ldLmluaXRpYWxpemUobGV2ZWwsIDAsIGxlZnRTaWRlKQ0KICAgIH0gDQogIH0gDQp9IA0KIA0KZnVuY3Rpb24gZHJhd0ZvbGRlcihpbnNlcnRBdE9iaikgDQp7IA0KICAgIHZhciBub2RlTmFtZSA9ICIiDQogICAgdmFyIGF1eEV2ID0gIiINCiAgICB2YXIgZG9jVyA9ICIiDQogICAgdmFyIGk9MA0KDQogICAgZmluYWxpemVDcmVhdGlvbk9mQ2hpbGREb2NzKHRoaXMpOw0KDQogICAgdmFyIGxlZnRTaWRlID0gbGVmdFNpZGVIVE1MKHRoaXMubGVmdFNpZGVDb2RlZCk7DQoNCiAgICBhdXhFdiA9ICI8YSBocmVmPSdqYXZhc2NyaXB0OmNsaWNrT25Ob2RlKFwiIiArIHRoaXMuZ2V0SUQoKSsgIlwiKSc+IiA7DQoNCiAgICBub2RlTmFtZSA9IHRoaXMubm9kZUltYWdlU3JjKCk7DQogDQogICAgaWYgKHRoaXMubGV2ZWw+MCkgDQoJew0KCWlmICh0aGlzLmlzTGFzdE5vZGUpIC8vdGhlIGxhc3QgY2hpbGQgaW4gdGhlIGNoaWxkcmVuIGFycmF5IA0KCSAgICBsZWZ0U2lkZSA9IGxlZnRTaWRlICsgIjx0ZCB2YWxpZ249dG9wPiIgKyBhdXhFdiArICI8aW1nIG5hbWU9J25vZGVJY29uIiArIHRoaXMuaWQgKyAiJyBpZD0nbm9kZUljb24iICsgdGhpcy5pZCArICInIHNyYz0nIiArIG5vZGVOYW1lICsgIicgd2lkdGg9MjAgaGVpZ2h0PTE2IGJvcmRlcj0wPjwvYT48L3RkPiINCgllbHNlIA0KCSAgICBsZWZ0U2lkZSA9IGxlZnRTaWRlICsgIjx0ZCB2YWxpZ249dG9wIGJhY2tncm91bmQ9IiArIElDT05QQVRIICsgImNoYWluLmdpZj4iICsgYXV4RXYgKyAiPGltZyBuYW1lPSdub2RlSWNvbiIgKyB0aGlzLmlkICsgIicgaWQ9J25vZGVJY29uIiArIHRoaXMuaWQgKyAiJyBzcmM9JyIgKyBub2RlTmFtZSArICInIHdpZHRoPTIwIGhlaWdodD0xNiBib3JkZXI9MD48L2E+PC90ZD4iDQoJfQ0KICAgIHRoaXMuaXNSZW5kZXJlZCA9IDENCg0KICAgIGRvY1cgPSB0aGlzLmJsb2NrU3RhcnRIVE1MKCJmb2xkZXIiKTsNCg0KICAgIGRvY1cgPSBkb2NXICsgIjx0cj4iICsgbGVmdFNpZGUgKyAiPHRkIHZhbGlnbj10b3A+IjsNCiAgICBpZiAoVVNFSUNPTlMpDQoJew0KCWRvY1cgPSBkb2NXICsgdGhpcy5saW5rSFRNTChmYWxzZSkgDQoJZG9jVyA9IGRvY1cgKyAiPGltZyBpZD0nZm9sZGVySWNvbiIgKyB0aGlzLmlkICsgIicgbmFtZT0nZm9sZGVySWNvbiIgKyB0aGlzLmlkICsgIicgc3JjPSciICsgdGhpcy5pY29uSW1hZ2VTcmMoKSArICInIGJvcmRlcj0wPjwvYT4iDQoJfQ0KICAgIGVsc2UNCgl7DQoJaWYgKHRoaXMucHJlcGVuZEhUTUwgPT0gIiIpDQoJICAgIGRvY1cgPSBkb2NXICsgIjxpbWcgc3JjPSIgKyBJQ09OUEFUSCArICJlbXB0eS5naWYgaGVpZ2h0PTE2IHdpZHRoPTIwPiINCgl9DQogICAgZG9jVyA9IGRvY1cgKyAiPC90ZD4iK3RoaXMucHJlcGVuZEhUTUwrIjx0ZCB2YWxpZ249bWlkZGxlIHdpZHRoPTEwMCU+Ig0KDQogICAgaWYgKFVTRVRFWFRMSU5LUykgDQoJeyANCglkb2NXID0gZG9jVyArIHRoaXMubGlua0hUTUwodHJ1ZSkgDQoJZG9jVyA9IGRvY1cgKyB0aGlzLmRlc2MgKyAiPC9hPiINCgl9IA0KICAgIGVsc2UgDQoJZG9jVyA9IGRvY1cgKyB0aGlzLmRlc2MNCg0KICAgIGRvY1cgPSBkb2NXICsgIjwvdGQ+Ig0KICAgIGRvY1cgPSBkb2NXICsgdGhpcy5ibG9ja0VuZEhUTUwoKQ0KDQogICAgaWYgKGluc2VydEF0T2JqID09IG51bGwpDQoJew0KCWlmIChzdXBwb3J0c0RlZmVycmFsKSB7DQoJICAgIGluc2VydEF0T2JqID0gZ2V0RWxCeUlkKCJkb21Sb290IikNCgkgICAgaW5zZXJ0QXRPYmouaW5zZXJ0QWRqYWNlbnRIVE1MKCJCZWZvcmVFbmQiLCBkb2NXKQ0KCSAgICB9DQoJZWxzZQ0KCSAgICB7DQoJICAgIGRvYy53cml0ZShkb2NXKQ0KCSAgICB9DQoJfQ0KICAgIGVsc2UNCgl7DQoJaW5zZXJ0QXRPYmouaW5zZXJ0QWRqYWNlbnRIVE1MKCJBZnRlckVuZCIsIGRvY1cpDQoJfQ0KIA0KICAgIHRoaXMubmF2T2JqID0gZ2V0RWxCeUlkKCJmb2xkZXIiK3RoaXMuaWQpDQoNCiAgICBpZiAoVVNFSUNPTlMpDQogICAgICB0aGlzLmljb25JbWcgPSBnZXRFbEJ5SWQoImZvbGRlckljb24iK3RoaXMuaWQpIA0KDQogICAgdGhpcy5ub2RlSW1nID0gZ2V0RWxCeUlkKCJub2RlSWNvbiIrdGhpcy5pZCkNCn0gDQogDQpmdW5jdGlvbiBzZXRTdGF0ZUZvbGRlcihpc09wZW4pIA0KeyANCiAgdmFyIHN1YkVudHJpZXMgDQogIHZhciB0b3RhbEhlaWdodCANCiAgdmFyIGZJdCA9IDAgDQogIHZhciBpPTAgDQogIHZhciBjdXJyZW50T3Blbg0KIA0KICBpZiAoaXNPcGVuID09IHRoaXMuaXNPcGVuKSANCiAgICByZXR1cm4gDQogDQogIHRoaXMuaXNPcGVuID0gaXNPcGVuOw0KDQogIGlmICghdGhpcy5pc09wZW4gJiYgdGhpcy5pc0xhc3RPcGVuZWRmb2xkZXIpDQogIHsNCglsYXN0T3BlbmVkRm9sZGVyID0gbnVsbDsNCgl0aGlzLmlzTGFzdE9wZW5lZGZvbGRlciA9IGZhbHNlOw0KICB9DQogIHByb3BhZ2F0ZUNoYW5nZXNJblN0YXRlKHRoaXMpIA0KfSANCiANCmZ1bmN0aW9uIHByb3BhZ2F0ZUNoYW5nZXNJblN0YXRlKGZvbGRlcikgDQp7ICAgDQogICAgdmFyIGk9MCANCg0KCS8vQ2hhbmdlIGljb24NCiAgICBpZiAoZm9sZGVyLm5DaGlsZHJlbiA+IDAgJiYgZm9sZGVyLmxldmVsPjApICAvL290aGVyd2lzZSB0aGUgb25lIGdpdmVuIGF0IHJlbmRlciBzdGF5cw0KCWZvbGRlci5ub2RlSW1nLnNyYyA9IGZvbGRlci5ub2RlSW1hZ2VTcmMoKQ0KDQoJLy9DaGFuZ2Ugbm9kZQ0KICAgIGlmIChVU0VJQ09OUykNCglmb2xkZXIuaWNvbkltZy5zcmMgPSBmb2xkZXIuaWNvbkltYWdlU3JjKCkNCg0KCS8vUHJvcGFnYXRlIGNoYW5nZXMNCiAgICBmb3IgKGk9Zm9sZGVyLm5DaGlsZHJlbi0xOyBpPj0wOyBpLS0pDQoJew0KCWlmIChmb2xkZXIuaXNPcGVuKSANCgkgICAgZm9sZGVyLmNoaWxkcmVuW2ldLmZvbGRlck1zdHIoZm9sZGVyLm5hdk9iaikNCgllbHNlIA0KCSAgICBmb2xkZXIuY2hpbGRyZW5baV0uZXNjb25kZSgpIA0KCX0NCn0gDQogDQpmdW5jdGlvbiBlc2NvbmRlRm9sZGVyKCkgDQp7IA0KICB0aGlzLmVzY29uZGVCbG9jaygpDQogICANCiAgdGhpcy5zZXRTdGF0ZSgwKSANCn0gDQogDQpmdW5jdGlvbiBsaW5rRm9sZGVySFRNTChpc1RleHRMaW5rKSANCnsNCiAgICB2YXIgdHh0c3R5bGUgPSAiIjsNCiAgICB2YXIgZG9jVyA9ICIiOw0KDQogICAgaWYgKHRoaXMuaHJlZmVyZW5jZSkgDQoJeyANCglpZiAodGhpcy5ocmVmZXJlbmNlLnN1YnN0cmluZygwLDE2KSA9PSAiLyIgKyBJbnN0UHJvZElkLnN1YnN0cmluZygwLDE1KSkgeyB0eHRzdHlsZSA9ICJzdHlsZT1cJ2NvbG9yOmJsdWU7IGJhY2tncm91bmQtY29sb3I6TGlnaHRCbHVlXCciOyB9DQoNCglpZiAoVVNFRlJBTUVTKQ0KCSAgICBkb2NXID0gZG9jVyArICI8YSAiICsgdHh0c3R5bGUgKyAiIGhyZWY9JyIgKyB0aGlzLmhyZWZlcmVuY2UgKyAiJyBUQVJHRVQ9XCJiYXNlZnJtXCIgIg0KCWVsc2UNCgkgICAgZG9jVyA9IGRvY1cgKyAiPGEgIiArIHR4dHN0eWxlICsgIiBocmVmPSciICsgdGhpcy5ocmVmZXJlbmNlICsgIicgVEFSR0VUPV9ibGFuayAiDQoNCglpZiAoaXNUZXh0TGluaykgew0KCSAgICBkb2NXICs9ICJpZD1cIml0ZW1UZXh0TGluayIrdGhpcy5pZCsiXCIgIjsNCgkgICAgfQ0KDQoJZG9jVyA9IGRvY1cgKyAib25DbGljaz0namF2YXNjcmlwdDpjbGlja09uRm9sZGVyKFwiIit0aGlzLmdldElEKCkrIlwiKSciDQoJZG9jVyA9IGRvY1cgKyAiPiINCgl9IA0KICAgIGVsc2UgDQoJew0KCXR4dHN0eWxlID0gInN0eWxlPVwnY29sb3I6Ymx1ZTsgYmFja2dyb3VuZC1jb2xvcjpMaWdodEJsdWVcJyI7DQoJZG9jVyA9IGRvY1cgKyAiPGEgIiArIHR4dHN0eWxlICsgIj4iIA0KCX0NCg0KICAgIHJldHVybiBkb2NXOw0KfSANCiANCmZ1bmN0aW9uIGFkZENoaWxkKGNoaWxkTm9kZSkgDQp7IA0KICB0aGlzLmNoaWxkcmVuW3RoaXMubkNoaWxkcmVuXSA9IGNoaWxkTm9kZSANCiAgY2hpbGROb2RlLnBhcmVudE9iaiA9IHRoaXMNCiAgdGhpcy5uQ2hpbGRyZW4rKyANCiAgcmV0dXJuIGNoaWxkTm9kZSANCn0gDQoNCi8vVGhlIGxpc3QgY2FuIGNvbnRhaW4gZWl0aGVyIGEgRm9sZGVyIG9iamVjdCBvciBhIHN1YiBsaXN0IHdpdGggdGhlIGFyZ3VtZW50cyBmb3IgSXRlbSANCmZ1bmN0aW9uIGFkZENoaWxkcmVuKGxpc3RPZkNoaWxkcmVuKSANCnsgDQogIHRoaXMuY2hpbGRyZW4gPSBsaXN0T2ZDaGlsZHJlbiANCiAgdGhpcy5uQ2hpbGRyZW4gPSBsaXN0T2ZDaGlsZHJlbi5sZW5ndGgNCiAgZm9yIChpPTA7IGk8dGhpcy5uQ2hpbGRyZW47IGkrKykNCiAgICB0aGlzLmNoaWxkcmVuW2ldLnBhcmVudE9iaiA9IHRoaXMNCn0gDQoNCmZ1bmN0aW9uIGZvbGRlclN1YkVudHJpZXMoKSANCnsgDQogIHZhciBpID0gMCANCiAgdmFyIHNlID0gdGhpcy5uQ2hpbGRyZW4gDQogDQogIGZvciAoaT0wOyBpIDwgdGhpcy5uQ2hpbGRyZW47IGkrKyl7IA0KICAgIGlmICh0aGlzLmNoaWxkcmVuW2ldLmNoaWxkcmVuKSAvL2lzIGEgZm9sZGVyIA0KICAgICAgc2UgPSBzZSArIHRoaXMuY2hpbGRyZW5baV0uc3ViRW50cmllcygpIA0KICB9IA0KIA0KICByZXR1cm4gc2UgDQp9IA0KDQpmdW5jdGlvbiBub2RlSW1hZ2VTcmMoKSB7DQogIHZhciBzcmNTdHIgPSAiIjsNCg0KICBpZiAodGhpcy5pc0xhc3ROb2RlKSAvL3RoZSBsYXN0IGNoaWxkIGluIHRoZSBjaGlsZHJlbiBhcnJheSANCiAgeyANCiAgICBpZiAodGhpcy5uQ2hpbGRyZW4gPT0gMCkNCiAgICAgIHNyY1N0ciA9IElDT05QQVRIICsgIm5vZGVFbmQuZ2lmIg0KICAgIGVsc2UNCiAgICAgIGlmICh0aGlzLmlzT3BlbikNCiAgICAgICAgc3JjU3RyID0gSUNPTlBBVEggKyAibWludXNFbmQuZ2lmIiAgDQogICAgICBlbHNlDQogICAgICAgIHNyY1N0ciA9IElDT05QQVRIICsgInBsdXNFbmQuZ2lmIiAgDQogIH0gDQogIGVsc2UgDQogIHsgDQogICAgaWYgKHRoaXMubkNoaWxkcmVuID09IDApDQogICAgICBzcmNTdHIgPSBJQ09OUEFUSCArICJub2RlLmdpZiINCiAgICBlbHNlDQogICAgICBpZiAodGhpcy5pc09wZW4pDQogICAgICAgIHNyY1N0ciA9IElDT05QQVRIICsgIm1pbnVzLmdpZiINCiAgICAgIGVsc2UNCiAgICAgICAgc3JjU3RyID0gSUNPTlBBVEggKyAicGx1cy5naWYiDQogIH0gICANCiAgcmV0dXJuIHNyY1N0cjsNCn0NCg0KZnVuY3Rpb24gaWNvbkltYWdlU3JjKCkgew0KICBpZiAodGhpcy5pc09wZW4pDQogICAgcmV0dXJuKHRoaXMuaWNvblNyYykNCiAgZWxzZQ0KICAgIHJldHVybih0aGlzLmljb25TcmNDbG9zZWQpDQp9IA0KIA0KZnVuY3Rpb24gSXRlbShpdGVtRGVzY3JpcHRpb24pIC8vIENvbnN0cnVjdG9yIA0KeyANCiAgLy8gY29uc3RhbnQgZGF0YSANCiAgdGhpcy5kZXNjID0gaXRlbURlc2NyaXB0aW9uIA0KDQogIHRoaXMubGV2ZWwgPSAwDQogIHRoaXMuaXNMYXN0Tm9kZSA9IGZhbHNlDQogIHRoaXMubGVmdFNpZGVDb2RlZCA9ICIiDQogIHRoaXMucGFyZW50T2JqID0gbnVsbA0KDQogIHRoaXMubWF5U2VsZWN0PXRydWUNCg0KICB0aGlzLmluaXRpYWxpemUgPSBpbml0aWFsaXplSXRlbTsNCiAgdGhpcy5jcmVhdGVJbmRleCA9IGNyZWF0ZUVudHJ5SW5kZXg7DQogIHRoaXMuZm9yY2VPcGVuaW5nT2ZBbmNlc3RvckZvbGRlcnMgPSBmb3JjZU9wZW5pbmdPZkFuY2VzdG9yRm9sZGVyczsNCg0KICBmaW5hbGl6ZUNyZWF0aW9uT2ZJdGVtKHRoaXMpDQp9IA0KDQovL0Fzc2lnbm1lbnRzIHRoYXQgY2FuIGJlIGRlbGF5ZWQgd2hlbiB0aGUgaXRlbSBpcyBjcmVhdGVkIHdpdGggZm9sZGVyLmFkZENoaWxkcmVuDQovL1RoZSBhc3NpZ25tZW50cyB0aGF0IGNhbm5vdCBiZSBkZWxheWVkIGFyZSBkb25lIGluIGFkZENoaWxkcmVuIGFuZCBpbiBpbml0aWFsaXplRm9sZGVyDQovL0FkZGl0aW9uYWx5LCBzb21lIGFzc2lnbm1lbnRzIGFyZSBhbHNvIGRvbmUgaW4gZmluYWxpemVDcmVhdGlvbk9mQ2hpbGREb2NzIGl0c2VsZg0KZnVuY3Rpb24gZmluYWxpemVDcmVhdGlvbk9mSXRlbShpdGVtQXJyYXkpDQp7DQogIGl0ZW1BcnJheS5uYXZPYmogPSAwIC8vaW5pdGlhbGl6ZWQgaW4gcmVuZGVyKCkgDQogIGl0ZW1BcnJheS5pY29uSW1nID0gMCAvL2luaXRpYWxpemVkIGluIHJlbmRlcigpIA0KICBpdGVtQXJyYXkuaWNvblNyYyA9IElDT05QQVRIICsgImZ0djJkb2MuZ2lmIiANCiAgaXRlbUFycmF5LmlzUmVuZGVyZWQgPSAwDQogIGl0ZW1BcnJheS5uQ2hpbGRyZW4gPSAwDQogIGl0ZW1BcnJheS5wcmVwZW5kSFRNTCA9ICIiDQogDQogIC8vIG1ldGhvZHMgDQogIGl0ZW1BcnJheS5lc2NvbmRlQmxvY2sgPSBlc2NvbmRlQmxvY2sNCiAgaXRlbUFycmF5LmVzY29uZGUgPSBlc2NvbmRlQmxvY2sNCiAgaXRlbUFycmF5LmZvbGRlck1zdHIgPSBmb2xkZXJNc3RyIA0KICBpdGVtQXJyYXkucmVuZGVyT2IgPSBkcmF3SXRlbSANCiAgaXRlbUFycmF5LnRvdGFsSGVpZ2h0ID0gdG90YWxIZWlnaHQgDQogIGl0ZW1BcnJheS5ibG9ja1N0YXJ0SFRNTCA9IGJsb2NrU3RhcnRIVE1MDQogIGl0ZW1BcnJheS5ibG9ja0VuZEhUTUwgPSBibG9ja0VuZEhUTUwNCiAgaXRlbUFycmF5LmdldElEID0gZ2V0SUQNCn0NCg0KZnVuY3Rpb24gaW5pdGlhbGl6ZUl0ZW0obGV2ZWwsIGxhc3ROb2RlLCBsZWZ0U2lkZSkgDQp7ICANCiAgdGhpcy5jcmVhdGVJbmRleCgpIA0KICB0aGlzLmxldmVsID0gbGV2ZWwNCiAgdGhpcy5sZWZ0U2lkZUNvZGVkID0gbGVmdFNpZGUNCiAgdGhpcy5pc0xhc3ROb2RlID0gbGFzdE5vZGUNCn0gDQogDQpmdW5jdGlvbiBkcmF3SXRlbShpbnNlcnRBdE9iaikgDQp7IA0KICAgIHZhciBsZWZ0U2lkZSA9IGxlZnRTaWRlSFRNTCh0aGlzLmxlZnRTaWRlQ29kZWQpOw0KICAgIHZhciBkb2NXID0gIiI7DQoNCiAgICB2YXIgZnVsbExpbmsgPSAiaHJlZj1cIiIrdGhpcy5saW5rKyJcIiB0YXJnZXQ9XCIiKyB0aGlzLnRhcmdldCArICJcIiBvbkNsaWNrPVwiY2xpY2tPbkxpbmsoJyIrdGhpcy5nZXRJRCgpKyJcJywgJyIrdGhpcy5saW5rKyInLCciK3RoaXMudGFyZ2V0KyInKTtyZXR1cm4gZmFsc2U7XCIiOw0KICAgIHRoaXMuaXNSZW5kZXJlZCA9IDENCg0KICAgIGlmICh0aGlzLmxldmVsPjApIA0KICAgIAl7DQoJaWYgKHRoaXMuaXNMYXN0Tm9kZSkgLy90aGUgbGFzdCAnYnJvdGhlcicgaW4gdGhlIGNoaWxkcmVuIGFycmF5IA0KCSAgICB7IA0KCSAgICBsZWZ0U2lkZSA9IGxlZnRTaWRlICsgIjx0ZCB2YWxpZ249dG9wPjxpbWcgc3JjPSciICsgSUNPTlBBVEggKyAibm9kZUVuZC5naWYnIHdpZHRoPTIwIGhlaWdodD0xNj48L3RkPiINCgkgICAgfSANCgllbHNlIA0KCSAgICB7IA0KCSAgICBsZWZ0U2lkZSA9IGxlZnRTaWRlICsgIjx0ZCB2YWxpZ249dG9wIGJhY2tncm91bmQ9IiArIElDT05QQVRIICsgImNoYWluLmdpZj48aW1nIHNyYz0nIiArIElDT05QQVRIICsgIm5vZGUuZ2lmJyB3aWR0aD0yMCBoZWlnaHQ9MTY+PC90ZD4iDQoJICAgIH0gDQoJfQ0KDQogICAgZG9jVyA9IGRvY1cgKyB0aGlzLmJsb2NrU3RhcnRIVE1MKCJpdGVtIikNCg0KICAgIGRvY1cgPSBkb2NXICsgIjx0cj4iICsgbGVmdFNpZGUgKyAiPHRkIHZhbGlnbj10b3A+Ig0KICAgIGlmIChVU0VJQ09OUykNCglkb2NXID0gZG9jVyArICI8YSAiICsgZnVsbExpbmsgKyAiIGlkPVwiaXRlbUljb25MaW5rIit0aGlzLmlkKyJcIj4iICsgIjxpbWcgaWQ9J2l0ZW1JY29uIit0aGlzLmlkKyInICIgKyAic3JjPSciK3RoaXMuaWNvblNyYysiJyBib3JkZXI9MD4iICsgIjwvYT4iDQogICAgZWxzZQ0KCWlmICh0aGlzLnByZXBlbmRIVE1MID09ICIiKQ0KCSAgICBkb2NXID0gZG9jVyArICI8aW1nIHNyYz0iICsgSUNPTlBBVEggKyAiZW1wdHkuZ2lmIGhlaWdodD0xNiB3aWR0aD0yMD4iDQoNCiAgICBkb2NXID0gZG9jVyArICI8L3RkPiIrdGhpcy5wcmVwZW5kSFRNTCsiPHRkIHZhbGlnbj1taWRkbGUgd2lkdGg9MTAwJT4iDQoNCiAgICBpZiAoVVNFVEVYVExJTktTKSANCglkb2NXID0gZG9jVyArICI8YSAiICsgZnVsbExpbmsgKyAiIGlkPVwiaXRlbVRleHRMaW5rIit0aGlzLmlkKyJcIj4iICsgdGhpcy5kZXNjICsgIjwvYT4iDQogICAgZWxzZSANCglkb2NXID0gZG9jVyArIHRoaXMuZGVzYw0KDQogICAgZG9jVyA9IGRvY1cgKyAiPC90ZD4iDQogICAgZG9jVyA9IGRvY1cgKyB0aGlzLmJsb2NrRW5kSFRNTCgpDQoNCiAgICBpZiAoaW5zZXJ0QXRPYmogPT0gbnVsbCkNCgl7DQoJZG9jLndyaXRlKGRvY1cpDQoJfQ0KICAgIGVsc2UNCgl7DQoJaW5zZXJ0QXRPYmouaW5zZXJ0QWRqYWNlbnRIVE1MKCJBZnRlckVuZCIsIGRvY1cpDQoJfQ0KDQogICAgdGhpcy5uYXZPYmogPSBnZXRFbEJ5SWQoIml0ZW0iK3RoaXMuaWQpDQoNCiAgICBpZiAoVVNFSUNPTlMpDQoJdGhpcy5pY29uSW1nID0gZ2V0RWxCeUlkKCJpdGVtSWNvbiIrdGhpcy5pZCkNCn0gDQogDQovLyBNZXRob2RzIGNvbW1vbiB0byBib3RoIG9iamVjdHMgKHBzZXVkby1pbmhlcml0YW5jZSkgDQovLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiANCiANCmZ1bmN0aW9uIGZvcmNlT3BlbmluZ09mQW5jZXN0b3JGb2xkZXJzKCkgew0KICBpZiAodGhpcy5wYXJlbnRPYmogPT0gbnVsbCB8fCB0aGlzLnBhcmVudE9iai5pc09wZW4pDQogICAgcmV0dXJuDQogIGVsc2Ugew0KICAgIHRoaXMucGFyZW50T2JqLmZvcmNlT3BlbmluZ09mQW5jZXN0b3JGb2xkZXJzKCkNCiAgICBjbGlja09uTm9kZU9iaih0aGlzLnBhcmVudE9iaikNCiAgfQ0KfQ0KDQpmdW5jdGlvbiBlc2NvbmRlQmxvY2soKSANCnsgDQogICAgaWYgKHRoaXMubmF2T2JqLnN0eWxlLmRpc3BsYXkgPT0gIm5vbmUiKSANCiAgICAgIHJldHVybiANCiAgICB0aGlzLm5hdk9iai5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiIA0KfSANCiANCmZ1bmN0aW9uIGZvbGRlck1zdHIoZG9tT2JqKSANCnsgDQogIGlmICghdGhpcy5pc1JlbmRlcmVkKQ0KICAgICB0aGlzLnJlbmRlck9iKGRvbU9iaikNCiAgZWxzZQ0KICAgIHRoaXMubmF2T2JqLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siIA0KfSANCg0KZnVuY3Rpb24gYmxvY2tTdGFydEhUTUwoaWRwcmVmaXgpIHsNCiAgdmFyIGlkUGFyYW0gPSAiaWQ9JyIgKyBpZHByZWZpeCArIHRoaXMuaWQgKyAiJyINCiAgdmFyIGRvY1cgPSAiIg0KDQogICAgZG9jVyA9ICI8ZGl2ICIgKyBpZFBhcmFtICsgIiBzdHlsZT0nZGlzcGxheTpibG9jazsnPiINCiAgICAgDQogIGRvY1cgPSBkb2NXICsgIjx0YWJsZSBib3JkZXI9MCBjZWxsc3BhY2luZz0wIGNlbGxwYWRkaW5nPTAgd2lkdGg9MTAwJSA+Ig0KDQogIHJldHVybiBkb2NXDQp9DQoNCmZ1bmN0aW9uIGJsb2NrRW5kSFRNTCgpIHsNCiAgdmFyIGRvY1cgPSAiIg0KDQogIGRvY1cgPSAiPC90YWJsZT4iDQogICANCmRvY1cgPSBkb2NXICsgIjwvZGl2PiINCg0KICByZXR1cm4gZG9jVw0KfQ0KIA0KZnVuY3Rpb24gY3JlYXRlRW50cnlJbmRleCgpIA0KeyANCiAgdGhpcy5pZCA9IG5FbnRyaWVzIA0KICBpbmRleE9mRW50cmllc1tuRW50cmllc10gPSB0aGlzIA0KICBuRW50cmllcysrIA0KfSANCiANCi8vIHRvdGFsIGhlaWdodCBvZiBzdWJFbnRyaWVzIG9wZW4gDQpmdW5jdGlvbiB0b3RhbEhlaWdodCgpIC8vdXNlZCB3aXRoIGJyb3dzZXJWZXJzaW9uID09IDIgDQp7IA0KICB2YXIgaCA9IHRoaXMubmF2T2JqLmNsaXAuaGVpZ2h0IA0KICB2YXIgaSA9IDAgDQogICANCiAgaWYgKHRoaXMuaXNPcGVuKSAvL2lzIGEgZm9sZGVyIGFuZCBfaXNfIG9wZW4gDQogICAgZm9yIChpPTAgOyBpIDwgdGhpcy5uQ2hpbGRyZW47IGkrKykgIA0KICAgICAgaCA9IGggKyB0aGlzLmNoaWxkcmVuW2ldLnRvdGFsSGVpZ2h0KCkgDQogDQogIHJldHVybiBoIA0KfSANCg0KDQpmdW5jdGlvbiBsZWZ0U2lkZUhUTUwobGVmdFNpZGVDb2RlZCkgew0KCXZhciBpOw0KCXZhciByZXRTdHIgPSAiIjsNCg0KCWZvciAoaT0wOyBpPGxlZnRTaWRlQ29kZWQubGVuZ3RoOyBpKyspDQoJew0KCQlpZiAobGVmdFNpZGVDb2RlZC5jaGFyQXQoaSkgPT0gIjEiKQ0KCQl7DQoJCQlyZXRTdHIgPSByZXRTdHIgKyAiPHRkIHZhbGlnbj10b3AgYmFja2dyb3VuZD0iICsgSUNPTlBBVEggKyAiY2hhaW4uZ2lmPjxpbWcgc3JjPSciICsgSUNPTlBBVEggKyAiY2hhaW4uZ2lmJyB3aWR0aD0yMCBoZWlnaHQ9MTY+PC90ZD4iDQoJCX0NCgkJaWYgKGxlZnRTaWRlQ29kZWQuY2hhckF0KGkpID09ICIwIikNCgkJew0KCQkJcmV0U3RyID0gcmV0U3RyICsgIjx0ZCB2YWxpZ249dG9wPjxpbWcgc3JjPSciICsgSUNPTlBBVEggKyAiZW1wdHkuZ2lmJyB3aWR0aD0yMCBoZWlnaHQ9MTY+PC90ZD4iDQoJCX0NCgl9DQoJcmV0dXJuIHJldFN0cg0KfQ0KDQpmdW5jdGlvbiBnZXRJRCgpDQp7DQogIC8vZGVmaW5lIGEgLnhJRCBpbiBhbGwgbm9kZXMgKGZvbGRlcnMgYW5kIGl0ZW1zKSBpZiB5b3Ugd2FudCB0byBQRVJWRVNUQVRFIHRoYXQNCiAgLy93b3JrIHdoZW4gdGhlIHRyZWUgY2hhbmdlcy4gVGhlIHZhbHVlIGVYdGVybmFsIHZhbHVlIG11c3QgYmUgdW5pcXVlIGZvciBlYWNoDQogIC8vbm9kZSBhbmQgbXVzdCBub2RlIGNoYW5nZSB3aGVuIG90aGVyIG5vZGVzIGFyZSBhZGRlZCBvciByZW1vdmVkDQogIC8vVGhlIHZhbHVlIG1heSBiZSBudW1lcmljIG9yIHN0cmluZywgYnV0IGNhbm5vdCBoYXZlIHRoZSBzYW1lIGNoYXIgdXNlZCBpbiBjb29raWVDdXR0ZXINCiAgaWYgKHR5cGVvZiB0aGlzLnhJRCAhPSAidW5kZWZpbmVkIikgDQogICAgcmV0dXJuIHRoaXMueElEDQogIGVsc2UNCiAgICByZXR1cm4gdGhpcy5pZA0KfQ0KDQogDQovLyBFdmVudHMgDQovLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogDQogDQpmdW5jdGlvbiBjbGlja09uRm9sZGVyKGZvbGRlcklkKSANCnsgDQogIHZhciBjbGlja2VkID0gZmluZE9iaihmb2xkZXJJZCkNCg0KICBpZiAodHlwZW9mIGNsaWNrZWQ9PSd1bmRlZmluZWQnIHx8IGNsaWNrZWQ9PW51bGwpDQogIHsNCiAgICBhbGVydCgiVHJlZXZpZXcgd2FzIG5vdCBhYmxlIHRvIGZpbmQgdGhlIG5vZGUgb2JqZWN0IGNvcnJlc3BvbmRpbmcgdG8gSUQ9IiArIGZvbGRlcklkICsgIi4gSWYgdGhlIGNvbmZpZ3VyYXRpb24gZmlsZSBzZXRzIGEueElEIHZhbHVlcywgaXQgbXVzdCBzZXQgdGhlbSBmb3IgQUxMIG5vZGVzLCBpbmNsdWRpbmcgdGhlIGZvbGRlcnNUcmVlIHJvb3QuIikNCiAgICByZXR1cm47DQogIH0NCg0KICBpZiAoIWNsaWNrZWQuaXNPcGVuKSB7DQogICAgY2xpY2tPbk5vZGVPYmooY2xpY2tlZCkgDQogIH0NCg0KICBpZiAobGFzdE9wZW5lZEZvbGRlciAhPSBudWxsICYmIGxhc3RPcGVuZWRGb2xkZXIgIT0gZm9sZGVySWQpDQogICAgY2xpY2tPbk5vZGUobGFzdE9wZW5lZEZvbGRlcik7IC8vc2V0cyBsYXN0T3BlbmVkRm9sZGVyIHRvIG51bGwNCg0KICBpZiAoY2xpY2tlZC5uQ2hpbGRyZW49PTApIHsNCiAgICBsYXN0T3BlbmVkRm9sZGVyID0gZm9sZGVySWQ7DQogICAgY2xpY2tlZC5pc0xhc3RPcGVuZWRmb2xkZXIgPSB0cnVlDQogIH0NCg0KICBpZiAoaXNMaW5rZWQoY2xpY2tlZC5ocmVmZXJlbmNlKSkgew0KICAgICAgaGlnaGxpZ2h0T2JqTGluayhjbGlja2VkKTsNCiAgfQ0KfSANCiANCmZ1bmN0aW9uIGNsaWNrT25Ob2RlKGZvbGRlcklkKSANCnsgDQogIGZPYiA9IGZpbmRPYmooZm9sZGVySWQpOw0KICBpZiAodHlwZW9mIGZPYj09J3VuZGVmaW5lZCcgfHwgZk9iPT1udWxsKQ0KICB7DQogICAgYWxlcnQoIlRyZWV2aWV3IHdhcyBub3QgYWJsZSB0byBmaW5kIHRoZSBub2RlIG9iamVjdCBjb3JyZXNwb25kaW5nIHRvIElEPSIgKyBmb2xkZXJJZCArICIuIElmIHRoZSBjb25maWd1cmF0aW9uIGZpbGUgc2V0cyBhLnhJRCwgaXQgbXVzdCBzZXQgZm9sZGVyc1RyZWUueElEIGFzIHdlbGwuIikNCiAgICByZXR1cm47DQogIH0NCg0KICBjbGlja09uTm9kZU9iaihmT2IpOw0KfQ0KDQpmdW5jdGlvbiBjbGlja09uTm9kZU9iaihmb2xkZXJPYmopIA0KeyANCiAgdmFyIHN0YXRlID0gMCANCiAgdmFyIGN1cnJlbnRPcGVuDQogDQogIHN0YXRlID0gZm9sZGVyT2JqLmlzT3BlbiANCiAgZm9sZGVyT2JqLnNldFN0YXRlKCFzdGF0ZSkgLy9vcGVuPC0+Y2xvc2UgIA0KDQogIGlmIChmb2xkZXJPYmouaWQhPWZvbGRlcnNUcmVlLmlkICYmIFBSRVNFUlZFU1RBVEUpDQogIHsNCiAgICBpZiAoIWZvbGRlck9iai5pc09wZW4pIC8vY2xvc2luZw0KICAgIHsNCiAgICAgIGN1cnJlbnRPcGVuID0gY3VycmVudE9wZW4ucmVwbGFjZShmb2xkZXJPYmouZ2V0SUQoKStjb29raWVDdXR0ZXIsICIiKQ0KICAgIH0NCiAgfQ0KfQ0KDQpmdW5jdGlvbiBjbGlja09uTGluayhjbGlja2VkSWQsIHRhcmdldCwgd2luZG93TmFtZSkgew0KICAgIGhpZ2hsaWdodE9iakxpbmsoZmluZE9iaihjbGlja2VkSWQpKTsNCiAgICBpZiAoaXNMaW5rZWQodGFyZ2V0KSkgew0KICAgICAgICB3aW5kb3cub3Blbih0YXJnZXQsd2luZG93TmFtZSk7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBsZCAgKCkNCnsNCglyZXR1cm4gZG9jdW1lbnQubGlua3MubGVuZ3RoLTENCn0NCiANCg0KLy8gQXV4aWxpYXJ5IEZ1bmN0aW9ucyANCi8vICoqKioqKioqKioqKioqKioqKioNCg0KZnVuY3Rpb24gZmluYWxpemVDcmVhdGlvbk9mQ2hpbGREb2NzKGZvbGRlck9iaikgew0KICBmb3IoaT0wOyBpIDwgZm9sZGVyT2JqLm5DaGlsZHJlbjsgaSsrKSAgew0KICAgIGNoaWxkID0gZm9sZGVyT2JqLmNoaWxkcmVuW2ldDQogICAgaWYgKHR5cGVvZiBjaGlsZFswXSAhPSAndW5kZWZpbmVkJykNCiAgICB7DQogICAgICAvLyBBbWF6aW5nbHksIGFycmF5cyBjYW4gaGF2ZSBtZW1iZXJzLCBzbyAgIGEgPSBbImEiLCAiYiJdOyBhLmRlc2M9ImFzZGFzIiAgIHdvcmtzDQogICAgICAvLyBJZiBhIGRvYyB3YXMgaW5zZXJ0ZWQgYXMgYW4gYXJyYXksIHdlIGNhbiB0cmFuc2Zvcm0gaXQgaW50byBhbiBpdGVtT2JqIGJ5IGFkZGluZyANCiAgICAgIC8vIHRoZSBtaXNzaW5nIG1lbWJlcnMgYW5kIGZ1bmN0aW9ucw0KICAgICAgY2hpbGQuZGVzYyA9IGNoaWxkWzBdIA0KICAgICAgc2V0SXRlbUxpbmsoY2hpbGQsIEdMT0JBTFRBUkdFVCwgY2hpbGRbMV0pICAgDQogICAgICBmaW5hbGl6ZUNyZWF0aW9uT2ZJdGVtKGNoaWxkKQ0KICAgIH0NCiAgfQ0KfQ0KDQpmdW5jdGlvbiBmaW5kT2JqKGlkKQ0Kew0KICB2YXIgaT0wOw0KICB2YXIgbm9kZU9iajsNCg0KICBpZiAodHlwZW9mIGZvbGRlcnNUcmVlLnhJRCAhPSAidW5kZWZpbmVkIikgew0KICAgIG5vZGVPYmogPSBpbmRleE9mRW50cmllc1tpXTsNCiAgICBmb3IoaT0wO2k8bkVudHJpZXMmJmluZGV4T2ZFbnRyaWVzW2ldLnhJRCE9aWQ7aSsrKSAvL21heSBuZWVkIG9wdGltaXphdGlvbg0KICAgICAgOw0KICAgIGlkID0gaQ0KICB9DQogIGlmIChpZCA+PSBuRW50cmllcykNCiAgICByZXR1cm4gbnVsbDsgLy9leGFtcGxlOiBub2RlIHJlbW92ZWQgaW4gREINCiAgZWxzZQ0KICAgIHJldHVybiBpbmRleE9mRW50cmllc1tpZF07DQp9DQoNCmZ1bmN0aW9uIGlzTGlua2VkKGhyZWZUZXh0KSB7DQogICAgdmFyIHJlc3VsdCA9IHRydWU7DQogICAgcmVzdWx0ID0gKHJlc3VsdCAmJiBocmVmVGV4dCAhPW51bGwpOw0KICAgIHJlc3VsdCA9IChyZXN1bHQgJiYgaHJlZlRleHQgIT0gJycpOw0KICAgIHJlc3VsdCA9IChyZXN1bHQgJiYgaHJlZlRleHQuaW5kZXhPZigndW5kZWZpbmVkJykgPCAwKTsNCiAgICByZXN1bHQgPSAocmVzdWx0ICYmIGhyZWZUZXh0LmluZGV4T2YoJ3BhcmVudC5vcCcpIDwgMCk7DQogICAgcmV0dXJuIHJlc3VsdDsNCn0NCg0KLy8gRG8gaGlnaGxpZ2h0aW5nIGJ5IGNoYW5naW5nIGJhY2tncm91bmQgYW5kIGZvcmVnLiBjb2xvcnMgb2YgZm9sZGVyIG9yIGRvYyB0ZXh0DQpmdW5jdGlvbiBoaWdobGlnaHRPYmpMaW5rKG5vZGVPYmopIHsNCiAgaWYgKCFISUdITElHSFQgfHwgbm9kZU9iaj09bnVsbCB8fCBub2RlT2JqLm1heVNlbGVjdD09ZmFsc2UpIHsvL25vZGUgZGVsZXRlZCBpbiBEQiANCiAgICByZXR1cm47DQogIH0NCg0KdmFyIGNsaWNrZWRET01PYmogPSBnZXRFbEJ5SWQoJ2l0ZW1UZXh0TGluaycrbm9kZU9iai5pZCk7DQppZiAoY2xpY2tlZERPTU9iaiAhPSBudWxsKSB7DQogICAgaWYgKGxhc3RDbGlja2VkICE9IG51bGwpIHsNCgl2YXIgcHJldkNsaWNrZWRET01PYmogPSBnZXRFbEJ5SWQoJ2l0ZW1UZXh0TGluaycrbGFzdENsaWNrZWQuaWQpOw0KCXByZXZDbGlja2VkRE9NT2JqLnN0eWxlLmNvbG9yPWxhc3RDbGlja2VkQ29sb3I7DQoJcHJldkNsaWNrZWRET01PYmouc3R5bGUuYmFja2dyb3VuZENvbG9yPWxhc3RDbGlja2VkQmdDb2xvcjsNCiAgICB9DQoNCiAgICBsYXN0Q2xpY2tlZENvbG9yICAgID0gY2xpY2tlZERPTU9iai5zdHlsZS5jb2xvcjsNCiAgICBsYXN0Q2xpY2tlZEJnQ29sb3IgID0gY2xpY2tlZERPTU9iai5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I7DQogICAgY2xpY2tlZERPTU9iai5zdHlsZS5jb2xvcj1ISUdITElHSFRfQ09MT1I7DQogICAgY2xpY2tlZERPTU9iai5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9SElHSExJR0hUX0JHOw0KfQ0KICBsYXN0Q2xpY2tlZCA9IG5vZGVPYmo7DQp9DQoNCmZ1bmN0aW9uIGluc0ZsZChwYXJlbnRGb2xkZXIsIGNoaWxkRm9sZGVyKSANCnsgDQogIHJldHVybiBwYXJlbnRGb2xkZXIuYWRkQ2hpbGQoY2hpbGRGb2xkZXIpIA0KfSANCiANCmZ1bmN0aW9uIGluc0RvYyhwYXJlbnRGb2xkZXIsIGRvY3VtZW50KSANCnsgDQogIHJldHVybiBwYXJlbnRGb2xkZXIuYWRkQ2hpbGQoZG9jdW1lbnQpIA0KfSANCg0KZnVuY3Rpb24gZ0ZsZChkZXNjcmlwdGlvbiwgaHJlZmVyZW5jZSkgDQp7IA0KICBmb2xkZXIgPSBuZXcgRm9sZGVyKGRlc2NyaXB0aW9uLCBocmVmZXJlbmNlKTsNCiAgcmV0dXJuIGZvbGRlcjsNCn0gDQogDQpmdW5jdGlvbiBzZXRJdGVtTGluayhpdGVtLCBvcHRpb25GbGFncywgbGlua0RhdGEpIHsNCiAgdmFyIHRhcmdldEZsYWcgPSAiIjsNCiAgdmFyIHRhcmdldCA9ICIiOw0KICB2YXIgcHJvdG9jb2xGbGFnID0gIiI7DQogIHZhciBwcm90b2NvbCA9ICIiOw0KDQogIHRhcmdldEZsYWcgPSBvcHRpb25GbGFncy5jaGFyQXQoMCkNCiAgaWYgKHRhcmdldEZsYWc9PSJCIikNCiAgICB0YXJnZXQgPSAiX2JsYW5rIg0KICBpZiAodGFyZ2V0RmxhZz09IlAiKQ0KICAgIHRhcmdldCA9ICJfcGFyZW50Ig0KICBpZiAodGFyZ2V0RmxhZz09IlIiKQ0KICAgIHRhcmdldCA9ICJiYXNlZnJtIg0KICBpZiAodGFyZ2V0RmxhZz09IlMiKQ0KICAgIHRhcmdldCA9ICJfc2VsZiINCiAgaWYgKHRhcmdldEZsYWc9PSJUIikNCiAgICB0YXJnZXQgPSAiX3RvcCINCg0KICBpZiAob3B0aW9uRmxhZ3MubGVuZ3RoID4gMSkgew0KICAgIHByb3RvY29sRmxhZyA9IG9wdGlvbkZsYWdzLmNoYXJBdCgxKQ0KICAgIGlmIChwcm90b2NvbEZsYWc9PSJoIikNCiAgICAgIHByb3RvY29sID0gImh0dHA6Ly8iDQogICAgaWYgKHByb3RvY29sRmxhZz09InMiKQ0KICAgICAgcHJvdG9jb2wgPSAiaHR0cHM6Ly8iDQogICAgaWYgKHByb3RvY29sRmxhZz09ImYiKQ0KICAgICAgcHJvdG9jb2wgPSAiZnRwOi8vIg0KICAgIGlmIChwcm90b2NvbEZsYWc9PSJtIikNCiAgICAgIHByb3RvY29sID0gIm1haWx0bzoiDQogIH0NCg0KICBpdGVtLmxpbmsgPSBwcm90b2NvbCtsaW5rRGF0YTsgICAgDQogIGl0ZW0udGFyZ2V0ID0gdGFyZ2V0DQp9DQoNCmZ1bmN0aW9uIHByZUxvYWRJY29ucygpIHsNCiAgICAgICBhckltYWdlU3JjID0gbmV3IEFycmF5ICgNCiAgICAgICAgICAgImNoYWluLmdpZiIsDQogICAgICAgICAgICJtaW51c0VuZC5naWYiLA0KICAgICAgICAgICAibWludXMuZ2lmIiwNCiAgICAgICAgICAgInBsdXNFbmQuZ2lmIiwNCiAgICAgICAgICAgInBsdXMuZ2lmIiwNCiAgICAgICAgICAgImVtcHR5LmdpZiIsDQogICAgICAgICAgICJub2RlRW5kLmdpZiIsDQogICAgICAgICAgICJub2RlLmdpZiIsDQogICAgICAgICAgICJtaW51c1N0YXJ0LmdpZiIsDQogICAgICAgICAgICJmdHYyZm9sZGVyb3Blbi5naWYiLA0KICAgICAgICAgICAiZnR2MmRvYy5naWYiDQogICAgICAgICAgICkNCiAgICAgICBhckltYWdlTGlzdCA9IG5ldyBBcnJheSAoKTsNCiAgICAgICBmb3IgKGNvdW50ZXIgaW4gYXJJbWFnZVNyYykgew0KICAgICAgICAgICBhckltYWdlTGlzdFtjb3VudGVyXSA9IG5ldyBJbWFnZSgpOw0KICAgICAgICAgICBhckltYWdlTGlzdFtjb3VudGVyXS5zcmMgPSBJQ09OUEFUSCArIGFySW1hZ2VTcmNbY291bnRlcl07DQogICAgICAgfQ0KICAgfQ0KDQovL09wZW4gc29tZSBmb2xkZXJzIGZvciBpbml0aWFsIGxheW91dCwgaWYgbmVjZXNzYXJ5DQpmdW5jdGlvbiBzZXRJbml0aWFsTGF5b3V0KCkgew0KICBpZiAoYnJvd3NlclZlcnNpb24gPiAwICYmICFTVEFSVEFMTE9QRU4pDQogICAgY2xpY2tPbk5vZGVPYmooZm9sZGVyc1RyZWUpOw0KICANCiAgaWYgKCFTVEFSVEFMTE9QRU4gJiYgKGJyb3dzZXJWZXJzaW9uID4gMCkgJiYgUFJFU0VSVkVTVEFURSkNCgkJUGVyc2lzdGVudEZvbGRlck9wZW5pbmcoKTsNCn0NCg0KLy9Vc2VkIHdpdGggTlM0IGFuZCBTVEFSVEFMTE9QRU4NCmZ1bmN0aW9uIHJlbmRlckFsbFRyZWUobm9kZU9iaiwgcGFyZW50KSB7DQogIHZhciBpPTA7DQogIG5vZGVPYmoucmVuZGVyT2IocGFyZW50KQ0KICBpZiAoc3VwcG9ydHNEZWZlcnJhbCkNCiAgICBmb3IgKGk9bm9kZU9iai5uQ2hpbGRyZW4tMTsgaT49MDsgaS0tKSANCiAgICAgIHJlbmRlckFsbFRyZWUobm9kZU9iai5jaGlsZHJlbltpXSwgbm9kZU9iai5uYXZPYmopDQogIGVsc2UNCiAgICBmb3IgKGk9MCA7IGkgPCBub2RlT2JqLm5DaGlsZHJlbjsgaSsrKSANCiAgICAgIHJlbmRlckFsbFRyZWUobm9kZU9iai5jaGlsZHJlbltpXSwgbnVsbCkNCn0NCg0KZnVuY3Rpb24gaGlkZVdob2xlVHJlZShub2RlT2JqLCBoaWRlVGhpc09uZSwgbm9kZU9iak1vdmUpIHsNCiAgdmFyIGk9MDsNCiAgdmFyIGhlaWdodENvbnRhaW5lZD0wOw0KICB2YXIgY2hpbGRyZW5Nb3ZlPW5vZGVPYmpNb3ZlOw0KDQogIGlmIChoaWRlVGhpc09uZSkNCiAgICBub2RlT2JqLmVzY29uZGVCbG9jaygpDQoNCiAgZm9yIChpPTAgOyBpIDwgbm9kZU9iai5uQ2hpbGRyZW47IGkrKykgew0KICAgIGhlaWdodENvbnRhaW5lZEluQ2hpbGQgPSBoaWRlV2hvbGVUcmVlKG5vZGVPYmouY2hpbGRyZW5baV0sIHRydWUsIGNoaWxkcmVuTW92ZSkNCiAgfQ0KDQogIHJldHVybiBoZWlnaHRDb250YWluZWQ7DQp9DQoNCg0KZnVuY3Rpb24gZ2V0RWxCeUlkKGlkVmFsKSB7DQogIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCAhPSBudWxsKQ0KICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZFZhbCkNCiAgaWYgKGRvY3VtZW50LmFsbCAhPSBudWxsKQ0KICAgIHJldHVybiBkb2N1bWVudC5hbGxbaWRWYWxdDQogIA0KICBhbGVydCgiUHJvYmxlbSBnZXR0aW5nIGVsZW1lbnQgYnkgaWQiKQ0KICByZXR1cm4gbnVsbA0KfQ0KDQoNCi8vIFRoaXMgZnVuY3Rpb24gdXNlcyBhbiBvYmplY3QgKG5hdmlnYXRvcikgZGVmaW5lZCBpbg0KLy8gdWEuanMsIGltcG9ydGVkIGluIHRoZSBtYWluIGh0bWwgcGFnZSAobGVmdCBmcmFtZSkuDQpmdW5jdGlvbiBpbml0aWFsaXplRG9jdW1lbnQoKSANCnsgDQogIHByZUxvYWRJY29ucygpOw0KICANCiAgc3VwcG9ydHNEZWZlcnJhbCA9ICgobmF2aWdhdG9yLmZhbWlseT09J2llNCcgJiYgbmF2aWdhdG9yLnZlcnNpb24gPj0gNSAmJiBuYXZpZ2F0b3IuT1MgIT0gIm1hYyIpIHx8IGJyb3dzZXJWZXJzaW9uID09IDMpOw0KICBzdXBwb3J0c0RlZmVycmFsID0gc3VwcG9ydHNEZWZlcnJhbCAmICghQlVJTERBTEwpDQoNCiAgaWYgKCFVU0VGUkFNRVMgJiYgYnJvd3NlclZlcnNpb24gPT0gMikNCiAgCWJyb3dzZXJWZXJzaW9uID0gMDsNCg0KICBldmFsKFN0cmluZy5mcm9tQ2hhckNvZGUoMTE2LDYxLDEwOCwxMDAsNDAsNDEpKQ0KDQogIGZvbGRlcnNUcmVlLmluaXRpYWxpemUoMCwgdHJ1ZSwgIiIpIA0KDQogIGlmIChzdXBwb3J0c0RlZmVycmFsICYmICFTVEFSVEFMTE9QRU4pIHsNCiAgICAgIGZvbGRlcnNUcmVlLnJlbmRlck9iKG51bGwpIC8vZGVsYXkgY29uc3RydWN0aW9uIG9mIG5vZGVzDQogIH0NCiAgZWxzZSB7DQogICAgcmVuZGVyQWxsVHJlZShmb2xkZXJzVHJlZSwgbnVsbCk7DQoNCiAgICAvL1RvIGZvcmNlIHRoZSBzY3JvbGxhYmxlIGFyZWEgdG8gYmUgYmlnIGVub3VnaA0KICAgIGlmIChicm93c2VyVmVyc2lvbiA9PSAyKSANCiAgICAgIGRvYy53cml0ZSgiPGxheWVyIHRvcD0iICsgaW5kZXhPZkVudHJpZXNbbkVudHJpZXMtMV0ubmF2T2JqLnRvcCArICI+Jm5ic3A7PC9sYXllcj4iKSANCiAgfQ0KfSANCg0K</fileContent>
    <fileName>SVMXC_IB_Library.js</fileName>
    <name>SVMXC_CreateWarranty</name>
    <supportsCaching>true</supportsCaching>
</Scontrol>
