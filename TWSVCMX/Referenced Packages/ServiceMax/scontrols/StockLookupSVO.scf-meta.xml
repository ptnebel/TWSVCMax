<?xml version="1.0" encoding="UTF-8"?>
<Scontrol xmlns="http://soap.sforce.com/2006/04/metadata">
    <contentSource>HTML</contentSource>
    <encodingKey>UTF-8</encodingKey>
    <fileContent>Lyo9PT09PT09PSAgIEdsb2JhbCB2YXJpYWJsZXMgdXNlZCBieSBTdG9jayBMb29rdXAgUm91dGluZXMgICA9PT09PT09PT09PSovDQp2YXIgU0xLUF9Qcm9kdWN0SWQ7DQp2YXIgU0xLUF9SZXFRdHk7DQp2YXIgU0xLUF9SZWNvcmRUeXBlOw0KdmFyIFNMS1BfUmVjb3JkSWQ7DQp2YXIgU0xLUF9Vc2VySWQ7DQp2YXIgU0xLUF9nZW9jb2RlcjsNCnZhciBTTEtQX21hcDsNCnZhciBTTEtQX2RpcmVjdGlvbnNQYW5lbDsNCnZhciBTTEtQX2RpcmVjdGlvbnM7DQp2YXIgU0xLUF9Zb3VBcmVIZXJlOw0KdmFyIFNMS1BfcmFkaXVzID0gMDsNCnZhciBTTEtQX1N0YXJ0aW5nUG9pbnQ7DQp2YXIgU0xLUF9TaG93UmVzdWx0czsNCnZhciBTTEtQX1Nob3dNYXA7DQp2YXIgU0xLUF9TaG93T3B0aW9uczsNCnZhciBHTUxLUF9MYXQxOyANCnZhciBHTUxLUF9Mb24xOyANCnZhciBHTUxLUF9nZW9jb2RlcjsgDQp2YXIgU0xLUF9yb3dudW07DQp2YXIgcmVjRm91bmQ9IiI7IA0KLyo9PT09PT09PSAgIEdsb2JhbCB2YXJpYWJsZXMgdXNlZCBieSBDYW5jZWwgUGFydHMgUmVxdWVzdCA9PT09PT09PT09PSovDQp2YXIgQ05QUl9SZXF1ZXN0SWQ7DQp2YXIgQ05QUl9Vc2VySWQ7DQoNCi8qPT09PT09PT0gICBHbG9iYWwgdmFyaWFibGVzIHVzZWQgYnkgQ2FuY2VsIFNoaXBtZW50IE9yZGVyID09PT09PT09PT09Ki8NCnZhciBDTlNIUF9TaGlwbWVudE9yZGVySWQ7DQp2YXIgQ05TSFBfVXNlcklkOw0KDQovKj09PT09PT09ICAgR2xvYmFsIHZhcmlhYmxlcyB1c2VkIGJ5IENyZWF0ZSBTaGlwbWVudCBPcmRlciBmcm9tIFBhcnRzIFJlcXVlc3QgPT09PT09PT09PT0qLw0KdmFyIFNIUFJfUmVxdWVzdElkOw0KdmFyIFNIUFJfVXNlcklkOw0KdmFyIFNIUFJfU2hpcG1lbnRPcmRlcklkOw0KdmFyIFNIUFJfUmVxdWVzdGVkRnJvbUlkOw0KdmFyIFNIUFJfUmVxdWlyZWRBdElkOw0KdmFyIFNIUFJfQ29tcGFueUlkOw0KdmFyIFNIUFJfT3duZXJJZDsNCnZhciBTSFBSX0FkZGxJbmZvOw0KDQovKj09PT09PT09ICAgR2xvYmFsIHZhcmlhYmxlcyB1c2VkIGJ5IENyZWF0ZSBTaGlwbWVudCBPcmRlciBmcm9tIFNWTyA9PT09PT09PT09PSovDQp2YXIgU0hTVk9fU1ZPSWQ7DQp2YXIgU0hTVk9fVXNlcklkOw0KdmFyIFNIU1ZPX0NvbXBhbnlJZDsNCnZhciBTSFNWT19DYXNlSWQ7DQp2YXIgU0hTVk9fQ29udGFjdElkOw0KdmFyIFNIU1ZPX1JlcXVpcmVkQXRJZDsNCnZhciBTSFNWT19Pd25lcklkOw0KDQovKj09PT09PT09ICAgR2xvYmFsIHZhcmlhYmxlcyB1c2VkIGJ5IENhbmNlbCBTVk8gUGFydHMgUmVxdWVzdCA9PT09PT09PT09PSovDQp2YXIgQ05TVk9QUl9TVk9JZDsNCnZhciBDTlNWT1BSX1VzZXJJZDsNCnZhciBDTlNWT1BSX1NWT0xpbmVJZDsNCg0KLyo9PT09PT09PSAgIEdsb2JhbCB2YXJpYWJsZXMgdXNlZCBieSBQcm9jZXNzIFBhcnRzIFJlcXVlc3QgUmVjZWlwdHMgPT09PT09PT09PT0qLw0KdmFyIFBQUlJfUmVxdWVzdElkOw0KdmFyIFBQUlJfVXNlcklkOw0KdmFyIFBQUlJfU2l0ZUlkOw0KdmFyIFBQUlJfUmVjZWlwdHM7DQp2YXIgUFBSUl9QUk51bWJlcjsNCnZhciBQUFJSX1Nlc3Npb25JZDsNCnZhciBQUFJSX1N1cHBsaWVySWQ7DQp2YXIgUFBSUl9Tb3VyY2VMb2NJZDsJCS8vIEhTIDA0LzI4LzIwMDgNCnZhciBQUFJSX1NvdXJjZUxvY1N0b2NrYWJsZTsNCg0KLyo9PT09PT09PSAgIEdsb2JhbCB2YXJpYWJsZXMgdXNlZCBieSBQcm9jZXNzIFNWTyBSZWNlaXB0cyA9PT09PT09PT09PSovDQp2YXIgUFJTVk9fU1ZPSWQ7DQp2YXIgUFJTVk9fVXNlcklkOw0KdmFyIFBSU1ZPX1NWT0xpbmVJZDsNCnZhciBQUlNWT19SZXFSZWNvcmRUeXBlSWQ7DQp2YXIgUFJTVk9fUmVjZWlwdHM7DQp2YXIgUFJTVk9fU1ZPTnVtYmVyOw0KdmFyIFBSU1ZPX1Nlc3Npb25JZDsNCg0KLyo9PT09PT09PSAgIEdsb2JhbCB2YXJpYWJsZXMgdXNlZCBieSBQcm9jZXNzIFNoaXBtZW50cyA9PT09PT09PT09PSovDQp2YXIgUFJTSFBfU2hpcG1lbnRPcmRlcklkOw0KdmFyIFBSU0hQX1VzZXJJZDsNCnZhciBQUlNIUF9TaGlwbWVudHM7DQp2YXIgUFJTSFBfU2hpcG1lbnROdW1iZXI7DQp2YXIgUFJTSFBfU2Vzc2lvbklkOw0KdmFyIFBSU0hQX1NvdXJjZUxvY0lkOw0KdmFyIFBSU0hQX0Rlc3RMb2NJZDsNCnZhciBQUlNIUF9EZXN0TG9jU3RvY2thYmxlOw0KDQovKj09PT09PT09ICAgR2xvYmFsIHZhcmlhYmxlcyB1c2VkIGJ5IFBvc3QgU3RvY2sgQWRqdXN0bWVudCB0byBJbnZlbnRvcnkgPT09PT09PT09PT0qLw0KdmFyIEFESklOVl9BZGp1c3RtZW50SWQ7DQp2YXIgQURKSU5WX0Fkak51bWJlcjsNCnZhciBBREpJTlZfVXNlcklkOw0KdmFyIEFESklOVl9TZXNzaW9uSWQ7DQp2YXIgQURKSU5WX1Byb2RJZDsNCnZhciBBREpJTlZfQWRqUXR5Ow0KdmFyIEFESklOVl9TaXRlSWQ7DQoNCi8qPT09PT09PT0gICBHbG9iYWwgdmFyaWFibGVzIHVzZWQgYnkgUG9zdCBTVk8gVXNhZ2UgdG8gSW52ZW50b3J5ID09PT09PT09PT09Ki8NCnZhciBTVk9VU0dJTlZfU1ZPSWQ7DQp2YXIgU1ZPVVNHSU5WX1VzZXJJZDsNCnZhciBTVk9VU0dJTlZfU1ZPTGluZUlkOw0KdmFyIFNWT1VTR0lOVl9TZXNzaW9uSWQ7DQp2YXIgU1ZPVVNHSU5WX1NWT051bWJlcjsNCnZhciBTVk9VU0dJTlZfVXNhZ2VSZWNvcmRzOw0KDQovKj09PT09PT09ICAgR2xvYmFsIHZhcmlhYmxlcyB1c2VkIGJ5IFBvc3QgU3RvY2sgVHJhbnNmZXIgdG8gSW52ZW50b3J5ID09PT09PT09PT09Ki8NCnZhciBYRlJJTlZfWGZlcklkOw0KdmFyIFhGUklOVl9Vc2VySWQ7DQp2YXIgWEZSSU5WX1Nlc3Npb25JZDsNCnZhciBYRlJJTlZfWGZlck51bWJlcjsNCnZhciBYRlJJTlZfU291cmNlTG9jSWQ7DQp2YXIgWEZSSU5WX0Rlc3RMb2NJZDsNCnZhciBYRlJJTlZfWGZlclJlY29yZHM7DQoNCi8qPT09PT09PT0gICBHbG9iYWwgdmFyaWFibGVzIHVzZWQgYnkgUHJvY2VzcyBSTUEgUmVjZWlwdHMgPT09PT09PT09PT0qLw0KdmFyIFBSUk1BX1JNQUlkOw0KdmFyIFBSUk1BX1VzZXJJZDsNCnZhciBQUlJNQV9STUFMaW5lSWQ7DQp2YXIgUFJSTUFfUk1BTnVtYmVyOw0KdmFyIFBSUk1BX1Nlc3Npb25JZDsNCnZhciBQUlJNQV9SZWNlaXB0czsNCnZhciBQUlJNQV9SZWNvcmRUeXBlSWQ7DQp2YXIgUFJSTUFfU291cmNlTG9jSWQ7DQp2YXIgUFJSTUFfRGVzdExvY0lkOw0KdmFyIFBSUk1BX0Rlc3RDb3N0ZWRBdFZhbHVlOw0KdmFyIFBSUk1BX1NvdXJjZVN0b2NrYWJsZTsNCnZhciBQUlJNQV9EZXN0U3RvY2thYmxlOw0KDQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KDQpmdW5jdGlvbiBTVk1YQ19TZXR1cFN0b2NrTG9va3VwUGFnZShyZXFJZCwgcmVxVHlwZSwgdUlkKQ0Kew0KCVNWTVhJX0luaXRNZXNzYWdlTGlzdCgiU0xLUFNDMSIpOyANCglTVk1YSV9TZXRMYWJlbHMoIlN0b2NrTG9va3VwUFIiKTsgDQoNCiAgICB2YXIgUHJvZE5hbWU7DQoNCiAgICBTTEtQX1VzZXJJZCA9IHVJZDsNCiAgICBTTEtQX1JlY29yZFR5cGUgPSByZXFUeXBlOw0KDQogICAgaWYgKFNMS1BfUmVjb3JkVHlwZSA9PSAnU1ZPJykNCiAgICAJew0KCXZhciBzb3FsMSA9ICJTRUxFQ1QgSWQsIFNWTVhDX19Qcm9kdWN0X19jLCBTVk1YQ19fUHJvZHVjdF9fci5OYW1lLCBTVk1YQ19fUmVxdWVzdGVkX1F1YW50aXR5Ml9fYywgIiArDQoJCSAgICAiU1ZNWENfX1JlcXVlc3RlZF9Mb2NhdGlvbl9fYyBGUk9NIFNWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2MgV0hFUkUgSWQgPSAnIiArIHJlcUlkICsgIiciOw0KCXZhciBxcjEgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMSk7DQoJaWYgKHFyMS5zaXplIDw9IDApDQoJICAgIHsNCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAyIikpOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm47DQoJICAgIH0NCglyZWMxID0gcXIxLmdldEFycmF5KCJyZWNvcmRzIik7DQoJU0xLUF9Qcm9kdWN0SWQgPSByZWMxWzBdLlNWTVhDX19Qcm9kdWN0X19jOw0KCVByb2ROYW1lID0gcmVjMVswXS5TVk1YQ19fUHJvZHVjdF9fYyA/IHJlYzFbMF0uU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSA6ICJVbmtub3duIjsNCglTTEtQX1JlcVF0eSA9IHJlYzFbMF0uU1ZNWENfX1JlcXVlc3RlZF9RdWFudGl0eTJfX2M7DQoJU0xLUF9SZWNvcmRJZCA9IHJlYzFbMF0uSWQ7DQoJU0xLUF9TaXRlSWQgPSByZWMxWzBdLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2M7DQoJaWYgKFNMS1BfU2l0ZUlkID09IG51bGwpDQoJICAgIHsNCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAzIikpOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm47DQoJICAgIH0NCgl9DQogICAgZWxzZSBpZiAocmVxVHlwZSA9PSAnUFInKQ0KICAgIAl7DQoJdmFyIHNvcWwyID0gIlNFTEVDVCBTVk1YQ19fUGFydHNfUmVxdWVzdF9fYywgU1ZNWENfX1Byb2R1Y3RfX2MsIFNWTVhDX19Qcm9kdWN0X19yLk5hbWUsIFNWTVhDX19RdWFudGl0eV9SZXF1aXJlZDJfX2MsICIgKw0KCQkgICAgIlNWTVhDX19QYXJ0c19SZXF1ZXN0X19yLlNWTVhDX19SZXF1aXJlZF9BdF9Mb2NhdGlvbl9fYyBGUk9NIFNWTVhDX19QYXJ0c19SZXF1ZXN0X0xpbmVfX2MgV0hFUkUgSWQgPSAnIiArIHJlcUlkICsgIiciOw0KCXZhciBxcjIgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMik7DQoJaWYgKHFyMi5zaXplIDw9IDApDQoJICAgIHsNCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAyIikpOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm47DQoJICAgIH0NCglyZWMyID0gcXIyLmdldEFycmF5KCJyZWNvcmRzIik7DQoJU0xLUF9Qcm9kdWN0SWQgPSByZWMyWzBdLlNWTVhDX19Qcm9kdWN0X19jOw0KCVByb2ROYW1lID0gcmVjMlswXS5TVk1YQ19fUHJvZHVjdF9fYyA/IHJlYzJbMF0uU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSA6ICJVbmtub3duIjsNCglTTEtQX1JlcVF0eSA9IHJlYzJbMF0uU1ZNWENfX1F1YW50aXR5X1JlcXVpcmVkMl9fYzsNCglTTEtQX1JlY29yZElkID0gcmVjMlswXS5TVk1YQ19fUGFydHNfUmVxdWVzdF9fYzsNCglTTEtQX1NpdGVJZCA9IHJlYzJbMF0uU1ZNWENfX1BhcnRzX1JlcXVlc3RfX3IuU1ZNWENfX1JlcXVpcmVkX0F0X0xvY2F0aW9uX19jOw0KCX0NCiAgICBlbHNlDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDQiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJQcm9kTmFtZSIpLmlubmVySFRNTCA9IFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNiIpICsgUHJvZE5hbWU7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIlJlcVF0eSIpLmlubmVySFRNTCA9ICAgU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA3IikrIHBhcnNlRmxvYXQoU0xLUF9SZXFRdHkpOy8vIlJlcXVpcmVkIFF1YW50aXR5OiAiDQoNCiAgICB2YXIgc29xbDMgPSAiU0VMRUNUIFNWTVhDX19TdHJlZXRfX2MsIFNWTVhDX19DaXR5X19jLCBTVk1YQ19fU3RhdGVfX2MsIFNWTVhDX19aaXBfX2MsIFNWTVhDX19Db3VudHJ5X19jICIgKw0KICAgIAkJIkZST00gU1ZNWENfX1NpdGVfX2MgV0hFUkUgSWQgPSAnIiArIFNMS1BfU2l0ZUlkICsgIiciOw0KICAgIHFyMyA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwzKTsNCiAgICBpZiAocXIzLnNpemUgPD0gMCkNCgl7DQoJU0xLUF9Zb3VBcmVIZXJlID0gU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA1Iik7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInVzZXJBZGRyZXNzIikuaW5uZXJIVE1MID0gIjxzdHJvbmc+IitTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDUiKSsiPC8+IiAgDQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIlJhZGl1cyIpLmRpc2FibGVkID0gdHJ1ZTsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiTEFCMDIwIikuZGlzYWJsZWQgPSB0cnVlOw0KCX0NCiAgICBlbHNlDQoJew0KCXJlYzMgPSBxcjMuZ2V0QXJyYXkoInJlY29yZHMiKTsNCg0KCWlmIChyZWMzWzBdLlNWTVhDX19TdHJlZXRfX2MpIHZhciBteVN0cmVldCA9IHJlYzNbMF0uU1ZNWENfX1N0cmVldF9fYzsNCgllbHNlIHZhciBteVN0cmVldCA9ICIiOw0KDQoJaWYgKHJlYzNbMF0uU1ZNWENfX0NpdHlfX2MpIHZhciBteUNpdHkgPSByZWMzWzBdLlNWTVhDX19DaXR5X19jOw0KCWVsc2UgdmFyIG15Q2l0eSA9ICIiOw0KDQoJaWYgKHJlYzNbMF0uU1ZNWENfX1N0YXRlX19jKSB2YXIgbXlTdGF0ZSA9IHJlYzNbMF0uU1ZNWENfX1N0YXRlX19jOw0KCWVsc2UgdmFyIG15U3RhdGUgPSAiIjsNCg0KCWlmIChyZWMzWzBdLlNWTVhDX19aaXBfX2MpIHZhciBteVppcCA9IHJlYzNbMF0uU1ZNWENfX1ppcF9fYzsNCgllbHNlIHZhciBteVppcCA9ICIiOw0KDQoJaWYgKHJlYzNbMF0uU1ZNWENfX0NvdW50cnlfX2MpIHZhciBteUNvdW50cnkgPSByZWMzWzBdLlNWTVhDX19Db3VudHJ5X19jOw0KCWVsc2UgdmFyIG15Q291bnRyeSA9ICIiOw0KDQoJU0xLUF9Zb3VBcmVIZXJlID0gbXlTdHJlZXQgKyAiICIgKyBteUNpdHkgKyAiICIgKyBteVN0YXRlICsgIiAiICsgbXlaaXAgKyAiICIgKyBteUNvdW50cnk7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInVzZXJBZGRyZXNzIikuaW5uZXJIVE1MID0gbXlTdHJlZXQgKyAiPGJyPiIgKyBteUNpdHkgKyAiICIgKyBteVN0YXRlICsgIiAiICsgbXlaaXAgKyAiPGJyPiIgKyBteUNvdW50cnk7DQoJfQ0KICAgIFNWTVhJX1Nob3dNYXAoKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Db21wdXRlRGlzdGFuY2UocG9pbnQpIA0Kew0KICAgIGlmICghU0xLUF9TdGFydGluZ1BvaW50KSB7IHJldHVybiAwOyB9DQogICAgdmFyIHVuaXRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkxBQjAyMCIpLnZhbHVlOyAgDQogICAgdmFyIHJhd0Rpc3RhbmNlID0gU0xLUF9TdGFydGluZ1BvaW50LmRpc3RhbmNlRnJvbShwb2ludCk7DQogICAgdmFyIGtpbG9tZXRlcnMgPSByYXdEaXN0YW5jZS8xMDAwOw0KICAgIHZhciBtaWxlcyA9IGtpbG9tZXRlcnMgKiAwLjYyMTM3MTE5MjsNCiAgICBpZiAodW5pdHMgPT0gIk1pbGVzIikgeyByZXR1cm4gTWF0aC5yb3VuZChtaWxlcyk7IH0NCiAgICBlbHNlIHsgcmV0dXJuIChNYXRoLnJvdW5kKGtpbG9tZXRlcnMpKTsgfQ0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8gDQovLyBUaGlzIGZ1bmN0aW9uIHVzZXMgdGhlIGhhdmVyc2luZSAoaGFsZi12ZXJzZWQtc2luZSkgbWV0aG9kIHRvIGNhbGN1bGF0ZSANCi8vIGRpc3RhbmNlIGJldHdlZW4gdHdvICdwb2ludHMnIA0KZnVuY3Rpb24gU1ZNWElfQ2FsY3VsYXRlRGlzdGFuY2UobGF0MSwgbG9uMSwgbGF0MiwgbG9uMiwgdW5pdHMpIA0KeyANCgl2YXIgUiA9IDYzNzE7IC8vIGttIA0KCS8vdmFyIHVuaXRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkxBQjAyMCIpLnZhbHVlOw0KCXZhciBkTGF0ID0gKGxhdDItbGF0MSkgKiBNYXRoLlBJIC8gMTgwOyANCgl2YXIgZExvbiA9IChsb24yLWxvbjEpICogTWF0aC5QSSAvIDE4MDsgDQoJdmFyIGEgPSBNYXRoLnNpbihkTGF0LzIpICogTWF0aC5zaW4oZExhdC8yKSArIA0KCU1hdGguY29zKGxhdDEgKiBNYXRoLlBJIC8gMTgwKSAqIE1hdGguY29zKGxhdDIgKiBNYXRoLlBJIC8gMTgwKSAqIA0KCU1hdGguc2luKGRMb24vMikgKiBNYXRoLnNpbihkTG9uLzIpOyANCgl2YXIgYyA9IDIgKiBNYXRoLmF0YW4yKE1hdGguc3FydChhKSwgTWF0aC5zcXJ0KDEtYSkpOyANCgl2YXIgZGttID0gUiAqIGM7DQoJdmFyIGRtaWxlcyA9IGRrbSAqIDAuNjIxMzcxMTkyOyANCglpZiAodW5pdHMgPT0gIk1pbGVzIikNCgl7DQoJCXJldHVybiBNYXRoLnJvdW5kKGRtaWxlcyk7DQoJfQ0KCWVsc2Uge3JldHVybiBNYXRoLnJvdW5kKGRrbSk7fQ0KfSANCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9TTEtQX1Nob3dEaXJlY3Rpb25zKEZyb21BZGRyZXNzLCBUb0FkZHJlc3MpDQp7DQogICAgU0xLUF9kaXJlY3Rpb25zUGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGl2Um91dGUiKTsgIA0KICAgIGlmICghU0xLUF9kaXJlY3Rpb25zKQ0KCVNMS1BfZGlyZWN0aW9ucyA9IG5ldyBHRGlyZWN0aW9ucyhTTEtQX21hcCwgU0xLUF9kaXJlY3Rpb25zUGFuZWwpOyAgDQogICAgZWxzZQ0KCVNMS1BfZGlyZWN0aW9ucy5jbGVhcigpOw0KICAgIFNMS1BfZGlyZWN0aW9ucy5sb2FkKEZyb21BZGRyZXNzICsgIiB0byAiICsgVG9BZGRyZXNzKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9TTEtQX1NldFJlcXVlc3RGcm9tTG9jYXRpb24oU2l0ZUlkLCBUYWcpDQp7DQogICAgdmFyIGFucyA9IGNvbmZpcm0oVGFnICsgU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE1IikpOw0KICAgIGlmICghYW5zKSB7IHJldHVybjsgfQ0KDQogICAgaWYgKFNMS1BfUmVjb3JkVHlwZSA9PSAnU1ZPJykNCiAgICAJew0KCQkJdmFyIGNPYmogPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2MiKTsNCgkJCWNPYmouSWQgPSBTTEtQX1JlY29yZElkOw0KCQkJLy9jT2JqLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2MgPSBTaXRlSWQ7DQoJCQljT2JqLlNWTVhDX19Gcm9tX0xvY2F0aW9uX19jPSBTaXRlSWQ7DQoJCQl0cnkgew0KCQkJICAgICAgICANCgkJCQkJdmFyIHJldCA9IHNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShbY09ial0pOyAgICAgICAgICAgICAgICAgICAgICAgIA0KCQkJCQlpZiAocmV0WzBdLnN1Y2Nlc3MhPSd0cnVlJykNCgkJCQkJew0KCQkJCQkgICAgYWxlcnQoJ2ZhaWxlZCBmb3Igd2QnKTsNCgkJCQkJCWFsZXJ0KHJldFswXS5lcnJvcnMubWVzc2FnZSk7DQoJCQkJCX0NCgkJCQkJZWxzZQ0KCQkJCQl7DQoJCQkJCQlhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTciKSk7DQoJCQkJCQl3aW5kb3cub3BlbmVyLmxvY2F0aW9uID0gIi8iICsgU0xLUF9SZWNvcmRJZDsNCgkJCQkJCUNsb3NlV2luZG93KCk7DQoJCQkJCX0NCgkJCSAgIH0NCiAgICAgICAgICAgICAgICBjYXRjaChlcnJvcikgew0KCQkJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxOCIpKyJcbiIgKyAiMTIzIiArIGVycm9yKTsNCgkJCX0NCgkJfQ0KICAgIGVsc2UgaWYgKFNMS1BfUmVjb3JkVHlwZSA9PSAnUFInKQ0KICAgIAl7DQoJdmFyIGNPYmogPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19QYXJ0c19SZXF1ZXN0X19jIik7DQoJY09iai5JZCA9IFNMS1BfUmVjb3JkSWQ7DQoJY09iai5TVk1YQ19fUmVxdWVzdGVkX0Zyb21fX2MgPSBTaXRlSWQ7DQoJdHJ5IHsNCgkgICAgdmFyIHJldCA9IHNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShbY09ial0pOw0KCQkNCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDIwIikpOwkNCgkgICAgd2luZG93Lm9wZW5lci5sb2NhdGlvbiA9ICIvIiArIFNMS1BfUmVjb3JkSWQ7DQoJICAgIENsb3NlV2luZG93KCk7DQoJICAgIH0NCgljYXRjaChlcnJvcikgew0KCQ0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTgiKSsiXG4iICsgIjQ1NiIrIGVycm9yKTsNCgkgICAgfQ0KCX0NCiAgICBlbHNlDQoJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxOSIpKyJcbiIpOw0KCX0NCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9TTEtQX0FkZExvY2F0aW9uVG9NYXAoU3RvY2tSZWMsIFNpdGVOYW1lLCBTdHJlZXQsIENpdHksIFN0YXRlLCBaaXAsIENvdW50cnksIFBob25lLCBRdHlBdmxibCwgU2l0ZUlkLGN1cnJjbnQsdG90Y250KQ0Kew0KICAgIHZhciBhZGRfcm93X3RvX2dyaWQgPSB0cnVlOw0KICAgIHZhciBhZGRyID0gU3RyZWV0ICsgIiwgIiArIENpdHkgKyAiLCAiICsgU3RhdGUgKyAiICIgKyBaaXAgKyAiLCAiICsgQ291bnRyeTsNCiAgICB2YXIgRGlzdGFuY2UgPSAiVW5rbm93biI7DQoJIA0KICAgIFNMS1BfZ2VvY29kZXIuZ2V0TGF0TG5nDQogICAgKGFkZHIsIA0KCWZ1bmN0aW9uKHBvaW50KQ0KCXsNCglpZiAocG9pbnQpDQoJICAgIHsNCgkJCURpc3RhbmNlID0gU1ZNWElfQ29tcHV0ZURpc3RhbmNlKHBvaW50KTsNCgkJCWlmIChEaXN0YW5jZSA8PSBTTEtQX3JhZGl1cyB8fCBTTEtQX3JhZGl1cyA9PSAwKQ0KCQkJew0KCQkJCXJlY0ZvdW5kID0iWUVTIjsNCgkJCQl2YXIgU3RvY2tUYWcgPSAiPGI+IiArIFNpdGVOYW1lICsgIjwvYj48YnI+IiArIA0KCQkJCQkJICBTdHJlZXQgKyAiPGJyPiIgKyBDaXR5ICsgIiwgIiArIFN0YXRlICsgIiAiICsgWmlwICsgIiwgIiArIENvdW50cnkgKyAiPGJyPiIgKyANCgkJCQkJCSAgU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEzIikgKyBQaG9uZSArICI8YnI+IiArIA0KCQkJCQkJICAiPGI+ICIrU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE0IikgKyBwYXJzZUZsb2F0KFN0b2NrUmVjLlNWTVhDX19RdWFudGl0eTJfX2MpICsgIjwvYj4iICsNCgkJCQkJCSAgIjxicj4iK1NWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMiIpOw0KDQoJCQkJdmFyIG15SWNvbiA9IG5ldyBHSWNvbihHX0RFRkFVTFRfSUNPTik7DQoJCQkJaWYgKHBhcnNlRmxvYXQoUXR5QXZsYmwpID49IHBhcnNlRmxvYXQoU0xLUF9SZXFRdHkpKSANCgkJCQkJew0KCQkJCQkJbXlJY29uLmltYWdlID0gImh0dHA6Ly9tYXBzLmdvb2dsZS5jb20vbWFwZmlsZXMva21sL3BhbDIvaWNvbjUucG5nIjsgDQoJCQkJCX0NCgkJCQllbHNlIA0KCQkJCQl7DQoJCQkJCQlteUljb24uaW1hZ2UgPSAiaHR0cDovL21hcHMuZ29vZ2xlLmNvbS9tYXBmaWxlcy9rbWwvcGFsNC9pY29uNTMucG5nIjsgDQoJCQkJCX0NCg0KCQkJCW15SWNvbi5pY29uU2l6ZT1uZXcgR1NpemUoMzIsMzIpOw0KCQkJCW15SWNvbi5zaGFkb3dTaXplPW5ldyBHU2l6ZSg1NiwzMik7DQoJCQkJbXlJY29uLmljb25BbmNob3I9bmV3IEdQb2ludCgxNiwzMik7DQoJCQkJbXlJY29uLmluZm9XaW5kb3dBbmNob3I9bmV3IEdQb2ludCgxNiwwKTsNCgkJCQltYXJrZXJPcHRpb25zMiA9IHsgaWNvbjpteUljb24gfTsNCgkJCQl2YXIgbWFya2VyID0gbmV3IEdNYXJrZXIocG9pbnQsIG1hcmtlck9wdGlvbnMyKTsNCgkJCQlTTEtQX21hcC5zZXRDZW50ZXIocG9pbnQsIDgpOw0KCQkJCVNMS1BfbWFwLmFkZE92ZXJsYXkobWFya2VyKTsNCgkJCQlHRXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAibW91c2VvdmVyIiwgZnVuY3Rpb24oKSB7IG1hcmtlci5vcGVuSW5mb1dpbmRvd0h0bWwoU3RvY2tUYWcpOyB9KSA7DQoJCQkJR0V2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgIm1vdXNlb3V0IiwgZnVuY3Rpb24oKSB7IG1hcmtlci5jbG9zZUluZm9XaW5kb3coKTsgfSkgOw0KCQkJCUdFdmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICJjbGljayIsIGZ1bmN0aW9uKCkgeyBTVk1YSV9TTEtQX1Nob3dEaXJlY3Rpb25zKFNMS1BfWW91QXJlSGVyZSwgYWRkcik7IH0pOw0KCQkJCUdFdmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICJkYmxjbGljayIsIGZ1bmN0aW9uKCkgeyBTVk1YSV9TTEtQX1NldFJlcXVlc3RGcm9tTG9jYXRpb24oU2l0ZUlkLCBTaXRlTmFtZSk7IH0pOw0KCQkJCVNWTVhJX1NMS1BfQWRkUmVzdWx0Um93KFN0b2NrUmVjLCBTaXRlTmFtZSwgU3RyZWV0LCBDaXR5LCBTdGF0ZSwgWmlwLCBDb3VudHJ5LCBQaG9uZSwgU2l0ZUlkLCBEaXN0YW5jZSk7DQoJCQl9DQoJCQllbHNlIGlmIChEaXN0YW5jZSA+IFNMS1BfcmFkaXVzKQ0KCQkJew0KCQkJCWlmKHBhcnNlSW50KGN1cnJjbnQpPT1wYXJzZUludCh0b3RjbnQpICYmIHJlY0ZvdW5kID09Ik5PIikNCgkJCQl7DQoJCQkJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAyMiIpKTsNCgkJCQkJdHJ5ew0KCQkJCQkJdmFyIHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpc3RfdGJvZHkiKTsNCgkJCQkJCWNsZWFyX3RhYmxlKHRib2R5KTsNCgkJCQkJfWNhdGNoKGUpe30NCgkJCQl9DQoJCQl9DQoJICAgfQ0KCWVsc2UNCgkJew0KCSAgICBTVk1YSV9TTEtQX0FkZFJlc3VsdFJvdyhTdG9ja1JlYywgU2l0ZU5hbWUsIFN0cmVldCwgQ2l0eSwgU3RhdGUsIFppcCwgQ291bnRyeSwgUGhvbmUsIFNpdGVJZCwgU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDIxIikpOyAgDQoJCX0NCiAgICAgfQ0KICAgICk7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfU2hvd01hcCgpIA0Kew0KICAgIGlmICh3aW5kb3cuc2NyZWVuKQ0KICAgIHsNCgl3aW5kb3cubW92ZVRvKDAsMCk7DQoJd2luZG93LnJlc2l6ZVRvKHNjcmVlbi53aWR0aCwgc2NyZWVuLmhlaWdodCk7DQogICAgfQ0KICAgIFNMS1BfbWFwID0gbmV3IEdNYXAyKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkaXZNYXAiKSk7DQogICAgU0xLUF9tYXAuYWRkQ29udHJvbChuZXcgR0xhcmdlTWFwQ29udHJvbCgpKTsNCiAgICBTTEtQX21hcC5hZGRDb250cm9sKG5ldyBHTWFwVHlwZUNvbnRyb2woKSk7DQogICAgU0xLUF9tYXAuZW5hYmxlU2Nyb2xsV2hlZWxab29tKCk7DQoNCiAgICBTTEtQX2dlb2NvZGVyID0gbmV3IEdDbGllbnRHZW9jb2RlcigpOw0KICAgIGlmICghU0xLUF9nZW9jb2RlcikNCgl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA4IikpOw0KCUNsb3NlV2luZG93KCk7DQoJfQ0KICAgU0xLUF9TdGFydGluZ1BvaW50ID0gbmV3IEdMYXRMbmcoKTsNCiAgIFNWTVhJX1NMS1BfQWRkU3RhcnRpbmdQb2ludCgpOw0KICAgU1ZNWElfU0xLUF9BZGRTdGFydGluZ1BvaW50V2l0aExhdExvbmcoKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9TTEtQX0FkZFN0YXJ0aW5nUG9pbnQoKQ0Kew0KDQogICAgaWYgKEdCcm93c2VySXNDb21wYXRpYmxlKCkpDQogICAgew0KCQlTTEtQX2dlb2NvZGVyLmdldExhdExuZw0KCQkoU0xLUF9Zb3VBcmVIZXJlLCANCgkJCWZ1bmN0aW9uKHBvaW50KQ0KCQkJew0KCQkJaWYgKHBvaW50KQ0KCQkJew0KCQkJU0xLUF9TdGFydGluZ1BvaW50ID0gcG9pbnQ7DQoJCQl2YXIgYmx1ZUljb24gPSBuZXcgR0ljb24oR19ERUZBVUxUX0lDT04pOw0KCQkJYmx1ZUljb24uaW1hZ2UgPSAiaHR0cDovL21hcHMuZ29vZ2xlLmNvbS9tYXBmaWxlcy9rbWwvcGFsMy9pY29uMzgucG5nIjsNCgkJCWJsdWVJY29uLmljb25TaXplPW5ldyBHU2l6ZSgzMiwzMik7DQoJCQlibHVlSWNvbi5zaGFkb3dTaXplPW5ldyBHU2l6ZSg1NiwzMik7DQoJCQlibHVlSWNvbi5pY29uQW5jaG9yPW5ldyBHUG9pbnQoMTYsMzIpOw0KCQkJYmx1ZUljb24uaW5mb1dpbmRvd0FuY2hvcj1uZXcgR1BvaW50KDE2LDApOw0KCQkJbWFya2VyT3B0aW9ucyA9IHsgaWNvbjpibHVlSWNvbiB9Ow0KCQkJdmFyIG1hcmtlciA9IG5ldyBHTWFya2VyKHBvaW50LCBtYXJrZXJPcHRpb25zKTsNCgkJCVNMS1BfbWFwLnNldENlbnRlcihwb2ludCwgOCk7DQoJCQlTTEtQX21hcC5hZGRPdmVybGF5KG1hcmtlcik7DQoJCQlTTEtQX21hcC5wYW5Ubyhwb2ludCk7DQoJCQlHRXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAibW91c2VvdmVyIiwgZnVuY3Rpb24oKSB7IG1hcmtlci5vcGVuSW5mb1dpbmRvd0h0bWwoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEwIikpOyB9KSA7DQoJCQlHRXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAibW91c2VvdXQiLCBmdW5jdGlvbigpIHsgbWFya2VyLmNsb3NlSW5mb1dpbmRvdygpOyB9KSA7DQoJCQl9DQoJCQllbHNlDQoJCQl7DQoJCQlhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDkiKSk7DQoJCQlTVk1YSV9TTEtQX1Nob3dVbml0ZWRTdGF0ZXMoKTsNCgkJCX0NCgkJCX0NCgkJKTsNCiAgICB9DQovLwlTVk1YSV9TTEtQX0FkZFN0YXJ0aW5nUG9pbnRXaXRoTGF0TG9uZygpOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1NMS1BfU2hvd1VuaXRlZFN0YXRlcygpDQp7DQogICAgU0xLUF9TdGFydGluZ1BvaW50ID0gbmV3IEdMYXRMbmcoKTsNCg0KICAgIGlmIChHQnJvd3NlcklzQ29tcGF0aWJsZSgpKQ0KICAgIHsNCiAgICBTTEtQX2dlb2NvZGVyLmdldExhdExuZw0KCSgiVW5pdGVkIFN0YXRlcyIsIA0KCSAgICBmdW5jdGlvbihwb2ludCkNCgkgICAgew0KCSAgICBpZiAocG9pbnQpDQoJCXsNCgkJU0xLUF9TdGFydGluZ1BvaW50ID0gcG9pbnQ7DQoJCXZhciBibHVlSWNvbiA9IG5ldyBHSWNvbihHX0RFRkFVTFRfSUNPTik7DQoJCWJsdWVJY29uLmltYWdlID0gImh0dHA6Ly9tYXBzLmdvb2dsZS5jb20vbWFwZmlsZXMva21sL3BhbDMvaWNvbjM4LnBuZyI7DQoJCWJsdWVJY29uLmljb25TaXplPW5ldyBHU2l6ZSgzMiwzMik7DQoJCWJsdWVJY29uLnNoYWRvd1NpemU9bmV3IEdTaXplKDU2LDMyKTsNCgkJYmx1ZUljb24uaWNvbkFuY2hvcj1uZXcgR1BvaW50KDE2LDMyKTsNCgkJYmx1ZUljb24uaW5mb1dpbmRvd0FuY2hvcj1uZXcgR1BvaW50KDE2LDApOw0KCQltYXJrZXJPcHRpb25zID0geyBpY29uOmJsdWVJY29uIH07DQoJCXZhciBtYXJrZXIgPSBuZXcgR01hcmtlcihwb2ludCwgbWFya2VyT3B0aW9ucyk7DQoJCVNMS1BfbWFwLnNldENlbnRlcihwb2ludCwgOCk7DQoJCVNMS1BfbWFwLmFkZE92ZXJsYXkobWFya2VyKTsNCgkJU0xLUF9tYXAucGFuVG8ocG9pbnQpOw0KCQlHRXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAibW91c2VvdmVyIiwgZnVuY3Rpb24oKSB7IG1hcmtlci5vcGVuSW5mb1dpbmRvd0h0bWwoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEwIikpOyB9KSA7DQoJCUdFdmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICJtb3VzZW91dCIsIGZ1bmN0aW9uKCkgeyBtYXJrZXIuY2xvc2VJbmZvV2luZG93KCk7IH0pIDsNCgkJfQ0KCSAgICB9DQoJKTsNCiAgICB9DQoNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovIA0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8gDQpmdW5jdGlvbiBTVk1YSV9TTEtQX0FkZFN0YXJ0aW5nUG9pbnRXaXRoTGF0TG9uZygpIA0KeyANCglHTUxLUF9TdGFydGluZ1BvaW50ID0gbmV3IEdMYXRMbmcoKTsgDQoJR01MS1BfZ2VvY29kZXIgPSBuZXcgR0NsaWVudEdlb2NvZGVyKCk7IA0KCWlmICghR01MS1BfZ2VvY29kZXIpIA0KCXsgDQoJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAyMyIpKTsNCgkJLy9hbGVydCgnVW5hYmxlIHRvIGxhdW5jaCBHZW9jb2RlciB0byBjYWxjdWxhdGUgY29vcmRpbmF0ZXMuUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluc2l0cmF0b3IuJyk7DQoJCS8vIFNWTVhEQ19DbG9zZVdpbmRvdygpOyANCgkJd2luZG93LmNsb3NlKCk7IA0KCX0gDQoJaWYgKEdCcm93c2VySXNDb21wYXRpYmxlKCkpIA0KCXsgDQoJCUdNTEtQX2dlb2NvZGVyLmdldExvY2F0aW9ucyANCgkJKFNMS1BfWW91QXJlSGVyZSwgDQoJCWZ1bmN0aW9uKHJlc3BvbnNlKSANCgkJeyANCgkJCWlmIChyZXNwb25zZSAmJiByZXNwb25zZS5TdGF0dXMuY29kZSA9PSAyMDApIA0KCQkJeyANCgkJCQl2YXIgcGxhY2UgPSByZXNwb25zZS5QbGFjZW1hcmtbMF07IA0KCQkJCXZhciBwb2ludCA9IG5ldyBHTGF0TG5nKHBsYWNlLlBvaW50LmNvb3JkaW5hdGVzWzFdLCBwbGFjZS5Qb2ludC5jb29yZGluYXRlc1swXSk7IA0KCQkJCUdNTEtQX0xhdDEgPSBwbGFjZS5Qb2ludC5jb29yZGluYXRlc1sxXTsgDQoJCQkJR01MS1BfTG9uMSA9IHBsYWNlLlBvaW50LmNvb3JkaW5hdGVzWzBdOyANCg0KLyoJCQkJR01MS1BfU3RhcnRpbmdQb2ludCA9IHBvaW50OyANCgkJCQl2YXIgYmx1ZUljb24gPSBuZXcgR0ljb24oR19ERUZBVUxUX0lDT04pOyANCgkJCQlibHVlSWNvbi5pbWFnZSA9ICJodHRwOi8vbWFwcy5nb29nbGUuY29tL21hcGZpbGVzL2ttbC9wYWwzL2ljb24zOC5wbmciOyANCgkJCQlibHVlSWNvbi5pY29uU2l6ZT1uZXcgR1NpemUoMzIsMzIpOyANCgkJCQlibHVlSWNvbi5zaGFkb3dTaXplPW5ldyBHU2l6ZSg1NiwzMik7IA0KCQkJCWJsdWVJY29uLmljb25BbmNob3I9bmV3IEdQb2ludCgxNiwzMik7IA0KCQkJCWJsdWVJY29uLmluZm9XaW5kb3dBbmNob3I9bmV3IEdQb2ludCgxNiwwKTsgDQoJCQkJbWFya2VyT3B0aW9ucyA9IHsgaWNvbjpibHVlSWNvbiB9OyANCgkJCQl2YXIgbWFya2VyID0gbmV3IEdNYXJrZXIocG9pbnQsIG1hcmtlck9wdGlvbnMpOyANCgkJCQlTTEtQX21hcC5zZXRDZW50ZXIocG9pbnQsIDgpOyANCgkJCQlTTEtQX21hcC5hZGRPdmVybGF5KG1hcmtlcik7IA0KCQkJCVNMS1BfbWFwLnBhblRvKHBvaW50KTsgDQoJCQkJR0V2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgIm1vdXNlb3ZlciIsIGZ1bmN0aW9uKCkgeyBtYXJrZXIub3BlbkluZm9XaW5kb3dIdG1sKFNMS1BfWW91QXJlSGVyZSk7IH0pIDsgDQoJCQkJR0V2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgIm1vdXNlb3V0IiwgZnVuY3Rpb24oKSB7IG1hcmtlci5jbG9zZUluZm9XaW5kb3coKTsgfSkgOyAqLw0KCQkJfSANCgkJCWVsc2UgDQoJCQl7IA0KLy8JCQkJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA5IikpOw0KLy8JCQkJU1ZNWElfU0xLUF9TaG93VW5pdGVkU3RhdGVzKCk7DQoJCQkJbnVsbDsNCgkJCX0gDQoJCX0gDQoJCSk7IA0KCX0gDQp9IA0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YQ19TTEtQX0ZpbmRTdG9jaygpDQp7DQogICAgdmFyIFNpdGVOYW1lOw0KICAgIHZhciBTdHJlZXQ7DQogICAgdmFyIENpdHk7DQogICAgdmFyIFN0YXRlOw0KICAgIHZhciBaaXA7DQogICAgdmFyIENvdW50cnk7DQogICAgdmFyIFBob25lOw0KCXJlY0ZvdW5kID0iTk8iOw0KICAgIFNMS1BfcmFkaXVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIlJhZGl1cyIpLnZhbHVlOw0KDQovKiAgICB2YXIgc29xbCA9ICJTRUxFQ1QgSWQsIFNWTVhDX19Mb2NhdGlvbl9fYywgU1ZNWENfX1F1YW50aXR5Ml9fYywgU1ZNWENfX0xvY2F0aW9uX19yLk5hbWUsIFNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fU3RyZWV0X19jLCAiICsNCiAgICAJICAgICAgICJTVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX0NpdHlfX2MsIFNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fU3RhdGVfX2MsIFNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fWmlwX19jLCAiICsNCgkgICAgICAgIlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fQ291bnRyeV9fYywgU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19TaXRlX1Bob25lX19jLCAiICsNCgkgICAgICAgIlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fU2VydmljZV9FbmdpbmVlcl9fYyBGUk9NIFNWTVhDX19Qcm9kdWN0X1N0b2NrX19jICIgKw0KICAgIAkgICAgICAgIldIRVJFIFNWTVhDX19Qcm9kdWN0X19jID0gJyIgKyBTTEtQX1Byb2R1Y3RJZCArICInIEFORCBTVk1YQ19fU3RhdHVzX19jID0gJ0F2YWlsYWJsZScgQU5EIFNWTVhDX19RdWFudGl0eTJfX2MgPiAwIjsqLw0KCSB2YXIgc29xbCA9ICJTRUxFQ1QgSWQsIFNWTVhDX19Mb2NhdGlvbl9fYywgU1ZNWENfX1F1YW50aXR5Ml9fYywgU1ZNWENfX0xvY2F0aW9uX19yLk5hbWUsIFNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fU3RyZWV0X19jLCAiICsNCiAgICAJICAgICAgICJTVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX0NpdHlfX2MsIFNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fU3RhdGVfX2MsICAgU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19aaXBfX2MsICIgKw0KCSAgICAgICAgICAgIlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fQ291bnRyeV9fYywgU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19TaXRlX1Bob25lX19jLCAiICsNCgkJICAgICAgICJTVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX0xhdGl0dWRlX19jLCBTVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX0xvbmdpdHVkZV9fYywgIiArDQoJICAgICAgICAgICAiU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19TZXJ2aWNlX0VuZ2luZWVyX19jIEZST00gU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX2MgIiArDQogICAgCSAgICAgICAiV0hFUkUgU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19MYXRpdHVkZV9fYyA8PiBudWxsIGFuZCBTVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX0xvbmdpdHVkZV9fYyA8PiBudWxsIGFuZCBTVk1YQ19fUHJvZHVjdF9fYyA9ICciICsgU0xLUF9Qcm9kdWN0SWQgKyAiJyBBTkQgU1ZNWENfX1N0YXR1c19fYyA9ICdBdmFpbGFibGUnIEFORCBTVk1YQ19fUXVhbnRpdHkyX19jID4gMCBPcmRlciBCeSBTVk1YQ19fTG9jYXRpb25fX3IuTmFtZSIgOw0KDQogICAgdmFyIHF1ZXJ5UmVzdWx0ID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbCk7IA0KICAgIGlmIChxdWVyeVJlc3VsdC5zaXplIDw9IDApDQoJCXsNCgkJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMSIpKTsJICAgCQkNCgkJfQ0KCVNMS1BfbWFwLmNsZWFyT3ZlcmxheXMoKTsNCiAgICBTVk1YSV9TTEtQX0FkZFN0YXJ0aW5nUG9pbnQoKTsNCiAJU1ZNWElfU0xLUF9BZGRTdGFydGluZ1BvaW50V2l0aExhdExvbmcoKTsNCg0KICAgIFNMS1Bfcm93bnVtID0gMDsNCiAgICB2YXIgaGVhZGVyID0gZmFsc2U7DQogICAgdmFyIHN0b2NrcmVjb3JkcyA9IHF1ZXJ5UmVzdWx0LmdldEFycmF5KCJyZWNvcmRzIik7DQogICAgdmFyIHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpc3RfdGJvZHkiKTsNCg0KICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RvY2tyZWNvcmRzLmxlbmd0aDsgaSsrKQ0KCXsNCgkJdmFyIHJlYyA9IHN0b2NrcmVjb3Jkc1tpXTsNCgkJaWYocmVjLlNWTVhDX19Mb2NhdGlvbl9fYyAhPSBudWxsKQ0KCQl7DQoJCQl2YXIgU3ZjRW5ncklkID0gcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fU2VydmljZV9FbmdpbmVlcl9fYzsNCgkJCWlmIChTdmNFbmdySWQgPT1udWxsIHx8IFN2Y0VuZ3JJZC5zdWJzdHIoMCwxNSkgIT0gU0xLUF9Vc2VySWQpCS8vIFNraXAgY3VycmVudCB1c2VyJ3Mgc2l0ZXMNCgkJCXsNCgkJCQlpZiAoIXJlYy5TVk1YQ19fTG9jYXRpb25fX3IuTmFtZSkgU2l0ZU5hbWUgPSAiIjsNCgkJCQllbHNlIFNpdGVOYW1lID0gcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5OYW1lOw0KDQoJCQkJaWYgKCFyZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19TdHJlZXRfX2MpIFN0cmVldCA9ICIiOw0KCQkJCWVsc2UgU3RyZWV0ID0gcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fU3RyZWV0X19jOw0KDQoJCQkJaWYgKCFyZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19DaXR5X19jKSBDaXR5ID0gIiI7DQoJCQkJZWxzZSBDaXR5ID0gcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fQ2l0eV9fYzsNCg0KCQkJCWlmICghcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fU3RhdGVfX2MpIFN0YXRlID0gIiI7DQoJCQkJZWxzZSBTdGF0ZSA9IHJlYy5TVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX1N0YXRlX19jOw0KDQoJCQkJaWYgKCFyZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19aaXBfX2MpIFppcCA9ICIiOw0KCQkJCWVsc2UgWmlwID0gcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fWmlwX19jOw0KDQoJCQkJaWYgKCFyZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19Db3VudHJ5X19jKSBDb3VudHJ5ID0gIiI7DQoJCQkJZWxzZSBDb3VudHJ5ID0gcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fQ291bnRyeV9fYzsNCg0KCQkJCWlmICghcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fU2l0ZV9QaG9uZV9fYykgUGhvbmUgPSAiIjsNCgkJCQllbHNlIFBob25lID0gcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fU2l0ZV9QaG9uZV9fYzsNCg0KCQkJCWlmICghaGVhZGVyKSB7DQoJCQkJU1ZNWElfU0xLUF9EcmF3SGVhZGVyKHRib2R5KTsNCgkJCQloZWFkZXIgPSB0cnVlOw0KCQkJCX0NCgkNCgkJCQl2YXIgcG9pbnQgPSBuZXcgR0xhdExuZyhyZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19MYXRpdHVkZV9fYywgcmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fTG9uZ2l0dWRlX19jKTsgCQkJCVNWTVhJX1NMS1BfQWRkUG9pbnRUb01hcChyZWMscG9pbnQscmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fTGF0aXR1ZGVfX2MscmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fTG9uZ2l0dWRlX19jLCBTaXRlTmFtZSwgU3RyZWV0LCBDaXR5LCBTdGF0ZSwgWmlwLCBDb3VudHJ5LCBQaG9uZSwgcGFyc2VGbG9hdChyZWMuU1ZNWENfX1F1YW50aXR5Ml9fYyksIHJlYy5TVk1YQ19fTG9jYXRpb25fX2MsaSxzdG9ja3JlY29yZHMubGVuZ3RoKTsNCg0KDQoJCQkvKglpZiAocmVjLlNWTVhDX19Mb2NhdGlvbl9fci5TVk1YQ19fTGF0aXR1ZGVfX2MgIT0gbnVsbCAmJiByZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19Mb25naXR1ZGVfX2MgIT0gbnVsbCkNCgkJCQl7DQoJCQkJCXZhciBwb2ludCA9IG5ldyBHTGF0TG5nKHJlYy5TVk1YQ19fTG9jYXRpb25fX3IuU1ZNWENfX0xhdGl0dWRlX19jLCByZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19Mb25naXR1ZGVfX2MpOyAJCQkJU1ZNWElfU0xLUF9BZGRQb2ludFRvTWFwKHJlYyxwb2ludCxyZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19MYXRpdHVkZV9fYyxyZWMuU1ZNWENfX0xvY2F0aW9uX19yLlNWTVhDX19Mb25naXR1ZGVfX2MsIFNpdGVOYW1lLCBTdHJlZXQsIENpdHksIFN0YXRlLCBaaXAsIENvdW50cnksIFBob25lLCBwYXJzZUZsb2F0KHJlYy5TVk1YQ19fUXVhbnRpdHkyX19jKSwgcmVjLlNWTVhDX19Mb2NhdGlvbl9fYyxpLHN0b2NrcmVjb3Jkcy5sZW5ndGgpOw0KCQkJCSANCgkJCQl9DQoJCQkJZWxzZQ0KCQkJCXsNCgkJCQkJU1ZNWElfU0xLUF9BZGRMb2NhdGlvblRvTWFwKHJlYyxTaXRlTmFtZSwgU3RyZWV0LCBDaXR5LCBTdGF0ZSwgWmlwLCBDb3VudHJ5LCBQaG9uZSwgcGFyc2VGbG9hdChyZWMuU1ZNWENfX1F1YW50aXR5Ml9fYyksIHJlYy5TVk1YQ19fTG9jYXRpb25fX2MsaSxzdG9ja3JlY29yZHMubGVuZ3RoKTsNCgkJCQl9Ki8NCgkJCQlTTEtQX3Jvd251bSArPSAxOw0KCQkJfQ0KCQl9DQoJfQ0KDQogICAgdmFyIHJ2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkxBQjAxOSIpLnZhbHVlOw0KICAgIGlmIChydiA9PSAiTWFwIikgeyBTTEtQX1Nob3dNYXAgPSBmYWxzZTsgU0xLUF9TaG93UmVzdWx0cyA9IHRydWU7IH0NCiAgICBpZiAocnYgPT0gIkdyaWQiKSB7IFNMS1BfU2hvd1Jlc3VsdHMgPSBmYWxzZTsgU0xLUF9TaG93TWFwID0gdHJ1ZTsgfQ0KICAgIGlmIChydiA9PSAiQm90aCIpIHsgU0xLUF9TaG93UmVzdWx0cyA9IGZhbHNlOyBTTEtQX1Nob3dNYXAgPSBmYWxzZTsgfQ0KDQogICAgU1ZNWENfU0xLUF9Ub2dnbGVNYXAoKTsNCiAgICBTVk1YQ19TTEtQX1RvZ2dsZVJlc3VsdHMoKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9TTEtQX0FkZFBvaW50VG9NYXAoU3RvY2tSZWMsIFBvaW50LGxhdGl0dWRlLGxvbmdpdHV0ZSwgU2l0ZU5hbWUsIFN0cmVldCwgQ2l0eSwgU3RhdGUsIFppcCwgQ291bnRyeSwgUGhvbmUsIFF0eUF2bGJsLCBTaXRlSWQsY3VycmNudCx0b3RjbnQpIA0KeyANCg0KCXZhciBteUljb24gPSBuZXcgR0ljb24oR19ERUZBVUxUX0lDT04pOyANCglteUljb24uaW1hZ2UgPSAiaHR0cDovL21hcHMuZ29vZ2xlLmNvbS9tYXBmaWxlcy9rbWwvcGFsMi9pY29uNS5wbmciOyANCgl2YXIgU3RvY2tUYWcgPSAiPGI+IiArIFNpdGVOYW1lICsgIjwvYj48YnI+IiArIA0KCQkJCQkJCQkJICBTdHJlZXQgKyAiPGJyPiIgKyBDaXR5ICsgIiwgIiArIFN0YXRlICsgIiAiICsgWmlwICsgIiwgIiArIENvdW50cnkgKyAiPGJyPiIgKyANCgkJCQkJCQkJCSAgU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEzIikgKyBQaG9uZSArICI8YnI+IiArIA0KCQkJCQkJCQkJICAiPGI+ICIrU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE0IikgKyBwYXJzZUZsb2F0KFN0b2NrUmVjLlNWTVhDX19RdWFudGl0eTJfX2MpICsgIjwvYj4iICsNCgkJCQkJCQkJCSAgIjxicj4iK1NWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMiIpOw0KCXZhciB1bml0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJMQUIwMjAiKS52YWx1ZTsgDQoJRGlzdGFuY2UgPSBTVk1YSV9DYWxjdWxhdGVEaXN0YW5jZShHTUxLUF9MYXQxLEdNTEtQX0xvbjEsbGF0aXR1ZGUsbG9uZ2l0dXRlLHVuaXRzKTsNCglpZihEaXN0YW5jZSA9PSAwKQ0KCXsNCgkJU1ZNWElfU0xLUF9BZGRMb2NhdGlvblRvTWFwKFN0b2NrUmVjLFNpdGVOYW1lLCBTdHJlZXQsIENpdHksIFN0YXRlLCBaaXAsIENvdW50cnksIFBob25lLCBRdHlBdmxibCwgU2l0ZUlkLGN1cnJjbnQsdG90Y250KTsNCgl9DQoJZWxzZSBpZiAoRGlzdGFuY2UgPD0gU0xLUF9yYWRpdXMgfHwgU0xLUF9yYWRpdXMgPT0gMCkNCgl7DQoJCXJlY0ZvdW5kID09IllFUyINCgkJbXlJY29uLmljb25TaXplPW5ldyBHU2l6ZSgzMiwzMik7IA0KCQlteUljb24uc2hhZG93U2l6ZT1uZXcgR1NpemUoNTYsMzIpOyANCgkJbXlJY29uLmljb25BbmNob3I9bmV3IEdQb2ludCgxNiwzMik7IA0KCQlteUljb24uaW5mb1dpbmRvd0FuY2hvcj1uZXcgR1BvaW50KDE2LDApOyANCgkJdmFyIG1hcmtlck9wdGlvbnMyID0geyBpY29uOm15SWNvbiB9OyANCgkJdmFyIG1hcmtlciA9IG5ldyBHTWFya2VyKFBvaW50LCBtYXJrZXJPcHRpb25zMik7DQoJCVNMS1BfbWFwLmFkZE92ZXJsYXkobWFya2VyKTsgDQoJCUdFdmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICJtb3VzZW92ZXIiLCBmdW5jdGlvbigpIHsgbWFya2VyLm9wZW5JbmZvV2luZG93SHRtbChTdG9ja1RhZyk7fSkgOyANCgkJR0V2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgIm1vdXNlb3V0IiwgZnVuY3Rpb24oKSB7IG1hcmtlci5jbG9zZUluZm9XaW5kb3coKTsgfSkgOyANCgkJR0V2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgImRibGNsaWNrIiwgZnVuY3Rpb24oKSB7IFNWTVhJX1NMS1BfU2V0UmVxdWVzdEZyb21Mb2NhdGlvbihTaXRlSWQsIFNpdGVOYW1lKTsgfSk7IA0KCQlTVk1YSV9TTEtQX0FkZFJlc3VsdFJvdyhTdG9ja1JlYywgU2l0ZU5hbWUsIFN0cmVldCwgQ2l0eSwgU3RhdGUsIFppcCwgQ291bnRyeSwgUGhvbmUsIFNpdGVJZCwgRGlzdGFuY2UpOw0KCX0NCgllbHNlIGlmIChEaXN0YW5jZSA+IFNMS1BfcmFkaXVzKQ0KCXsNCgkJaWYocGFyc2VJbnQoY3VycmNudCk9PXBhcnNlSW50KHRvdGNudCkgJiYgcmVjRm91bmQgPT0iTk8iKQ0KCQl7DQoJCQlhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMjIiKSk7DQoJCQl0cnl7DQoJCQkJdmFyIHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpc3RfdGJvZHkiKTsNCgkJCQljbGVhcl90YWJsZSh0Ym9keSk7DQoJCQl9Y2F0Y2goZSl7fQ0KCQl9DQoJfQ0KfSANCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfU0xLUF9BZGRSZXN1bHRSb3coU3RvY2tSZWMsIFNpdGVOYW1lLCBTdHJlZXQsIENpdHksIFN0YXRlLCBaaXAsIENvdW50cnksIFBob25lLCBTaXRlSWQsIERpc3RhbmNlKQ0Kew0KICAgIHZhciB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsaXN0X3Rib2R5Iik7DQogICAgdmFyIHRyID0gbWFrZVJvdyhtYWtlQXR0cnMoU0xLUF9yb3dudW0sdGJvZHkpKTsNCiAgICB0ci5zb2JqZWN0ID0gU3RvY2tSZWM7DQogICAgdGJvZHkuYXBwZW5kQ2hpbGQodHIpOw0KDQoJICAgIC8vIENvbCAxLiBMb2NhdGlvbiBOYW1lDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseyJzY29wZSI6InJvdyJ9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgdGFyZ2V0PV9ibGFuayBpZD1cIiIgKyBTdG9ja1JlYy5JZCArICJTaXRlTmFtZVwiIGhyZWY9XCIvIiArIFN0b2NrUmVjLklkICsgIlwiPiIgKyBTaXRlTmFtZSArICI8L2E+IjsNCg0KCSAgICAvLyBDb2wgMi4gU3RyZWV0DQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseyJzY29wZSI6InJvdyJ9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgdGFyZ2V0PV9ibGFuayBocmVmPVwiLyIgKyBTdG9ja1JlYy5JZCArICJcIj4iICsgU3RyZWV0ICsgIjwvYT4iOw0KDQoJICAgIC8vIENvbCAzLiBDaXR5DQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseyJzY29wZSI6InJvdyJ9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgdGFyZ2V0PV9ibGFuayBocmVmPVwiLyIgKyBTdG9ja1JlYy5JZCArICJcIj4iICsgQ2l0eSArICI8L2E+IjsNCg0KCSAgICAvLyBDb2wgNC4gU3RhdGUNCiAgICBjcmVhdGVUYWcodHIsInRoIix7InNjb3BlIjoicm93In0pLmlubmVySFRNTCA9DQoJICAgICI8YSB0YXJnZXQ9X2JsYW5rIGhyZWY9XCIvIiArIFN0b2NrUmVjLklkICsgIlwiPiIgKyBTdGF0ZSArICI8L2E+IjsNCg0KCSAgICAvLyBDb2wgNS4gWmlwDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseyJzY29wZSI6InJvdyJ9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgdGFyZ2V0PV9ibGFuayBocmVmPVwiLyIgKyBTdG9ja1JlYy5JZCArICJcIj4iICsgWmlwICsgIjwvYT4iOw0KDQoJICAgIC8vIENvbCA2LiBDb3VudHJ5DQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseyJzY29wZSI6InJvdyJ9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgdGFyZ2V0PV9ibGFuayBocmVmPVwiLyIgKyBTdG9ja1JlYy5JZCArICJcIj4iICsgQ291bnRyeSArICI8L2E+IjsNCg0KCSAgICAvLyBDb2wgNy4gUGhvbmUNCiAgICBjcmVhdGVUYWcodHIsInRoIix7InNjb3BlIjoicm93In0pLmlubmVySFRNTCA9DQoJICAgICI8YSB0YXJnZXQ9X2JsYW5rIGhyZWY9XCIvIiArIFN0b2NrUmVjLklkICsgIlwiPiIgKyBQaG9uZSArICI8L2E+IjsNCg0KCSAgICAvLyBDb2wgOC4gQXZhaWxhYmxlIFF1YW50aXR5DQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseyJzY29wZSI6InJvdyIsICJhbGlnbiI6InJpZ2h0In0pLmlubmVySFRNTCA9DQoJICAgICI8YSB0YXJnZXQ9X2JsYW5rIGhyZWY9XCIvIiArIFN0b2NrUmVjLklkICsgIlwiPiIgKyBTdG9ja1JlYy5TVk1YQ19fUXVhbnRpdHkyX19jICsgIjwvYT4iOw0KDQoJICAgIC8vIENvbCA5LiBEaXN0YW5jZQ0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsic2NvcGUiOiJyb3ciLCAiYWxpZ24iOiJyaWdodCJ9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgdGFyZ2V0PV9ibGFuayBocmVmPVwiLyIgKyBTdG9ja1JlYy5JZCArICJcIj4iICsgRGlzdGFuY2UgKyAiPC9hPiI7DQoNCgkgICAgLy8gQ29sIDEwLiBSYWRpbyBidXR0b24NCiAgICBjcmVhdGVUYWcodHIsInRkIixbXSkuaW5uZXJIVE1MID0NCgkiPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5hbWU9XCJyYWRpb1wiIHZhbHVlPVwiIiArIFN0b2NrUmVjLklkICsgIlwiPjwvaW5wdXQ+IjsNCg0KCSAgICAvLyBDb2wgMTEuIEhpZGRlbiBTaXRlIElkDQogICAgY3JlYXRlVGFnKHRyLCJ0ZCIsW10pLmlubmVySFRNTCA9DQoJIjxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgaWQ9XCIiICsgU3RvY2tSZWMuSWQgKyAiU2l0ZUlkXCIgdmFsdWU9XCIiICsgU3RvY2tSZWMuU1ZNWENfX0xvY2F0aW9uX19jICsgIlwiPjwvaW5wdXQ+IjsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9TTEtQX0RyYXdIZWFkZXIodGEpDQp7DQogICAgY2xlYXJfdGFibGUodGEpOw0KICAgIHZhciB0ciA9IG1ha2VSb3coeydjbGFzcyc6J2hlYWRlclJvdyd9KTsNCiAgICB0YS5hcHBlbmRDaGlsZCh0cik7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJ30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMDkiKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJ30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMTAiKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJ30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMTEiKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJ30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMTIiKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJ30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMTMiKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJ30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMTQiKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJ30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMTUiKSsiICM8L2E+IjsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnLCdhbGlnbic6J3JpZ2h0J30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMTYiKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJywnYWxpZ24nOidyaWdodCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDE3IikrIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCcsJ2FsaWduJzonY2VudGVyJ30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMTgiKSsiPC9hPiI7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWENfU0xLUF9Ub2dnbGVNYXAoKQ0Kew0KICAgIGlmIChTTEtQX1Nob3dNYXApDQogICAgCXsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGl2TWFwIikuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGl2Um91dGUiKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KCVNMS1BfU2hvd01hcCA9IGZhbHNlOw0KCX0NCiAgICBlbHNlDQoJew0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkaXZNYXAiKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGl2Um91dGUiKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCglTTEtQX1Nob3dNYXAgPSB0cnVlOw0KCX0NCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YQ19TTEtQX1RvZ2dsZVJlc3VsdHMoKQ0Kew0KICAgIGlmIChTTEtQX1Nob3dSZXN1bHRzKQ0KCXsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGl2UmVzdWx0cyIpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQoJU0xLUF9TaG93UmVzdWx0cyA9IGZhbHNlOw0KCX0NCiAgICBlbHNlDQoJew0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkaXZSZXN1bHRzIikuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQoJU0xLUF9TaG93UmVzdWx0cyA9IHRydWU7DQoJfQ0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhDX1NMS1BfVG9nZ2xlT3B0aW9ucygpDQp7DQogICAgaWYgKFNMS1BfU2hvd09wdGlvbnMpDQoJew0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkaXZPcHRpb25zIikuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCglTTEtQX1Nob3dPcHRpb25zID0gZmFsc2U7DQoJfQ0KICAgIGVsc2UNCgl7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRpdk9wdGlvbnMiKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCglTTEtQX1Nob3dPcHRpb25zID0gdHJ1ZTsNCgl9DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gY3JlYXRlVGFnKHBhcmVudCwgbmFtZSwga2V5dmFsUGFpcnMpDQp7DQogICAgdmFyIHJldDsNCiAgICB2YXIgYnJvd3NlciA9IG5hdmlnYXRvci5hcHBOYW1lOw0KICAgIGlmIChicm93c2VyID09ICJNaWNyb3NvZnQgSW50ZXJuZXQgRXhwbG9yZXIiKSB7DQoJICAgIHZhciB0clRhZyA9ICI8IituYW1lKyIgIjsNCgkgICAgZm9yIChrZXkgaW4ga2V5dmFsUGFpcnMpIHsNCgkJCSAgICB0clRhZyArPSBrZXkgKyAiPVwiIiArIGtleXZhbFBhaXJzW2tleV0gKyAiXCIiOw0KCSAgICB9DQoJICAgIHRyVGFnICs9ICI+IjsNCgkgICAgcmV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0clRhZyk7DQogICAgfSBlbHNlIHsNCgkgICAgcmV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChuYW1lKTsNCgkgICAgZm9yIChrZXkgaW4ga2V5dmFsUGFpcnMpIHsNCgkJICAgIHJldC5zZXRBdHRyaWJ1dGUoa2V5LCBrZXl2YWxQYWlyc1trZXldKTsNCgkgICAgfQ0KICAgIH0NCiAgICBwYXJlbnQuYXBwZW5kQ2hpbGQocmV0KTsNCiAgICByZXR1cm4gcmV0Ow0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhDX1NMS1BfUmVxdWVzdFN0b2NrKCkNCnsNCiAgICB2YXIgY2hlY2tlZCA9IGZhbHNlOw0KICAgIHZhciBybGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCJyYWRpbyIpOw0KICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmxpc3QubGVuZ3RoOyBpKyspDQogICAgCXsNCglpZiAocmxpc3RbaV0uY2hlY2tlZCkNCgkgICAgew0KCSAgICBjaGVja2VkID0gdHJ1ZTsNCgkgICAgYnJlYWs7DQoJICAgIH0NCgl9DQogICAgaWYgKCFjaGVja2VkKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAzIikpOw0KCXJldHVybjsNCgl9DQogICAgdmFyIHNpZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJsaXN0W2ldLnZhbHVlKyJTaXRlSWQiKS52YWx1ZTsNCiAgICB2YXIgc24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChybGlzdFtpXS52YWx1ZSsiU2l0ZU5hbWUiKS5pbm5lckhUTUw7DQogICAgU1ZNWElfU0xLUF9TZXRSZXF1ZXN0RnJvbUxvY2F0aW9uKHNpZCwgc24pOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhDX0NhbmNlbFBhcnRzUmVxdWVzdChyZXFJZCwgdUlkKQ0Kew0KICAgIFNWTVhJX0luaXRNZXNzYWdlTGlzdCgiUFJFUVNDMSIpOw0KICAgIFNWTVhJX1NldExhYmVscygiY2FuY2VscGFydHNyZXF1ZXN0Iik7DQoNCiAgICB2YXIgYW5zID0gY29uZmlybShTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDMiKSk7DQogICAgaWYgKCFhbnMpIHsgcmV0dXJuOyB9DQoNCiAgICBDTlBSX1JlcXVlc3RJZCA9IHJlcUlkOw0KICAgIENOUFJfVXNlcklkID0gdUlkOw0KDQogICAgLy8gR2V0IFBhcnRzIFJlcXVlc3QgaGVhZGVyIGluZm8NCiAgICB2YXIgc29xbDEgPSAiU0VMRUNUIFNWTVhDX19TdGF0dXNfX2MgRlJPTSBTVk1YQ19fUGFydHNfUmVxdWVzdF9fYyBXSEVSRSBJZCA9ICciICsgQ05QUl9SZXF1ZXN0SWQgKyAiJyI7DQogICAgdmFyIHFyMSA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwxKTsNCiAgICBpZiAocXIxLnNpemUgPD0gMCkNCgl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAyIikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICB2YXIgcmVjMSA9IHFyMS5nZXRBcnJheSgicmVjb3JkcyIpOw0KICAgIGlmIChyZWMxWzBdLlNWTVhDX19TdGF0dXNfX2MgPT0gIkNvbXBsZXRlZCIpDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDQiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIGlmIChyZWMxWzBdLlNWTVhDX19TdGF0dXNfX2MgPT0gIkNhbmNlbGVkIikNCiAgICAJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNSIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQoNCiAgICAvLyBHZXQgb3BlbiBQYXJ0cyBSZXF1ZXN0IGxpbmVzDQogICAgdmFyIHNvcWwyID0gIlNFTEVDVCBJZCwgU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MsIFNWTVhDX19RdWFudGl0eV9TaGlwcGVkMl9fYywgIiArDQogICAgCQkiU1ZNWENfX1F1YW50aXR5X1JlY2VpdmVkMl9fYywgU1ZNWENfX0xpbmVfU3RhdHVzX19jICIgKw0KCQkiRlJPTSBTVk1YQ19fUGFydHNfUmVxdWVzdF9MaW5lX19jIFdIRVJFIFNWTVhDX19QYXJ0c19SZXF1ZXN0X19jID0gJyIgKyBDTlBSX1JlcXVlc3RJZCArICInIjsNCiAgICB2YXIgcXIyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDIpOw0KICAgIHJlY3MgPSBxcjIuZ2V0QXJyYXkoInJlY29yZHMiKTsNCg0KICAgIHZhciBjdXJkYXRlID0gbmV3IERhdGUoKTsNCiAgICB2YXIgaW52YWxpZCA9IGZhbHNlOw0KICAgIHZhciByZXFsaW5lcyA9IG5ldyBBcnJheSgpOw0KICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcmVjcy5sZW5ndGg7IGsrKykNCiAgICAJew0KCXZhciByZWMgPSByZWNzW2tdOw0KDQoJaWYgKHJlYy5TVk1YQ19fTGluZV9TdGF0dXNfX2MgPT0gIkNvbXBsZXRlZCIgfHwgcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jID4gMCB8fA0KCQkJCXJlYy5TVk1YQ19fUXVhbnRpdHlfUmVjZWl2ZWQyX19jID4gMCB8fCByZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBwZWQyX19jID4gMCkNCgkgICAgew0KCSAgICBpbnZhbGlkID0gdHJ1ZTsNCgkgICAgYnJlYWs7DQoJICAgIH0NCgl2YXIgcmVxbGluZSA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYyIpOw0KCXJlcWxpbmUuSWQgPSByZWMuSWQ7DQoJcmVxbGluZS5TVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAiQ2FuY2VsZWQiOw0KCXJlcWxpbmUuU1ZNWENfX0NhbmNlbGVkX09uX19jID0gU1ZNWElfR2V0Q3VycmVudFRpbWUoKTsNCglyZXFsaW5lLlNWTVhDX19DYW5jZWxlZF9CeV9fYyA9IENOUFJfVXNlcklkOw0KCXJlcWxpbmVzLnB1c2gocmVxbGluZSk7DQoJfQ0KDQogICAgaWYgKGludmFsaWQpDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDYiKSsiXG4iK1NWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNyIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQoNCiAgICB0cnkgew0KCXNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShyZXFsaW5lcyk7DQoJfQ0KICAgIGNhdGNoIChlKSB7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAxIikgKyAiXG4iICsgZSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm4gZmFsc2U7DQogICAgCX0NCiAgICB2YXIgcmVxaGRyID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fUGFydHNfUmVxdWVzdF9fYyIpOw0KICAgIHJlcWhkci5JZCA9IENOUFJfUmVxdWVzdElkOw0KICAgIHJlcWhkci5TVk1YQ19fU3RhdHVzX19jID0gIkNhbmNlbGVkIjsNCiAgICByZXFoZHIuU1ZNWENfX0NhbmNlbGVkX09uX19jID0gU1ZNWElfR2V0Q3VycmVudFRpbWUoKTsNCiAgICByZXFoZHIuU1ZNWENfX0NhbmNlbGVkX0J5X19jID0gQ05QUl9Vc2VySWQ7DQogICAgdHJ5IHsNCglzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUoW3JlcWhkcl0pOw0KCX0NCiAgICBjYXRjaCAoZSkgew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMSIpICsgIlxuIiArIGUpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuIGZhbHNlOw0KICAgIAl9DQogICAgd2luZG93Lm9wZW5lci5sb2NhdGlvbi5yZWxvYWQodHJ1ZSk7DQogICAgQ2xvc2VXaW5kb3coKTsNCiAgICByZXR1cm4gdHJ1ZTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YQ19DYW5jZWxTaGlwbWVudE9yZGVyKHNocElkLCB1SWQpDQp7DQoJU1ZNWElfSW5pdE1lc3NhZ2VMaXN0KCJQT1JEU0MxIik7DQoJU1ZNWElfU2V0TGFiZWxzKCJDYW5jZWxTaGlwbWVudG9yZGVyIik7DQoJDQogICAgQ05TSFBfU2hpcG1lbnRPcmRlcklkID0gc2hwSWQ7DQogICAgQ05TSFBfVXNlcklkID0gdUlkOw0KDQogICAgLy8gR2V0IFNoaXBtZW50IG9yZGVyIGhlYWRlciBpbmZvDQogICAgdmFyIHNvcWwxID0gIlNFTEVDVCBTVk1YQ19fT3JkZXJfU3RhdHVzX19jIEZST00gU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYyBXSEVSRSBJZCA9ICciICsgQ05TSFBfU2hpcG1lbnRPcmRlcklkICsgIiciOw0KICAgIHZhciBxcjEgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMSk7DQogICAgaWYgKHFyMS5zaXplIDw9IDApDQoJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMiIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgdmFyIHJlYzEgPSBxcjEuZ2V0QXJyYXkoInJlY29yZHMiKTsNCiAgICBpZiAocmVjMVswXS5TVk1YQ19fT3JkZXJfU3RhdHVzX19jID09ICJDbG9zZWQiKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAzIikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBpZiAocmVjMVswXS5TVk1YQ19fT3JkZXJfU3RhdHVzX19jID09ICJDYW5jZWxlZCIpDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDQiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KDQogICAgLy8gR2V0IG9wZW4gc2hpcG1lbnQgb3JkZXIgbGluZXMNCiAgICB2YXIgc29xbDIgPSAiU0VMRUNUIElkLCBTVk1YQ19fTGluZV9TdGF0dXNfX2MsIFNWTVhDX19BY3R1YWxfUXVhbnRpdHkyX19jIEZST00gU1ZNWENfX1JNQV9TaGlwbWVudF9MaW5lX19jIFdIRVJFIFNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MgPSAnIiArIENOU0hQX1NoaXBtZW50T3JkZXJJZCArICInIjsNCiAgICB2YXIgcXIyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDIpOw0KICAgIHJlY3MgPSBxcjIuZ2V0QXJyYXkoInJlY29yZHMiKTsNCg0KICAgIHZhciBjdXJkYXRlID0gbmV3IERhdGUoKTsNCiAgICB2YXIgaW52YWxpZCA9IGZhbHNlOw0KICAgIHZhciBzaHBsaW5lcyA9IG5ldyBBcnJheSgpOw0KICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcmVjcy5sZW5ndGg7IGsrKykNCiAgICAJew0KCXZhciByZWMgPSByZWNzW2tdOw0KDQoJaWYgKHJlYy5TVk1YQ19fTGluZV9TdGF0dXNfX2MgPT0gIkNvbXBsZXRlZCIgfHwgcmVjLlNWTVhDX19MaW5lX1N0YXR1c19fYyA9PSAiQ2FuY2VsZWQiIHx8IHBhcnNlRmxvYXQocmVjLlNWTVhDX19BY3R1YWxfUXVhbnRpdHkyX19jKSA+IDApDQoJICAgIHsNCgkgICAgaW52YWxpZCA9IHRydWU7DQoJICAgIGJyZWFrOw0KCSAgICB9DQoJdmFyIHNocGxpbmUgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19STUFfU2hpcG1lbnRfTGluZV9fYyIpOw0KCXNocGxpbmUuSWQgPSByZWMuSWQ7DQoJc2hwbGluZS5TVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAiQ2FuY2VsZWQiOw0KCXNocGxpbmUuU1ZNWENfX0NhbmNlbGVkX09uX19jID0gU1ZNWElfR2V0Q3VycmVudFRpbWUoKTsNCglzaHBsaW5lLlNWTVhDX19DYW5jZWxlZF9CeV9fYyA9IENOU0hQX1VzZXJJZDsNCglzaHBsaW5lcy5wdXNoKHNocGxpbmUpOw0KCX0NCg0KICAgIGlmIChpbnZhbGlkKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA1IikrIlxuIitTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDYiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KDQogICAgdHJ5IHsNCglzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUoc2hwbGluZXMpOw0KCX0NCiAgICBjYXRjaCAoZSkgew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMSIpICsgIlxuIiArIGUpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuIGZhbHNlOw0KICAgIAl9DQogICAgdmFyIHNocGhkciA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYyIpOw0KICAgIHNocGhkci5JZCA9IENOU0hQX1NoaXBtZW50T3JkZXJJZDsNCiAgICBzaHBoZHIuU1ZNWENfX09yZGVyX1N0YXR1c19fYyA9ICJDYW5jZWxlZCI7DQogICAgc2hwaGRyLlNWTVhDX19DYW5jZWxlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQogICAgc2hwaGRyLlNWTVhDX19DYW5jZWxlZF9CeV9fYyA9IENOU0hQX1VzZXJJZDsNCiAgICB0cnkgew0KCXNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShbc2hwaGRyXSk7DQoJfQ0KICAgIGNhdGNoIChlKSB7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAxIikgKyAiXG4iICsgZSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm4gZmFsc2U7DQogICAgCX0NCiAgICB3aW5kb3cub3BlbmVyLmxvY2F0aW9uLnJlbG9hZCh0cnVlKTsNCiAgICBDbG9zZVdpbmRvdygpOw0KICAgIHJldHVybiB0cnVlOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1BSU2hwX1Nob3dQUlRvQmVTaGlwcGVkKHJlcUlkLCB1SWQpDQp7DQoNCglTVk1YSV9Jbml0TWVzc2FnZUxpc3QoIlBSRVFTQzIiKTsNCglTVk1YSV9TZXRMYWJlbHMoIkNyZWF0ZVNoaXBtZW50RnJvbVBSIik7DQoNCiAgICBTSFBSX1JlcXVlc3RJZCA9IHJlcUlkOw0KICAgIFNIUFJfVXNlcklkID0gdUlkOw0KDQogICAgLy8gR2V0IFBhcnRzIFJlcXVlc3QgaGVhZGVyIGluZm8NCiAgICB2YXIgc29xbDEgPSAiU0VMRUNUIE93bmVySWQsIFNWTVhDX19Db21wYW55X19jLCBTVk1YQ19fU3RhdHVzX19jLCBTVk1YQ19fUmVxdWVzdGVkX0Zyb21fX2MsICIgKw0KICAgIAkJIlNWTVhDX19SZXF1aXJlZF9BdF9Mb2NhdGlvbl9fYywgU1ZNWENfX0FkZGl0aW9uYWxfSW5mb3JtYXRpb25fX2MgIiArDQoJCSJGUk9NIFNWTVhDX19QYXJ0c19SZXF1ZXN0X19jIFdIRVJFIElkID0gJyIgKyBTSFBSX1JlcXVlc3RJZCArICInIjsNCiAgICB2YXIgcXIxID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDEpOw0KICAgIGlmIChxcjEuc2l6ZSA8PSAwKQ0KCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDIiKSArICJcbiIgKyBlKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgdmFyIHJlYzEgPSBxcjEuZ2V0QXJyYXkoInJlY29yZHMiKTsNCiAgICBpZiAocmVjMVswXS5TVk1YQ19fU3RhdHVzX19jID09ICJDb21wbGV0ZWQiKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAzIikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBpZiAocmVjMVswXS5TVk1YQ19fU3RhdHVzX19jID09ICJDYW5jZWxlZCIpDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDQiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIFNIUFJfQ29tcGFueUlkID0gcmVjMVswXS5TVk1YQ19fQ29tcGFueV9fYzsNCiAgICBTSFBSX1JlcXVlc3RlZEZyb21JZCA9IHJlYzFbMF0uU1ZNWENfX1JlcXVlc3RlZF9Gcm9tX19jOw0KICAgIFNIUFJfUmVxdWlyZWRBdElkID0gcmVjMVswXS5TVk1YQ19fUmVxdWlyZWRfQXRfTG9jYXRpb25fX2M7DQogICAgU0hQUl9Pd25lcklkID0gcmVjMVswXS5Pd25lcklkOw0KICAgIFNIUFJfQWRkbEluZm8gPSByZWMxWzBdLlNWTVhDX19BZGRpdGlvbmFsX0luZm9ybWF0aW9uX19jOw0KDQogICAgLy8gR2V0IG9wZW4gUGFydHMgUmVxdWVzdCBsaW5lcw0KICAgIHZhciBzb3FsMiA9ICJTRUxFQ1QgSWQsIFNWTVhDX19QYXJ0c19SZXF1ZXN0X19jLCBTVk1YQ19fUHJvZHVjdF9fYywgU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSwgU1ZNWENfX1F1YW50aXR5X1JlcXVpcmVkMl9fYywgIiArDQogICAgCQkiU1ZNWENfX0RhdGVfUmVxdWlyZWRfX2MsIFNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jLCBTVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MsIFNWTVhDX19BZGRpdGlvbmFsX0luZm9ybWF0aW9uX19jLFNWTVhDX19Vbml0X1ByaWNlMl9fYyAiICsNCgkJIkZST00gU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYyBXSEVSRSBTVk1YQ19fUGFydHNfUmVxdWVzdF9fYyA9ICciICsgU0hQUl9SZXF1ZXN0SWQgKyAiJyBBTkQgIiArDQoJCSJTVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAnT3BlbiciOyAvL0J5IEdtIDE4anVuMDggYWRkZWQgZmxkIDogU1ZNWENfX1VuaXRfUHJpY2UyX19jICANCiAgICB0cnkgew0KICAgIHZhciBxcjIgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMik7DQogICAgfSBjYXRjaCAoZSkgeyBhbGVydChlKTsgfQ0KICAgIGlmIChxcjIuc2l6ZSA8PSAwKQ0KCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDUiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIHZhciByZXFyZWNzID0gbmV3IHNmb3JjZS5RdWVyeVJlc3VsdEl0ZXJhdG9yKHFyMik7DQoNCiAgICB2YXIgcm93Y250ID0gMDsNCiAgICB2YXIgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibGlzdF90Ym9keSIpOw0KDQogICAgU1ZNWElfUFJTaHBfRHJhd0hlYWRlcih0Ym9keSk7DQoNCiAgICB3aGlsZShyZXFyZWNzLmhhc05leHQoKSkNCgl7DQoJdmFyIHJlcXJlYyA9IHJlcXJlY3MubmV4dCgpOw0KCXZhciByZXFpZCA9IHJlcXJlYy5JZDsNCgl2YXIgcHJvZGlkID0gcmVxcmVjLlNWTVhDX19Qcm9kdWN0X19jOw0KCXZhciBSZXFRdHkgPSBwYXJzZUZsb2F0KHJlcXJlYy5TVk1YQ19fUXVhbnRpdHlfUmVxdWlyZWQyX19jKTsNCg0KCWlmIChyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MgPT0gbnVsbCB8fCBpc05hTihyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MpKQ0KCSAgICB2YXIgU2hpcEluaXRRdHkgPSAwOw0KCWVsc2UNCgkgICAgdmFyIFNoaXBJbml0UXR5ID0gcGFyc2VGbG9hdChyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MpOw0KDQoJdmFyIFJlbVF0eSA9IFJlcVF0eS1TaGlwSW5pdFF0eTsNCg0KCWlmIChSZW1RdHkgPiAwKQ0KCSAgICB7DQoJICAgIHZhciB0ciA9IG1ha2VSb3cobWFrZUF0dHJzKHJvd2NudCx0Ym9keSkgKTsNCgkgICAgdHIuc29iamVjdCA9IHJlcXJlYzsNCgkgICAgdGJvZHkuYXBwZW5kQ2hpbGQodHIpOw0KDQoJCSAgICAvLyBDb2wgMS4gUHJvZHVjdCBOYW1lDQoJICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsic2NvcGUiOiJyb3cifSkuaW5uZXJIVE1MID0NCgkJICAgICI8YSB0YXJnZXQ9X2JsYW5rIGhyZWY9XCIvIiArIHByb2RpZCArICJcIj4iICsgcmVxcmVjLlNWTVhDX19Qcm9kdWN0X19yLk5hbWUgKyAiPC9hPiI7DQoNCgkJICAgIC8vIENvbCAyLiBSZW1haW5pbmcgUXVhbnRpdHkNCgkgICAgY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkgICAgIjxpbnB1dCBkaXNhYmxlZD1cInRydWVcIiB0eXBlPVwidGV4dFwiIGlkPVwiIiArIHJlcWlkICsgIlJlbVF0eVwiIG5hbWU9XCIiICsgcmVxaWQgKyAiUmVtUXR5XCIgdmFsdWU9XCIiICsgUmVtUXR5ICsgIlwiPjwvaW5wdXQ+IjsNCg0KCQkgICAgLy8gQ29sIDMuIFF1YW50aXR5IHRvIGJlIHNoaXBwZWQNCgkgICAgY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkgICAgIjxpbnB1dCB0eXBlPVwidGV4dFwiIGlkPVwiIiArIHJlcWlkICsgIlNocFF0eVwiIG5hbWU9XCIiICsgcmVxaWQgKyAiU2hwUXR5XCIgdmFsdWU9XCIiICsgUmVtUXR5ICsgIlwiPjwvaW5wdXQ+IjsNCg0KCQkgICAgLy8gQ29sIDQuIFF1YW50aXR5IHNoaXBtZW50IGluaXRpYXRlZCAoaGlkZGVuIGZvciB1cGRhdGUgbGF0ZXIpDQoJICAgIGNyZWF0ZVRhZyh0ciwidGQiLCBbXSkuaW5uZXJIVE1MID0NCgkJICAgICI8aW5wdXQgdHlwZT1cImhpZGRlblwiIGlkPVwiIiArIHJlcWlkICsgIlNoaXBJbml0UXR5XCIgbmFtZT1cIiIgKyByZXFpZCArICJTaGlwSW5pdFF0eVwiIHZhbHVlPVwiIiArIFNoaXBJbml0UXR5ICsgIlwiPjwvaW5wdXQ+IjsNCg0KCQkgICAgLy8gQ29sIDUuIFN0YXR1cyBNZXNzYWdlDQoJICAgIGNyZWF0ZVRhZyh0ciwidGQiLCBbXSkuaW5uZXJIVE1MID0NCgkJICAgICI8ZGl2IGlkPVwiIiArIHJlcWlkICsgIkVyck1zZ1wiIG5hbWU9XCIiICsgcmVxaWQgKyAiRXJyTXNnXCI+PC9kaXY+IjsNCg0KCQkgICAgLy8gQ29sIDUuIEhpZGRlbiBmaWVsZCB0byBnZXQgYSBoYW5kbGUgb24gdGhlIGVudGlyZSByb3cuIE5vIFVJIHB1cnBvc2UNCgkgICAgY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkgICAgIjxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgaWQ9XCJyb3dpZFwiIG5hbWU9XCJyb3dpZFwiPjwvaW5wdXQ+IjsNCg0KCSAgICByb3djbnQgKz0gMTsNCgkgICAgfQ0KCX0NCiAgICBpZiAocm93Y250ID09IDApDQogICAgCXsNCgkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDUiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YWl0bXNnJykuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nOyANCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2FpdG1zZycpLnN0eWxlLmhlaWdodCA9IDA7IA0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1BSU2hwX0RyYXdIZWFkZXIodGEpDQp7DQogICAgdmFyIHRyID0gbWFrZVJvdyh7J2NsYXNzJzonaGVhZGVyUm93J30pOw0KICAgIHRhLmFwcGVuZENoaWxkKHRyKTsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnfSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIGhyZWY9XCIjXCIgdGl0bGU9XCJcIj4iK1NWTVhJX0dldE1lc3NhZ2UoIkxBQjAwNSIpKyI8L2E+IjsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnLCdhbGlnbic6J3JpZ2h0J30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMDYiKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJywnYWxpZ24nOidyaWdodCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDA3IikrIjwvYT4iOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1BSU2hwX1ZhbGlkYXRlQW5kUHJvY2VzcygpDQp7DQogICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1snQ3JlYXRlU2hpcG1lbnRGcm9tUFInXTsNCg0KDQogICAgdmFyIHNvYmplY3RMaXN0ID0gbmV3IEFycmF5KCk7DQogICAgZm9yIChpID0gMDsgaSA8IGZvcm0uZWxlbWVudHMubGVuZ3RoOyBpKyspDQoJew0KCWlmIChmb3JtLmVsZW1lbnRzW2ldLm5hbWUgPT0gJ3Jvd2lkJykJCS8vIE5lZWQgYW4gaWRlbnRpZmllciB0byBwcm9jZXNzIGVhY2ggcm93IG9ubHkgb25jZQ0KCSAgICB7DQoJICAgIHZhciBwbiA9IGZvcm0uZWxlbWVudHNbaV0ucGFyZW50Tm9kZTsNCgkgICAgdmFyIHBwbiA9IGZvcm0uZWxlbWVudHNbaV0ucGFyZW50Tm9kZS5wYXJlbnROb2RlOw0KCSAgICBpZiAocHBuLnNvYmplY3QpDQoJCXsNCgkJc29iamVjdExpc3QucHVzaChwcG4uc29iamVjdCk7DQoJCX0NCgkgICAgfQ0KCX0NCg0KICAgIHZhciBpbnZhbGlkID0gZmFsc2U7DQogICAgdmFyIHNraXBjbnQgPSAwOw0KICAgIGZvciAodmFyIGsgPSAwOyBrIDwgc29iamVjdExpc3QubGVuZ3RoOyBrKyspDQogICAgCXsNCgl2YXIgcmVjX2ludmFsaWQgPSBmYWxzZTsNCgl2YXIgcmVjID0gc29iamVjdExpc3Rba107DQoJdmFyIFJlbVF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJSZW1RdHkiKS52YWx1ZSk7DQoJdmFyIFNocFF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJTaHBRdHkiKS52YWx1ZSk7DQoJdmFyIEVyck1zZyA9ICIiOw0KCWlmIChpc05hTihTaHBRdHkpIHx8IFNocFF0eSA8IDApDQoJICAgIHsNCgkgICAgRXJyTXNnID0gU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA2Iik7IA0KCSAgICByZWNfaW52YWxpZCA9IHRydWU7DQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICB9DQoJZWxzZSBpZiAoU2hwUXR5ID09IDApDQoJICAgIHsNCgkgICAgc2tpcGNudCArPSAxOw0KCSAgICB9DQoJZWxzZSBpZihTaHBRdHkgPiBSZW1RdHkpDQoJICAgIHsNCgkgICAgRXJyTXNnID1TVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDciKTsgDQoJICAgIHJlY19pbnZhbGlkID0gdHJ1ZTsNCgkgICAgaW52YWxpZCA9IHRydWU7DQoJICAgIH0NCglpZiAocmVjX2ludmFsaWQpDQoJICAgIHsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5zdHlsZS5ib3JkZXIgPSAiI0ZGMDAwMCAycHggc29saWQiOw0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkVyck1zZyIpLmlubmVySFRNTCA9IEVyck1zZzsNCgkgICAgfQ0KCWVsc2UNCgkgICAgew0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkVyck1zZyIpLnN0eWxlLmJvcmRlciA9ICIwIjsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5pbm5lckhUTUwgPSAiIjsNCgkgICAgfQ0KCX0NCiAgICBpZihpbnZhbGlkKSB7IHJldHVybjsgfQ0KDQogICAgaWYoc2tpcGNudCA9PSBzb2JqZWN0TGlzdC5sZW5ndGgpDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDgiKSk7DQoJcmV0dXJuOw0KCX0NCg0KICAgIGlmIChTVk1YSV9QUlNocF9DcmVhdGVTaGlwbWVudE9yZGVyKHNvYmplY3RMaXN0KSkNCiAgICAJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwOSIpKTsNCgl3aW5kb3cub3BlbmVyLmxvY2F0aW9uID0gIi8iICsgU0hQUl9TaGlwbWVudE9yZGVySWQ7DQoJQ2xvc2VXaW5kb3coKTsNCgl9DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUFJTaHBfQ3JlYXRlU2hpcG1lbnRPcmRlcihzb2JqZWN0TGlzdCkNCnsNCiAgICAvLyBHZXQgU2FsZXNmb3JjZSBpbnRlcm5hbCBSZWNvcmQgVHlwZSBJRCBmb3IgUk1BIEhlYWRlciAiU2hpcG1lbnQiDQogICAgdmFyIHNvcWwgPSAiU0VMRUNUIElkIEZST00gUmVjb3JkVHlwZSBXSEVSRSBTb2JqZWN0VHlwZSA9ICdTVk1YQ19fUk1BX1NoaXBtZW50X09yZGVyX19jJyBBTkQgTmFtZSA9ICdTaGlwbWVudCciDQogICAgdmFyIHF1ZXJ5UmVzdWx0ID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbCk7IA0KICAgIHZhciBydHJlY29yZHMgPSBxdWVyeVJlc3VsdC5nZXRBcnJheSgicmVjb3JkcyIpOw0KICAgIGlmIChydHJlY29yZHMubGVuZ3RoID09IDApIHsgICAgICAgIA0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMCIpKTsgDQogICAgICAgIHdpbmRvdy5jbG9zZSgpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIHZhciBTaGlwbWVudEhkclJlY29yZFR5cGUgPSBydHJlY29yZHNbMF0uSWQ7DQoNCiAgICAvLyBHZXQgU2FsZXNmb3JjZSBpbnRlcm5hbCBSZWNvcmQgVHlwZSBJRCBmb3IgUk1BIExpbmUgIlNoaXBtZW50Ig0KICAgIHZhciBzb3FsID0gIlNFTEVDVCBJZCBGUk9NIFJlY29yZFR5cGUgV0hFUkUgU29iamVjdFR5cGUgPSAnU1ZNWENfX1JNQV9TaGlwbWVudF9MaW5lX19jJyBBTkQgTmFtZSA9ICdTaGlwbWVudCciDQogICAgdmFyIHF1ZXJ5UmVzdWx0ID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbCk7IA0KICAgIHZhciBydHJlY29yZHMgPSBxdWVyeVJlc3VsdC5nZXRBcnJheSgicmVjb3JkcyIpOw0KICAgIGlmIChydHJlY29yZHMubGVuZ3RoID09IDApIHsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTAiKSk7IA0KCXdpbmRvdy5jbG9zZSgpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIHZhciBTaGlwbWVudExpbmVSZWNvcmRUeXBlID0gcnRyZWNvcmRzWzBdLklkOw0KICAgIHZhciBjdXJkYXRlID0gbmV3IERhdGUoKTsNCg0KICAgIHZhciBzaHBIZHIgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MiKTsNCiAgICBzaHBIZHIuUmVjb3JkVHlwZUlkID0gU2hpcG1lbnRIZHJSZWNvcmRUeXBlOw0KICAgIHNocEhkci5TVk1YQ19fQ29tcGFueV9fYyA9IFNIUFJfQ29tcGFueUlkOw0KICAgIHNocEhkci5TVk1YQ19fT3JkZXJfU3RhdHVzX19jID0gIk9wZW4iOw0KICAgIHNocEhkci5TVk1YQ19fRXhwZWN0ZWRfRGVsaXZlcnlfRGF0ZV9fYyA9IHNvYmplY3RMaXN0WzBdLlNWTVhDX19EYXRlX1JlcXVpcmVkX19jOw0KICAgIHNocEhkci5TVk1YQ19fU291cmNlX0xvY2F0aW9uX19jID0gU0hQUl9SZXF1ZXN0ZWRGcm9tSWQ7DQogICAgc2hwSGRyLlNWTVhDX19EZXN0aW5hdGlvbl9Mb2NhdGlvbl9fYyA9IFNIUFJfUmVxdWlyZWRBdElkOw0KICAgIHNocEhkci5TVk1YQ19fU2VydmljZV9FbmdpbmVlcl9fYyA9IFNIUFJfT3duZXJJZDsNCiAgICBzaHBIZHIuU1ZNWENfX1BhcnRzX1JlcXVlc3RfX2MgPSBTSFBSX1JlcXVlc3RJZDsNCiAgICBzaHBIZHIuU1ZNWENfX1NoaXBwaW5nX1JlY2VpdmluZ19Ob3Rlc19fYyA9IFNIUFJfQWRkbEluZm87DQogICAgdHJ5IHsNCiAgICAgICAgdmFyIHJldCA9IHNmb3JjZS5jb25uZWN0aW9uLmNyZWF0ZShbc2hwSGRyXSk7IA0KCQlpZiAocmV0WzBdLmdldEJvb2xlYW4oInN1Y2Nlc3MiKSkgDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3JldHVybiByZXRbMF0uaWQ7ICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIH0gDQogICAgICAgICAgICAgICAgZWxzZSANCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KHJldFswXS5lcnJvcnMubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcmV0dXJuIG51bGw7DQogICAgICAgICAgICAgICAgfSAgDQoJCX0NCiAgICBjYXRjaChlcnJvcikgew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMSIpKyJcbiIrIGVycm9yKTsgICAgICAgICAgICAgIA0KICAgIH0NCiAgICBTSFBSX1NoaXBtZW50T3JkZXJJZCA9IHJldFswXS5pZDsNCg0KICAgIC8vIGJ1aWxkIGFuIGFycmF5IG9mIHNoaXBtZW50IGxpbmVzDQogICAgdmFyIHNocGxpbmVzID0gbmV3IEFycmF5KCk7DQogICAgdmFyIHJlcWxpbmVzID0gbmV3IEFycmF5KCk7DQogICAgZm9yICh2YXIgayA9IDA7IGsgPCBzb2JqZWN0TGlzdC5sZW5ndGg7IGsrKykNCiAgICAJew0KCXZhciByZWMgPSBzb2JqZWN0TGlzdFtrXTsNCgl2YXIgU2hwUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlNocFF0eSIpLnZhbHVlKTsNCgl2YXIgUmVtUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlJlbVF0eSIpLnZhbHVlKTsNCgl2YXIgU2hpcEluaXRRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiU2hpcEluaXRRdHkiKS52YWx1ZSk7DQoNCglpZiAoU2hwUXR5ID09IDApIHsgY29udGludWU7IH0JCS8vIEl0ZW0gbm90IHNoaXBwZWQuIFNraXAuDQoNCgl2YXIgc2hwTGluZSA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1JNQV9TaGlwbWVudF9MaW5lX19jIik7DQogICAgICAgIHNocExpbmUuU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYyA9IFNIUFJfU2hpcG1lbnRPcmRlcklkOw0KICAgICAgICBzaHBMaW5lLlJlY29yZFR5cGVJZCA9IFNoaXBtZW50TGluZVJlY29yZFR5cGU7DQogICAgICAgIHNocExpbmUuU1ZNWENfX1Byb2R1Y3RfX2MgPSByZWMuU1ZNWENfX1Byb2R1Y3RfX2M7DQogICAgICAgIHNocExpbmUuU1ZNWENfX0V4cGVjdGVkX1NoaXBfRGF0ZV9fYyA9IHJlYy5TVk1YQ19fRGF0ZV9SZXF1aXJlZF9fYzsNCgkJc2hwTGluZS5TVk1YQ19fRXhwZWN0ZWRfUXVhbnRpdHkyX19jID0gU2hwUXR5Ow0KICAgICAgICBzaHBMaW5lLlNWTVhDX19TaGlwX0xvY2F0aW9uX19jID0gU0hQUl9SZXF1aXJlZEF0SWQ7DQogICAgICAgIHNocExpbmUuU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gIk9wZW4iOw0KICAgICAgICBzaHBMaW5lLlNWTVhDX19MaW5lX1R5cGVfX2MgPSAiT3V0Ym91bmQgKFNoaXBtZW50KSI7DQogICAgICAgIHNocExpbmUuU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYyA9IHJlYy5JZDsNCiAgICAgICAgc2hwTGluZS5TVk1YQ19fUG9zdGVkX1RvX0ludmVudG9yeV9fYyA9IGZhbHNlOw0KICAgICAgICBzaHBMaW5lLlNWTVhDX19QYWNraW5nX0luc3RydWN0aW9uc19fYyA9IHJlYy5TVk1YQ19fQWRkaXRpb25hbF9JbmZvcm1hdGlvbl9fYzsNCiAgICAgICAgc2hwTGluZS5TVk1YQ19fU2VydmljZV9FbmdpbmVlcl9fYyA9IFNIUFJfT3duZXJJZDsNCgkJc2hwTGluZS5TVk1YQ19fTGluZV9QcmljZTJfX2MgPSByZWMuU1ZNWENfX1VuaXRfUHJpY2UyX19jOyAvL0J5IEdtIDE4SnVuMDggDQoJCXNocExpbmUuU1ZNWENfX1VzZV9QcmljZV9Gcm9tX1ByaWNlYm9va19fYyA9ICJGYWxzZSI7IC8vQlkgR00gMThKdW4wOA0KCXNocGxpbmVzLnB1c2goc2hwTGluZSk7DQoNCgl2YXIgcmVxbGluZSA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYyIpOw0KCXJlcWxpbmUuSWQgPSByZWMuSWQ7DQoJcmVxbGluZS5TVk1YQ19fUXVhbnRpdHlfU2hpcG1lbnRfSW5pdGlhdGVkMl9fYyA9IFNoaXBJbml0UXR5ICsgU2hwUXR5Ow0KCXJlcWxpbmVzLnB1c2gocmVxbGluZSk7DQoJfQ0KDQogICAgdHJ5IHsNCglzZm9yY2UuY29ubmVjdGlvbi5jcmVhdGUoc2hwbGluZXMpOw0KCX0NCiAgICBjYXRjaCAoZSkgewkJDQoJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMiIpKyJcbiIrIGUpOyAgICAgICAgICAgICAgDQoJCXJldHVybiBmYWxzZTsNCiAgICAJfQ0KDQogICAgLy8gVXBkYXRlIHRoZSBwYXJ0cyByZXF1ZXN0IGxpbmVzIHdpdGggc2hpcG1lbnQgaW5pdGlhdGVkIHF1YW50aXR5DQogICAgdHJ5IHsNCglzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUocmVxbGluZXMpOw0KCX0NCiAgICBjYXRjaCAoZSkgew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMSIpICsgIlxuIiArIGUpOw0KCXJldHVybiBmYWxzZTsNCiAgICAJfQ0KICAgIHJldHVybiB0cnVlOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1NWT1NocF9TaG93U2NyZWVuKHNlcnZJZCwgdUlkKQ0Kew0KDQoJU1ZNWElfSW5pdE1lc3NhZ2VMaXN0KCJXT1JEU0M1Iik7DQoJU1ZNWElfU2V0TGFiZWxzKCJDcmVhdGVTaGlwbWVudEZyb21TVk8iKTsNCg0KICAgIFNIU1ZPX1NWT0lkID0gc2VydklkOw0KICAgIFNIU1ZPX1VzZXJJZCA9IHVJZDsNCg0KICAgIC8vIEdldCBTZXJ2aWNlIE9yZGVyIGhlYWRlciBpbmZvDQogICAgdmFyIHNvcWwxID0gIlNFTEVDVCBPd25lcklkLCBTVk1YQ19fQ29tcGFueV9fYywgU1ZNWENfX0Nhc2VfX2MsIFNWTVhDX19Db250YWN0X19jLCBTVk1YQ19fT3JkZXJfU3RhdHVzX19jIEZST00gU1ZNWENfX1NlcnZpY2VfT3JkZXJfX2MgV0hFUkUgSWQgPSAnIiArIFNIU1ZPX1NWT0lkICsgIiciOw0KICAgIHZhciBxcjEgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMSk7DQogICAgaWYgKHFyMS5zaXplIDw9IDApDQoJewkgDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAyIikgKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgdmFyIHJlYzEgPSBxcjEuZ2V0QXJyYXkoInJlY29yZHMiKTsNCiAgICBpZiAocmVjMVswXS5TVk1YQ19fT3JkZXJfU3RhdHVzX19jID09ICJDbG9zZWQiKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAzIikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBpZiAocmVjMVswXS5TVk1YQ19fT3JkZXJfU3RhdHVzX19jID09ICJDYW5jZWxlZCIpDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDQiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIFNIU1ZPX0NvbXBhbnlJZCA9IHJlYzFbMF0uU1ZNWENfX0NvbXBhbnlfX2M7DQogICAgU0hTVk9fQ2FzZUlkID0gcmVjMVswXS5TVk1YQ19fQ2FzZV9fYzsNCiAgICBTSFNWT19Db250YWN0SWQgPSByZWMxWzBdLlNWTVhDX19Db250YWN0X19jOw0KICAgIFNIU1ZPX093bmVySWQgPSByZWMxWzBdLk93bmVySWQ7DQoNCiAgICAvLyBHZXQgU2FsZXNmb3JjZSBpbnRlcm5hbCBSZWNvcmQgVHlwZSBJRCBmb3IgU1ZPIExpbmUgIlJlcXVlc3QvUmVjZWlwdCINCiAgICB2YXIgc29xbDIgPSAiU0VMRUNUIElkIEZST00gUmVjb3JkVHlwZSBXSEVSRSBTb2JqZWN0VHlwZSA9ICdTVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jJyBBTkQgTmFtZSA9ICdSZXF1ZXN0L1JlY2VpcHQnIg0KICAgIHZhciBxcjIgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMik7IA0KICAgIGlmIChxcjIuc2l6ZSA8PSAwKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEwIikpOyAgICAgICAgICAgICAgDQogICAgICAgIHdpbmRvdy5jbG9zZSgpOw0KICAgICAgICByZXR1cm47DQoJfQ0KICAgIHZhciByZWMyID0gcXIyLmdldEFycmF5KCJyZWNvcmRzIik7DQoNCiAgICAvLyBHZXQgb3BlbiBTZXJ2aWNlIE9yZGVyIGxpbmVzDQogICAgdmFyIHNvcWwzID0gIlNFTEVDVCBJZCwgU1ZNWENfX1JlcXVlc3RlZF9Mb2NhdGlvbl9fYyxTVk1YQ19fUmVxdWVzdGVkX0xvY2F0aW9uX19yLk5hbWUgIiArDQoJCSJGUk9NIFNWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2MgV0hFUkUgU1ZNWENfX1NlcnZpY2VfT3JkZXJfX2MgPSAnIiArIFNIU1ZPX1NWT0lkICsgIicgQU5EICIgKw0KCQkiU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gJ09wZW4nIEFORCBSZWNvcmRUeXBlSWQgPSAnIiArIHJlYzJbMF0uSWQgKyAiJyI7DQogICAgdHJ5IHsNCiAgICB2YXIgcXIzID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDMpOw0KICAgIH0gY2F0Y2ggKGUpIHsgYWxlcnQoZSk7IH0NCiAgICBpZiAocXIzLnNpemUgPD0gMCkNCgl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA1IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICB2YXIgUmVxdWlyZWRBdCA9IGZhbHNlOw0KICAgIHZhciByZWNjbnQgPSAwOw0KICAgIHZhciBrID0gMDsNCiAgICB2YXIgcmVjMyA9IG5ldyBzZm9yY2UuUXVlcnlSZXN1bHRJdGVyYXRvcihxcjMpOw0KICAgIHZhciBMb2NMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkxvY2F0aW9uTGlzdCIpOw0KICAgIHdoaWxlKHJlYzMuaGFzTmV4dCgpKQ0KICAgIAl7DQoJdmFyIHN2b2xpbmUgPSByZWMzLm5leHQoKTsNCglpZiAoc3ZvbGluZS5TVk1YQ19fUmVxdWVzdGVkX0xvY2F0aW9uX19jKQ0KCSAgICB7DQoJICAgIHZhciBza2lwID0gZmFsc2U7DQoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgTG9jTGlzdC5sZW5ndGg7IGkrKykNCgkJew0KCQlpZiAoTG9jTGlzdFtpXS52YWx1ZSA9PSBzdm9saW5lLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2MpDQoJCSAgICB7DQoJCSAgICBza2lwID0gdHJ1ZTsNCgkJICAgIGJyZWFrOw0KCQkgICAgfQ0KCQl9DQoJICAgIGlmICghc2tpcCkNCgkJew0KCQlsb2MgPSBuZXcgT3B0aW9uKHN2b2xpbmUuU1ZNWENfX1JlcXVlc3RlZF9Mb2NhdGlvbl9fci5OYW1lLCBzdm9saW5lLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2MpOw0KCQlMb2NMaXN0Lm9wdGlvbnNbaysrXSA9IGxvYzsNCgkJcmVjY250ICs9IDE7DQoJCX0NCgkgICAgfQ0KCWlmIChzdm9saW5lLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2MgJiYgIVNIU1ZPX1JlcXVpcmVkQXRJZCkNCgkgICAgew0KCSAgICBTSFNWT19SZXF1aXJlZEF0SWQgPSBzdm9saW5lLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2M7DQoJICAgIFJlcXVpcmVkQXQgPSB0cnVlOw0KCSAgICB9DQoJfQ0KDQogICAgaWYgKHJlY2NudCA9PSAwKQ0KICAgIAl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA2IikpOw0KICAgICAgICB3aW5kb3cuY2xvc2UoKTsNCiAgICAgICAgcmV0dXJuOw0KCX0NCg0KICAgIGlmICghUmVxdWlyZWRBdCkNCiAgICAJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNyIpKTsNCiAgICAgICAgd2luZG93LmNsb3NlKCk7DQogICAgICAgIHJldHVybjsNCgl9DQoNCiAgICBpZiAocmVjY250ID09IDEpCQkvLyBJZiBvbmx5IG9uZSBsb2NhdGlvbiBpcyBhdmFpbGFibGUsIHByZS1zZWxlY3QgaXQNCgl7DQoJTG9jTGlzdC5zZWxlY3RlZEluZGV4ID0gMDsNCglTVk1YSV9TVk9TaHBfU2hvd1Byb2R1Y3RzRm9yTG9jYXRpb24oTG9jTGlzdCk7DQoJfQ0KICAgIGVsc2UgeyBMb2NMaXN0LnNlbGVjdGVkSW5kZXggPSAtMTsgfQ0KDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dhaXRtc2cnKS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7IA0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YWl0bXNnJykuc3R5bGUuaGVpZ2h0ID0gMDsgDQoNCiAgICByZXR1cm47DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfU1ZPU2hwX1Nob3dQcm9kdWN0c0ZvckxvY2F0aW9uKExvY0xpc3QpDQp7DQogICAgaWYgKExvY0xpc3Quc2VsZWN0ZWRJbmRleCA8IDApIHsgcmV0dXJuOyB9CQkvLyBqdXN0IHRvIGJlIHNhZmUNCg0KICAgIC8vIEdldCBvcGVuIFNlcnZpY2UgT3JkZXIgbGluZXMNCiAgICB2YXIgc29xbDIgPSAiU0VMRUNUIElkLCBTVk1YQ19fU2VydmljZV9PcmRlcl9fYywgU1ZNWENfX1Byb2R1Y3RfX2MsIFNWTVhDX19Qcm9kdWN0X19yLk5hbWUsIFNWTVhDX19SZXF1ZXN0ZWRfUXVhbnRpdHkyX19jLCAiICsNCiAgICAJCSJTVk1YQ19fRGF0ZV9SZXF1ZXN0ZWRfX2MsIFNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jLCBTVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MsIFNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2MgIiArDQoJCSJGUk9NIFNWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2MgV0hFUkUgU1ZNWENfX1NlcnZpY2VfT3JkZXJfX2MgPSAnIiArIFNIU1ZPX1NWT0lkICsgIicgQU5EICIgKw0KCQkiU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gJ09wZW4nIEFORCBTVk1YQ19fUmVxdWVzdGVkX0xvY2F0aW9uX19jID0gJyIgKyBMb2NMaXN0W0xvY0xpc3Quc2VsZWN0ZWRJbmRleF0udmFsdWUgKyAiJyI7DQogICAgdHJ5IHsNCiAgICB2YXIgcXIyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDIpOw0KICAgIH0gY2F0Y2ggKGUpIHsgYWxlcnQoZSk7IH0NCiAgICBpZiAocXIyLnNpemUgPD0gMCkNCgl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA4IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICB2YXIgcmVxcmVjcyA9IG5ldyBzZm9yY2UuUXVlcnlSZXN1bHRJdGVyYXRvcihxcjIpOw0KDQogICAgdmFyIHJvd2NudCA9IDA7DQogICAgdmFyIHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpc3RfdGJvZHkiKTsNCg0KICAgIFNWTVhJX1NWT1NocF9EcmF3SGVhZGVyKHRib2R5KTsNCg0KICAgIHdoaWxlKHJlcXJlY3MuaGFzTmV4dCgpKQ0KCXsNCgl2YXIgcmVxcmVjID0gcmVxcmVjcy5uZXh0KCk7DQoJdmFyIHJlcWlkID0gcmVxcmVjLklkOw0KCXZhciBwcm9kaWQgPSByZXFyZWMuU1ZNWENfX1Byb2R1Y3RfX2M7DQoJdmFyIFJlcVF0eSA9IHBhcnNlRmxvYXQocmVxcmVjLlNWTVhDX19SZXF1ZXN0ZWRfUXVhbnRpdHkyX19jKTsNCg0KCWlmIChyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MgPT0gbnVsbCB8fCBpc05hTihyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MpKQ0KCSAgICB2YXIgU2hpcEluaXRRdHkgPSAwOw0KCWVsc2UNCgkgICAgdmFyIFNoaXBJbml0UXR5ID0gcGFyc2VGbG9hdChyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MpOw0KDQoJdmFyIFJlbVF0eSA9IFJlcVF0eS1TaGlwSW5pdFF0eTsNCg0KCWlmIChSZW1RdHkgPiAwKQ0KCSAgICB7DQoJICAgIHZhciB0ciA9IG1ha2VSb3cobWFrZUF0dHJzKHJvd2NudCx0Ym9keSkgKTsNCgkgICAgdHIuc29iamVjdCA9IHJlcXJlYzsNCgkgICAgdGJvZHkuYXBwZW5kQ2hpbGQodHIpOw0KDQoJCSAgICAvLyBDb2wgMS4gUHJvZHVjdCBOYW1lDQoJICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsic2NvcGUiOiJyb3cifSkuaW5uZXJIVE1MID0NCgkJICAgICI8YSB0YXJnZXQ9X2JsYW5rIGhyZWY9XCIvIiArIHByb2RpZCArICJcIj4iICsgcHJvZGlkID8gcmVxcmVjLlNWTVhDX19Qcm9kdWN0X19yLk5hbWUgOiAiVW5rbm93biIgKyAiPC9hPiI7DQoNCgkJICAgIC8vIENvbCAyLiBSZW1haW5pbmcgUXVhbnRpdHkNCgkgICAgY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkgICAgIjxpbnB1dCBkaXNhYmxlZD1cInRydWVcIiB0eXBlPVwidGV4dFwiIGlkPVwiIiArIHJlcWlkICsgIlJlbVF0eVwiIG5hbWU9XCIiICsgcmVxaWQgKyAiUmVtUXR5XCIgdmFsdWU9XCIiICsgUmVtUXR5ICsgIlwiPjwvaW5wdXQ+IjsNCg0KCQkgICAgLy8gQ29sIDMuIFF1YW50aXR5IHRvIGJlIHNoaXBwZWQNCgkgICAgY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkgICAgIjxpbnB1dCB0eXBlPVwidGV4dFwiIGlkPVwiIiArIHJlcWlkICsgIlNocFF0eVwiIG5hbWU9XCIiICsgcmVxaWQgKyAiU2hwUXR5XCIgdmFsdWU9XCIiICsgUmVtUXR5ICsgIlwiPjwvaW5wdXQ+IjsNCg0KCQkgICAgLy8gQ29sIDQuIFF1YW50aXR5IHNoaXBtZW50IGluaXRpYXRlZCAoaGlkZGVuIGZvciB1cGRhdGUgbGF0ZXIpDQoJICAgIGNyZWF0ZVRhZyh0ciwidGQiLCBbXSkuaW5uZXJIVE1MID0NCgkJICAgICI8aW5wdXQgdHlwZT1cImhpZGRlblwiIGlkPVwiIiArIHJlcWlkICsgIlNoaXBJbml0UXR5XCIgbmFtZT1cIiIgKyByZXFpZCArICJTaGlwSW5pdFF0eVwiIHZhbHVlPVwiIiArIFNoaXBJbml0UXR5ICsgIlwiPjwvaW5wdXQ+IjsNCg0KCQkgICAgLy8gQ29sIDUuIFN0YXR1cyBNZXNzYWdlDQoJICAgIGNyZWF0ZVRhZyh0ciwidGQiLCBbXSkuaW5uZXJIVE1MID0NCgkJICAgICI8ZGl2IGlkPVwiIiArIHJlcWlkICsgIkVyck1zZ1wiIG5hbWU9XCIiICsgcmVxaWQgKyAiRXJyTXNnXCI+PC9kaXY+IjsNCg0KCQkgICAgLy8gQ29sIDUuIEhpZGRlbiBmaWVsZCB0byBnZXQgYSBoYW5kbGUgb24gdGhlIGVudGlyZSByb3cuIE5vIFVJIHB1cnBvc2UNCgkgICAgY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkgICAgIjxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgaWQ9XCJyb3dpZFwiIG5hbWU9XCJyb3dpZFwiPjwvaW5wdXQ+IjsNCg0KCSAgICByb3djbnQgKz0gMTsNCgkgICAgfQ0KCX0NCiAgICBpZiAocm93Y250ID09IDApDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDgiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1NWT1NocF9EcmF3SGVhZGVyKHRhKQ0Kew0KICAgIGNsZWFyX3RhYmxlKG51bGwpOw0KDQogICAgdmFyIHRyID0gbWFrZVJvdyh7J2NsYXNzJzonaGVhZGVyUm93J30pOw0KICAgIHRhLmFwcGVuZENoaWxkKHRyKTsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnfSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIGhyZWY9XCIjXCIgdGl0bGU9XCJcIj4iK1NWTVhJX0dldE1lc3NhZ2UoIkxBQjAwNSIpKyI8L2E+IjsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnLCdhbGlnbic6J3JpZ2h0J30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMDYiKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJywnYWxpZ24nOidyaWdodCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDA3IikrIjwvYT4iOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1NWT1NocF9WYWxpZGF0ZUFuZFByb2Nlc3MoKQ0Kew0KICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiTG9jYXRpb25MaXN0Iikuc2VsZWN0ZWRJbmRleCA8IDApDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTEiKSk7DQoJcmV0dXJuOw0KCX0NCg0KICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbJ0NyZWF0ZVNoaXBtZW50RnJvbVNWTyddOw0KDQogICAgdmFyIHNvYmplY3RMaXN0ID0gbmV3IEFycmF5KCk7DQogICAgZm9yIChpID0gMDsgaSA8IGZvcm0uZWxlbWVudHMubGVuZ3RoOyBpKyspDQoJew0KCWlmIChmb3JtLmVsZW1lbnRzW2ldLm5hbWUgPT0gJ3Jvd2lkJykJCS8vIE5lZWQgYW4gaWRlbnRpZmllciB0byBwcm9jZXNzIGVhY2ggcm93IG9ubHkgb25jZQ0KCSAgICB7DQoJICAgIHZhciBwbiA9IGZvcm0uZWxlbWVudHNbaV0ucGFyZW50Tm9kZTsNCgkgICAgdmFyIHBwbiA9IGZvcm0uZWxlbWVudHNbaV0ucGFyZW50Tm9kZS5wYXJlbnROb2RlOw0KCSAgICBpZiAocHBuLnNvYmplY3QpDQoJCXsNCgkJc29iamVjdExpc3QucHVzaChwcG4uc29iamVjdCk7DQoJCX0NCgkgICAgfQ0KCX0NCg0KICAgIHZhciBpbnZhbGlkID0gZmFsc2U7DQogICAgdmFyIHNraXBjbnQgPSAwOw0KICAgIGZvciAodmFyIGsgPSAwOyBrIDwgc29iamVjdExpc3QubGVuZ3RoOyBrKyspDQogICAgCXsNCgl2YXIgcmVjX2ludmFsaWQgPSBmYWxzZTsNCgl2YXIgcmVjID0gc29iamVjdExpc3Rba107DQoJdmFyIFJlbVF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJSZW1RdHkiKS52YWx1ZSk7DQoJdmFyIFNocFF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJTaHBRdHkiKS52YWx1ZSk7DQoJdmFyIEVyck1zZyA9ICIiOw0KCWlmIChpc05hTihTaHBRdHkpIHx8IFNocFF0eSA8IDApDQoJICAgIHsNCgkgICAgRXJyTXNnID0gU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEyIik7IA0KCSAgICByZWNfaW52YWxpZCA9IHRydWU7DQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICB9DQoJZWxzZSBpZiAoU2hwUXR5ID09IDApDQoJICAgIHsNCgkgICAgc2tpcGNudCArPSAxOw0KCSAgICB9DQoJZWxzZSBpZihTaHBRdHkgPiBSZW1RdHkpDQoJICAgIHsNCgkgICAgRXJyTXNnID1TVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTMiKTsgDQoJICAgIHJlY19pbnZhbGlkID0gdHJ1ZTsNCgkgICAgaW52YWxpZCA9IHRydWU7DQoJICAgIH0NCglpZiAocmVjX2ludmFsaWQpDQoJICAgIHsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5zdHlsZS5ib3JkZXIgPSAiI0ZGMDAwMCAycHggc29saWQiOw0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkVyck1zZyIpLmlubmVySFRNTCA9IEVyck1zZzsNCgkgICAgfQ0KCWVsc2UNCgkgICAgew0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkVyck1zZyIpLnN0eWxlLmJvcmRlciA9ICIwIjsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5pbm5lckhUTUwgPSAiIjsNCgkgICAgfQ0KCX0NCiAgICBpZihpbnZhbGlkKSB7IHJldHVybjsgfQ0KDQogICAgaWYoc2tpcGNudCA9PSBzb2JqZWN0TGlzdC5sZW5ndGgpDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTQiKSk7DQoJcmV0dXJuOw0KCX0NCg0KICAgIGlmIChTVk1YSV9TVk9TaHBfQ3JlYXRlU2hpcG1lbnRPcmRlcihzb2JqZWN0TGlzdCkpDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTUiKSk7DQoJd2luZG93Lm9wZW5lci5sb2NhdGlvbiA9ICIvIiArIFNoaXBtZW50T3JkZXJJZDsNCglDbG9zZVdpbmRvdygpOw0KCX0NCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9TVk9TaHBfQ3JlYXRlU2hpcG1lbnRPcmRlcihzb2JqZWN0TGlzdCkNCnsNCiAgICB2YXIgTG9jTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJMb2NhdGlvbkxpc3QiKTsNCiAgICB2YXIgaWR4ID0gTG9jTGlzdC5zZWxlY3RlZEluZGV4Ow0KICAgIHZhciBTb3VyY2VMb2NJZCA9IExvY0xpc3RbaWR4XS52YWx1ZTsNCg0KICAgIC8vIEdldCBTYWxlc2ZvcmNlIGludGVybmFsIFJlY29yZCBUeXBlIElEIGZvciBSTUEgSGVhZGVyICJTaGlwbWVudCINCiAgICB2YXIgc29xbCA9ICJTRUxFQ1QgSWQgRlJPTSBSZWNvcmRUeXBlIFdIRVJFIFNvYmplY3RUeXBlID0gJ1NWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MnIEFORCBOYW1lID0gJ1NoaXBtZW50JyINCiAgICB2YXIgcXVlcnlSZXN1bHQgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsKTsgDQogICAgdmFyIHJ0cmVjb3JkcyA9IHF1ZXJ5UmVzdWx0LmdldEFycmF5KCJyZWNvcmRzIik7DQogICAgaWYgKHJ0cmVjb3Jkcy5sZW5ndGggPT0gMCkgeyAgICAgICANCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTAiKSk7DQogICAgICAgIHdpbmRvdy5jbG9zZSgpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIHZhciBTaGlwbWVudEhkclJlY29yZFR5cGUgPSBydHJlY29yZHNbMF0uSWQ7DQoNCiAgICAvLyBHZXQgU2FsZXNmb3JjZSBpbnRlcm5hbCBSZWNvcmQgVHlwZSBJRCBmb3IgUk1BIExpbmUgIlNoaXBtZW50Ig0KICAgIHZhciBzb3FsID0gIlNFTEVDVCBJZCBGUk9NIFJlY29yZFR5cGUgV0hFUkUgU29iamVjdFR5cGUgPSAnU1ZNWENfX1JNQV9TaGlwbWVudF9MaW5lX19jJyBBTkQgTmFtZSA9ICdTaGlwbWVudCciDQogICAgdmFyIHF1ZXJ5UmVzdWx0ID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbCk7IA0KICAgIHZhciBydHJlY29yZHMgPSBxdWVyeVJlc3VsdC5nZXRBcnJheSgicmVjb3JkcyIpOw0KICAgIGlmIChydHJlY29yZHMubGVuZ3RoID09IDApIHsgICAgDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEwIikpOw0KICAgICAgICB3aW5kb3cuY2xvc2UoKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICB2YXIgU2hpcG1lbnRMaW5lUmVjb3JkVHlwZSA9IHJ0cmVjb3Jkc1swXS5JZDsNCiAgICB2YXIgY3VyZGF0ZSA9IG5ldyBEYXRlKCk7DQoNCiAgICB2YXIgc2hwSGRyID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fUk1BX1NoaXBtZW50X09yZGVyX19jIik7DQogICAgc2hwSGRyLlJlY29yZFR5cGVJZCA9IFNoaXBtZW50SGRyUmVjb3JkVHlwZTsNCiAgICBzaHBIZHIuU1ZNWENfX0NvbXBhbnlfX2MgPSBTSFNWT19Db21wYW55SWQ7DQogICAgc2hwSGRyLlNWTVhDX19DYXNlX19jID0gU0hTVk9fQ2FzZUlkOw0KICAgIHNocEhkci5TVk1YQ19fQ29udGFjdF9fYyA9IFNIU1ZPX0NvbnRhY3RJZDsNCiAgICBzaHBIZHIuU1ZNWENfX09yZGVyX1N0YXR1c19fYyA9ICJPcGVuIjsNCiAgICBzaHBIZHIuU1ZNWENfX0V4cGVjdGVkX0RlbGl2ZXJ5X0RhdGVfX2MgPSBzb2JqZWN0TGlzdFswXS5TVk1YQ19fRGF0ZV9SZXF1aXJlZF9fYzsNCiAgICBzaHBIZHIuU1ZNWENfX1NvdXJjZV9Mb2NhdGlvbl9fYyA9IFNvdXJjZUxvY0lkOw0KICAgIHNocEhkci5TVk1YQ19fRGVzdGluYXRpb25fTG9jYXRpb25fX2MgPSBTSFNWT19SZXF1aXJlZEF0SWQ7DQogICAgc2hwSGRyLlNWTVhDX19TZXJ2aWNlX0VuZ2luZWVyX19jID0gU0hTVk9fT3duZXJJZDsNCiAgICBzaHBIZHIuU1ZNWENfX1NlcnZpY2VfT3JkZXJfX2MgPSBTSFNWT19TVk9JZDsNCiAgICB0cnkgew0KICAgICAgICB2YXIgcmV0ID0gc2ZvcmNlLmNvbm5lY3Rpb24uY3JlYXRlKFtzaHBIZHJdKTsgDQoJCWlmIChyZXRbMF0uZ2V0Qm9vbGVhbigic3VjY2VzcyIpKSANCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcmV0dXJuIHJldFswXS5pZDsgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgfSANCiAgICAgICAgICAgICAgICBlbHNlIA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQocmV0WzBdLmVycm9ycy5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9yZXR1cm4gbnVsbDsNCiAgICAgICAgICAgICAgICB9ICANCgl9DQogICAgY2F0Y2goZXJyb3IpIHsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTYiKSsiXG4iKyBlcnJvcik7DQoJfQ0KICAgIFNoaXBtZW50T3JkZXJJZCA9IHJldFswXS5pZDsNCg0KICAgIC8vIGJ1aWxkIGFuIGFycmF5IG9mIHNoaXBtZW50IGxpbmVzDQogICAgdmFyIHNocGxpbmVzID0gbmV3IEFycmF5KCk7DQogICAgdmFyIHJlcWxpbmVzID0gbmV3IEFycmF5KCk7DQogICAgZm9yICh2YXIgayA9IDA7IGsgPCBzb2JqZWN0TGlzdC5sZW5ndGg7IGsrKykNCiAgICAJew0KCXZhciByZWMgPSBzb2JqZWN0TGlzdFtrXTsNCgl2YXIgU2hwUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlNocFF0eSIpLnZhbHVlKTsNCgl2YXIgUmVtUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlJlbVF0eSIpLnZhbHVlKTsNCgl2YXIgU2hpcEluaXRRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiU2hpcEluaXRRdHkiKS52YWx1ZSk7DQoNCglpZiAoU2hwUXR5ID09IDApIHsgY29udGludWU7IH0JCS8vIEl0ZW0gbm90IHNoaXBwZWQuIFNraXAuDQoNCgl2YXIgc2hwTGluZSA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1JNQV9TaGlwbWVudF9MaW5lX19jIik7DQogICAgICAgIHNocExpbmUuU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYyA9IFNoaXBtZW50T3JkZXJJZDsNCiAgICAgICAgc2hwTGluZS5SZWNvcmRUeXBlSWQgPSBTaGlwbWVudExpbmVSZWNvcmRUeXBlOw0KICAgICAgICBzaHBMaW5lLlNWTVhDX19Qcm9kdWN0X19jID0gcmVjLlNWTVhDX19Qcm9kdWN0X19jOw0KICAgICAgICBzaHBMaW5lLlNWTVhDX19FeHBlY3RlZF9TaGlwX0RhdGVfX2MgPSByZWMuU1ZNWENfX0RhdGVfUmVxdWlyZWRfX2M7DQoJc2hwTGluZS5TVk1YQ19fRXhwZWN0ZWRfUXVhbnRpdHkyX19jID0gU2hwUXR5Ow0KICAgICAgICBzaHBMaW5lLlNWTVhDX19TaGlwX0xvY2F0aW9uX19jID0gU0hTVk9fUmVxdWlyZWRBdElkOw0KICAgICAgICBzaHBMaW5lLlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICJPcGVuIjsNCiAgICAgICAgc2hwTGluZS5TVk1YQ19fTGluZV9UeXBlX19jID0gIk91dGJvdW5kIChTaGlwbWVudCkiOw0KICAgICAgICBzaHBMaW5lLlNWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2MgPSByZWMuSWQ7DQogICAgICAgIHNocExpbmUuU1ZNWENfX1Bvc3RlZF9Ub19JbnZlbnRvcnlfX2MgPSBmYWxzZTsNCiAgICAgICAgc2hwTGluZS5TVk1YQ19fU2VydmljZV9FbmdpbmVlcl9fYyA9IFNIU1ZPX093bmVySWQ7DQoJCXNocExpbmUuU1ZNWENfX1VzZV9QcmljZV9Gcm9tX1ByaWNlYm9va19fYyA9ICJGYWxzZSI7IC8vQnkgR20gMThKdW4wOA0KCXNocGxpbmVzLnB1c2goc2hwTGluZSk7DQoNCgl2YXIgcmVxbGluZSA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYyIpOw0KCXJlcWxpbmUuSWQgPSByZWMuSWQ7DQoJcmVxbGluZS5TVk1YQ19fUXVhbnRpdHlfU2hpcG1lbnRfSW5pdGlhdGVkMl9fYyA9IFNoaXBJbml0UXR5ICsgU2hwUXR5Ow0KCXJlcWxpbmVzLnB1c2gocmVxbGluZSk7DQoJfQ0KDQogICAgdHJ5IHsNCglzZm9yY2UuY29ubmVjdGlvbi5jcmVhdGUoc2hwbGluZXMpOw0KCX0NCiAgICBjYXRjaCAoZSkgew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxNyIpKyAiXG4iICsgZSk7DQoJcmV0dXJuIGZhbHNlOw0KICAgIAl9DQoNCiAgICAvLyBVcGRhdGUgdGhlIFNWTyBwYXJ0cyByZXF1ZXN0IGxpbmVzIHdpdGggc2hpcG1lbnQgaW5pdGlhdGVkIHF1YW50aXR5DQogICAgdHJ5IHsNCglzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUocmVxbGluZXMpOw0KCX0NCiAgICBjYXRjaCAoZSkgew0KICAgICAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDEiKSArICJcbiIgKyBlKTsNCglyZXR1cm4gZmFsc2U7DQogICAgCX0NCiAgICByZXR1cm4gdHJ1ZTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YQ19TVk9fQ2FuY2VsUGFydHNSZXF1ZXN0KHNlcnZJZCwgdUlkLCBsaW5lSWQpDQp7DQoNCglTVk1YSV9Jbml0TWVzc2FnZUxpc3QoIldPUkRTQzEiKTsNCglTVk1YSV9TZXRMYWJlbHMoIkNhbmNlbFNWT0xpbmVQYXJ0c1JlcXVlc3QiKTsNCgkNCgkNCiAgICBDTlNWT1BSX1NWT0lkID0gc2VydklkOw0KICAgIENOU1ZPUFJfVXNlcklkID0gdUlkOw0KICAgIENOU1ZPUFJfU1ZPTGluZUlkID0gbGluZUlkOw0KDQogICAgLy8gR2V0IFNlcnZpY2UgT3JkZXIgaGVhZGVyIGluZm8NCiAgICB2YXIgc29xbDEgPSAiU0VMRUNUIFNWTVhDX19PcmRlcl9TdGF0dXNfX2MgRlJPTSBTVk1YQ19fU2VydmljZV9PcmRlcl9fYyBXSEVSRSBJZCA9ICciICsgQ05TVk9QUl9TVk9JZCArICInIjsNCiAgICB2YXIgcXIxID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDEpOw0KICAgIGlmIChxcjEuc2l6ZSA8PSAwKQ0KCXsNCgkgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAyIikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICB2YXIgcmVjMSA9IHFyMS5nZXRBcnJheSgicmVjb3JkcyIpOw0KICAgIGlmIChyZWMxWzBdLlNWTVhDX19PcmRlcl9TdGF0dXNfX2MgPT0gIkNsb3NlZCIpDQogICAgCXsNCgkgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAzIikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBpZiAocmVjMVswXS5TVk1YQ19fT3JkZXJfU3RhdHVzX19jID09ICJDYW5jZWxlZCIpDQogICAgCXsNCgkgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA0IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCg0KICAgIC8vIEdldCBTYWxlc2ZvcmNlIGludGVybmFsIFJlY29yZCBUeXBlIElEIGZvciBTZXJ2aWNlIG9yZGVyICJSZXF1ZXN0L1JlY2VpcHQiDQogICAgdmFyIHNvcWwyID0gIlNFTEVDVCBJZCBGUk9NIFJlY29yZFR5cGUgV0hFUkUgU29iamVjdFR5cGUgPSAnU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYycgQU5EIE5hbWUgPSAnUmVxdWVzdC9SZWNlaXB0JyINCiAgICB2YXIgcXIyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDIpOyANCiAgICB2YXIgcmVjMiA9IHFyMi5nZXRBcnJheSgicmVjb3JkcyIpOw0KICAgIGlmIChyZWMyLmxlbmd0aCA9PSAwKQ0KCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDUiKSk7ICAgICAgIA0KCSAgIHdpbmRvdy5jbG9zZSgpOw0KICAgICAgICByZXR1cm47DQoJfQ0KICAgIFJlcVJlY29yZFR5cGVJZCA9IHJlYzJbMF0uSWQ7DQoNCiAgICAvLyBHZXQgb3BlbiBTZXJ2aWNlIE9yZGVyIGxpbmVzDQogICAgdmFyIHNvcWwzID0gIlNFTEVDVCBJZCwgU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MsIFNWTVhDX19RdWFudGl0eV9TaGlwcGVkMl9fYywgIiArDQogICAgCQkiU1ZNWENfX1JlY2VpdmVkX1F1YW50aXR5Ml9fYywgU1ZNWENfX0xpbmVfU3RhdHVzX19jICIgKw0KCQkiRlJPTSBTVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jIFdIRVJFIFNWTVhDX19TZXJ2aWNlX09yZGVyX19jID0gJyIgKyBDTlNWT1BSX1NWT0lkICsgIicgIiArDQoJCSJBTkQgUmVjb3JkVHlwZUlkID0gJyIgKyBSZXFSZWNvcmRUeXBlSWQgKyAiJyI7DQogICAgaWYgKENOU1ZPUFJfU1ZPTGluZUlkKSB7IHNvcWwzID0gc29xbDMgKyAiIEFORCBJZCA9ICciICsgQ05TVk9QUl9TVk9MaW5lSWQgKyAiJyI7IH0NCiAgICB2YXIgcXIzID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDMpOw0KICAgIHJlY3MgPSBxcjMuZ2V0QXJyYXkoInJlY29yZHMiKTsNCg0KICAgIHZhciBjdXJkYXRlID0gbmV3IERhdGUoKTsNCiAgICB2YXIgaW52YWxpZCA9IGZhbHNlOw0KICAgIHZhciBzdm9saW5lcyA9IG5ldyBBcnJheSgpOw0KICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcmVjcy5sZW5ndGg7IGsrKykNCiAgICAJew0KCXZhciByZWMgPSByZWNzW2tdOw0KDQoJaWYgKHJlYy5TVk1YQ19fTGluZV9TdGF0dXNfX2MgPT0gIkNvbXBsZXRlZCIgfHwgcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jID4gMCB8fA0KCQkJCQlyZWMuU1ZNWENfX1JlY2VpdmVkX1F1YW50aXR5Ml9fYyA+IDAgfHwgcmVjLlNWTVhDX19RdWFudGl0eV9TaGlwcGVkMl9fYyA+IDApDQoJICAgIHsNCgkgICAgaW52YWxpZCA9IHRydWU7DQoJICAgIGJyZWFrOw0KCSAgICB9DQoJdmFyIHN2b2xpbmUgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2MiKTsNCglzdm9saW5lLklkID0gcmVjLklkOw0KCXN2b2xpbmUuU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gIkNhbmNlbGVkIjsNCglzdm9saW5lLlNWTVhDX19DYW5jZWxlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoJc3ZvbGluZS5TVk1YQ19fQ2FuY2VsZWRfQnlfX2MgPSBDTlNWT1BSX1VzZXJJZDsNCglzdm9saW5lcy5wdXNoKHN2b2xpbmUpOw0KCX0NCg0KICAgIGlmIChpbnZhbGlkKQ0KICAgIAl7DQoJaWYgKENOU1ZPUFJfU1ZPTGluZUlkKQ0KCSAgICB7DQoNCgkJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA2IikrIlxuIitTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDciKSk7IA0KCQl9DQoJCQ0KCWVsc2UNCgkgICAgew0KDQoJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwOCIpKyJcbiIrU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA5IikpOyANCgkJfQ0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCg0KICAgIHRyeSB7DQoJc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKHN2b2xpbmVzKTsNCgl9DQogICAgY2F0Y2ggKGUpIHsNCg0KCSBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDEiKSArICJcbiIgKyBlKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybiBmYWxzZTsNCiAgICAJfQ0KICANCgkgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEwIikpOw0KICAgIHdpbmRvdy5vcGVuZXIubG9jYXRpb24ucmVsb2FkKHRydWUpOw0KICAgIENsb3NlV2luZG93KCk7DQogICAgcmV0dXJuIHRydWU7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUHJvY1BSUl9TaG93UmVxdWVzdFJlY29yZHMocmVxSWQsIHJlcU51bSwgdUlkLCBzZXNzSWQpDQp7DQogICAgU1ZNWElfSW5pdE1lc3NhZ2VMaXN0KCJQUkVRU0MzIik7DQogICAgU1ZNWElfU2V0TGFiZWxzKCJwcm9jcHJyZWNlaXB0Iik7DQoNCiAgICBQUFJSX1JlcXVlc3RJZCA9IHJlcUlkOw0KICAgIFBQUlJfVXNlcklkID0gdUlkOw0KICAgIFBQUlJfUFJOdW1iZXIgPSByZXFOdW07DQogICAgUFBSUl9TZXNzaW9uSWQgPSBzZXNzSWQ7DQoNCiAgICAvLyBHZXQgUGFydHMgUmVxdWVzdCBoZWFkZXIgaW5mbw0KICAgIHZhciBzb3FsMSA9ICJTRUxFQ1QgU1ZNWENfX1N0YXR1c19fYywgU1ZNWENfX0NvbXBhbnlfX2MsIFNWTVhDX19SZXF1ZXN0ZWRfRnJvbV9fYywgU1ZNWENfX1JlcXVpcmVkX0F0X0xvY2F0aW9uX19jICIgKw0KCQkiRlJPTSBTVk1YQ19fUGFydHNfUmVxdWVzdF9fYyBXSEVSRSBJZCA9ICciICsgUFBSUl9SZXF1ZXN0SWQgKyAiJyI7DQogICAgdmFyIHFyMSA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwxKTsNCiAgICBpZiAocXIxLnNpemUgPD0gMCkNCgl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAyIikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICB2YXIgcmVjMSA9IHFyMS5nZXRBcnJheSgicmVjb3JkcyIpOw0KICAgIGlmIChyZWMxWzBdLlNWTVhDX19TdGF0dXNfX2MgPT0gIkNvbXBsZXRlZCIpDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDMiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIGlmIChyZWMxWzBdLlNWTVhDX19TdGF0dXNfX2MgPT0gIkNhbmNlbGVkIikNCiAgICAJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNCIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgUFBSUl9TaXRlSWQgPSByZWMxWzBdLlNWTVhDX19SZXF1aXJlZF9BdF9Mb2NhdGlvbl9fYzsNCiAgICBQUFJSX1N1cHBsaWVySWQgPSByZWMxWzBdLlNWTVhDX19Db21wYW55X19jOw0KICAgIFBQUlJfU291cmNlTG9jU3RvY2thYmxlID0gdHJ1ZTsNCg0KICAgIC8vIElmIHNvdXJjZSBsb2NhdGlvbiBpcyBub3QgYSBzdG9ja2luZyBsb2NhdGlvbiBhbmQgYSBzdXBwbGllciBuYW1lIGlzIGdpdmVuLA0KICAgIC8vIGl0IGlzIGltcGxpZWQgdGhhdCB0aGUgcmVjZWlwdCB3YXMgZnJvbSBhIHN1cHBsaWVyDQogICAgLy8gYW5kIGl0IGRvZXMgbm90IGhhdmUgdG8gYmUgYWNjb3VudGVkIGZvciBpbiBpbnZlbnRvcnkNCiAgICAvLyBTbyB3ZSBjaG9vc2UgdGhlIGRlZmF1bHQgaW50ZXJuYWwgbG9jYXRpb24NCiAgICBpZiAocmVjMVswXS5TVk1YQ19fUmVxdWVzdGVkX0Zyb21fX2MgJiYgUFBSUl9TdXBwbGllcklkKSAgICAgICAgICAgICAvLyBIUyAwNC8yOC8yMDA4DQoJew0KCXZhciBzb3FsNCA9ICJTRUxFQ1QgU1ZNWENfX1N0b2NraW5nX0xvY2F0aW9uX19jIEZST00gU1ZNWENfX1NpdGVfX2MgV0hFUkUgSWQgPSAnIiArIHJlYzFbMF0uU1ZNWENfX1JlcXVlc3RlZF9Gcm9tX19jICsgIiciOw0KCXZhciBxcjQgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsNCk7DQoJdmFyIHJlYzQgPSBxcjQuZ2V0QXJyYXkoInJlY29yZHMiKTsNCglpZiAocmVjNFswXS5TVk1YQ19fU3RvY2tpbmdfTG9jYXRpb25fX2MgPT0gImZhbHNlIikNCgkgICAgew0KCSAgICB2YXIgc29xbDMgPSAiU0VMRUNUIElkIEZST00gU1ZNWENfX1NpdGVfX2MgV0hFUkUgTmFtZSA9ICdEZWZhdWx0IFN1cHBsaWVyIExvY2F0aW9uJyI7DQoJICAgIHZhciBxcjMgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMyk7DQoJICAgIGlmIChxcjMuc2l6ZSA8PSAwKQ0KCQkJew0KCQkJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA1IikpOw0KCQkJQ2xvc2VXaW5kb3coKTsNCgkJCXJldHVybjsNCgkJCX0NCgkgICAgdmFyIHJlYzMgPSBxcjMuZ2V0QXJyYXkoInJlY29yZHMiKTsNCgkgICAgUFBSUl9Tb3VyY2VMb2NJZCA9IHJlYzNbMF0uSWQ7DQoJICAgIFBQUlJfU291cmNlTG9jU3RvY2thYmxlID0gZmFsc2U7DQoJICAgIH0NCgl9DQoNCiAgICAvLyBHZXQgb3BlbiBQYXJ0cyBSZXF1ZXN0IGxpbmVzDQogICAgdmFyIHNvcWwyID0gIlNFTEVDVCBJZCwgU1ZNWENfX1BhcnRzX1JlcXVlc3RfX2MsIFNWTVhDX19Qcm9kdWN0X19jLCBTVk1YQ19fUHJvZHVjdF9fci5OYW1lLCBTVk1YQ19fUXVhbnRpdHlfUmVxdWlyZWQyX19jLCAiICsNCiAgICAJCSJTVk1YQ19fRGF0ZV9SZXF1aXJlZF9fYywgU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MsIFNWTVhDX19RdWFudGl0eV9TaGlwcGVkMl9fYywgU1ZNWENfX0FkZGl0aW9uYWxfSW5mb3JtYXRpb25fX2MsU1ZNWENfX1VuaXRfUHJpY2UyX19jICIgKyANCgkJIkZST00gU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYyBXSEVSRSBTVk1YQ19fUGFydHNfUmVxdWVzdF9fYyA9ICciICsgUFBSUl9SZXF1ZXN0SWQgKyAiJyBBTkQgIiArDQoJCSJTVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAnT3BlbiciOyAvL0J5IEdtIDE4anVuMDggYWRkZWQgZmxkIDogU1ZNWENfX1VuaXRfUHJpY2UyX19jIA0KICAgIHRyeSB7DQogICAgdmFyIHFyMiA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwyKTsNCiAgICB9IGNhdGNoIChlKSB7IGFsZXJ0KGUpOyB9DQogICAgaWYgKHFyMi5zaXplIDw9IDApDQoJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNiIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgdmFyIHJlcXJlY3MgPSBuZXcgc2ZvcmNlLlF1ZXJ5UmVzdWx0SXRlcmF0b3IocXIyKTsNCg0KICAgIHZhciByb3dudW0gPSAwOw0KICAgIHZhciB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsaXN0X3Rib2R5Iik7DQoNCiAgICBTVk1YSV9Qcm9jUFJSX0RyYXdIZWFkZXIodGJvZHkpOw0KDQogICAgd2hpbGUocmVxcmVjcy5oYXNOZXh0KCkpDQoJew0KCXZhciByZXFyZWMgPSByZXFyZWNzLm5leHQoKTsNCg0KCXZhciByZXFpZCA9IHJlcXJlYy5JZDsNCgl2YXIgcHJvZGlkID0gcmVxcmVjLlNWTVhDX19Qcm9kdWN0X19jOw0KCXZhciBSZXFRdHkgPSBwYXJzZUZsb2F0KHJlcXJlYy5TVk1YQ19fUXVhbnRpdHlfUmVxdWlyZWQyX19jKTsNCg0KCWlmIChyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MgPT0gbnVsbCB8fCBpc05hTihyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MpKQ0KCSAgICB2YXIgU2hpcEluaXRRdHkgPSAwOw0KCWVsc2UNCgkgICAgdmFyIFNoaXBJbml0UXR5ID0gcGFyc2VGbG9hdChyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MpOw0KDQoJaWYgKHJlcXJlYy5TVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MgPT0gbnVsbCB8fCBpc05hTihyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBwZWQyX19jKSkNCgkgICAgdmFyIFNoaXBRdHkgPSAwOw0KCWVsc2UNCgkgICAgdmFyIFNoaXBRdHkgPSBwYXJzZUZsb2F0KHJlcXJlYy5TVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MpOw0KDQoJdmFyIHRyID0gbWFrZVJvdyhtYWtlQXR0cnMocm93bnVtLHRib2R5KSApOw0KCXRyLnNvYmplY3QgPSByZXFyZWM7DQoJdGJvZHkuYXBwZW5kQ2hpbGQodHIpOw0KDQoJCS8vIENvbCAxLiBQcm9kdWN0IE5hbWUNCgljcmVhdGVUYWcodHIsInRoIix7InNjb3BlIjoicm93In0pLmlubmVySFRNTCA9DQoJCSI8YSB0YXJnZXQ9X2JsYW5rIGhyZWY9XCIvIiArIHByb2RpZCArICJcIj4iICsgcHJvZGlkID8gcmVxcmVjLlNWTVhDX19Qcm9kdWN0X19yLk5hbWUgOiAiVW5rbm93biIgKyAiPC9hPiI7DQoNCgkJLy8gQ29sIDIuIFJlcXVlc3RlZCBRdWFudGl0eQ0KCWNyZWF0ZVRhZyh0ciwidGQiLCBbXSkuaW5uZXJIVE1MID0NCgkJIjxpbnB1dCBkaXNhYmxlZD1cInRydWVcIiB0eXBlPVwidGV4dFwiIGlkPVwiIiArIHJlcWlkICsgIlJlcVF0eVwiIG5hbWU9XCIiICsgcmVxaWQgKyAiUmVxUXR5XCIgdmFsdWU9XCIiICsgUmVxUXR5ICsgIlwiPjwvaW5wdXQ+IjsNCg0KCQkvLyBDb2wgMy4gUmVjZWl2ZWQgUXVhbnRpdHkNCgljcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSI8aW5wdXQgdHlwZT1cInRleHRcIiBpZD1cIiIgKyByZXFpZCArICJSY3ZRdHlcIiBuYW1lPVwiIiArIHJlcWlkICsgIlJjdlF0eVwiIHZhbHVlPVwiIiArIFJlcVF0eSArICJcIiBvbmNoYW5nZT1cIlNWTVhJX1Byb2NQUlJfVmFsaWRhdGVRdWFudGl0eSh0aGlzKTtcIj48L2lucHV0PiI7DQoNCgkJLy8gQ29sIDQuIENoZWNrYm94DQoJY3JlYXRlVGFnKHRyLCJ0ZCIseydjbGFzcyc6J2FjdGlvbkNvbHVtbicsJ2FsaWduJzonY2VudGVyJ30pLmlubmVySFRNTCA9DQoJCSI8aW5wdXQgY2hlY2tlZD1cInRydWVcIiBkaXNhYmxlZD1cInRydWVcIiB0eXBlPVwiY2hlY2tib3hcIiBpZD1cIiIgKyByZXFpZCArICJDaGVja2JveFwiIG5hbWU9XCJpZHNcIiB2YWx1ZT1cIiIgKyByZXFpZCArICJcIiA+Jm5ic3A7IjsNCg0KCQkvLyBDb2wgNS4gU3RhdHVzIE1lc3NhZ2UNCgljcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSI8ZGl2IGlkPVwiIiArIHJlcWlkICsgIkVyck1zZ1wiIG5hbWU9XCIiICsgcmVxaWQgKyAiRXJyTXNnXCI+PC9kaXY+IjsNCg0KCQkvLyBDb2wgNi4gU2hpcG1lbnQgSW5pdGlhdGVkIFF1YW50aXR5DQoJY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkiPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBkaXNhYmxlZD1cInRydWVcIiBpZD1cIiIgKyByZXFpZCArICJTaGlwSW5pdFF0eVwiIG5hbWU9XCIiICsgcmVxaWQgKyAiU2hpcEluaXRRdHlcIiB2YWx1ZT1cIiIgKyBTaGlwSW5pdFF0eSArICJcIj48L2lucHV0PiI7DQoNCgkJLy8gQ29sIDcuIFNoaXBwZWQgUXVhbnRpdHkNCgljcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSI8aW5wdXQgdHlwZT1cImhpZGRlblwiIGRpc2FibGVkPVwidHJ1ZVwiIGlkPVwiIiArIHJlcWlkICsgIlNoaXBRdHlcIiBuYW1lPVwiIiArIHJlcWlkICsgIlNoaXBRdHlcIiB2YWx1ZT1cIiIgKyBTaGlwUXR5ICsgIlwiPjwvaW5wdXQ+IjsNCg0KCXJvd251bSArPSAxOw0KCX0NCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2FpdG1zZycpLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJzsgDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dhaXRtc2cnKS5zdHlsZS5oZWlnaHQgPSAwOyANCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Qcm9jUFJSX1ZhbGlkYXRlUXVhbnRpdHkoY3RybCkNCnsNCiAgICB2YXIgcmVxaWQgPSBjdHJsLm5hbWUuc3Vic3RyaW5nKDAsMTgpOw0KICAgIHZhciByZXFxdHluYW1lID0gcmVxaWQgKyAiUmVxUXR5IjsNCiAgICB2YXIgcmVxcXR5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVxcXR5bmFtZSk7DQoNCiAgICBpZihwYXJzZUZsb2F0KGN0cmwudmFsdWUpID49IHBhcnNlRmxvYXQocmVxcXR5LnZhbHVlKSkNCiAgICAJew0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlcWlkKyJDaGVja2JveCIpLmNoZWNrZWQgPSB0cnVlOw0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlcWlkKyJDaGVja2JveCIpLmRpc2FibGVkID0gdHJ1ZTsNCgl9DQogICAgZWxzZQ0KICAgIAl7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVxaWQrIkNoZWNrYm94IikuY2hlY2tlZCA9IGZhbHNlOw0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlcWlkKyJDaGVja2JveCIpLmRpc2FibGVkID0gZmFsc2U7DQoJfQ0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Byb2NQUlJfRHJhd0hlYWRlcih0YSkNCnsNCiAgICB2YXIgdHIgPSBtYWtlUm93KHsnY2xhc3MnOidoZWFkZXJSb3cnfSk7DQogICAgdGEuYXBwZW5kQ2hpbGQodHIpOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIgKyBTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMDUiKSArICI8L2E+IjsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnLCdhbGlnbic6J3JpZ2h0J30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IiArIFNWTVhJX0dldE1lc3NhZ2UoIkxBQjAwNiIpICsgIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCcsJ2FsaWduJzoncmlnaHQnfSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIGhyZWY9XCIjXCIgdGl0bGU9XCJcIj4iICsgU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDA3IikgKyAiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJ30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IiArIFNWTVhJX0dldE1lc3NhZ2UoIkxBQjAwOCIpICsgIjwvYT4iOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Byb2NQUlJfVmFsaWRhdGVBbmRQcm9jZXNzKCkNCnsNCiAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWydwcm9jcHJyZWNlaXB0J107DQoNCiAgICB2YXIgc29iamVjdExpc3QgPSBuZXcgQXJyYXkoKTsNCiAgICBmb3IgKGkgPSAwOyBpIDwgZm9ybS5lbGVtZW50cy5sZW5ndGg7IGkrKykNCgl7DQoJaWYgKGZvcm0uZWxlbWVudHNbaV0ubmFtZSA9PSAnaWRzJykNCgkgICAgew0KCSAgICB2YXIgcG4gPSBmb3JtLmVsZW1lbnRzW2ldLnBhcmVudE5vZGU7DQoJICAgIHZhciBwcG4gPSBmb3JtLmVsZW1lbnRzW2ldLnBhcmVudE5vZGUucGFyZW50Tm9kZTsNCgkgICAgaWYgKHBwbi5zb2JqZWN0KQ0KCQl7DQoJCXNvYmplY3RMaXN0LnB1c2gocHBuLnNvYmplY3QpOw0KCQl9DQoJICAgIH0NCgl9DQoNCiAgICB2YXIgdmFsaWRfcmVjZWlwdHMgPSBuZXcgQXJyYXkoKTsNCiAgICB2YXIgaW52YWxpZCA9IGZhbHNlOw0KICAgIHZhciBza2lwY250ID0gMDsNCiAgICBmb3IgKHZhciBrID0gMDsgayA8IHNvYmplY3RMaXN0Lmxlbmd0aDsgaysrKQ0KICAgIAl7DQoJdmFyIHJlY19pbnZhbGlkID0gZmFsc2U7DQoJdmFyIHJlYyA9IHNvYmplY3RMaXN0W2tdOw0KCXZhciBTaGlwUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlNoaXBRdHkiKS52YWx1ZSk7DQoJdmFyIFNoaXBJbml0UXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlNoaXBJbml0UXR5IikudmFsdWUpOw0KCXZhciBSY3ZRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiUmN2UXR5IikudmFsdWUpOw0KCXZhciBSZXFRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiUmVxUXR5IikudmFsdWUpOw0KCXZhciBjaGVja2VkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJDaGVja2JveCIpLmNoZWNrZWQ7DQoJLy9hbGVydCgiY2hlY2tlZD0iICsgY2hlY2tlZCArICIsIFJlcVF0eT0iICsgUmVxUXR5ICsgIiwgUmN2UXR5PSIgKyBSY3ZRdHkgKyAiLCBTaGlwSW5pdFF0eT0iICsgU2hpcEluaXRRdHkgKyAiLCBTaGlwUXR5PSIgKyBTaGlwUXR5KTsNCgl2YXIgRXJyTXNnID0gIiI7DQoJaWYgKGlzTmFOKFJjdlF0eSkgfHwgUmN2UXR5IDwgMCkNCgkgICAgew0KCSAgICBFcnJNc2cgPSBTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDciKTsNCgkgICAgaW52YWxpZCA9IHRydWU7DQoJICAgIHJlY19pbnZhbGlkID0gdHJ1ZTsNCgkgICAgfQ0KCWVsc2UgaWYgKCFjaGVja2VkICYmIFJjdlF0eSA9PSAwKQ0KCSAgICB7DQoJICAgIHNraXBjbnQgKz0gMTsNCgkgICAgfQ0KCWVsc2UgaWYoUmN2UXR5ID4gUmVxUXR5KQ0KCSAgICB7DQoJICAgIEVyck1zZyA9IFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwOCIpOw0KCSAgICBpbnZhbGlkID0gdHJ1ZTsNCgkgICAgcmVjX2ludmFsaWQgPSB0cnVlOw0KCSAgICB9DQoJZWxzZSBpZiAoY2hlY2tlZCAmJiBSY3ZRdHkgPCBSZXFRdHkgJiYgU2hpcFF0eSA+IDApDQoJICAgIHsNCgkgICAgRXJyTXNnID0gU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA5Iik7DQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICByZWNfaW52YWxpZCA9IHRydWU7DQoJICAgIH0NCgllbHNlIGlmIChjaGVja2VkICYmIFJjdlF0eSA8IFJlcVF0eSAmJiBTaGlwSW5pdFF0eSA+IDApDQoJICAgIHsNCgkgICAgRXJyTXNnID0gU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEwIik7DQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICByZWNfaW52YWxpZCA9IHRydWU7DQoJICAgIH0NCglpZiAocmVjX2ludmFsaWQpDQoJICAgIHsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5zdHlsZS5ib3JkZXIgPSAiI0ZGMDAwMCAycHggc29saWQiOw0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkVyck1zZyIpLmlubmVySFRNTCA9IEVyck1zZzsNCgkgICAgfQ0KCWVsc2UNCgkgICAgew0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkVyck1zZyIpLnN0eWxlLmJvcmRlciA9ICIwIjsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5pbm5lckhUTUwgPSAiIjsNCgkgICAgfQ0KCWlmICghcmVjX2ludmFsaWQgJiYgUmN2UXR5ID4gMCkNCgkgICAgdmFsaWRfcmVjZWlwdHMucHVzaChyZWMpOw0KCX0NCiAgICBpZihpbnZhbGlkKSB7IHJldHVybjsgfQ0KDQogICAgaWYoc2tpcGNudCA9PSBzb2JqZWN0TGlzdC5sZW5ndGgpDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTEiKSk7DQoJcmV0dXJuOw0KCX0NCg0KICAgIFBQUlJfUmVjZWlwdHMgPSB2YWxpZF9yZWNlaXB0czsJCS8vIFByb2Nlc3Mgb25seSByZWNvcmRzIHdpdGggYSB2YWxpZCByZWNlaXB0IHF1YW50aXR5DQogICAgU1ZNWElfUHJvY1BSUl9Qcm9jZXNzUmVjZWlwdHMoKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Qcm9jUFJSX1Byb2Nlc3NSZWNlaXB0cygpDQp7DQogICAgdmFyIFByb2RBcnJheSA9IFNWTVhJX011bHRpRGltZW5zaW9uYWxBcnJheShQUFJSX1JlY2VpcHRzLmxlbmd0aCwgNik7DQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBQUFJSX1JlY2VpcHRzLmxlbmd0aDsgaSsrKQ0KCXsNCgl2YXIgUmN2UXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUFJSX1JlY2VpcHRzW2ldLklkKyJSY3ZRdHkiKS52YWx1ZSk7DQoJUHJvZEFycmF5W2ldWzBdID0gUFBSUl9SZWNlaXB0c1tpXS5TVk1YQ19fUHJvZHVjdF9fYzsNCglQcm9kQXJyYXlbaV1bMV0gPSBSY3ZRdHk7DQoJUHJvZEFycmF5W2ldWzJdID0gUFBSUl9TaXRlSWQ7DQoJUHJvZEFycmF5W2ldWzNdID0gIkluIFRyYW5zaXQiOw0KCWlmIChQUFJSX1NvdXJjZUxvY1N0b2NrYWJsZSA9PSB0cnVlKQ0KCSAgICBQcm9kQXJyYXlbaV1bMl0gPSBQUFJSX1NpdGVJZDsNCgllbHNlDQoJICAgIFByb2RBcnJheVtpXVsyXSA9IFBQUlJfU291cmNlTG9jSWQ7DQoJUHJvZEFycmF5W2ldWzVdID0gIkF2YWlsYWJsZSI7DQoJfQ0KICAgIC8vIENhbGwgc2VyaWFsIHNlbGVjdGlvbiB1dGlsaXR5LiBJdCB3aWxsIGNhcHR1cmUgc2VyaWFsIG51bWJlcnMgd2hlcmUgYXBwbGljYWJsZSBhbmQNCiAgICAvLyBjYWxsIGJhY2sgdGhlIHJvdXRpbmUgYmVsb3cgd2l0aCB0aGUgc2VsZWN0ZWQgc2VyaWFscw0KICAgIHdpbmRvdy5ibHVyKCk7DQogICAgdmFyIHJldHVyblZhbCA9IFNWTVhJX0RvU2VyaWFsU2VsZWN0aW9uKFByb2RBcnJheSwgIlBhcnRzIFJlY2VpcHQiLCBQUFJSX1BSTnVtYmVyLCBQUFJSX1VzZXJJZCwgUFBSUl9TZXNzaW9uSWQpOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX0NhbGxiYWNrX1Byb2Nlc3NQUlJlY2VpcHRzKFNlcmlhbFNlbGVjdFN0YXR1cywgU2VyaWFsQ291bnQsIFNlcmlhbEFycmF5KQ0Kew0KICAgIHdpbmRvdy5mb2N1cygpOw0KICAgIGlmICghU2VyaWFsU2VsZWN0U3RhdHVzKQ0KICAgIAl7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm4gZmFsc2U7DQoJfQ0KDQogICAgdmFyIHRvdHEgPSAwOw0KICAgIHZhciBTZXJpYWxTYXZlQXJyYXkgPSBTVk1YSV9NdWx0aURpbWVuc2lvbmFsQXJyYXkoU2VyaWFsQ291bnQsIDQpOw0KDQogICAgZm9yICh2YXIgaiA9IDA7IGogPCBQUFJSX1JlY2VpcHRzLmxlbmd0aDsgaisrKQ0KICAgIAl7DQoJdmFyIFByb2RJZCA9IFBQUlJfUmVjZWlwdHNbal0uU1ZNWENfX1Byb2R1Y3RfX2M7DQoJdmFyIFJjdlF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoUFBSUl9SZWNlaXB0c1tqXS5JZCsiUmN2UXR5IikudmFsdWUpOw0KDQoJLy8gRGVjcmVhc2UgSW4gVHJhbnNpdCBzdG9jayBpbiB0aGUgdGFyZ2V0IGxvY2F0aW9uDQoJaWYgKFBQUlJfU291cmNlTG9jU3RvY2thYmxlID09IHRydWUpDQoJICAgIHZhciBGcm9tU3RvY2tBcnIgPSBTVk1YSV9Eb1N0b2NrVXBkYXRlKFByb2RJZCwgUFBSUl9TaXRlSWQsICJJbiBUcmFuc2l0IiwgUmN2UXR5LCAiUGFydHMgUmVjZWlwdCIsIFBQUlJfUFJOdW1iZXIsICJEZWNyZWFzZSIsIFBQUlJfUmVxdWVzdElkLCBQUFJSX1JlY2VpcHRzW2pdLklkLCBQUFJSX1VzZXJJZCk7DQoJZWxzZQ0KCSAgICB2YXIgRnJvbVN0b2NrQXJyID0gU1ZNWElfRG9TdG9ja1VwZGF0ZShQcm9kSWQsIFBQUlJfU291cmNlTG9jSWQsICJQdXJjaGFzZWQiLCBSY3ZRdHksICJQYXJ0cyBSZWNlaXB0IiwgUFBSUl9QUk51bWJlciwgIkluY3JlYXNlIiwgUFBSUl9SZXF1ZXN0SWQsIFBQUlJfUmVjZWlwdHNbal0uSWQsIFBQUlJfVXNlcklkKTsNCglpZiAoIUZyb21TdG9ja0FyclswXSkNCgkgICAgew0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTMiKSArICJcbiIgKyBGcm9tU3RvY2tBcnJbNF0pOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm4gZmFsc2U7DQoJICAgIH0NCgl2YXIgRnJvbVByb2RTdG9ja0lkID0gRnJvbVN0b2NrQXJyWzFdOw0KDQoJLy8gSW5jcmVhc2UgQXZhaWxhYmxlIHN0b2NrIGluIHRoZSB0YXJnZXQgbG9jYXRpb24NCgl2YXIgVG9TdG9ja0FyciA9IFNWTVhJX0RvU3RvY2tVcGRhdGUoUHJvZElkLCBQUFJSX1NpdGVJZCwgIkF2YWlsYWJsZSIsIFJjdlF0eSwgIlBhcnRzIFJlY2VpcHQiLCBQUFJSX1BSTnVtYmVyLCAiSW5jcmVhc2UiLCBQUFJSX1JlcXVlc3RJZCwgUFBSUl9SZWNlaXB0c1tqXS5JZCwgUFBSUl9Vc2VySWQpOw0KCWlmICghVG9TdG9ja0FyclswXSkNCgkgICAgew0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTMiKSArICJcbiIgKyBGcm9tU3RvY2tBcnJbNF0pOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm4gZmFsc2U7DQoJICAgIH0NCgl2YXIgVG9Qcm9kU3RvY2tJZCA9IEZyb21TdG9ja0FyclsxXTsJCS8vIERPIE5PVCBDSEFOR0UgVEhJUy4gVGhpcyBpcyBhIEphdmFzY3JpcHQgYnVnLg0KCQkJCQkJCS8vIEZvciBzb21lIG15c3RlcmlvdXMgcmVhc29uLCB0aGUgcHJvZHVjdC1zdG9jay1pZA0KCQkJCQkJCS8vIGZvciBkZXN0aW5hdGlvbiBsb2NhdGlvbiBpcyBzZXQgaW4gRnJvbVN0b2NrQXJyWzFdDQoJCQkJCQkJLy8gaW5zdGVhZCBvZiBUb1N0b2NrQXJyWzFdIGV2ZW4gdGhvdWdoIHRoZSBjb2RlDQoJCQkJCQkJLy8gZXhwbGljaXRseSB1c2VzIFRvU3RvY2tBcnIuIERvbid0IGxvc2Ugc2xlZXAgb3ZlciB0aGlzLg0KCQkJCQkJCS8vIEhTIDA0LzI4LzIwMDgNCg0KCS8vIEJ1aWxkIHNlcmlhbCBudW1iZXIgYXJyYXkgZm9yIHRoZSByZWNlaXZlZCBxdWFudGl0eQ0KCWlmIChTZXJpYWxDb3VudCA+IDApDQoJICAgIHsNCgkgICAgZm9yICh2YXIgayA9IDA7IGsgPCBTZXJpYWxDb3VudDsgaysrKQ0KCQl7DQoJCWlmIChTZXJpYWxBcnJheVtrXVswXSA9PSBQcm9kSWQpDQoJCSAgICB7DQoJCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bMF0gPSBQcm9kSWQ7DQoJCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bMV0gPSBGcm9tUHJvZFN0b2NrSWQ7DQoJCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bMl0gPSBUb1Byb2RTdG9ja0lkOw0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzNdID0gU2VyaWFsQXJyYXlba11bN107DQoJCSAgICB0b3RxKys7DQoJCSAgICB9DQoJCX0NCgkgICAgfQ0KCX0NCg0KICAgIC8vIFVwZGF0ZSBzZXJpYWwgbnVtYmVycyBmb3IgdGhlIHJlY2VpdmVkIHF1YW50aXR5DQogICAgaWYgKFNlcmlhbENvdW50ID4gMCkgeyB2YXIgcmV0dXJuVmFsID0gU1ZNWElfRG9TZXJpYWxTYXZlKFNlcmlhbFNhdmVBcnJheSwgUFBSUl9Vc2VySWQpOyB9DQoNCiAgICAvLyBCdWlsZCBhcnJheXMgZm9yIHVwZGF0aW5nIFBhcnRzIFJlcXVlc3QgbGluZXMgYXMgd2VsbCBhcyBjcmVhdGluZyBuZXcgcmVxdWVzdCBsaW5lcyBpZiBhcHBsaWNhYmxlDQogICAgdmFyIG5ld2NudCA9IDA7DQogICAgdmFyIGN1cmRhdGUgPSBuZXcgRGF0ZSgpOw0KICAgIHZhciByZXFsaW5lc3VwZCA9IG5ldyBBcnJheSgpOw0KICAgIHZhciByZXFsaW5lc2lucyA9IG5ldyBBcnJheSgpOw0KICAgIGZvciAodmFyIG0gPSAwOyBtIDwgUFBSUl9SZWNlaXB0cy5sZW5ndGg7IG0rKykNCiAgICAJew0KCXZhciByZXFsaW5ldXBkID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fUGFydHNfUmVxdWVzdF9MaW5lX19jIik7DQoJdmFyIHJlYyA9IFBQUlJfUmVjZWlwdHNbbV07DQoJdmFyIFNoaXBRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiU2hpcFF0eSIpLnZhbHVlKTsNCgl2YXIgU2hpcEluaXRRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiU2hpcEluaXRRdHkiKS52YWx1ZSk7DQoJdmFyIFJjdlF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJSY3ZRdHkiKS52YWx1ZSk7DQoJdmFyIFJlcVF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJSZXFRdHkiKS52YWx1ZSk7DQoJdmFyIGNoZWNrZWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkNoZWNrYm94IikuY2hlY2tlZDsNCg0KCXJlcWxpbmV1cGQuSWQgPSByZWMuSWQ7DQoJcmVxbGluZXVwZC5TVk1YQ19fUXVhbnRpdHlfUmVjZWl2ZWQyX19jID0gUmN2UXR5Ow0KCXJlcWxpbmV1cGQuU1ZNWENfX0RhdGVfUmVjZWl2ZWRfX2MgPSBTVk1YSV9HZXRDdXJyZW50VGltZSgpOw0KDQoJcmVxbGluZXVwZC5TVk1YQ19fUG9zdGVkX1RvX0ludmVudG9yeV9fYyA9IHRydWU7DQoJaWYgKGNoZWNrZWQgJiYgUmN2UXR5ID09IDApDQoJICAgIHsNCgkgICAgcmVxbGluZXVwZC5TVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAiQ2FuY2VsZWQiOw0KCSAgICByZXFsaW5ldXBkLlNWTVhDX19DYW5jZWxlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoJICAgIHJlcWxpbmV1cGQuU1ZNWENfX0NhbmNlbGVkX0J5X19jID0gUFBSUl9Vc2VySWQ7DQoJICAgIH0NCgllbHNlIGlmIChSY3ZRdHkgPiAwKQ0KCSAgICB7DQoJICAgIHJlcWxpbmV1cGQuU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gIkNvbXBsZXRlZCI7DQoJICAgIHJlcWxpbmV1cGQuU1ZNWENfX0Nsb3NlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoJICAgIHJlcWxpbmV1cGQuU1ZNWENfX0Nsb3NlZF9CeV9fYyA9IFBQUlJfVXNlcklkOw0KCSAgICB9DQoJcmVxbGluZXN1cGQucHVzaChyZXFsaW5ldXBkKTsNCg0KCS8vYWxlcnQoIlByb2Q6ICIgKyBQUFJSX1JlY2VpcHRzW21dLlNWTVhDX19Qcm9kdWN0X19yLk5hbWUgKyAiLCBjaGVja2VkPSIgKyBjaGVja2VkICsgIiwgUmN2OiAiICsgUmN2UXR5ICsgIiwgUmVxOiAiICsgUmVxUXR5KTsNCg0KCS8vIFBhcnQgaXMgcGFydGlhbGx5IHJlY2VpdmVkIGFuZCB1c2VyIGRvZXMgbm90IHdhbnQgdG8gY2xvc2UgdGhlIHJlcXVlc3QgeWV0LiBDcmVhdGUgYSBuZXcgbGluZSBmb3IgcmVtYWluaW5nIHF0eS4NCglpZiAoIWNoZWNrZWQgJiYgUmN2UXR5IDwgUmVxUXR5KQ0KCSAgICB7DQoJICAgIHZhciBjdXJkYXRlID0gbmV3IERhdGUoKTsNCgkgICAgdmFyIGRhdGVzdHIgPSBDb252ZXJ0RGF0ZVRvU0ZEQ0RhdGUoY3VyZGF0ZSk7DQoJICAgIHZhciBzZmRjZGF0ZXN0ciA9IHJlYy5TVk1YQ19fRGF0ZV9SZXF1aXJlZF9fYzsNCgkgICAgdmFyIHNmZGNkYXRlID0gbmV3IERhdGUoc2ZkY2RhdGVzdHIuc3Vic3RyaW5nKDAsNCksIHBhcnNlRmxvYXQoc2ZkY2RhdGVzdHIuc3Vic3RyaW5nKDUsNykpLTEsIHNmZGNkYXRlc3RyLnN1YnN0cmluZyg4KSk7DQoNCgkgICAgdmFyIHJlcWxpbmVpbnMgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19QYXJ0c19SZXF1ZXN0X0xpbmVfX2MiKTsNCgkgICAgcmVxbGluZWlucy5TVk1YQ19fUGFydHNfUmVxdWVzdF9fYyA9IHJlYy5TVk1YQ19fUGFydHNfUmVxdWVzdF9fYzsNCgkgICAgcmVxbGluZWlucy5TVk1YQ19fUHJvZHVjdF9fYyA9IHJlYy5TVk1YQ19fUHJvZHVjdF9fYzsNCgkgICAgcmVxbGluZWlucy5TVk1YQ19fUXVhbnRpdHlfUmVxdWlyZWQyX19jID0gUmVxUXR5IC0gUmN2UXR5Ow0KCSAgICBpZiAoc2ZkY2RhdGUgPiBjdXJkYXRlKQ0KCQlyZXFsaW5laW5zLlNWTVhDX19EYXRlX1JlcXVpcmVkX19jID0gc2ZkY2RhdGVzdHI7DQoJICAgIGVsc2UNCgkJcmVxbGluZWlucy5TVk1YQ19fRGF0ZV9SZXF1aXJlZF9fYyA9IGRhdGVzdHI7DQoJICAgIHJlcWxpbmVpbnMuU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gIk9wZW4iOw0KCSAgICByZXFsaW5laW5zLlNWTVhDX19Qb3N0ZWRfVG9fSW52ZW50b3J5X19jID0gZmFsc2U7DQoJICAgIHJlcWxpbmVpbnMuU1ZNWENfX0FkZGl0aW9uYWxfSW5mb3JtYXRpb25fX2MgPSByZWMuU1ZNWENfX0FkZGl0aW9uYWxfSW5mb3JtYXRpb25fX2M7DQoJICAgIHJlcWxpbmVpbnMuU1ZNWENfX1VuaXRfUHJpY2UyX19jID0gcmVjLlNWTVhDX19Vbml0X1ByaWNlMl9fYzsgLy9CWSBHTSAxOEp1bjA4DQoJICAgIHJlcWxpbmVpbnMuU1ZNWENfX1VzZV9QcmljZV9Gcm9tX1ByaWNlYm9va19fYyA9ICJGYWxzZSI7IC8vQlkgR00gMThKdW4wOA0KCSAgICByZXFsaW5lc2lucy5wdXNoKHJlcWxpbmVpbnMpOw0KCSAgICBuZXdjbnQgKz0gMTsNCgkgICAgfQ0KCX0NCg0KICAgIC8vIFVwZGF0ZSByZWNlaXB0IGluZm9ybWF0aW9uIG9uIHBhcnRzIHJlcXVlc3RzDQogICAgdHJ5IHsNCglzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUocmVxbGluZXN1cGQpOw0KCX0NCiAgICBjYXRjaCAoZSkgew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMSIpICsgIlxuIiArIGUpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuIGZhbHNlOw0KICAgIAl9DQoNCiAgICAvLyBDcmVhdGUgbmV3IHBhcnRzIHJlcXVlc3RzIGlmIGFwcGxpY2FibGUNCiAgICBpZiAobmV3Y250ID4gMCkNCiAgICAJew0KCXRyeSB7DQoJICAgIHZhciByZXR4ID0gc2ZvcmNlLmNvbm5lY3Rpb24uY3JlYXRlKHJlcWxpbmVzaW5zKTsNCgkgICAgfQ0KCWNhdGNoIChlKSB7DQoJICAgIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMSIpICsgIlxuIiArIGUpOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm4gZmFsc2U7DQoJICAgIH0NCgl9DQogICAgZWxzZQ0KICAgIAl7DQoJLy8gVG8gdXBkYXRlIFBhcnRzIFJlcXVlc3QgaGVhZGVyIHN0YXR1cy4uLg0KCS8vIGNoZWNrIGlmIGFsbCBsaW5lcyBoYXZlIGJlZW4gY29tcGxldGVkIG9yIGNhbmNlbGVkIGJ5IGNvbXBhcmluZyBjb3VudHMNCgl2YXIgc29xbDIgPSAiU0VMRUNUIENvdW50KCkgRlJPTSBTVk1YQ19fUGFydHNfUmVxdWVzdF9MaW5lX19jIFdIRVJFIFNWTVhDX19QYXJ0c19SZXF1ZXN0X19jID0gJyIgKyBQUFJSX1JlcXVlc3RJZCArICInIjsNCglxcjIgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMik7DQoNCgl2YXIgc29xbDMgPSAiU0VMRUNUIENvdW50KCkgRlJPTSBTVk1YQ19fUGFydHNfUmVxdWVzdF9MaW5lX19jIFdIRVJFIFNWTVhDX19QYXJ0c19SZXF1ZXN0X19jID0gJyIgKyBQUFJSX1JlcXVlc3RJZCArICInIEFORCBTVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAnQ29tcGxldGVkJyI7DQoJcXIzID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDMpOw0KDQoJdmFyIHNvcWw0ID0gIlNFTEVDVCBDb3VudCgpIEZST00gU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYyBXSEVSRSBTVk1YQ19fUGFydHNfUmVxdWVzdF9fYyA9ICciICsgUFBSUl9SZXF1ZXN0SWQgKyAiJyBBTkQgU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gJ0NhbmNlbGVkJyI7DQoJcXI0ID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDQpOw0KDQoJdmFyIHJlcWhkciA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1BhcnRzX1JlcXVlc3RfX2MiKTsNCglyZXFoZHIuSWQgPSBQUFJSX1JlcXVlc3RJZDsNCg0KCXZhciBoZHJ1cGQgPSBmYWxzZTsNCglpZiAocXIyLnNpemUgPT0gcXIzLnNpemUpCQkvLyBBbGwgbGluZXMgY29tcGxldGVkDQoJICAgIHsNCgkgICAgcmVxaGRyLlNWTVhDX19TdGF0dXNfX2MgPSAiQ29tcGxldGVkIjsNCgkgICAgcmVxaGRyLlNWTVhDX19DbG9zZWRfT25fX2MgPSBTVk1YSV9HZXRDdXJyZW50VGltZSgpOw0KCSAgICByZXFoZHIuU1ZNWENfX0Nsb3NlZF9CeV9fYyA9IFBQUlJfVXNlcklkOw0KCSAgICBoZHJ1cGQgPSB0cnVlOw0KCSAgICB9DQoJZWxzZSBpZiAocXIyLnNpemUgPT0gcXI0LnNpemUpCS8vIEFsbCBsaW5lcyBDYW5jZWxlZA0KCSAgICB7DQoJICAgIHJlcWhkci5TVk1YQ19fU3RhdHVzX19jID0gIkNhbmNlbGVkIjsNCgkgICAgcmVxaGRyLlNWTVhDX19DYW5jZWxlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoJICAgIHJlcWhkci5TVk1YQ19fQ2FuY2VsZWRfQnlfX2MgPSBQUFJSX1VzZXJJZDsNCgkgICAgaGRydXBkID0gdHJ1ZTsNCgkgICAgfQ0KCWlmIChoZHJ1cGQpDQoJICAgIHsNCgkgICAgdHJ5IHsNCgkJc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKFtyZXFoZHJdKTsNCgkJfQ0KCSAgICBjYXRjaCAoZSkgew0KCQlhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDEiKSArICJcbiIgKyBlKTsNCgkJQ2xvc2VXaW5kb3coKTsNCgkJcmV0dXJuIGZhbHNlOw0KCQl9DQoJICAgIH0NCgl9DQogICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEyIikpOw0KICAgIHdpbmRvdy5vcGVuZXIubG9jYXRpb24ucmVsb2FkKHRydWUpOw0KICAgIENsb3NlV2luZG93KCk7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUHJvY1NWT19TaG93UmVxdWVzdFJlY29yZHMoc2VydklkLCBzdm9udW0sIHVJZCwgbGluZUlkLCBzZXNzSWQpDQp7DQogICAgU1ZNWElfSW5pdE1lc3NhZ2VMaXN0KCJXT1JEU0M5Iik7IA0KICAgIFNWTVhJX1NldExhYmVscygiUHJvY2Vzc1JlY2VpcHRzRm9yU1ZPIik7ICANCg0KDQogICAgUFJTVk9fU1ZPSWQgPSBzZXJ2SWQ7DQogICAgUFJTVk9fVXNlcklkID0gdUlkOw0KICAgIFBSU1ZPX1NWT0xpbmVJZCA9IGxpbmVJZDsNCiAgICBQUlNWT19TVk9OdW1iZXIgPSBzdm9udW07DQogICAgUFJTVk9fU2Vzc2lvbklkID0gc2Vzc0lkOw0KDQogICAgLy8gR2V0IFNWTyBoZWFkZXIgaW5mbw0KICAgIHZhciBzb3FsMSA9ICJTRUxFQ1QgU1ZNWENfX09yZGVyX1N0YXR1c19fYyBGUk9NIFNWTVhDX19TZXJ2aWNlX09yZGVyX19jIFdIRVJFIElkID0gJyIgKyBQUlNWT19TVk9JZCArICInIjsNCiAgICB2YXIgcXIxID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDEpOw0KICAgIGlmIChxcjEuc2l6ZSA8PSAwKQ0KCXsNCgkgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAyIikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICB2YXIgcmVjMSA9IHFyMS5nZXRBcnJheSgicmVjb3JkcyIpOw0KICAgIGlmIChyZWMxWzBdLlNWTVhDX19PcmRlcl9TdGF0dXNfX2MgPT0gIkNsb3NlZCIpDQogICAgCXsNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDgiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIGlmIChyZWMxWzBdLlNWTVhDX19PcmRlcl9TdGF0dXNfX2MgPT0gIkNhbmNlbGVkIikNCgl7DQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA5IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCg0KICAgIC8vIEdldCBTYWxlc2ZvcmNlIGludGVybmFsIFJlY29yZCBUeXBlIElEIGZvciBTZXJ2aWNlIG9yZGVyICJSZXF1ZXN0L1JlY2VpcHQiDQogICAgdmFyIHNvcWwgPSAiU0VMRUNUIElkIEZST00gUmVjb3JkVHlwZSBXSEVSRSBTb2JqZWN0VHlwZSA9ICdTVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jJyBBTkQgTmFtZSA9ICdSZXF1ZXN0L1JlY2VpcHQnIg0KICAgIHZhciBxdWVyeVJlc3VsdCA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwpOyANCiAgICB2YXIgcnRyZWNvcmRzID0gcXVlcnlSZXN1bHQuZ2V0QXJyYXkoInJlY29yZHMiKTsNCiAgICBpZiAocnRyZWNvcmRzLmxlbmd0aCA9PSAwKQ0KCXsgICAgICAgIA0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMCIpKTsNCiAgICAgICAgd2luZG93LmNsb3NlKCk7DQogICAgICAgIHJldHVybjsNCgl9DQogICAgUFJTVk9fUmVxUmVjb3JkVHlwZUlkID0gcnRyZWNvcmRzWzBdLklkOw0KDQogICAgLy8gR2V0IG9wZW4gU1ZPIGxpbmVzDQogICAgdmFyIHNvcWwyID0gIlNFTEVDVCBJZCwgU1ZNWENfX1Byb2R1Y3RfX2MsIFNWTVhDX19Qcm9kdWN0X19yLk5hbWUsIFNWTVhDX19SZXF1ZXN0ZWRfUXVhbnRpdHkyX19jLCAiICsNCiAgICAJCSJTVk1YQ19fRGF0ZV9SZXF1ZXN0ZWRfX2MsIFNWTVhDX19RdWFudGl0eV9TaGlwbWVudF9Jbml0aWF0ZWQyX19jLCBTVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MsICIgKw0KICAgIAkJIlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2MsICIrDQogICAgICAgICAgICAiU1ZNWENfX1JlcXVlc3RlZF9aaXBfX2MsIFNWTVhDX19SZXF1ZXN0ZWRfU3RyZWV0X19jLFNWTVhDX19SZXF1ZXN0ZWRfU3RhdGVfX2MsIFNWTVhDX19SZXF1ZXN0ZWRfQ291bnRyeV9fYywgU1ZNWENfX1JlcXVlc3RlZF9DaXR5X19jLCAiKw0KCQkJIlNWTVhDX19SZWNlaXZlZF9aaXBfX2MsICBTVk1YQ19fUmVjZWl2ZWRfU3RyZWV0X19jLCBTVk1YQ19fUmVjZWl2ZWRfU3RhdGVfX2MsICBTVk1YQ19fUmVjZWl2ZWRfQ291bnRyeV9fYywgU1ZNWENfX1JlY2VpdmVkX0NpdHlfX2MgICIgKw0KCQkiRlJPTSBTVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jIFdIRVJFIFNWTVhDX19TZXJ2aWNlX09yZGVyX19jID0gJyIgKyBQUlNWT19TVk9JZCArICInIEFORCAiICsNCgkJIlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICdPcGVuJyBBTkQgUmVjb3JkVHlwZUlkID0gJyIgKyBQUlNWT19SZXFSZWNvcmRUeXBlSWQgKyAiJyI7DQogICAgaWYgKFBSU1ZPX1NWT0xpbmVJZCkgeyBzb3FsMiA9IHNvcWwyICsgIiBBTkQgSWQgPSAnIiArIFBSU1ZPX1NWT0xpbmVJZCArICInIiB9IDsNCiAgICB2YXIgcXIyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDIpOw0KICAgIGlmIChxcjIuc2l6ZSA8PSAwKQ0KCXsNCglpZiAoUFJTVk9fU1ZPTGluZUlkKQ0KCQl7CSAgICANCgkJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDExIikpOw0KCQl9DQoJZWxzZQ0KCSAgICB7CQ0KCQlhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTIiKSk7DQoJCX0NCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgdmFyIHJlcXJlY3MgPSBuZXcgc2ZvcmNlLlF1ZXJ5UmVzdWx0SXRlcmF0b3IocXIyKTsNCg0KICAgIHZhciByb3dudW0gPSAwOw0KICAgIHZhciB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsaXN0X3Rib2R5Iik7DQoNCiAgICBTVk1YSV9Qcm9jU1ZPX0RyYXdIZWFkZXIodGJvZHkpOw0KDQogICAgdmFyIG5vbG9jID0gMDsNCiAgICB3aGlsZShyZXFyZWNzLmhhc05leHQoKSkNCgl7DQoJdmFyIHJlcXJlYyA9IHJlcXJlY3MubmV4dCgpOw0KDQoJaWYgKCFyZXFyZWMuU1ZNWENfX1JlcXVlc3RlZF9Mb2NhdGlvbl9fYykNCgkgICAgew0KCSAgICBub2xvYyArPSAxOw0KCSAgICBjb250aW51ZTsNCgkgICAgfQ0KDQoJdmFyIHJlcWlkID0gcmVxcmVjLklkOw0KCXZhciBwcm9kaWQgPSByZXFyZWMuU1ZNWENfX1Byb2R1Y3RfX2M7DQoJdmFyIFJlcVF0eSA9IHBhcnNlRmxvYXQocmVxcmVjLlNWTVhDX19SZXF1ZXN0ZWRfUXVhbnRpdHkyX19jKTsNCg0KCWlmIChyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MgPT0gbnVsbCB8fCBpc05hTihyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MpKQ0KCSAgICB2YXIgU2hpcEluaXRRdHkgPSAwOw0KCWVsc2UNCgkgICAgdmFyIFNoaXBJbml0UXR5ID0gcGFyc2VGbG9hdChyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBtZW50X0luaXRpYXRlZDJfX2MpOw0KDQoJaWYgKHJlcXJlYy5TVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MgPT0gbnVsbCB8fCBpc05hTihyZXFyZWMuU1ZNWENfX1F1YW50aXR5X1NoaXBwZWQyX19jKSkNCgkgICAgdmFyIFNoaXBRdHkgPSAwOw0KCWVsc2UNCgkgICAgdmFyIFNoaXBRdHkgPSBwYXJzZUZsb2F0KHJlcXJlYy5TVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MpOw0KDQoJdmFyIHRyID0gbWFrZVJvdyhtYWtlQXR0cnMocm93bnVtLHRib2R5KSApOw0KCXRyLnNvYmplY3QgPSByZXFyZWM7DQoJdGJvZHkuYXBwZW5kQ2hpbGQodHIpOw0KDQoJCS8vIENvbCAxLiBQcm9kdWN0IE5hbWUNCgljcmVhdGVUYWcodHIsInRoIix7InNjb3BlIjoicm93In0pLmlubmVySFRNTCA9DQoJCSI8YSB0YXJnZXQ9X2JsYW5rIGhyZWY9XCIvIiArIHByb2RpZCArICJcIj4iICsgcHJvZGlkID8gcmVxcmVjLlNWTVhDX19Qcm9kdWN0X19yLk5hbWUgOiAiVW5rbm93biIgKyAiPC9hPiI7DQoNCgkJLy8gQ29sIDIuIFJlcXVlc3RlZCBRdWFudGl0eQ0KCWNyZWF0ZVRhZyh0ciwidGQiLCBbXSkuaW5uZXJIVE1MID0NCgkJIjxpbnB1dCBkaXNhYmxlZD1cInRydWVcIiB0eXBlPVwidGV4dFwiIGlkPVwiIiArIHJlcWlkICsgIlJlcVF0eVwiIG5hbWU9XCIiICsgcmVxaWQgKyAiUmVxUXR5XCIgdmFsdWU9XCIiICsgUmVxUXR5ICsgIlwiPjwvaW5wdXQ+IjsNCg0KCQkvLyBDb2wgMy4gUmVjZWl2ZWQgUXVhbnRpdHkNCgljcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSI8aW5wdXQgdHlwZT1cInRleHRcIiBpZD1cIiIgKyByZXFpZCArICJSY3ZRdHlcIiBuYW1lPVwiIiArIHJlcWlkICsgIlJjdlF0eVwiIHZhbHVlPVwiIiArIFJlcVF0eSArICJcIiBvbmNoYW5nZT1cIlNWTVhJX1Byb2NTVk9fVmFsaWRhdGVRdWFudGl0eSh0aGlzKTtcIj48L2lucHV0PiI7DQoNCgkJLy8gQ29sIDQuIENoZWNrYm94DQoJY3JlYXRlVGFnKHRyLCJ0ZCIseydjbGFzcyc6J2FjdGlvbkNvbHVtbicsJ2FsaWduJzonY2VudGVyJ30pLmlubmVySFRNTCA9DQoJCSI8aW5wdXQgY2hlY2tlZD1cInRydWVcIiBkaXNhYmxlZD1cInRydWVcIiB0eXBlPVwiY2hlY2tib3hcIiBpZD1cIiIgKyByZXFpZCArICJDaGVja2JveFwiIG5hbWU9XCJpZHNcIiB2YWx1ZT1cIiIgKyByZXFpZCArICJcIiA+Jm5ic3A7IjsNCg0KCQkvLyBDb2wgNS4gU3RhdHVzIE1lc3NhZ2UNCgljcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSI8ZGl2IGlkPVwiIiArIHJlcWlkICsgIkVyck1zZ1wiIG5hbWU9XCIiICsgcmVxaWQgKyAiRXJyTXNnXCI+PC9kaXY+IjsNCg0KCQkvLyBDb2wgNi4gU2hpcG1lbnQgSW5pdGlhdGVkIFF1YW50aXR5DQoJY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkiPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBkaXNhYmxlZD1cInRydWVcIiBpZD1cIiIgKyByZXFpZCArICJTaGlwSW5pdFF0eVwiIG5hbWU9XCIiICsgcmVxaWQgKyAiU2hpcEluaXRRdHlcIiB2YWx1ZT1cIiIgKyBTaGlwSW5pdFF0eSArICJcIj48L2lucHV0PiI7DQoNCgkJLy8gQ29sIDcuIFNoaXBwZWQgUXVhbnRpdHkNCgljcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSI8aW5wdXQgdHlwZT1cImhpZGRlblwiIGRpc2FibGVkPVwidHJ1ZVwiIGlkPVwiIiArIHJlcWlkICsgIlNoaXBRdHlcIiBuYW1lPVwiIiArIHJlcWlkICsgIlNoaXBRdHlcIiB2YWx1ZT1cIiIgKyBTaGlwUXR5ICsgIlwiPjwvaW5wdXQ+IjsNCg0KCXJvd251bSArPSAxOw0KCX0NCg0KICAgIGlmIChub2xvYyA+IDApDQogICAgCXsNCglpZiAocm93bnVtID4gMCkJCQkgICAgDQoJICAgIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMyIpKTsNCgllbHNlDQoJICAgIHsNCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE0IikpOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm47DQoJICAgIH0NCgl9DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dhaXRtc2cnKS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7IA0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YWl0bXNnJykuc3R5bGUuaGVpZ2h0ID0gMDsgDQp9DQoNCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Qcm9jU1ZPX1ZhbGlkYXRlUXVhbnRpdHkoY3RybCkNCnsNCiAgICB2YXIgcmVxaWQgPSBjdHJsLm5hbWUuc3Vic3RyaW5nKDAsMTgpOw0KICAgIHZhciByZXFxdHluYW1lID0gcmVxaWQgKyAiUmVxUXR5IjsNCiAgICB2YXIgcmVxcXR5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVxcXR5bmFtZSk7DQoNCiAgICBpZihwYXJzZUZsb2F0KGN0cmwudmFsdWUpID49IHBhcnNlRmxvYXQocmVxcXR5LnZhbHVlKSkNCiAgICAJew0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlcWlkKyJDaGVja2JveCIpLmNoZWNrZWQgPSB0cnVlOw0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlcWlkKyJDaGVja2JveCIpLmRpc2FibGVkID0gdHJ1ZTsNCgl9DQogICAgZWxzZQ0KICAgIAl7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVxaWQrIkNoZWNrYm94IikuY2hlY2tlZCA9IGZhbHNlOw0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlcWlkKyJDaGVja2JveCIpLmRpc2FibGVkID0gZmFsc2U7DQoJfQ0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Byb2NTVk9fRHJhd0hlYWRlcih0YSkNCnsNCiAgICB2YXIgdHIgPSBtYWtlUm93KHsnY2xhc3MnOidoZWFkZXJSb3cnfSk7DQogICAgdGEuYXBwZW5kQ2hpbGQodHIpOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDA1IikrIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCcsJ2FsaWduJzoncmlnaHQnfSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIGhyZWY9XCIjXCIgdGl0bGU9XCJcIj4iK1NWTVhJX0dldE1lc3NhZ2UoIkxBQjAwNiIpKyI8L2E+IjsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnLCdhbGlnbic6J3JpZ2h0J30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+ICIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDA3IikrIiAgPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJ30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMDgiKSsiPC9hPiI7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUHJvY1NWT19WYWxpZGF0ZUFuZFByb2Nlc3MoKQ0Kew0KICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbJ1Byb2Nlc3NSZWNlaXB0c0ZvclNWTyddOw0KDQogICAgdmFyIHNvYmplY3RMaXN0ID0gbmV3IEFycmF5KCk7DQogICAgZm9yIChpID0gMDsgaSA8IGZvcm0uZWxlbWVudHMubGVuZ3RoOyBpKyspDQoJew0KCWlmIChmb3JtLmVsZW1lbnRzW2ldLm5hbWUgPT0gJ2lkcycpDQoJICAgIHsNCgkgICAgdmFyIHBuID0gZm9ybS5lbGVtZW50c1tpXS5wYXJlbnROb2RlOw0KCSAgICB2YXIgcHBuID0gZm9ybS5lbGVtZW50c1tpXS5wYXJlbnROb2RlLnBhcmVudE5vZGU7DQoJICAgIGlmIChwcG4uc29iamVjdCkNCgkJew0KCQlzb2JqZWN0TGlzdC5wdXNoKHBwbi5zb2JqZWN0KTsNCgkJfQ0KCSAgICB9DQoJfQ0KDQogICAgdmFyIHZhbGlkX3JlY2VpcHRzID0gbmV3IEFycmF5KCk7DQogICAgdmFyIGludmFsaWQgPSBmYWxzZTsNCiAgICB2YXIgc2tpcGNudCA9IDA7DQogICAgaW52YWxpZCA9IGZhbHNlOw0KICAgIGZvciAodmFyIGsgPSAwOyBrIDwgc29iamVjdExpc3QubGVuZ3RoOyBrKyspDQogICAgCXsNCgl2YXIgcmVjX2ludmFsaWQgPSBmYWxzZTsNCgl2YXIgcmVjID0gc29iamVjdExpc3Rba107DQoJdmFyIFNoaXBRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiU2hpcFF0eSIpLnZhbHVlKTsNCgl2YXIgU2hpcEluaXRRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiU2hpcEluaXRRdHkiKS52YWx1ZSk7DQoJdmFyIFJjdlF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJSY3ZRdHkiKS52YWx1ZSk7DQoJdmFyIFJlcVF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJSZXFRdHkiKS52YWx1ZSk7DQoJdmFyIGNoZWNrZWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkNoZWNrYm94IikuY2hlY2tlZDsNCgkvL2FsZXJ0KCJjaGVja2VkPSIgKyBjaGVja2VkICsgIiwgUmVxUXR5PSIgKyBSZXFRdHkgKyAiLCBSY3ZRdHk9IiArIFJjdlF0eSArICIsIFNoaXBJbml0UXR5PSIgKyBTaGlwSW5pdFF0eSArICIsIFNoaXBRdHk9IiArIFNoaXBRdHkpOw0KCXZhciBFcnJNc2cgPSAiIjsNCglpZiAoaXNOYU4oUmN2UXR5KSB8fCBSY3ZRdHkgPCAwKQ0KCSAgICB7DQoJICAgIEVyck1zZyA9IFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMyIpOyANCgkJDQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICByZWNfaW52YWxpZCA9IHRydWU7DQoJICAgIH0NCgllbHNlIGlmICghY2hlY2tlZCAmJiBSY3ZRdHkgPT0gMCkNCgkgICAgew0KCSAgICBza2lwY250ICs9IDE7DQoJICAgIH0NCgllbHNlIGlmKFJjdlF0eSA+IFJlcVF0eSkNCgkgICAgew0KCSAgICBFcnJNc2cgPSAgU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA0Iik7DQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICByZWNfaW52YWxpZCA9IHRydWU7DQoJICAgIH0NCgllbHNlIGlmIChjaGVja2VkICYmIFJjdlF0eSA8IFJlcVF0eSAmJiBTaGlwUXR5ID4gMCkNCgkgICAgew0KCSAgICBFcnJNc2cgPSBTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDUiKTsNCgkgICAgaW52YWxpZCA9IHRydWU7DQoJICAgIHJlY19pbnZhbGlkID0gdHJ1ZTsNCgkgICAgfQ0KCWVsc2UgaWYgKGNoZWNrZWQgJiYgUmN2UXR5IDwgUmVxUXR5ICYmIFNoaXBJbml0UXR5ID4gMCkNCgkgICAgew0KCSAgICBFcnJNc2cgPSBTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDYiKTsgDQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICByZWNfaW52YWxpZCA9IHRydWU7DQoJICAgIH0NCglpZiAocmVjX2ludmFsaWQpDQoJICAgIHsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5zdHlsZS5ib3JkZXIgPSAiI0ZGMDAwMCAycHggc29saWQiOw0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkVyck1zZyIpLmlubmVySFRNTCA9IEVyck1zZzsNCgkgICAgfQ0KCWVsc2UNCgkgICAgew0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkVyck1zZyIpLnN0eWxlLmJvcmRlciA9ICIwIjsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5pbm5lckhUTUwgPSAiIjsNCgkgICAgfQ0KCWlmICghcmVjX2ludmFsaWQgJiYgUmN2UXR5ID4gMCkNCgkgICAgdmFsaWRfcmVjZWlwdHMucHVzaChyZWMpOw0KCX0NCg0KICAgIGlmKGludmFsaWQpIHsgcmV0dXJuOyB9DQoNCiAgICBpZihza2lwY250ID09IHNvYmplY3RMaXN0Lmxlbmd0aCkNCiAgICAJewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDciKSk7DQoJcmV0dXJuOw0KCX0NCg0KICAgIFBSU1ZPX1JlY2VpcHRzID0gdmFsaWRfcmVjZWlwdHM7DQogICAgU1ZNWElfUHJvY1NWT19Qcm9jZXNzUmVjZWlwdHMoKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Qcm9jU1ZPX1Byb2Nlc3NSZWNlaXB0cygpDQp7DQogICAgdmFyIFByb2RBcnJheSA9IFNWTVhJX011bHRpRGltZW5zaW9uYWxBcnJheShQUlNWT19SZWNlaXB0cy5sZW5ndGgsIDYpOw0KICAgIGZvciAodmFyIGkgPSAwOyBpIDwgUFJTVk9fUmVjZWlwdHMubGVuZ3RoOyBpKyspDQoJew0KCXZhciBSY3ZRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSU1ZPX1JlY2VpcHRzW2ldLklkKyJSY3ZRdHkiKS52YWx1ZSk7DQoJUHJvZEFycmF5W2ldWzBdID0gUFJTVk9fUmVjZWlwdHNbaV0uU1ZNWENfX1Byb2R1Y3RfX2M7DQoJUHJvZEFycmF5W2ldWzFdID0gUmN2UXR5Ow0KCVByb2RBcnJheVtpXVsyXSA9IFBSU1ZPX1JlY2VpcHRzW2ldLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2M7DQoJUHJvZEFycmF5W2ldWzNdID0gIkluIFRyYW5zaXQiOw0KCVByb2RBcnJheVtpXVs0XSA9IFBSU1ZPX1JlY2VpcHRzW2ldLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2M7DQoJUHJvZEFycmF5W2ldWzVdID0gIkF2YWlsYWJsZSI7DQoJfQ0KICAgIC8vIENhbGwgc2VyaWFsIHNlbGVjdGlvbiB1dGlsaXR5LiBJdCB3aWxsIGNhcHR1cmUgc2VyaWFsIG51bWJlcnMgd2hlcmUgYXBwbGljYWJsZSBhbmQNCiAgICAvLyBjYWxsIGJhY2sgdGhlIHJvdXRpbmUgYmVsb3cgd2l0aCB0aGUgc2VsZWN0ZWQgc2VyaWFscw0KICAgIHdpbmRvdy5ibHVyKCk7DQogICAgdmFyIHJldHVyblZhbCA9IFNWTVhJX0RvU2VyaWFsU2VsZWN0aW9uKFByb2RBcnJheSwgIlNWTyBSZWNlaXB0IiwgUFJTVk9fU1ZPTnVtYmVyLCBQUlNWT19Vc2VySWQsIFBSU1ZPX1Nlc3Npb25JZCk7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfQ2FsbGJhY2tfUHJvY2Vzc1NWT1JlY2VpcHRzKFNlcmlhbFNlbGVjdFN0YXR1cywgU2VyaWFsQ291bnQsIFNlcmlhbEFycmF5KQ0Kew0KICAgIHdpbmRvdy5mb2N1cygpOw0KICAgIGlmICghU2VyaWFsU2VsZWN0U3RhdHVzKQ0KICAgIAl7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm4gZmFsc2U7DQoJfQ0KICAgIHZhciB0b3RxID0gMDsNCiAgICB2YXIgU2VyaWFsU2F2ZUFycmF5ID0gU1ZNWElfTXVsdGlEaW1lbnNpb25hbEFycmF5KFNlcmlhbENvdW50LCA0KTsNCg0KICAgIGZvciAodmFyIGogPSAwOyBqIDwgUFJTVk9fUmVjZWlwdHMubGVuZ3RoOyBqKyspDQogICAgCXsNCgl2YXIgUHJvZElkID0gUFJTVk9fUmVjZWlwdHNbal0uU1ZNWENfX1Byb2R1Y3RfX2M7DQoJdmFyIFJjdlF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoUFJTVk9fUmVjZWlwdHNbal0uSWQrIlJjdlF0eSIpLnZhbHVlKTsNCg0KCS8vIERlY3JlYXNlIEluIFRyYW5zaXQgc3RvY2sgaW4gdGhlIHRhcmdldCBsb2NhdGlvbg0KCXZhciBGcm9tU3RvY2tBcnIgPSBTVk1YSV9Eb1N0b2NrVXBkYXRlKFByb2RJZCwgUFJTVk9fUmVjZWlwdHNbal0uU1ZNWENfX1JlcXVlc3RlZF9Mb2NhdGlvbl9fYywgIkluIFRyYW5zaXQiLCBSY3ZRdHksICJTVk8gUmVjZWlwdCIsIFBSU1ZPX1NWT051bWJlciwgIkRlY3JlYXNlIiwgUFJTVk9fU1ZPSWQsIFBSU1ZPX1JlY2VpcHRzW2pdLklkLCBQUlNWT19Vc2VySWQpOw0KCWlmICghRnJvbVN0b2NrQXJyWzBdKQ0KCSAgICB7CQ0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTUiKSsiXG4iICsgRnJvbVN0b2NrQXJyWzRdKTsNCgkgICAgQ2xvc2VXaW5kb3coKTsNCgkgICAgcmV0dXJuIGZhbHNlOw0KCSAgICB9DQoJdmFyIEZyb21Qcm9kU3RvY2tJZCA9IEZyb21TdG9ja0FyclsxXTsNCg0KCS8vIEluY3JlYXNlIEF2YWlsYWJsZSBzdG9jayBpbiB0aGUgdGFyZ2V0IGxvY2F0aW9uDQoJdmFyIFRvU3RvY2tBcnIgPSBTVk1YSV9Eb1N0b2NrVXBkYXRlKFByb2RJZCwgUFJTVk9fUmVjZWlwdHNbal0uU1ZNWENfX1JlcXVlc3RlZF9Mb2NhdGlvbl9fYywgIkF2YWlsYWJsZSIsIFJjdlF0eSwgIlNWTyBSZWNlaXB0IiwgUFJTVk9fU1ZPTnVtYmVyLCAiSW5jcmVhc2UiLCBQUlNWT19TVk9JZCwgUFJTVk9fUmVjZWlwdHNbal0uSWQsIFBSU1ZPX1VzZXJJZCk7DQoJaWYgKCFUb1N0b2NrQXJyWzBdKQ0KCSAgICB7CSAgIA0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTUiKSsiXG4iICsgRnJvbVN0b2NrQXJyWzRdKTsNCgkgICAgQ2xvc2VXaW5kb3coKTsNCgkgICAgcmV0dXJuIGZhbHNlOw0KCSAgICB9DQoJdmFyIFRvUHJvZFN0b2NrSWQgPSBGcm9tU3RvY2tBcnJbMV07DQoNCgkvLyBCdWlsZCBzZXJpYWwgbnVtYmVyIGFycmF5IGZvciB0aGUgcmVjZWl2ZWQgcXVhbnRpdHkNCglpZiAoU2VyaWFsQ291bnQgPiAwKQ0KCSAgICB7DQoJICAgIGZvciAodmFyIGsgPSAwOyBrIDwgU2VyaWFsQ291bnQ7IGsrKykNCgkJew0KCQlpZiAoU2VyaWFsQXJyYXlba11bMF0gPT0gUHJvZElkICYmIFNlcmlhbEFycmF5W2tdWzRdID09IFBSU1ZPX1JlY2VpcHRzW2pdLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2MpDQoJCSAgICB7DQoJCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bMF0gPSBQcm9kSWQ7DQoJCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bMV0gPSBGcm9tUHJvZFN0b2NrSWQ7DQoJCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bMl0gPSBUb1Byb2RTdG9ja0lkOw0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzNdID0gU2VyaWFsQXJyYXlba11bN107DQoJCSAgICB0b3RxKys7DQoJCSAgICB9DQoJCX0NCgkgICAgfQ0KCX0NCg0KICAgIC8vIFVwZGF0ZSBzZXJpYWwgbnVtYmVycyBmb3IgdGhlIHJlY2VpdmVkIHF1YW50aXR5DQogICAgaWYgKFNlcmlhbENvdW50ID4gMCkgeyB2YXIgcmV0dXJuVmFsID0gU1ZNWElfRG9TZXJpYWxTYXZlKFNlcmlhbFNhdmVBcnJheSwgUFJTVk9fVXNlcklkKTsgfQ0KDQogICAgdmFyIG5ld2NudCA9IDA7DQogICAgdmFyIGN1cmRhdGUgPSBuZXcgRGF0ZSgpOw0KICAgIHZhciBzdm9saW5lc3VwZCA9IG5ldyBBcnJheSgpOw0KICAgIHZhciBzdm9saW5lc2lucyA9IG5ldyBBcnJheSgpOw0KICAgIGZvciAodmFyIG0gPSAwOyBtIDwgUFJTVk9fUmVjZWlwdHMubGVuZ3RoOyBtKyspDQogICAgCXsNCgkJCXZhciBzdm9saW5ldXBkID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jIik7DQoJCQl2YXIgcmVjID0gUFJTVk9fUmVjZWlwdHNbbV07DQoJCQl2YXIgU2hpcFF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJTaGlwUXR5IikudmFsdWUpOw0KCQkJdmFyIFNoaXBJbml0UXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlNoaXBJbml0UXR5IikudmFsdWUpOw0KCQkJdmFyIFJjdlF0eSA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJSY3ZRdHkiKS52YWx1ZSk7DQoJCQl2YXIgUmVxUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlJlcVF0eSIpLnZhbHVlKTsNCgkJCXZhciBjaGVja2VkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJDaGVja2JveCIpLmNoZWNrZWQ7DQoNCgkJCXN2b2xpbmV1cGQuSWQgPSByZWMuSWQ7DQoJCQlzdm9saW5ldXBkLlNWTVhDX19SZWNlaXZlZF9RdWFudGl0eTJfX2MgPSBSY3ZRdHk7DQoJCQlzdm9saW5ldXBkLlNWTVhDX19EYXRlX1JlY2VpdmVkX19jID0gU1ZNWElfR2V0Q3VycmVudFRpbWUoKTsNCg0KCQkJc3ZvbGluZXVwZC5TVk1YQ19fUG9zdGVkX1RvX0ludmVudG9yeV9fYyA9IHRydWU7DQoJCQlpZiAoY2hlY2tlZCAmJiBSY3ZRdHkgPT0gMCkNCgkJCQl7DQoJCQkJc3ZvbGluZXVwZC5TVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAiQ2FuY2VsZWQiOw0KCQkJCXN2b2xpbmV1cGQuU1ZNWENfX0NhbmNlbGVkX09uX19jID0gU1ZNWElfR2V0Q3VycmVudFRpbWUoKTsNCgkJCQlzdm9saW5ldXBkLlNWTVhDX19DYW5jZWxlZF9CeV9fYyA9IFBSU1ZPX1VzZXJJZDsNCgkJCQl9DQoJCQllbHNlIGlmIChSY3ZRdHkgPiAwKQ0KCQkJCXsNCgkJCQlzdm9saW5ldXBkLlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICJDb21wbGV0ZWQiOw0KCQkJCXN2b2xpbmV1cGQuU1ZNWENfX0Nsb3NlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoJCQkJc3ZvbGluZXVwZC5TVk1YQ19fQ2xvc2VkX0J5X19jID0gUFJTVk9fVXNlcklkOw0KCQkJCX0NCgkJCXN2b2xpbmVzdXBkLnB1c2goc3ZvbGluZXVwZCk7DQoNCgkJCS8vIFBhcnQgaXMgcGFydGlhbGx5IHJlY2VpdmVkIGFuZCB1c2VyIGRvZXMgbm90IHdhbnQgdG8gY2xvc2UgdGhlIHJlcXVlc3QgeWV0LiBDcmVhdGUgYSBuZXcgbGluZSBmb3IgcmVtYWluaW5nIHF0eS4NCgkJDQoJCQlpZiAoIWNoZWNrZWQgJiYgUmN2UXR5IDwgUmVxUXR5KQ0KCQkJCXsNCgkJCQl2YXIgc3ZvbGluZWlucyA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYyIpOw0KCQkJCXN2b2xpbmVpbnMuUmVjb3JkVHlwZUlkID0gUFJTVk9fUmVxUmVjb3JkVHlwZUlkOw0KCQkJCXN2b2xpbmVpbnMuU1ZNWENfX0xpbmVfVHlwZV9fYyA9ICJQYXJ0cyI7DQoJCQkJc3ZvbGluZWlucy5TVk1YQ19fU2VydmljZV9PcmRlcl9fYyA9IFBSU1ZPX1NWT0lkOw0KCQkJCXN2b2xpbmVpbnMuU1ZNWENfX1Byb2R1Y3RfX2MgPSByZWMuU1ZNWENfX1Byb2R1Y3RfX2M7DQoJCQkJc3ZvbGluZWlucy5TVk1YQ19fUmVxdWVzdGVkX1F1YW50aXR5Ml9fYyA9IFJlcVF0eSAtIFJjdlF0eTsNCgkJCQlzdm9saW5laW5zLlNWTVhDX19EYXRlX1JlcXVlc3RlZF9fYyA9IHJlYy5TVk1YQ19fRGF0ZV9SZXF1ZXN0ZWRfX2M7DQoJCQkJc3ZvbGluZWlucy5TVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAiT3BlbiI7DQoJCQkJc3ZvbGluZWlucy5TVk1YQ19fUG9zdGVkX1RvX0ludmVudG9yeV9fYyA9IGZhbHNlOw0KCQkJCS8vc3ZvbGluZWlucy5TVk1YQ19fUmVxdWVzdGVkX0xvY2F0aW9uX19jID0gcmVjLlNWTVhDX19SZXF1ZXN0ZWRfTG9jYXRpb25fX2MgOyAgDQoJCQkJc3ZvbGluZWlucy5TVk1YQ19fUmVxdWVzdGVkX0xvY2F0aW9uX19jICAgICA9IHJlYy5TVk1YQ19fUmVxdWVzdGVkX0Zyb21fX2M7CQkJIC8vIEFkZGVkICBvbiA2LVNlcC0wOCAgYnkgU2QJCQ0KCQkJCXN2b2xpbmVpbnMuU1ZNWENfX1JlcXVlc3RlZF9aaXBfX2MgICAgCT0gcmVjLlNWTVhDX19SZXF1ZXN0ZWRfWmlwX19jOyANCgkJCQlzdm9saW5laW5zLlNWTVhDX19SZXF1ZXN0ZWRfU3RyZWV0X19jIAk9IHJlYy5TVk1YQ19fUmVxdWVzdGVkX1N0cmVldF9fYzsgOw0KCQkJCXN2b2xpbmVpbnMuU1ZNWENfX1JlcXVlc3RlZF9TdGF0ZV9fYyAJPSByZWMuU1ZNWENfX1JlcXVlc3RlZF9TdGF0ZV9fYzsNCgkJCQlzdm9saW5laW5zLlNWTVhDX19SZXF1ZXN0ZWRfQ291bnRyeV9fYyAJPSByZWMuU1ZNWENfX1JlcXVlc3RlZF9Db3VudHJ5X19jOyANCgkJCQlzdm9saW5laW5zLlNWTVhDX19SZXF1ZXN0ZWRfQ2l0eV9fYyAJPSByZWMuU1ZNWENfX1JlcXVlc3RlZF9DaXR5X19jOyANCgkJCQlzdm9saW5laW5zLlNWTVhDX19SZWNlaXZlZF9aaXBfX2MgCQk9IHJlYy5TVk1YQ19fUmVjZWl2ZWRfWmlwX19jOyANCgkJCQlzdm9saW5laW5zLlNWTVhDX19SZWNlaXZlZF9TdHJlZXRfX2MgCT0gcmVjLlNWTVhDX19SZWNlaXZlZF9TdHJlZXRfX2M7IA0KCQkJCXN2b2xpbmVpbnMuU1ZNWENfX1JlY2VpdmVkX1N0YXRlX19jIAk9IHJlYy5TVk1YQ19fUmVjZWl2ZWRfU3RhdGVfX2M7IA0KCQkJCXN2b2xpbmVpbnMuU1ZNWENfX1JlY2VpdmVkX0NvdW50cnlfX2MgCT0gcmVjLlNWTVhDX19SZWNlaXZlZF9Db3VudHJ5X19jOyANCgkJCQlzdm9saW5laW5zLlNWTVhDX19SZWNlaXZlZF9DaXR5X19jIAkJPSByZWMuU1ZNWENfX1JlY2VpdmVkX0NpdHlfX2M7DQoJCQkJDQoJCQkJc3ZvbGluZXNpbnMucHVzaChzdm9saW5laW5zKTsNCgkJCQluZXdjbnQgKz0gMTsNCgkJCQl9DQoJfQ0KDQogICAgdHJ5IHsNCglzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUoc3ZvbGluZXN1cGQpOw0KCX0NCiAgICBjYXRjaCAoZSkgewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTYiKSsiXG4iICsgZSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm4gZmFsc2U7DQogICAgCX0NCg0KICAgIGlmIChuZXdjbnQgPiAwKQ0KICAgIAl7DQoJdHJ5IHsNCgkgICAgc2ZvcmNlLmNvbm5lY3Rpb24uY3JlYXRlKHN2b2xpbmVzaW5zKTsNCgkgICAgfQ0KCWNhdGNoIChlKSB7CSAgIA0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTciKSsiXG4iICsgZSk7DQoJICAgIENsb3NlV2luZG93KCk7DQoJICAgIHJldHVybiBmYWxzZTsNCgkgICAgfQ0KCX0gICANCiAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTgiKSk7CQkJCQ0KICAgIHdpbmRvdy5vcGVuZXIubG9jYXRpb24ucmVsb2FkKHRydWUpOw0KICAgIENsb3NlV2luZG93KCk7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUHJvY1NocF9TaG93U2hpcG1lbnRSZWNvcmRzKHNocElkLCBzaHBOdW0sIHVJZCwgc2Vzc0lkKQ0Kew0KICAgIFNWTVhJX0luaXRNZXNzYWdlTGlzdCgiUE9SRFNDOCIpOyANCiAgICBTVk1YSV9TZXRMYWJlbHMoIlByb2Nlc3NTaGlwbWVudHMiKTsgIA0KCQ0KICAgIFBSU0hQX1NoaXBtZW50T3JkZXJJZCA9IHNocElkOw0KICAgIFBSU0hQX1VzZXJJZCA9IHVJZDsNCiAgICBQUlNIUF9TaGlwbWVudE51bWJlciA9IHNocE51bTsNCiAgICBQUlNIUF9TZXNzaW9uSWQgPSBzZXNzSWQ7DQoNCiAgICAvLyBHZXQgUGFydHMgUmVxdWVzdCBoZWFkZXIgaW5mbw0KICAgIHZhciBzb3FsMSA9ICJTRUxFQ1QgU1ZNWENfX09yZGVyX1N0YXR1c19fYywgU1ZNWENfX1NvdXJjZV9Mb2NhdGlvbl9fYywgU1ZNWENfX0Rlc3RpbmF0aW9uX0xvY2F0aW9uX19jLCAiICsNCiAgICAJCSJTVk1YQ19fRGVzdGluYXRpb25fTG9jYXRpb25fX3IuU1ZNWENfX1N0b2NraW5nX0xvY2F0aW9uX19jICIgKw0KICAgIAkJIkZST00gU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYyBXSEVSRSBJZCA9ICciICsgUFJTSFBfU2hpcG1lbnRPcmRlcklkICsgIiciOw0KICAgIHZhciBxcjEgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMSk7DQogICAgaWYgKHFyMS5zaXplIDw9IDApDQoJewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDIiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIHZhciByZWMxID0gcXIxLmdldEFycmF5KCJyZWNvcmRzIik7DQogICAgaWYgKHJlYzFbMF0uU1ZNWENfX09yZGVyX1N0YXR1c19fYyA9PSAiQ2xvc2VkIikNCiAgICAJewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDMiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIGlmIChyZWMxWzBdLlNWTVhDX19PcmRlcl9TdGF0dXNfX2MgPT0gIkNhbmNlbGVkIikNCiAgICAJewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDQiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIGlmICghcmVjMVswXS5TVk1YQ19fU291cmNlX0xvY2F0aW9uX19jKQ0KICAgIAl7CQ0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNSIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgLy8gTm90IG5lZWRlZCBhbnltb3JlLiBEZXN0aW5hdGlvbiBsb2NhdGlvbiBpcyBvcHRpb25hbCBpbiB0aGUgc2hpcG1lbnQgcGFnZSBsYXlvdXQNCiAgICAvLyBIUyAwNC8yOC8yMDA4DQogICAgLy9pZiAoIXJlYzFbMF0uU1ZNWENfX0Rlc3RpbmF0aW9uX0xvY2F0aW9uX19jKQ0KICAgIC8vCXsNCi8vCQlhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDYiKSk7DQovLwkJQ2xvc2VXaW5kb3coKTsNCi8vCQlyZXR1cm47DQovLwl9DQogICAgUFJTSFBfU291cmNlTG9jSWQgPSByZWMxWzBdLlNWTVhDX19Tb3VyY2VfTG9jYXRpb25fX2M7DQogICAgUFJTSFBfRGVzdExvY0lkID0gcmVjMVswXS5TVk1YQ19fRGVzdGluYXRpb25fTG9jYXRpb25fX2M7DQogICAgaWYgKHJlYzFbMF0uU1ZNWENfX0Rlc3RpbmF0aW9uX0xvY2F0aW9uX19jKQ0KICAgIAlQUlNIUF9EZXN0TG9jU3RvY2thYmxlID0gcmVjMVswXS5TVk1YQ19fRGVzdGluYXRpb25fTG9jYXRpb25fX3IuU1ZNWENfX1N0b2NraW5nX0xvY2F0aW9uX19jOw0KDQogICAgLy8gSWYgZGVzdGluYXRpb24gbG9jYXRpb24gaXMgYmxhbmsgb3IgaWYgaXQgaXMgbm90IGEgc3RvY2tpbmcgbG9jYXRpb24sDQogICAgLy8gaXQgaXMgaW1wbGllZCB0aGF0IHRoZSBzaGlwbWVudCBpcyBkaXJlY3RseSBtYWRlIHRvIHRoZSBjdXN0b21lciANCiAgICAvLyBhbmQgaXQgZG9lcyBub3QgaGF2ZSB0byBiZSBhY2NvdW50ZWQgZm9yIGluIGludmVudG9yeQ0KICAgIC8vIFNvIHdlIGNob29zZSB0aGUgaW50ZXJuYWwgbG9jYXRpb24NCiAgICBpZiAoUFJTSFBfRGVzdExvY0lkID09IG51bGwgfHwgUFJTSFBfRGVzdExvY0lkLmxlbmd0aCA8PSAwIHx8IHJlYzFbMF0uU1ZNWENfX0Rlc3RpbmF0aW9uX0xvY2F0aW9uX19yLlNWTVhDX19TdG9ja2luZ19Mb2NhdGlvbl9fYyA9PSAiZmFsc2UiKQ0KICAgIAl7DQoJdmFyIHNvcWwzID0gIlNFTEVDVCBJZCBGUk9NIFNWTVhDX19TaXRlX19jIFdIRVJFIE5hbWUgPSAnRGVmYXVsdCBDdXN0b21lciBMb2NhdGlvbiciOw0KCXZhciBxcjMgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMyk7DQoJaWYgKHFyMy5zaXplIDw9IDApDQoJICAgIHsNCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA3IikpOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm47DQoJICAgIH0NCgl2YXIgcmVjMyA9IHFyMy5nZXRBcnJheSgicmVjb3JkcyIpOw0KCVBSU0hQX0Rlc3RMb2NJZCA9IHJlYzNbMF0uSWQ7DQoJUFJTSFBfRGVzdExvY1N0b2NrYWJsZSA9IGZhbHNlOw0KCX0NCg0KICAgIC8vIEdldCBvcGVuIFNoaXBtZW50IGxpbmVzDQogICAgdmFyIHNvcWwyID0gIlNFTEVDVCBJZCwgUmVjb3JkVHlwZUlkLCBTVk1YQ19fUHJvZHVjdF9fYywgU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSwgU1ZNWENfX0V4cGVjdGVkX1F1YW50aXR5Ml9fYywgIiArDQogICAgCQkiU1ZNWENfX0V4cGVjdGVkX1NoaXBfRGF0ZV9fYywgU1ZNWENfX0xpbmVfVHlwZV9fYywgU1ZNWENfX1BhY2tpbmdfSW5zdHJ1Y3Rpb25zX19jLCAiICsNCiAgICAJCSJTVk1YQ19fUGFydHNfUmVxdWVzdF9MaW5lX19jLCBTVk1YQ19fUGFydHNfUmVxdWVzdF9MaW5lX19yLlNWTVhDX19RdWFudGl0eV9TaGlwcGVkMl9fYywgIiArDQoJCSJTVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jLCBTVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19yLlNWTVhDX19RdWFudGl0eV9TaGlwcGVkMl9fYyxTVk1YQ19fTGluZV9QcmljZTJfX2MgLCBTVk1YQ19fU2VydmljZV9FbmdpbmVlcl9fYyAsU1ZNWENfX1NhbGVzX09yZGVyX051bWJlcl9fYyAiICsNCgkJIkZST00gU1ZNWENfX1JNQV9TaGlwbWVudF9MaW5lX19jIFdIRVJFIFNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MgPSAnIiArIFBSU0hQX1NoaXBtZW50T3JkZXJJZCArICInIEFORCAiICsNCgkJIlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICdPcGVuJyI7IC8vQnkgR20gMThKdW4wOCBBZGRlZCA6IFNWTVhDX19MaW5lX1ByaWNlMl9fYw0KCQkNCgkgDQoJCQ0KCQkNCiAgICB0cnkgew0KICAgIHZhciBxcjIgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMik7DQogICAgfSBjYXRjaCAoZSkgeyBhbGVydChlKTsgfQ0KICAgIGlmIChxcjIuc2l6ZSA8PSAwKQ0KCXsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA4IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICB2YXIgc2hwcmVjcyA9IG5ldyBzZm9yY2UuUXVlcnlSZXN1bHRJdGVyYXRvcihxcjIpOw0KDQogICAgdmFyIHJvd251bSA9IDA7DQogICAgdmFyIHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpc3RfdGJvZHkiKTsNCg0KICAgIFNWTVhJX1Byb2NTaHBfRHJhd0hlYWRlcih0Ym9keSk7DQoNCiAgICB3aGlsZShzaHByZWNzLmhhc05leHQoKSkNCgl7DQoJdmFyIHNocHJlYyA9IHNocHJlY3MubmV4dCgpOw0KDQoJdmFyIHNocGlkID0gc2hwcmVjLklkOw0KCXZhciBwcm9kaWQgPSBzaHByZWMuU1ZNWENfX1Byb2R1Y3RfX2M7DQoJaWYgKHNocHJlYy5TVk1YQ19fRXhwZWN0ZWRfUXVhbnRpdHkyX19jID09IG51bGwgfHwgaXNOYU4oc2hwcmVjLlNWTVhDX19FeHBlY3RlZF9RdWFudGl0eTJfX2MpKQ0KCSAgICB2YXIgRXhwUXR5ID0gMDsNCgllbHNlDQoJICAgIHZhciBFeHBRdHkgPSBwYXJzZUZsb2F0KHNocHJlYy5TVk1YQ19fRXhwZWN0ZWRfUXVhbnRpdHkyX19jKTsNCg0KCXZhciB0ciA9IG1ha2VSb3cobWFrZUF0dHJzKHJvd251bSx0Ym9keSkgKTsNCgl0ci5zb2JqZWN0ID0gc2hwcmVjOw0KCXRib2R5LmFwcGVuZENoaWxkKHRyKTsNCg0KCQkvLyBDb2wgMS4gUHJvZHVjdCBOYW1lDQoJY3JlYXRlVGFnKHRyLCJ0aCIseyJzY29wZSI6InJvdyJ9KS5pbm5lckhUTUwgPQ0KCQkiPGEgdGFyZ2V0PV9ibGFuayBocmVmPVwiLyIgKyBwcm9kaWQgKyAiXCI+IiArIHByb2RpZCA/IHNocHJlYy5TVk1YQ19fUHJvZHVjdF9fci5OYW1lIDogIlVua25vd24iICsgIjwvYT4iOw0KDQoJCS8vIENvbCAyLiBSZXF1ZXN0ZWQgUXVhbnRpdHkNCgljcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSI8aW5wdXQgZGlzYWJsZWQ9XCJ0cnVlXCIgdHlwZT1cInRleHRcIiBpZD1cIiIgKyBzaHBpZCArICJFeHBRdHlcIiBuYW1lPVwiIiArIHNocGlkICsgIkV4cFF0eVwiIHZhbHVlPVwiIiArIEV4cFF0eSArICJcIj48L2lucHV0PiI7DQoNCgkJLy8gQ29sIDMuIFNoaXBwZWQgUXVhbnRpdHkNCgljcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSI8aW5wdXQgdHlwZT1cInRleHRcIiBpZD1cIiIgKyBzaHBpZCArICJTaHBRdHlcIiBuYW1lPVwiIiArIHNocGlkICsgIlNocFF0eVwiIHZhbHVlPVwiIiArIEV4cFF0eSArICJcIiBvbmNoYW5nZT1cIlNWTVhJX1Byb2NTaHBfVmFsaWRhdGVRdWFudGl0eSh0aGlzKTtcIj48L2lucHV0PiI7DQoNCgkJLy8gQ29sIDQuIENoZWNrYm94DQoJY3JlYXRlVGFnKHRyLCJ0ZCIseydjbGFzcyc6J2FjdGlvbkNvbHVtbicsJ2FsaWduJzonY2VudGVyJ30pLmlubmVySFRNTCA9DQoJCSI8aW5wdXQgY2hlY2tlZD1cInRydWVcIiBkaXNhYmxlZD1cInRydWVcIiB0eXBlPVwiY2hlY2tib3hcIiBpZD1cIiIgKyBzaHBpZCArICJDaGVja2JveFwiIG5hbWU9XCJpZHNcIiB2YWx1ZT1cIiIgKyBzaHBpZCArICJcIiA+Jm5ic3A7IjsNCg0KCQkvLyBDb2wgNS4gU3RhdHVzIE1lc3NhZ2UNCgljcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSI8ZGl2IGlkPVwiIiArIHNocGlkICsgIkVyck1zZ1wiIG5hbWU9XCIiICsgc2hwaWQgKyAiRXJyTXNnXCI+PC9kaXY+IjsNCg0KCXJvd251bSArPSAxOw0KCX0NCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2FpdG1zZycpLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJzsgDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dhaXRtc2cnKS5zdHlsZS5oZWlnaHQgPSAwOyANCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Qcm9jU2hwX1ZhbGlkYXRlUXVhbnRpdHkoY3RybCkNCnsNCiAgICB2YXIgc2hwaWQgPSBjdHJsLm5hbWUuc3Vic3RyaW5nKDAsMTgpOw0KICAgIHZhciBleHBxdHluYW1lID0gc2hwaWQgKyAiRXhwUXR5IjsNCiAgICB2YXIgZXhwcXR5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZXhwcXR5bmFtZSk7DQoNCiAgICBpZihwYXJzZUZsb2F0KGN0cmwudmFsdWUpID49IHBhcnNlRmxvYXQoZXhwcXR5LnZhbHVlKSkNCiAgICAJew0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNocGlkKyJDaGVja2JveCIpLmNoZWNrZWQgPSB0cnVlOw0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNocGlkKyJDaGVja2JveCIpLmRpc2FibGVkID0gdHJ1ZTsNCgl9DQogICAgZWxzZQ0KICAgIAl7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2hwaWQrIkNoZWNrYm94IikuY2hlY2tlZCA9IGZhbHNlOw0KCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNocGlkKyJDaGVja2JveCIpLmRpc2FibGVkID0gZmFsc2U7DQoJfQ0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Byb2NTaHBfRHJhd0hlYWRlcih0YSkNCnsNCiAgICB2YXIgdHIgPSBtYWtlUm93KHsnY2xhc3MnOidoZWFkZXJSb3cnfSk7DQogICAgdGEuYXBwZW5kQ2hpbGQodHIpOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgiTEFCMDA1IikrIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCcsJ2FsaWduJzoncmlnaHQnfSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIGhyZWY9XCIjXCIgdGl0bGU9XCJcIj4iK1NWTVhJX0dldE1lc3NhZ2UoIkxBQjAwNiIpKyI8L2E+IjsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnLCdhbGlnbic6J3JpZ2h0J30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMDciKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJ30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCJMQUIwMDgiKSsiPC9hPiI7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUHJvY1NocF9WYWxpZGF0ZUFuZFByb2Nlc3MoKQ0Kew0KICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbJ1Byb2Nlc3NTaGlwbWVudHMnXTsNCg0KICAgIHZhciBzb2JqZWN0TGlzdCA9IG5ldyBBcnJheSgpOw0KICAgIGZvciAoaSA9IDA7IGkgPCBmb3JtLmVsZW1lbnRzLmxlbmd0aDsgaSsrKQ0KCXsNCglpZiAoZm9ybS5lbGVtZW50c1tpXS5uYW1lID09ICdpZHMnKQ0KCSAgICB7DQoJICAgIHZhciBwbiA9IGZvcm0uZWxlbWVudHNbaV0ucGFyZW50Tm9kZTsNCgkgICAgdmFyIHBwbiA9IGZvcm0uZWxlbWVudHNbaV0ucGFyZW50Tm9kZS5wYXJlbnROb2RlOw0KCSAgICBpZiAocHBuLnNvYmplY3QpDQoJCXsNCgkJc29iamVjdExpc3QucHVzaChwcG4uc29iamVjdCk7DQoJCX0NCgkgICAgfQ0KCX0NCg0KICAgIHZhciB2YWxpZF9zaGlwbWVudHMgPSBuZXcgQXJyYXkoKTsNCiAgICB2YXIgaW52YWxpZCA9IGZhbHNlOw0KICAgIHZhciBza2lwY250ID0gMDsNCiAgICBmb3IgKHZhciBrID0gMDsgayA8IHNvYmplY3RMaXN0Lmxlbmd0aDsgaysrKQ0KICAgIAl7DQoJdmFyIHJlY19pbnZhbGlkID0gZmFsc2U7DQoJdmFyIHJlYyA9IHNvYmplY3RMaXN0W2tdOw0KCXZhciBFeHBRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiRXhwUXR5IikudmFsdWUpOw0KCXZhciBTaHBRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiU2hwUXR5IikudmFsdWUpOw0KCXZhciBjaGVja2VkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJDaGVja2JveCIpLmNoZWNrZWQ7DQoJLy9hbGVydCgiY2hlY2tlZD0iICsgY2hlY2tlZCArICIsIEV4cFF0eT0iICsgRXhwUXR5ICsgIiwgU2hwUXR5PSIgKyBTaHBRdHkpOw0KCXZhciBFcnJNc2cgPSAiIjsNCglpZiAoaXNOYU4oU2hwUXR5KSB8fCBTaHBRdHkgPCAwKQ0KCSAgICB7DQoJICAgIEVyck1zZyA9IFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwOSIpOw0KCSAgICBpbnZhbGlkID0gdHJ1ZTsNCgkgICAgcmVjX2ludmFsaWQgPSB0cnVlOw0KCSAgICB9DQoJZWxzZSBpZiAoIWNoZWNrZWQgJiYgU2hwUXR5ID09IDApDQoJICAgIHsNCgkgICAgc2tpcGNudCArPSAxOw0KCSAgICB9DQoJZWxzZSBpZihTaHBRdHkgPiBFeHBRdHkpDQoJICAgIHsNCgkgICAgRXJyTXNnID0gU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEwIik7DQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICByZWNfaW52YWxpZCA9IHRydWU7DQoJICAgIH0NCglpZiAocmVjX2ludmFsaWQpDQoJICAgIHsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5zdHlsZS5ib3JkZXIgPSAiI0ZGMDAwMCAycHggc29saWQiOw0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkVyck1zZyIpLmlubmVySFRNTCA9IEVyck1zZzsNCgkgICAgfQ0KCWVsc2UNCgkgICAgew0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkVyck1zZyIpLnN0eWxlLmJvcmRlciA9ICIwIjsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJFcnJNc2ciKS5pbm5lckhUTUwgPSAiIjsNCgkgICAgfQ0KCWlmKCFyZWNfaW52YWxpZCAmJiBTaHBRdHkgPiAwKQ0KCSAgICB2YWxpZF9zaGlwbWVudHMucHVzaChyZWMpOw0KCX0NCiAgICBpZihpbnZhbGlkKSB7IHJldHVybjsgfQ0KDQogICAgaWYoc2tpcGNudCA9PSBzb2JqZWN0TGlzdC5sZW5ndGgpDQogICAgCXsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDExIikpOw0KCXJldHVybjsNCgl9DQoNCiAgICBQUlNIUF9TaGlwbWVudHMgPSB2YWxpZF9zaGlwbWVudHM7DQogICAgU1ZNWElfUHJvY1NocF9Qcm9jZXNzU2hpcG1lbnRzKCk7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUHJvY1NocF9Qcm9jZXNzU2hpcG1lbnRzKCkNCnsNCiAgICB2YXIgUHJvZEFycmF5ID0gU1ZNWElfTXVsdGlEaW1lbnNpb25hbEFycmF5KFBSU0hQX1NoaXBtZW50cy5sZW5ndGgsIDYpOw0KICAgIGZvciAodmFyIGkgPSAwOyBpIDwgUFJTSFBfU2hpcG1lbnRzLmxlbmd0aDsgaSsrKQ0KCXsNCgl2YXIgU2hwUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUlNIUF9TaGlwbWVudHNbaV0uSWQrIlNocFF0eSIpLnZhbHVlKTsNCglQcm9kQXJyYXlbaV1bMF0gPSBQUlNIUF9TaGlwbWVudHNbaV0uU1ZNWENfX1Byb2R1Y3RfX2M7DQoJUHJvZEFycmF5W2ldWzFdID0gU2hwUXR5Ow0KCVByb2RBcnJheVtpXVsyXSA9IFBSU0hQX1NvdXJjZUxvY0lkOw0KCVByb2RBcnJheVtpXVszXSA9ICJBdmFpbGFibGUiOw0KCVByb2RBcnJheVtpXVs0XSA9IFBSU0hQX0Rlc3RMb2NJZDsNCglQcm9kQXJyYXlbaV1bNV0gPSAiSW4gVHJhbnNpdCI7DQoJfQ0KICAgIC8vIENhbGwgc2VyaWFsIHNlbGVjdGlvbiB1dGlsaXR5LiBJdCB3aWxsIGNhcHR1cmUgc2VyaWFsIG51bWJlcnMgd2hlcmUgYXBwbGljYWJsZSBhbmQNCiAgICAvLyBjYWxsIGJhY2sgdGhlIHJvdXRpbmUgYmVsb3cgd2l0aCB0aGUgc2VsZWN0ZWQgc2VyaWFscw0KICAgIHdpbmRvdy5ibHVyKCk7DQogICAgdmFyIHJldHVyblZhbCA9IFNWTVhJX0RvU2VyaWFsU2VsZWN0aW9uKFByb2RBcnJheSwgIlNoaXBtZW50IiwgUFJTSFBfU2hpcG1lbnROdW1iZXIsIFBSU0hQX1VzZXJJZCwgUFJTSFBfU2Vzc2lvbklkKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9DYWxsYmFja19Qcm9jZXNzU2hpcG1lbnQoU2VyaWFsU2VsZWN0U3RhdHVzLCBTZXJpYWxDb3VudCwgU2VyaWFsQXJyYXkpDQp7DQogICAgd2luZG93LmZvY3VzKCk7DQogICAgaWYgKCFTZXJpYWxTZWxlY3RTdGF0dXMpDQogICAgCXsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybiBmYWxzZTsNCgl9DQogICAgdmFyIHRvdHEgPSAwOw0KICAgIHZhciBTZXJpYWxTYXZlQXJyYXkgPSBTVk1YSV9NdWx0aURpbWVuc2lvbmFsQXJyYXkoU2VyaWFsQ291bnQsIDQpOw0KDQogICAgZm9yICh2YXIgaiA9IDA7IGogPCBQUlNIUF9TaGlwbWVudHMubGVuZ3RoOyBqKyspDQogICAgCXsNCgl2YXIgUHJvZElkID0gUFJTSFBfU2hpcG1lbnRzW2pdLlNWTVhDX19Qcm9kdWN0X19jOw0KCXZhciBTaHBRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSU0hQX1NoaXBtZW50c1tqXS5JZCsiU2hwUXR5IikudmFsdWUpOw0KDQoJLy8gRGVjcmVhc2UgQXZhaWxhYmxlIHN0b2NrIGluIHRoZSBzb3VyY2UgbG9jYXRpb24NCgl2YXIgRnJvbVN0b2NrQXJyID0gU1ZNWElfRG9TdG9ja1VwZGF0ZShQcm9kSWQsIFBSU0hQX1NvdXJjZUxvY0lkLCAiQXZhaWxhYmxlIiwgU2hwUXR5LCAiU2hpcG1lbnQiLCBQUlNIUF9TaGlwbWVudE51bWJlciwgIkRlY3JlYXNlIiwgUFJTSFBfU2hpcG1lbnRPcmRlcklkLCBQUlNIUF9TaGlwbWVudHNbal0uSWQsIFBSU0hQX1VzZXJJZCk7DQoJaWYgKCFGcm9tU3RvY2tBcnJbMF0pDQoJICAgIHsJICAgDQoJICAgIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMiIpKyJcbiIgKyBGcm9tU3RvY2tBcnJbNF0pOwkJDQoJICAgIENsb3NlV2luZG93KCk7DQoJICAgIHJldHVybjsNCgkgICAgfQ0KCXZhciBGcm9tUHJvZFN0b2NrSWQgPSBGcm9tU3RvY2tBcnJbMV07DQoNCgkvLyBJZiB0YXJnZXQgbG9jYXRpb24gaXMgbm90IHN0b2NrYWJsZSwgaXQgbWVhbnMgdGhlIHNoaXBtZW50IHdhcyBtYWRlIHRvIGEgY3VzdG9tZXIgbG9jYXRpb24uIENvbnNpZGVyIHRoZSBxdWFudGl0eSBhcyBDb25zdW1lZA0KCS8vIElmIHRhcmdldCBsb2NhdGlvbiBpcyBzdG9ja2FibGUsIGl0IG11c3QgYmUgYW4gaW50ZXJuYWwgbG9jYXRpb24uIENvbnNpZGVyIHRoZSBxdWFudGl0eSB0byBiZSBJbiBUcmFuc2l0IA0KCWlmIChQUlNIUF9EZXN0TG9jU3RvY2thYmxlID09IGZhbHNlKQ0KCSAgICB2YXIgVG9TdG9ja0FyciA9IFNWTVhJX0RvU3RvY2tVcGRhdGUoUHJvZElkLCBQUlNIUF9EZXN0TG9jSWQsICJDb25zdW1lZCIsIFNocFF0eSwgIlNoaXBtZW50IiwgUFJTSFBfU2hpcG1lbnROdW1iZXIsICJJbmNyZWFzZSIsIFBSU0hQX1NoaXBtZW50T3JkZXJJZCwgUFJTSFBfU2hpcG1lbnRzW2pdLklkLCBQUlNIUF9Vc2VySWQpOw0KCWVsc2UNCgkgICAgdmFyIFRvU3RvY2tBcnIgPSBTVk1YSV9Eb1N0b2NrVXBkYXRlKFByb2RJZCwgUFJTSFBfRGVzdExvY0lkLCAiSW4gVHJhbnNpdCIsIFNocFF0eSwgIlNoaXBtZW50IiwgUFJTSFBfU2hpcG1lbnROdW1iZXIsICJJbmNyZWFzZSIsIFBSU0hQX1NoaXBtZW50T3JkZXJJZCwgUFJTSFBfU2hpcG1lbnRzW2pdLklkLCBQUlNIUF9Vc2VySWQpOw0KCWlmICghVG9TdG9ja0FyclswXSkNCgkgICAgewkgICAgDQoJICAgIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMiIpKyJcbiIgKyBGcm9tU3RvY2tBcnJbNF0pOwkJDQoJICAgIENsb3NlV2luZG93KCk7DQoJICAgIHJldHVybjsNCgkgICAgfQ0KCXZhciBUb1Byb2RTdG9ja0lkID0gRnJvbVN0b2NrQXJyWzFdOw0KDQoJLy8gQnVpbGQgc2VyaWFsIG51bWJlciBhcnJheSBmb3IgdGhlIHNoaXBwZWQgcXVhbnRpdHkNCglpZiAoU2VyaWFsQ291bnQgPiAwKQ0KCSAgICB7DQoJICAgIGZvciAodmFyIGsgPSAwOyBrIDwgU2VyaWFsQ291bnQ7IGsrKykNCgkJew0KCQlpZiAoU2VyaWFsQXJyYXlba11bMF0gPT0gUHJvZElkICYmIFNlcmlhbEFycmF5W2tdWzRdID09IFBSU0hQX0Rlc3RMb2NJZCkNCgkJICAgIHsNCgkJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVswXSA9IFByb2RJZDsNCgkJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVsxXSA9IEZyb21Qcm9kU3RvY2tJZDsNCgkJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVsyXSA9IFRvUHJvZFN0b2NrSWQ7DQoJCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bM10gPSBTZXJpYWxBcnJheVtrXVs3XTsNCgkJICAgIHRvdHErKzsNCgkJICAgIH0NCgkJfQ0KCSAgICB9DQoJfQ0KDQogICAgLy8gVXBkYXRlIHNlcmlhbCBudW1iZXJzIGZvciB0aGUgc2hpcHBlZCBxdWFudGl0eQ0KICAgIGlmIChTZXJpYWxDb3VudCA+IDApIHsgdmFyIHJldHVyblZhbCA9IFNWTVhJX0RvU2VyaWFsU2F2ZShTZXJpYWxTYXZlQXJyYXksIFBSU0hQX1VzZXJJZCk7IH0NCg0KICAgIHZhciBuZXdjbnQgPSAwOw0KICAgIHZhciBjdXJkYXRlID0gbmV3IERhdGUoKTsNCiAgICB2YXIgcmVxbGluZXN1cGQgPSBuZXcgQXJyYXkoKTsNCiAgICB2YXIgc3ZvbGluZXN1cGQgPSBuZXcgQXJyYXkoKTsNCiAgICB2YXIgc2hwbGluZXN1cGQgPSBuZXcgQXJyYXkoKTsNCiAgICB2YXIgc2hwbGluZXNpbnMgPSBuZXcgQXJyYXkoKTsNCiAgICBmb3IgKHZhciBrID0gMDsgayA8IFBSU0hQX1NoaXBtZW50cy5sZW5ndGg7IGsrKykNCiAgICAJew0KCXZhciBzaHBsaW5ldXBkID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fUk1BX1NoaXBtZW50X0xpbmVfX2MiKTsNCgl2YXIgcmVjID0gUFJTSFBfU2hpcG1lbnRzW2tdOw0KCXZhciBFeHBRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiRXhwUXR5IikudmFsdWUpOw0KCXZhciBTaHBRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiU2hwUXR5IikudmFsdWUpOw0KCXZhciBjaGVja2VkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJDaGVja2JveCIpLmNoZWNrZWQ7DQoNCglzaHBsaW5ldXBkLklkID0gcmVjLklkOw0KCXNocGxpbmV1cGQuU1ZNWENfX0FjdHVhbF9RdWFudGl0eTJfX2MgPSBTaHBRdHk7DQoJc2hwbGluZXVwZC5TVk1YQ19fQWN0dWFsX1NoaXBfRGF0ZV9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoJc2hwbGluZXVwZC5TVk1YQ19fUG9zdGVkX1RvX0ludmVudG9yeV9fYyA9IHRydWU7DQoJaWYgKGNoZWNrZWQgJiYgU2hwUXR5ID09IDApDQoJICAgIHsNCgkgICAgc2hwbGluZXVwZC5TVk1YQ19fTGluZV9TdGF0dXNfX2MgPSAiQ2FuY2VsZWQiOw0KCSAgICBzaHBsaW5ldXBkLlNWTVhDX19DYW5jZWxlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoJICAgIHNocGxpbmV1cGQuU1ZNWENfX0NhbmNlbGVkX0J5X19jID0gUFJTSFBfVXNlcklkOw0KCSAgICB9DQoJZWxzZSBpZiAoU2hwUXR5ID4gMCkNCgkgICAgew0KCSAgICBzaHBsaW5ldXBkLlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICJDb21wbGV0ZWQiOw0KCSAgICBzaHBsaW5ldXBkLlNWTVhDX19DbG9zZWRfT25fX2MgPSBTVk1YSV9HZXRDdXJyZW50VGltZSgpOw0KCSAgICBzaHBsaW5ldXBkLlNWTVhDX19DbG9zZWRfQnlfX2MgPSBQUlNIUF9Vc2VySWQ7DQoJICAgIH0NCglzaHBsaW5lc3VwZC5wdXNoKHNocGxpbmV1cGQpOw0KDQoJLy8gVXBkYXRlIHJlbGF0ZWQgb2JqZWN0IChTZXJ2aWNlIG9yZGVyIG9yIFBhcnRzIFJlcXVlc3QpDQoJaWYgKHJlYy5TVk1YQ19fUGFydHNfUmVxdWVzdF9MaW5lX19jKQ0KCSAgICB7DQoJICAgIHZhciByZXFsaW5ldXBkID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fUGFydHNfUmVxdWVzdF9MaW5lX19jIik7DQoJICAgIHJlcWxpbmV1cGQuSWQgPSByZWMuU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYzsNCgkgICAgaWYoIXJlYy5TVk1YQ19fUGFydHNfUmVxdWVzdF9MaW5lX19yLlNWTVhDX19RdWFudGl0eV9TaGlwcGVkMl9fYykNCgkJeyByZXFsaW5ldXBkLlNWTVhDX19RdWFudGl0eV9TaGlwcGVkMl9fYyA9IFNocFF0eTsgfQ0KCSAgICBlbHNlDQoJCXsgcmVxbGluZXVwZC5TVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MgPSBwYXJzZUZsb2F0KHJlYy5TVk1YQ19fUGFydHNfUmVxdWVzdF9MaW5lX19yLlNWTVhDX19RdWFudGl0eV9TaGlwcGVkMl9fYykgKyBTaHBRdHk7IH0NCgkgICAgcmVxbGluZXN1cGQucHVzaChyZXFsaW5ldXBkKTsNCgkgICAgfQ0KCWVsc2UgaWYgKHJlYy5TVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jKQ0KCSAgICB7DQoJICAgIHZhciBzdm9saW5ldXBkID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jIik7DQoJICAgIHN2b2xpbmV1cGQuSWQgPSByZWMuU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYzsNCgkgICAgaWYoIXJlYy5TVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19yLlNWTVhDX19RdWFudGl0eV9TaGlwcGVkMl9fYykNCgkJeyBzdm9saW5ldXBkLlNWTVhDX19RdWFudGl0eV9TaGlwcGVkMl9fYyA9IFNocFF0eTsgfQ0KCSAgICBlbHNlDQoJCXsgc3ZvbGluZXVwZC5TVk1YQ19fUXVhbnRpdHlfU2hpcHBlZDJfX2MgPSBwYXJzZUZsb2F0KHJlYy5TVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19yLlNWTVhDX19RdWFudGl0eV9TaGlwcGVkMl9fYykgKyBTaHBRdHk7IH0NCgkgICAgc3ZvbGluZXN1cGQucHVzaChzdm9saW5ldXBkKTsNCgkgICAgfQ0KDQoJLy8gUGFydCBpcyBwYXJ0aWFsbHkgc2hpcHBlZCBhbmQgdXNlciBkb2VzIG5vdCB3YW50IHRvIGNsb3NlIHRoZSBzaGlwbWVudCB5ZXQuIENyZWF0ZSBhIG5ldyBsaW5lIGZvciByZW1haW5pbmcgcXR5Lg0KCWlmICghY2hlY2tlZCAmJiBTaHBRdHkgPCBFeHBRdHkpDQoJICAgIHsNCgkgICAgdmFyIHNocGxpbmVpbnMgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19STUFfU2hpcG1lbnRfTGluZV9fYyIpOw0KCSAgICBzaHBsaW5laW5zLlNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MgPSBQUlNIUF9TaGlwbWVudE9yZGVySWQ7DQoJICAgIHNocGxpbmVpbnMuU1ZNWENfX1Byb2R1Y3RfX2MgPSByZWMuU1ZNWENfX1Byb2R1Y3RfX2M7DQoJICAgIHNocGxpbmVpbnMuUmVjb3JkVHlwZUlkID0gcmVjLlJlY29yZFR5cGVJZDsNCgkgICAgc2hwbGluZWlucy5TVk1YQ19fTGluZV9UeXBlX19jID0gcmVjLlNWTVhDX19MaW5lX1R5cGVfX2M7DQoJICAgIHNocGxpbmVpbnMuU1ZNWENfX0V4cGVjdGVkX1F1YW50aXR5Ml9fYyA9IEV4cFF0eSAtIFNocFF0eTsNCgkgICAgc2hwbGluZWlucy5TVk1YQ19fRXhwZWN0ZWRfU2hpcF9EYXRlX19jID0gcmVjLlNWTVhDX19FeHBlY3RlZF9TaGlwX0RhdGVfX2M7DQoJICAgIHNocGxpbmVpbnMuU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gIk9wZW4iOw0KCSAgICBzaHBsaW5laW5zLlNWTVhDX19QYWNraW5nX0luc3RydWN0aW9uc19fYyA9IHJlYy5TVk1YQ19fUGFja2luZ19JbnN0cnVjdGlvbnNfX2M7DQoJICAgIHNocGxpbmVpbnMuU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYyA9IHJlYy5TVk1YQ19fUGFydHNfUmVxdWVzdF9MaW5lX19jOw0KCSAgICBzaHBsaW5laW5zLlNWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2MgPSByZWMuU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYzsNCgkJc2hwbGluZWlucy5TVk1YQ19fTGluZV9QcmljZTJfX2MgPSByZWMuU1ZNWENfX0xpbmVfUHJpY2UyX19jOyAvL0J5IEdtIDE4SnVuMDgNCgkJc2hwbGluZWlucy5TVk1YQ19fVXNlX1ByaWNlX0Zyb21fUHJpY2Vib29rX19jID0gIkZhbHNlIjsgLy9CeSBHbSAxOEp1bjA4DQoJICAgIHNocGxpbmVpbnMuU1ZNWENfX1Bvc3RlZF9Ub19JbnZlbnRvcnlfX2MgPSBmYWxzZTsJCQ0KCQlzaHBsaW5laW5zLlNWTVhDX19TZXJ2aWNlX0VuZ2luZWVyX19jICA9IHJlYy5TVk1YQ19fU2VydmljZV9FbmdpbmVlcl9fYzsNCgkJc2hwbGluZWlucy5TVk1YQ19fU2FsZXNfT3JkZXJfTnVtYmVyX19jID0gcmVjLlNWTVhDX19TYWxlc19PcmRlcl9OdW1iZXJfX2M7DQoJCQ0KCSAgICBzaHBsaW5lc2lucy5wdXNoKHNocGxpbmVpbnMpOw0KCSAgICBuZXdjbnQgKz0gMTsNCgkgICAgfQ0KCX0NCg0KICAgIHRyeSB7DQoJc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKHNocGxpbmVzdXBkKTsNCgl9DQogICAgY2F0Y2ggKGUpIHsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDEzIikrIlxuIiArIGUpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuIGZhbHNlOw0KCX0NCg0KICAgIGlmIChyZXFsaW5lc3VwZC5sZW5ndGggPiAwKQ0KICAgIAl7DQoJdHJ5IHsNCgkgICAgc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKHJlcWxpbmVzdXBkKTsNCgkgICAgfQ0KCWNhdGNoIChlKSB7CSAgIA0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTQiKSsiXG4iICsgZSk7DQoJICAgIENsb3NlV2luZG93KCk7DQoJICAgIHJldHVybiBmYWxzZTsNCgkgICAgfQ0KCX0NCiAgICBlbHNlIGlmIChzdm9saW5lc3VwZC5sZW5ndGggPiAwKQ0KICAgIAl7DQoJdHJ5IHsNCgkgICAgc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKHN2b2xpbmVzdXBkKTsNCgkgICAgfQ0KCWNhdGNoIChlKSB7CSAgIA0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTUiKSsiXG4iICsgZSk7DQoJICAgIENsb3NlV2luZG93KCk7DQoJICAgIHJldHVybiBmYWxzZTsNCgkgICAgfQ0KCX0NCg0KICAgIGlmIChuZXdjbnQgPiAwKQ0KICAgIAl7DQoJdHJ5IHsNCgkgICAgc2ZvcmNlLmNvbm5lY3Rpb24uY3JlYXRlKHNocGxpbmVzaW5zKTsNCgkgICAgfQ0KCWNhdGNoIChlKSB7CQ0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTYiKSsiXG4iICsgZSk7DQoJICAgIENsb3NlV2luZG93KCk7DQoJICAgIHJldHVybiBmYWxzZTsNCgkgICAgfQ0KCX0NCiAgICBlbHNlDQogICAgCXsNCgkvLyBUbyB1cGRhdGUgU2hpcG1lbnQgaGVhZGVyIHN0YXR1cy4uLg0KCS8vIGNoZWNrIGlmIGFsbCBsaW5lcyBoYXZlIGJlZW4gY29tcGxldGVkIG9yIGNhbmNlbGVkIGJ5IGNvbXBhcmluZyBjb3VudHMNCgl2YXIgc29xbDIgPSAiU0VMRUNUIENvdW50KCkgRlJPTSBTVk1YQ19fUk1BX1NoaXBtZW50X0xpbmVfX2MgV0hFUkUgU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYyA9ICciICsgUFJTSFBfU2hpcG1lbnRPcmRlcklkICsgIiciOw0KCXFyMiA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwyKTsNCg0KCXZhciBzb3FsMyA9ICJTRUxFQ1QgQ291bnQoKSBGUk9NIFNWTVhDX19STUFfU2hpcG1lbnRfTGluZV9fYyBXSEVSRSBTVk1YQ19fUk1BX1NoaXBtZW50X09yZGVyX19jID0gJyIgKyBQUlNIUF9TaGlwbWVudE9yZGVySWQgKyAiJyBBTkQgU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gJ0NvbXBsZXRlZCciOw0KCXFyMyA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwzKTsNCg0KCXZhciBzb3FsNCA9ICJTRUxFQ1QgQ291bnQoKSBGUk9NIFNWTVhDX19STUFfU2hpcG1lbnRfTGluZV9fYyBXSEVSRSBTVk1YQ19fUk1BX1NoaXBtZW50X09yZGVyX19jID0gJyIgKyBQUlNIUF9TaGlwbWVudE9yZGVySWQgKyAiJyBBTkQgU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gJ0NhbmNlbGVkJyI7DQoJcXI0ID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDQpOw0KDQoJdmFyIHNocGhkciA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYyIpOw0KCXNocGhkci5JZCA9IFBSU0hQX1NoaXBtZW50T3JkZXJJZDsNCg0KCXZhciBoZHJ1cGQgPSBmYWxzZTsNCglpZiAocXIyLnNpemUgPT0gcXIzLnNpemUpCQkvLyBBbGwgbGluZXMgY29tcGxldGVkDQoJICAgIHsNCgkgICAgc2hwaGRyLlNWTVhDX19PcmRlcl9TdGF0dXNfX2MgPSAiQ2xvc2VkIjsNCgkgICAgc2hwaGRyLlNWTVhDX19DbG9zZWRfQnlfX2MgPSBQUlNIUF9Vc2VySWQ7DQoJICAgIHNocGhkci5TVk1YQ19fQ2xvc2VkX09uX19jID0gU1ZNWElfR2V0Q3VycmVudFRpbWUoKTsNCgkgICAgaGRydXBkID0gdHJ1ZTsNCgkgICAgfQ0KCWVsc2UgaWYgKHFyMi5zaXplID09IHFyNC5zaXplKQkvLyBBbGwgbGluZXMgQ2FuY2VsZWQNCgkgICAgew0KCSAgICBzaHBoZHIuU1ZNWENfX09yZGVyX1N0YXR1c19fYyA9ICJDYW5jZWxlZCI7DQoJICAgIHNocGhkci5TVk1YQ19fQ2FuY2VsZWRfT25fX2MgPSBTVk1YSV9HZXRDdXJyZW50VGltZSgpOw0KCSAgICBzaHBoZHIuU1ZNWENfX0NhbmNlbGVkX0J5X19jID0gUFJTSFBfVXNlcklkOw0KCSAgICBoZHJ1cGQgPSB0cnVlOw0KCSAgICB9DQoJaWYgKGhkcnVwZCkNCgkgICAgew0KCSAgICB0cnkgew0KCQlzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUoW3NocGhkcl0pOw0KCQl9DQoJICAgIGNhdGNoIChlKSB7CQkNCgkJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE3IikrIlxuIiArIGUpOw0KCQlDbG9zZVdpbmRvdygpOw0KCQlyZXR1cm4gZmFsc2U7DQoJCX0NCgkgICAgfQ0KCX0gDQogICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE4IikpOwkNCiAgICB3aW5kb3cub3BlbmVyLmxvY2F0aW9uLnJlbG9hZCh0cnVlKTsNCiAgICBDbG9zZVdpbmRvdygpOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Bvc3RTdG9ja0FkanVzdG1lbnRUb0ludmVudG9yeShhZGpJZCwgYWRqTnVtLCB1SWQsIHNlc3NJZCkNCnsNCiAgICBTVk1YSV9Jbml0TWVzc2FnZUxpc3QoIlNBREpTQzEiKTsgIA0KICAgIFNWTVhJX1NldExhYmVscygiUG9zdFN0b2NrQWRqVG9JbnZlbnRvcnkiKTsgIA0KDQogICAgQURKSU5WX0FkanVzdG1lbnRJZCA9IGFkaklkOw0KICAgIEFESklOVl9BZGpOdW1iZXIgPSBhZGpOdW07DQogICAgQURKSU5WX1VzZXJJZCA9IHVJZDsNCiAgICBBREpJTlZfU2Vzc2lvbklkID0gc2Vzc0lkOw0KDQogICAgLyoqKj09PT09PT09PT09PT09IENvbW1lbnRlZCBvdXQgYnkgSFM6IDYvMjUvMjAwOS4gVGhpcyBpcyBjb250cm9sbGVkIGJ5IExNTyBub3cNCiAgICB2YXIgaW52ZW50b3J5X2VuYWJsZWQgPSBmYWxzZTsNCiAgICB2YXIgc29xbDEgPSAiU0VMRUNUIFNWTVhDX19FbmFibGVfSW52ZW50b3J5X01vZHVsZV9fYyBGUk9NIFNWTVhDX19TZXJ2aWNlTWF4X1NldHRpbmdzX19jIjsNCiAgICBxcjEgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMSk7DQogICAgaWYocXIxLnNpemUgPiAwKQ0KCXsNCglyZWMxID0gcXIxLmdldEFycmF5KCJyZWNvcmRzIik7DQoJaWYgKHJlYzFbMF0uU1ZNWENfX0VuYWJsZV9JbnZlbnRvcnlfTW9kdWxlX19jID09ICJ0cnVlIikNCgkgICAgaW52ZW50b3J5X2VuYWJsZWQgPSB0cnVlOw0KCWVsc2UNCgkgICAgaW52ZW50b3J5X2VuYWJsZWQgPSBmYWxzZTsNCgl9DQoNCiAgICBpZiAoIWludmVudG9yeV9lbmFibGVkKQ0KICAgIAl7CQ0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwMyIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgPT09PT09PT09KioqKioqKi8NCg0KICAgIHZhciBzb3FsMiA9ICJTRUxFQ1QgSWQsIFNWTVhDX19OZXdfUXVhbnRpdHkyX19jLCBTVk1YQ19fTG9jYXRpb25fX2MsIFNWTVhDX19Qcm9kdWN0X19jLCBTVk1YQ19fUG9zdGVkX1RvX0ludmVudG9yeV9fYyAiICsNCiAgICAJCSJGUk9NIFNWTVhDX19TdG9ja19BZGp1c3RtZW50X19jIFdIRVJFIElkID0gJyIgKyBBREpJTlZfQWRqdXN0bWVudElkICsgIiciOw0KICAgIHZhciBxcjIgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMik7DQogICAgcmVjcyA9IHFyMi5nZXRBcnJheSgicmVjb3JkcyIpOw0KDQogICAgaWYgKHJlY3NbMF0uU1ZNWENfX1Bvc3RlZF9Ub19JbnZlbnRvcnlfX2MgPT0gInRydWUiKQ0KCXsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA0IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBBREpJTlZfUHJvZElkID0gcmVjc1swXS5TVk1YQ19fUHJvZHVjdF9fYzsNCiAgICBBREpJTlZfQWRqUXR5ID0gcmVjc1swXS5TVk1YQ19fTmV3X1F1YW50aXR5Ml9fYzsNCiAgICBBREpJTlZfU2l0ZUlkID0gcmVjc1swXS5TVk1YQ19fTG9jYXRpb25fX2M7DQoNCiAgICB2YXIgUHJvZEFycmF5ID0gU1ZNWElfTXVsdGlEaW1lbnNpb25hbEFycmF5KDEsIDYpOw0KICAgIFByb2RBcnJheVswXVswXSA9IEFESklOVl9Qcm9kSWQ7DQogICAgUHJvZEFycmF5WzBdWzFdID0gQURKSU5WX0FkalF0eTsNCiAgICBQcm9kQXJyYXlbMF1bMl0gPSBBREpJTlZfU2l0ZUlkOw0KICAgIFByb2RBcnJheVswXVszXSA9ICJBdmFpbGFibGUiOw0KICAgIFByb2RBcnJheVswXVs0XSA9IEFESklOVl9TaXRlSWQ7DQogICAgUHJvZEFycmF5WzBdWzVdID0gIkF2YWlsYWJsZSI7DQoNCiAgICAvLyBDYWxsIHNlcmlhbCBzZWxlY3Rpb24gdXRpbGl0eS4gSXQgd2lsbCBjYXB0dXJlIHNlcmlhbCBudW1iZXJzIHdoZXJlIGFwcGxpY2FibGUgYW5kDQogICAgLy8gY2FsbCBiYWNrIHRoZSByb3V0aW5lIGJlbG93IHdpdGggdGhlIHNlbGVjdGVkIHNlcmlhbHMNCiAgICB3aW5kb3cuYmx1cigpOw0KICAgIHZhciByZXR1cm5WYWwgPSBTVk1YSV9Eb1NlcmlhbFNlbGVjdGlvbihQcm9kQXJyYXksICJTdG9jayBBZGp1c3RtZW50IiwgQURKSU5WX0Fkak51bWJlciwgQURKSU5WX1VzZXJJZCwgQURKSU5WX1Nlc3Npb25JZCk7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfQ2FsbGJhY2tfU3RvY2tBZGp1c3RtZW50KFNlcmlhbFNlbGVjdFN0YXR1cywgU2VyaWFsQ291bnQsIFNlcmlhbEFycmF5KQ0Kew0KICAgIHdpbmRvdy5mb2N1cygpOw0KICAgIGlmICghU2VyaWFsU2VsZWN0U3RhdHVzKQ0KICAgIAl7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm4gZmFsc2U7DQoJfQ0KDQogICAgdmFyIHRvdHEgPSAwOw0KICAgIHZhciBTZXJpYWxTYXZlQXJyYXkgPSBTVk1YSV9NdWx0aURpbWVuc2lvbmFsQXJyYXkoU2VyaWFsQ291bnQsIDQpOw0KDQogICAgdmFyIE9sZFF0eSA9IDA7DQogICAgdmFyIHNvcWwxID0gIlNFTEVDVCBTVk1YQ19fUXVhbnRpdHkyX19jIEZST00gU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX2MgIiArDQogICAgCQkiV0hFUkUgU1ZNWENfX1Byb2R1Y3RfX2MgPSAnIiArIEFESklOVl9Qcm9kSWQgKyANCgkJIicgQU5EIFNWTVhDX19Mb2NhdGlvbl9fYyA9ICciICsgQURKSU5WX1NpdGVJZCArIA0KCQkiJyBBTkQgU1ZNWENfX1N0YXR1c19fYyA9ICdBdmFpbGFibGUnIjsNCiAgICB2YXIgcXIxID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDEpOw0KICAgIGlmIChxcjEuc2l6ZSA8PSAwKQ0KICAgIAlPbGRRdHkgPSAwOw0KICAgIGVsc2UNCgl7DQoJcmVjMSA9IHFyMS5nZXRBcnJheSgicmVjb3JkcyIpOw0KCU9sZFF0eSA9IHBhcnNlRmxvYXQocmVjMVswXS5TVk1YQ19fUXVhbnRpdHkyX19jKTsNCgl9DQoNCiAgICB2YXIgQ2hhbmdlUXR5ID0gMDsNCiAgICB2YXIgQ2hhbmdlVHlwZSA9ICIiOw0KICAgIGlmIChBREpJTlZfQWRqUXR5ID4gT2xkUXR5KQ0KICAgIAl7DQoJQ2hhbmdlVHlwZSA9ICJJbmNyZWFzZSI7DQoJQ2hhbmdlUXR5ID0gQURKSU5WX0FkalF0eSAtIE9sZFF0eTsNCgl9DQogICAgZWxzZQ0KICAgIAl7DQoJQ2hhbmdlVHlwZSA9ICJEZWNyZWFzZSI7DQoJQ2hhbmdlUXR5ID0gT2xkUXR5IC0gQURKSU5WX0FkalF0eTsNCgl9DQogICAgLy8gRGVjcmVhc2UgQXZhaWxhYmxlIHN0b2NrIGluIHRoZSBzb3VyY2UgbG9jYXRpb24NCiAgICB2YXIgU3RvY2tBcnIgPSBTVk1YSV9Eb1N0b2NrVXBkYXRlKEFESklOVl9Qcm9kSWQsIEFESklOVl9TaXRlSWQsICJBdmFpbGFibGUiLCBDaGFuZ2VRdHksICJTdG9jayBBZGp1c3RtZW50IiwgQURKSU5WX0Fkak51bWJlciwgQ2hhbmdlVHlwZSwgQURKSU5WX0FkanVzdG1lbnRJZCwgbnVsbCwgQURKSU5WX1VzZXJJZCk7DQogICAgaWYgKCFTdG9ja0FyclswXSkNCgl7CQ0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNSIpKyJcbiIgKyBTdG9ja0Fycls0XSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm4gZmFsc2U7DQoJfQ0KICAgIHZhciBGcm9tUHJvZFN0b2NrSWQgPSBTdG9ja0FyclsxXTsNCiAgICB2YXIgVG9Qcm9kU3RvY2tJZCA9IFN0b2NrQXJyWzFdOw0KDQogICAgLy8gQnVpbGQgc2VyaWFsIG51bWJlciBhcnJheSBmb3IgdGhlIGFkanVzdGVkIHF1YW50aXR5DQogICAgaWYgKFNlcmlhbENvdW50ID4gMCkNCgl7DQoJZm9yICh2YXIgayA9IDA7IGsgPCBTZXJpYWxDb3VudDsgaysrKQ0KCSAgICB7DQoJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVswXSA9IEFESklOVl9Qcm9kSWQ7DQoJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVsxXSA9IEZyb21Qcm9kU3RvY2tJZDsNCgkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzJdID0gVG9Qcm9kU3RvY2tJZDsNCgkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzNdID0gU2VyaWFsQXJyYXlba11bN107DQoJICAgIHRvdHErKzsNCgkgICAgfQ0KCX0NCg0KICAgIC8vIERlbGV0ZSBhbGwgc2VyaWFsIG51bWJlcnMgZnJvbSB0aGUgYWRqdXN0bWVudCBsb2NhdGlvbg0KICAgIHZhciBzb3FsID0gIlNFTEVDVCBJZCBGUk9NIFNWTVhDX19Qcm9kdWN0X1NlcmlhbF9fYyBXSEVSRSBTVk1YQ19fUHJvZHVjdF9TdG9ja19fYyA9ICciICsgVG9Qcm9kU3RvY2tJZCArICInIjsNCiAgICB2YXIgcXIgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsKTsNCiAgICBpZiAocXIuc2l6ZSA+IDApDQoJew0KCXZhciBkZWxyZWNzID0gbmV3IEFycmF5KCk7DQoJdmFyIHNybHJlY3MgPSBuZXcgc2ZvcmNlLlF1ZXJ5UmVzdWx0SXRlcmF0b3IocXIpOw0KCXdoaWxlKHNybHJlY3MuaGFzTmV4dCgpKQ0KCSAgICB7DQoJICAgIHZhciByZWMgPSBzcmxyZWNzLm5leHQoKTsNCgkgICAgdmFyIHNybHJlYyA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1N0b2NrX1NlcmlhbF9fYyIpOw0KCSAgICBzcmxyZWMuSWQgPSByZWMuSWQ7DQoJICAgIGRlbHJlY3MucHVzaChyZWMuSWQpOw0KCSAgICB9DQoNCglpZiAoZGVscmVjcy5sZW5ndGggPiAwKQ0KCSAgICB7DQoJICAgIHRyeSB7DQoJCXNmb3JjZS5jb25uZWN0aW9uLmRlbGV0ZUlkcyhkZWxyZWNzKTsNCgkJfQ0KCSAgICBjYXRjaCAoZSkgewkJDQoJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNiIpKyAiXG4iICsgZSk7DQoJCUNsb3NlV2luZG93KCk7DQoJCXJldHVybiBmYWxzZTsNCgkJfQ0KCSAgICB9DQoJfQ0KDQogICAgLy8gVXBkYXRlIHNlcmlhbCBudW1iZXJzIGZvciB0aGUgYWRqdXN0ZWQgcXVhbnRpdHkNCiAgICBpZiAoU2VyaWFsQ291bnQgPiAwKSB7IHZhciByZXR1cm5WYWwgPSBTVk1YSV9Eb1NlcmlhbFNhdmUoU2VyaWFsU2F2ZUFycmF5LCBBREpJTlZfVXNlcklkKTsgfQ0KDQogICAgdmFyIGFkamxpbmUgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19TdG9ja19BZGp1c3RtZW50X19jIik7DQogICAgYWRqbGluZS5JZCA9IEFESklOVl9BZGp1c3RtZW50SWQ7DQogICAgYWRqbGluZS5TVk1YQ19fUG9zdGVkX1RvX0ludmVudG9yeV9fYyA9IHRydWU7DQoNCiAgICB0cnkgew0KCXNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShbYWRqbGluZV0pOw0KCX0NCiAgICBjYXRjaCAoZSkgewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDciKSsiXG4iICsgZSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm4gZmFsc2U7DQogICAgCX0NCiAgICB3aW5kb3cub3BlbmVyLmxvY2F0aW9uLnJlbG9hZCh0cnVlKTsNCiAgICBDbG9zZVdpbmRvdygpOw0KICAgIHJldHVybiB0cnVlOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Bvc3RTVk9Vc2FnZVRvSW52ZW50b3J5KHNlcnZJZCwgc2Vydk51bSwgdUlkLCBsaW5lSWQsIHNlc3NJZCkNCnsNCiAgICBTVk1YSV9Jbml0TWVzc2FnZUxpc3QoIldPUkRTQzciKTsgDQogICAgU1ZNWElfU2V0TGFiZWxzKCJQb3N0U1ZPVXNhZ2VUb0ludmVudG9yeSIpOyANCgkNCiAgICBTVk9VU0dJTlZfU1ZPSWQgPSBzZXJ2SWQ7DQogICAgU1ZPVVNHSU5WX1VzZXJJZCA9IHVJZDsNCiAgICBTVk9VU0dJTlZfU1ZPTGluZUlkID0gbGluZUlkOw0KICAgIFNWT1VTR0lOVl9TVk9OdW1iZXIgPSBzZXJ2TnVtOw0KICAgIFNWT1VTR0lOVl9TZXNzaW9uSWQgPSBzZXNzSWQ7DQoNCiAgICAvKioqPT09PT09PT09PT09PT0gQ29tbWVudGVkIG91dCBieSBIUzogNi8yNS8yMDA5LiBUaGlzIGlzIGNvbnRyb2xsZWQgYnkgTE1PIG5vdw0KICAgIHZhciBpbnZlbnRvcnlfZW5hYmxlZCA9IGZhbHNlOw0KICAgIHZhciBzb3FsMSA9ICJTRUxFQ1QgU1ZNWENfX0VuYWJsZV9JbnZlbnRvcnlfTW9kdWxlX19jIEZST00gU1ZNWENfX1NlcnZpY2VNYXhfU2V0dGluZ3NfX2MiOw0KICAgIHFyMSA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwxKTsNCiAgICBpZihxcjEuc2l6ZSA+IDApDQoJew0KCXJlYzEgPSBxcjEuZ2V0QXJyYXkoInJlY29yZHMiKTsNCglpbnZlbnRvcnlfZW5hYmxlZCA9IHJlYzFbMF0uU1ZNWENfX0VuYWJsZV9JbnZlbnRvcnlfTW9kdWxlX19jOw0KCX0NCg0KICAgIGlmICghaW52ZW50b3J5X2VuYWJsZWQpDQogICAgCXsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAzIikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICA9PT09PT09PT09PSoqKioqKioqLw0KDQogICAgLy8gR2V0IFNhbGVzZm9yY2UgaW50ZXJuYWwgUmVjb3JkIFR5cGUgSUQgZm9yIFNlcnZpY2Ugb3JkZXIgIlVzYWdlL0NvbnN1bXB0aW9uIg0KICAgIHZhciBzb3FsMiA9ICJTRUxFQ1QgSWQgRlJPTSBSZWNvcmRUeXBlIFdIRVJFIFNvYmplY3RUeXBlID0gJ1NWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2MnIEFORCBOYW1lID0gJ1VzYWdlL0NvbnN1bXB0aW9uJyI7DQogICAgdmFyIHFyMiA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwyKTsgDQogICAgdmFyIHJlYzIgPSBxcjIuZ2V0QXJyYXkoInJlY29yZHMiKTsNCiAgICBpZiAocmVjMi5sZW5ndGggPT0gMCkNCgl7ICAgICAgIA0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNSIpKTsNCiAgICAgICAgQ2xvc2VXaW5kb3coKTsNCiAgICAgICAgcmV0dXJuOw0KCX0NCiAgICBVc2FnZVJlY29yZFR5cGVJZCA9IHJlYzJbMF0uSWQ7DQoNCiAgICB2YXIgc29xbDMgPSAiU0VMRUNUIENvdW50KCkgRlJPTSBTVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jICIgKw0KICAgIAkJIldIRVJFIFNWTVhDX19TZXJ2aWNlX09yZGVyX19jID0gJyIgKyBTVk9VU0dJTlZfU1ZPSWQgKyAiJyBBTkQgUmVjb3JkVHlwZUlkID0gJyIgKyBVc2FnZVJlY29yZFR5cGVJZCArICInIjsNCiAgICB2YXIgcXIzID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDMpOw0KICAgIGlmIChxcjMuc2l6ZSA8PSAwKQ0KICAgIAl7ICAgICAgIA0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNCIpKTsNCiAgICAgICAgQ2xvc2VXaW5kb3coKTsNCiAgICAgICAgcmV0dXJuOw0KCX0NCg0KICAgIHZhciBzb3FsNCA9ICJTRUxFQ1QgSWQsIFNWTVhDX19Db25zdW1lZF9Gcm9tX0xvY2F0aW9uX19jLCBTVk1YQ19fUHJvZHVjdF9fYywgU1ZNWENfX0FjdHVhbF9RdWFudGl0eTJfX2MgRlJPTSBTVk1YQ19fU2VydmljZV9PcmRlcl9MaW5lX19jICIgKw0KICAgIAkJIldIRVJFIFNWTVhDX19TZXJ2aWNlX09yZGVyX19jID0gJyIgKyBTVk9VU0dJTlZfU1ZPSWQgKyAiJyBBTkQgUmVjb3JkVHlwZUlkID0gJyIgKyBVc2FnZVJlY29yZFR5cGVJZCArDQoJCSInIEFORCBTVk1YQ19fTGluZV9UeXBlX19jID0gJ1BhcnRzJyBBTkQgU1ZNWENfX1Bvc3RlZF9Ub19JbnZlbnRvcnlfX2MgPSBmYWxzZSI7DQogICAgaWYgKFNWT1VTR0lOVl9TVk9MaW5lSWQpIHsgc29xbDQgPSBzb3FsNCArICIgQU5EIElkID0gJyIgKyBTVk9VU0dJTlZfU1ZPTGluZUlkICsgIiciOyB9DQogICAgdmFyIHFyNCA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWw0KTsNCiAgICBpZiAocXI0LnNpemUgPD0gMCkNCiAgICAJew0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNiIpKTsgIA0KICAgICAgICBDbG9zZVdpbmRvdygpOw0KICAgICAgICByZXR1cm47DQoJfQ0KICAgIHZhciBsaW5lcmVjcyA9IHFyNC5nZXRBcnJheSgicmVjb3JkcyIpOw0KDQogICAgdmFyIFByb2RBcnJheSA9IFNWTVhJX011bHRpRGltZW5zaW9uYWxBcnJheShsaW5lcmVjcy5sZW5ndGgsIDYpOw0KDQogICAgZm9yICh2YXIgayA9IDA7IGsgPCBsaW5lcmVjcy5sZW5ndGg7IGsrKykNCiAgICAJew0KCXZhciByZWMgPSBsaW5lcmVjc1trXTsNCglpZiAoIXJlYy5TVk1YQ19fQ29uc3VtZWRfRnJvbV9Mb2NhdGlvbl9fYykNCgkgICAgew0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDkiKSk7ICANCgkgICAgQ2xvc2VXaW5kb3coKTsNCgkgICAgcmV0dXJuOw0KCSAgICB9DQoJUHJvZEFycmF5W2tdWzBdID0gcmVjLlNWTVhDX19Qcm9kdWN0X19jOw0KCVByb2RBcnJheVtrXVsxXSA9IHJlYy5TVk1YQ19fQWN0dWFsX1F1YW50aXR5Ml9fYzsNCglQcm9kQXJyYXlba11bMl0gPSByZWMuU1ZNWENfX0NvbnN1bWVkX0Zyb21fTG9jYXRpb25fX2M7DQoJUHJvZEFycmF5W2tdWzNdID0gIkF2YWlsYWJsZSI7DQoJUHJvZEFycmF5W2tdWzRdID0gcmVjLlNWTVhDX19Db25zdW1lZF9Gcm9tX0xvY2F0aW9uX19jOw0KCVByb2RBcnJheVtrXVs1XSA9ICJDb25zdW1lZCI7DQoJfQ0KICAgIFNWT1VTR0lOVl9Vc2FnZVJlY29yZHMgPSBsaW5lcmVjczsNCg0KICAgIC8vIENhbGwgc2VyaWFsIHNlbGVjdGlvbiB1dGlsaXR5LiBJdCB3aWxsIGNhcHR1cmUgc2VyaWFsIG51bWJlcnMgd2hlcmUgYXBwbGljYWJsZSBhbmQNCiAgICAvLyBjYWxsIGJhY2sgdGhlIHJvdXRpbmUgYmVsb3cgd2l0aCB0aGUgc2VsZWN0ZWQgc2VyaWFscw0KICAgIHdpbmRvdy5ibHVyKCk7DQogICAgdmFyIHJldHVyblZhbCA9IFNWTVhJX0RvU2VyaWFsU2VsZWN0aW9uKFByb2RBcnJheSwgIlNWTyBVc2FnZSIsIFNWT1VTR0lOVl9TVk9OdW1iZXIsIFNWT1VTR0lOVl9Vc2VySWQsIFNWT1VTR0lOVl9TZXNzaW9uSWQpOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX0NhbGxiYWNrX1Bvc3RTVk9Vc2FnZShTZXJpYWxTZWxlY3RTdGF0dXMsIFNlcmlhbENvdW50LCBTZXJpYWxBcnJheSkNCnsNCiAgICB3aW5kb3cuZm9jdXMoKTsNCiAgICBpZiAoIVNlcmlhbFNlbGVjdFN0YXR1cykNCiAgICAJew0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuIGZhbHNlOw0KCX0NCiAgICB2YXIgdG90cSA9IDA7DQogICAgdmFyIFNlcmlhbFNhdmVBcnJheSA9IFNWTVhJX011bHRpRGltZW5zaW9uYWxBcnJheShTZXJpYWxDb3VudCwgNCk7DQoNCiAgICBmb3IgKHZhciBqID0gMDsgaiA8IFNWT1VTR0lOVl9Vc2FnZVJlY29yZHMubGVuZ3RoOyBqKyspDQogICAgCXsNCgl2YXIgUHJvZElkID0gU1ZPVVNHSU5WX1VzYWdlUmVjb3Jkc1tqXS5TVk1YQ19fUHJvZHVjdF9fYzsNCgl2YXIgVXNhZ2VRdHkgPSBwYXJzZUZsb2F0KFNWT1VTR0lOVl9Vc2FnZVJlY29yZHNbal0uU1ZNWENfX0FjdHVhbF9RdWFudGl0eTJfX2MpOw0KDQoJLy8gRGVjcmVhc2UgQXZhaWxhYmxlIHN0b2NrIGluIHRoZSB1c2FnZSBsb2NhdGlvbg0KCXZhciBGcm9tU3RvY2tBcnIgPSBTVk1YSV9Eb1N0b2NrVXBkYXRlKFByb2RJZCwgU1ZPVVNHSU5WX1VzYWdlUmVjb3Jkc1tqXS5TVk1YQ19fQ29uc3VtZWRfRnJvbV9Mb2NhdGlvbl9fYywgIkF2YWlsYWJsZSIsIFVzYWdlUXR5LCAiU1ZPIFVzYWdlIiwgU1ZPVVNHSU5WX1NWT051bWJlciwgIkRlY3JlYXNlIiwgU1ZPVVNHSU5WX1NWT0lkLCBTVk9VU0dJTlZfVXNhZ2VSZWNvcmRzW2pdLklkLCBTVk9VU0dJTlZfVXNlcklkKTsNCglpZiAoIUZyb21TdG9ja0FyclswXSkNCgkgICAgewkgICAgDQoJICAgIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNyIpKyJcbiIgKyBGcm9tU3RvY2tBcnJbNF0pOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm4gZmFsc2U7DQoJICAgIH0NCgl2YXIgRnJvbVByb2RTdG9ja0lkID0gRnJvbVN0b2NrQXJyWzFdOw0KDQoJLy8gSW5jcmVhc2UgQ29uc3VtZWQgc3RvY2sgaW4gdGhlIHVzYWdlIGxvY2F0aW9uDQoJdmFyIFRvU3RvY2tBcnIgPSBTVk1YSV9Eb1N0b2NrVXBkYXRlKFByb2RJZCwgU1ZPVVNHSU5WX1VzYWdlUmVjb3Jkc1tqXS5TVk1YQ19fQ29uc3VtZWRfRnJvbV9Mb2NhdGlvbl9fYywgIkNvbnN1bWVkIiwgVXNhZ2VRdHksICJTVk8gVXNhZ2UiLCBTVk9VU0dJTlZfU1ZPTnVtYmVyLCAiSW5jcmVhc2UiLCBTVk9VU0dJTlZfU1ZPSWQsIFNWT1VTR0lOVl9Vc2FnZVJlY29yZHNbal0uSWQsIFNWT1VTR0lOVl9Vc2VySWQpOw0KCWlmICghVG9TdG9ja0FyclswXSkNCgkgICAgewkgICANCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA3IikrIlxuIiArIEZyb21TdG9ja0Fycls0XSk7DQoJICAgIENsb3NlV2luZG93KCk7DQoJICAgIHJldHVybiBmYWxzZTsNCgkgICAgfQ0KCXZhciBUb1Byb2RTdG9ja0lkID0gRnJvbVN0b2NrQXJyWzFdOw0KDQoJLy8gQnVpbGQgc2VyaWFsIG51bWJlciBhcnJheSBmb3IgdGhlIHRyYW5zZmVycmVkIHF1YW50aXR5DQoJaWYgKFNlcmlhbENvdW50ID4gMCkNCgkgICAgew0KCSAgICBmb3IgKHZhciBrID0gMDsgayA8IFNlcmlhbENvdW50OyBrKyspDQoJCXsNCgkJaWYgKFNlcmlhbEFycmF5W2tdWzBdID09IFByb2RJZCAmJiBTZXJpYWxBcnJheVtrXVs0XSA9PSBTVk9VU0dJTlZfVXNhZ2VSZWNvcmRzW2pdLlNWTVhDX19Db25zdW1lZF9Gcm9tX0xvY2F0aW9uX19jKQ0KCQkgICAgew0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzBdID0gUHJvZElkOw0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzFdID0gRnJvbVByb2RTdG9ja0lkOw0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzJdID0gVG9Qcm9kU3RvY2tJZDsNCgkJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVszXSA9IFNlcmlhbEFycmF5W2tdWzddOw0KCQkgICAgdG90cSsrOw0KCQkgICAgfQ0KCQl9DQoJICAgIH0NCgl9DQoNCiAgICAvLyBVcGRhdGUgc2VyaWFsIG51bWJlcnMgZm9yIHRoZSByZWNlaXZlZCBxdWFudGl0eQ0KICAgIGlmIChTZXJpYWxDb3VudCA+IDApIHsgdmFyIHJldHVyblZhbCA9IFNWTVhJX0RvU2VyaWFsU2F2ZShTZXJpYWxTYXZlQXJyYXksIFNWT1VTR0lOVl9Vc2VySWQpOyB9DQoNCiAgICB2YXIgY3VyZGF0ZSA9IG5ldyBEYXRlKCk7DQogICAgdmFyIHN2b2xpbmVzID0gbmV3IEFycmF5KCk7DQogICAgZm9yICh2YXIgbSA9IDA7IG0gPCBTVk9VU0dJTlZfVXNhZ2VSZWNvcmRzLmxlbmd0aDsgbSsrKQ0KICAgIAl7DQoJdmFyIHJlYyA9IFNWT1VTR0lOVl9Vc2FnZVJlY29yZHNbbV07DQoNCgl2YXIgc3ZvbGluZSA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1NlcnZpY2VfT3JkZXJfTGluZV9fYyIpOw0KCXN2b2xpbmUuSWQgPSByZWMuSWQ7DQoJc3ZvbGluZS5TVk1YQ19fUG9zdGVkX1RvX0ludmVudG9yeV9fYyA9IHRydWU7DQoJc3ZvbGluZXMucHVzaChzdm9saW5lKTsNCgl9DQoNCiAgICB0cnkgew0KCXNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShzdm9saW5lcyk7DQoJfQ0KICAgIGNhdGNoIChlKSB7CQ0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwOCIpKyJcbiIgKyBlKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybiBmYWxzZTsNCiAgICAJfQ0KICAgIHdpbmRvdy5vcGVuZXIubG9jYXRpb24ucmVsb2FkKHRydWUpOw0KICAgIENsb3NlV2luZG93KCk7DQogICAgcmV0dXJuIHRydWU7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUG9zdFN0b2NrVHJhbnNmZXJUb0ludmVudG9yeSh0cmZySWQsIHRyZnJOdW0sIHVJZCwgc2Vzc0lkKQ0Kew0KCVNWTVhJX0luaXRNZXNzYWdlTGlzdCgiU1hGUlNDMSIpOyAgDQoJU1ZNWElfU2V0TGFiZWxzKCJQb3N0U3RvY2tUcmFuVG9JbnZlbnRvcnkiKTsgIA0KICAgIHZhciBFcnJNc2cgPSAiIjsNCg0KICAgIFhGUklOVl9YZmVySWQgPSB0cmZySWQ7DQogICAgWEZSSU5WX1VzZXJJZCA9IHVJZDsNCiAgICBYRlJJTlZfWGZlck51bWJlciA9IHRyZnJOdW07DQogICAgWEZSSU5WX1Nlc3Npb25JZCA9IHNlc3NJZDsNCg0KICAgIC8qKio9PT09PT09PT09PT09PSBDb21tZW50ZWQgb3V0IGJ5IEhTOiA2LzI1LzIwMDkuIFRoaXMgaXMgY29udHJvbGxlZCBieSBMTU8gbm93DQogICAgdmFyIGludmVudG9yeV9lbmFibGVkID0gZmFsc2U7DQogICAgdmFyIHNvcWwxID0gIlNFTEVDVCBTVk1YQ19fRW5hYmxlX0ludmVudG9yeV9Nb2R1bGVfX2MgRlJPTSBTVk1YQ19fU2VydmljZU1heF9TZXR0aW5nc19fYyI7DQogICAgcXIxID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDEpOw0KICAgIGlmKHFyMS5zaXplID4gMCkNCgl7DQoJcmVjMSA9IHFyMS5nZXRBcnJheSgicmVjb3JkcyIpOw0KCWludmVudG9yeV9lbmFibGVkID0gcmVjMVswXS5TVk1YQ19fRW5hYmxlX0ludmVudG9yeV9Nb2R1bGVfX2M7DQoJfQ0KDQogICAgaWYgKCFpbnZlbnRvcnlfZW5hYmxlZCkNCiAgICAJewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDMiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgID09PT09PT0qKioqKioqKioqKi8NCg0KICAgIHZhciBzb3FsMiA9ICJTRUxFQ1QgU1ZNWENfX1NvdXJjZV9Mb2NhdGlvbl9fYywgU1ZNWENfX0Rlc3RpbmF0aW9uX0xvY2F0aW9uX19jIEZST00gU1ZNWENfX1N0b2NrX1RyYW5zZmVyX19jIFdIRVJFIElkID0gJyIgKyBYRlJJTlZfWGZlcklkICsgIiciOw0KICAgIHZhciBxcjIgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMik7DQogICAgcmVjMiA9IHFyMi5nZXRBcnJheSgicmVjb3JkcyIpOw0KICAgIGlmIChxcjIuc2l6ZSA8PSAwKQ0KICAgIAl7CQ0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNCIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgWEZSSU5WX1NvdXJjZUxvY0lkID0gcmVjMlswXS5TVk1YQ19fU291cmNlX0xvY2F0aW9uX19jOw0KICAgIFhGUklOVl9EZXN0TG9jSWQgPSByZWMyWzBdLlNWTVhDX19EZXN0aW5hdGlvbl9Mb2NhdGlvbl9fYzsNCg0KICAgIHZhciBzb3FsMyA9ICJTRUxFQ1QgSWQsIFNWTVhDX19Qcm9kdWN0X19jLCBTVk1YQ19fUHJvZHVjdF9fci5OYW1lLCBTVk1YQ19fUXVhbnRpdHlfVHJhbnNmZXJyZWQyX19jLCBTVk1YQ19fUG9zdGVkX1RvX0ludmVudG9yeV9fYyAiICsNCiAgICAJCSJGUk9NIFNWTVhDX19TdG9ja19UcmFuc2Zlcl9MaW5lX19jIFdIRVJFIFNWTVhDX19TdG9ja19UcmFuc2Zlcl9fYyA9ICciICsgWEZSSU5WX1hmZXJJZCArICInIjsNCiAgICB2YXIgcXIzID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDMpOw0KICAgIHJlY3MgPSBxcjMuZ2V0QXJyYXkoInJlY29yZHMiKTsNCg0KICAgIHZhciBQcm9kQXJyYXkgPSBTVk1YSV9NdWx0aURpbWVuc2lvbmFsQXJyYXkocmVjcy5sZW5ndGgsIDYpOw0KDQogICAgdmFyIGludmFsaWQgPSBmYWxzZTsNCiAgICBmb3IgKHZhciBrID0gMDsgayA8IHJlY3MubGVuZ3RoOyBrKyspDQogICAgCXsNCgl2YXIgcmVjID0gcmVjc1trXTsNCg0KCWlmIChyZWMuU1ZNWENfX1Bvc3RlZF9Ub19JbnZlbnRvcnlfX2MgPT0gInRydWUiKQ0KCSAgICB7DQoJICAgIGludmFsaWQgPSB0cnVlOw0KCSAgICBicmVhazsNCgkgICAgfQ0KCXZhciBzb3FsNCA9ICJTRUxFQ1QgU1ZNWENfX1F1YW50aXR5Ml9fYyBGUk9NIFNWTVhDX19Qcm9kdWN0X1N0b2NrX19jIFdIRVJFIFNWTVhDX19Qcm9kdWN0X19jID0gJyIgKyByZWMuU1ZNWENfX1Byb2R1Y3RfX2MgKyAiJyAiICsNCgkJIkFORCBTVk1YQ19fTG9jYXRpb25fX2MgPSAnIiArIFhGUklOVl9Tb3VyY2VMb2NJZCArICInIEFORCBTVk1YQ19fU3RhdHVzX19jID0gJ0F2YWlsYWJsZSciOw0KCXZhciBxcjQgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsNCk7DQoJaWYgKHFyNC5zaXplIDw9IDApDQoJICAgIHZhciBhdmxibF9xdHkgPSAwOw0KCWVsc2UgDQoJICAgIHsNCgkgICAgdmFyIHJlYzQgPSBxcjQuZ2V0QXJyYXkoInJlY29yZHMiKTsNCgkgICAgdmFyIGF2bGJsX3F0eSA9IHBhcnNlRmxvYXQocmVjNFswXS5TVk1YQ19fUXVhbnRpdHkyX19jKTsNCgkgICAgfQ0KCWlmIChwYXJzZUZsb2F0KHJlYy5TVk1YQ19fUXVhbnRpdHlfVHJhbnNmZXJyZWQyX19jKSA+IGF2bGJsX3F0eSkNCgkgICAgewkJDQoJICAgIEVyck1zZyA9IEVyck1zZyArIHJlYy5TVk1YQ19fUHJvZHVjdF9fci5OYW1lICsgU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA1IikgKyAiXG4iOw0KCSAgICB9DQoJCQ0KCVByb2RBcnJheVtrXVswXSA9IHJlYy5TVk1YQ19fUHJvZHVjdF9fYzsNCglQcm9kQXJyYXlba11bMV0gPSByZWMuU1ZNWENfX1F1YW50aXR5X1RyYW5zZmVycmVkMl9fYzsNCglQcm9kQXJyYXlba11bMl0gPSBYRlJJTlZfU291cmNlTG9jSWQ7DQoJUHJvZEFycmF5W2tdWzNdID0gIkF2YWlsYWJsZSI7DQoJUHJvZEFycmF5W2tdWzRdID0gWEZSSU5WX0Rlc3RMb2NJZDsNCglQcm9kQXJyYXlba11bNV0gPSAiQXZhaWxhYmxlIjsNCgl9DQoNCiAgICBpZiAoaW52YWxpZCkNCiAgICAJewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDYiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIGlmIChFcnJNc2cubGVuZ3RoID4gMCkNCiAgICAJew0KCWFsZXJ0KEVyck1zZyk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KDQogICAgWEZSSU5WX1hmZXJSZWNvcmRzID0gcmVjczsNCg0KICAgIC8vIENhbGwgc2VyaWFsIHNlbGVjdGlvbiB1dGlsaXR5LiBJdCB3aWxsIGNhcHR1cmUgc2VyaWFsIG51bWJlcnMgd2hlcmUgYXBwbGljYWJsZSBhbmQNCiAgICAvLyBjYWxsIGJhY2sgdGhlIHJvdXRpbmUgYmVsb3cgd2l0aCB0aGUgc2VsZWN0ZWQgc2VyaWFscw0KICAgIHdpbmRvdy5ibHVyKCk7DQogICAgdmFyIHJldHVyblZhbCA9IFNWTVhJX0RvU2VyaWFsU2VsZWN0aW9uKFByb2RBcnJheSwgIlN0b2NrIFRyYW5zZmVyIiwgWEZSSU5WX1hmZXJOdW1iZXIsIFhGUklOVl9Vc2VySWQsIFhGUklOVl9TZXNzaW9uSWQpOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX0NhbGxiYWNrX1N0b2NrVHJhbnNmZXIoU2VyaWFsU2VsZWN0U3RhdHVzLCBTZXJpYWxDb3VudCwgU2VyaWFsQXJyYXkpDQp7DQogICAgd2luZG93LmZvY3VzKCk7DQogICAgaWYgKCFTZXJpYWxTZWxlY3RTdGF0dXMpDQogICAgCXsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybiBmYWxzZTsNCgl9DQogICAgdmFyIHRvdHEgPSAwOw0KICAgIHZhciBTZXJpYWxTYXZlQXJyYXkgPSBTVk1YSV9NdWx0aURpbWVuc2lvbmFsQXJyYXkoU2VyaWFsQ291bnQsIDQpOw0KDQogICAgZm9yICh2YXIgaiA9IDA7IGogPCBYRlJJTlZfWGZlclJlY29yZHMubGVuZ3RoOyBqKyspDQogICAgCXsNCgl2YXIgUHJvZElkID0gWEZSSU5WX1hmZXJSZWNvcmRzW2pdLlNWTVhDX19Qcm9kdWN0X19jOw0KCXZhciBYZmVyUXR5ID0gcGFyc2VGbG9hdChYRlJJTlZfWGZlclJlY29yZHNbal0uU1ZNWENfX1F1YW50aXR5X1RyYW5zZmVycmVkMl9fYyk7DQoNCgkvLyBEZWNyZWFzZSBBdmFpbGFibGUgc3RvY2sgaW4gdGhlIHNvdXJjZSBsb2NhdGlvbg0KCXZhciBGcm9tU3RvY2tBcnIgPSBTVk1YSV9Eb1N0b2NrVXBkYXRlKFByb2RJZCwgWEZSSU5WX1NvdXJjZUxvY0lkLCAiQXZhaWxhYmxlIiwgWGZlclF0eSwgIlN0b2NrIFRyYW5zZmVyIiwgWEZSSU5WX1hmZXJOdW1iZXIsICJEZWNyZWFzZSIsIFhGUklOVl9YZmVySWQsIFhGUklOVl9YZmVyUmVjb3Jkc1tqXS5JZCwgWEZSSU5WX1VzZXJJZCk7DQoJaWYgKCFGcm9tU3RvY2tBcnJbMF0pDQoJICAgIHsJICAgDQoJICAgIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNyIpKyJcbiIgKyBGcm9tU3RvY2tBcnJbNF0pOw0KCSAgICBDbG9zZVdpbmRvdygpOw0KCSAgICByZXR1cm4gZmFsc2U7DQoJICAgIH0NCgl2YXIgRnJvbVByb2RTdG9ja0lkID0gRnJvbVN0b2NrQXJyWzFdOw0KDQoJLy8gSW5jcmVhc2UgQXZhaWxhYmxlIHN0b2NrIGluIHRoZSB0YXJnZXQgbG9jYXRpb24NCgl2YXIgVG9TdG9ja0FyciA9IFNWTVhJX0RvU3RvY2tVcGRhdGUoUHJvZElkLCBYRlJJTlZfRGVzdExvY0lkLCAiQXZhaWxhYmxlIiwgWGZlclF0eSwgIlN0b2NrIFRyYW5zZmVyIiwgWEZSSU5WX1hmZXJOdW1iZXIsICJJbmNyZWFzZSIsIFhGUklOVl9YZmVySWQsIFhGUklOVl9YZmVyUmVjb3Jkc1tqXS5JZCwgWEZSSU5WX1VzZXJJZCk7DQoJaWYgKCFUb1N0b2NrQXJyWzBdKQ0KCSAgICB7CSAgICANCgkgICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA3IikrIlxuIiArIEZyb21TdG9ja0Fycls0XSk7DQoJICAgIENsb3NlV2luZG93KCk7DQoJICAgIHJldHVybiBmYWxzZTsNCgkgICAgfQ0KCXZhciBUb1Byb2RTdG9ja0lkID0gRnJvbVN0b2NrQXJyWzFdOw0KDQoJLy8gQnVpbGQgc2VyaWFsIG51bWJlciBhcnJheSBmb3IgdGhlIHRyYW5zZmVycmVkIHF1YW50aXR5DQoJaWYgKFNlcmlhbENvdW50ID4gMCkNCgkgICAgew0KCSAgICBmb3IgKHZhciBrID0gMDsgayA8IFNlcmlhbENvdW50OyBrKyspDQoJCXsNCgkJaWYgKFNlcmlhbEFycmF5W2tdWzBdID09IFByb2RJZCAmJiBTZXJpYWxBcnJheVtrXVs0XSA9PSBYRlJJTlZfRGVzdExvY0lkKQ0KCQkgICAgew0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzBdID0gUHJvZElkOw0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzFdID0gRnJvbVByb2RTdG9ja0lkOw0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzJdID0gVG9Qcm9kU3RvY2tJZDsNCgkJICAgIFNlcmlhbFNhdmVBcnJheVt0b3RxXVszXSA9IFNlcmlhbEFycmF5W2tdWzddOw0KCQkgICAgdG90cSsrOw0KCQkgICAgfQ0KCQl9DQoJICAgIH0NCgl9DQoNCiAgICAvLyBVcGRhdGUgc2VyaWFsIG51bWJlcnMgZm9yIHRoZSByZWNlaXZlZCBxdWFudGl0eQ0KICAgIGlmIChTZXJpYWxDb3VudCA+IDApIHsgdmFyIHJldHVyblZhbCA9IFNWTVhJX0RvU2VyaWFsU2F2ZShTZXJpYWxTYXZlQXJyYXksIFhGUklOVl9Vc2VySWQpOyB9DQoNCiAgICB2YXIgY3VyZGF0ZSA9IG5ldyBEYXRlKCk7DQogICAgdmFyIGludmFsaWQgPSBmYWxzZTsNCiAgICB2YXIgeGZlcmxpbmVzID0gbmV3IEFycmF5KCk7DQogICAgZm9yICh2YXIgbSA9IDA7IG0gPCBYRlJJTlZfWGZlclJlY29yZHMubGVuZ3RoOyBtKyspDQogICAgCXsNCgl2YXIgcmVjID0gWEZSSU5WX1hmZXJSZWNvcmRzW21dOw0KDQoJdmFyIHhmZXJsaW5lID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fU3RvY2tfVHJhbnNmZXJfTGluZV9fYyIpOw0KCXhmZXJsaW5lLklkID0gcmVjLklkOw0KCXhmZXJsaW5lLlNWTVhDX19Qb3N0ZWRfVG9fSW52ZW50b3J5X19jID0gdHJ1ZTsNCgl4ZmVybGluZXMucHVzaCh4ZmVybGluZSk7DQoJfQ0KDQogICAgdHJ5IHsNCglzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUoeGZlcmxpbmVzKTsNCgl9DQogICAgY2F0Y2ggKGUpIHsJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA4IikrIlxuIiArIGUpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuIGZhbHNlOw0KICAgIAl9DQogICAgd2luZG93Lm9wZW5lci5sb2NhdGlvbi5yZWxvYWQodHJ1ZSk7DQogICAgQ2xvc2VXaW5kb3coKTsNCiAgICByZXR1cm4gdHJ1ZTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Qcm9jUk1BX1Nob3dMaW5lcyhybWFJZCwgcm1hbnVtLCB1SWQsIGxpbmVJZCwgc2Vzc0lkKQ0Kew0KICAgIFNWTVhJX0luaXRNZXNzYWdlTGlzdCgiUE9SRFNDNiIpOyANCiAgICBTVk1YSV9TZXRMYWJlbHMoIlByb2Nlc3NSZWNlaXB0c0ZvclJNQSIpOyANCgkNCiAgICBQUlJNQV9STUFJZCA9IHJtYUlkOw0KICAgIFBSUk1BX1VzZXJJZCA9IHVJZDsNCiAgICBQUlJNQV9STUFMaW5lSWQgPSBsaW5lSWQ7DQogICAgUFJSTUFfUk1BTnVtYmVyID0gcm1hbnVtOw0KICAgIFBSUk1BX1Nlc3Npb25JZCA9IHNlc3NJZDsNCg0KICAgIC8vIEdldCBSTUEgaGVhZGVyIGluZm8NCiAgICB2YXIgc29xbDEgPSAiU0VMRUNUIFNWTVhDX19Tb3VyY2VfTG9jYXRpb25fX2MsIFNWTVhDX19EZXN0aW5hdGlvbl9Mb2NhdGlvbl9fYywgU1ZNWENfX09yZGVyX1N0YXR1c19fYywgIiArDQoJCSJTVk1YQ19fU291cmNlX0xvY2F0aW9uX19yLlNWTVhDX19TdG9ja2luZ19Mb2NhdGlvbl9fYywgU1ZNWENfX0Rlc3RpbmF0aW9uX0xvY2F0aW9uX19yLlNWTVhDX19TdG9ja2luZ19Mb2NhdGlvbl9fYywgIiArDQoJCSJTVk1YQ19fRGVzdGluYXRpb25fTG9jYXRpb25fX3IuU1ZNWENfX0Nvc3RlZF9hdF92YWx1ZV9fYyAiICsNCiAgICAJCSJGUk9NIFNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MgV0hFUkUgSWQgPSAnIiArIFBSUk1BX1JNQUlkICsgIiciOw0KICAgIHZhciBxcjEgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMSk7DQogICAgaWYgKHFyMS5zaXplIDw9IDApDQoJewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDIiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIHZhciByZWMxID0gcXIxLmdldEFycmF5KCJyZWNvcmRzIik7DQogICAgaWYgKHJlYzFbMF0uU1ZNWENfX09yZGVyX1N0YXR1c19fYyA9PSAiQ2xvc2VkIikNCiAgICAJewkNCgkgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDAzIikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBpZiAocmVjMVswXS5TVk1YQ19fT3JkZXJfU3RhdHVzX19jID09ICJDYW5jZWxlZCIpDQogICAgCXsJDQoJIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNCIpKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybjsNCgl9DQogICAgaWYgKCFyZWMxWzBdLlNWTVhDX19EZXN0aW5hdGlvbl9Mb2NhdGlvbl9fYykNCiAgICAJewkJDQoJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA1IikpOw0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICBpZiAoIXJlYzFbMF0uU1ZNWENfX0Rlc3RpbmF0aW9uX0xvY2F0aW9uX19yLlNWTVhDX19TdG9ja2luZ19Mb2NhdGlvbl9fYykNCiAgICAJewkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDYiKSk7DQoJQ2xvc2VXaW5kb3coKTsNCglyZXR1cm47DQoJfQ0KICAgIFBSUk1BX1NvdXJjZUxvY0lkID0gcmVjMVswXS5TVk1YQ19fU291cmNlX0xvY2F0aW9uX19jOw0KICAgIFBSUk1BX0Rlc3RMb2NJZCA9IHJlYzFbMF0uU1ZNWENfX0Rlc3RpbmF0aW9uX0xvY2F0aW9uX19jOw0KICAgIFBSUk1BX0Rlc3RDb3N0ZWRBdFZhbHVlID0gcmVjMVswXS5TVk1YQ19fRGVzdGluYXRpb25fTG9jYXRpb25fX3IuU1ZNWENfX0Nvc3RlZF9hdF92YWx1ZV9fYzsNCg0KICAgIC8vIEdldCBTYWxlc2ZvcmNlIGludGVybmFsIFJlY29yZCBUeXBlIElEIGZvciBSTUEgTGluZSAiUk1BIg0KICAgIHZhciBzb3FsID0gIlNFTEVDVCBJZCBGUk9NIFJlY29yZFR5cGUgV0hFUkUgU29iamVjdFR5cGUgPSAnU1ZNWENfX1JNQV9TaGlwbWVudF9MaW5lX19jJyBBTkQgTmFtZSA9ICdSTUEnIg0KICAgIHZhciBxdWVyeVJlc3VsdCA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwpOyANCiAgICB2YXIgcnRyZWNvcmRzID0gcXVlcnlSZXN1bHQuZ2V0QXJyYXkoInJlY29yZHMiKTsNCiAgICBpZiAocnRyZWNvcmRzLmxlbmd0aCA9PSAwKQ0KCXsgICAgICAgIA0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMCIpKTsNCiAgICAgICAgd2luZG93LmNsb3NlKCk7DQogICAgICAgIHJldHVybjsNCgl9DQogICAgUFJSTUFfUmVjb3JkVHlwZUlkID0gcnRyZWNvcmRzWzBdLklkOw0KDQogICAgLy8gR2V0IG9wZW4gUk1BIGxpbmVzDQogICAgdmFyIHNvcWwyID0gIlNFTEVDVCBJZCwgU1ZNWENfX1Byb2R1Y3RfX2MsIFNWTVhDX19Qcm9kdWN0X19yLk5hbWUsICIgKw0KICAgIAkJIlNWTVhDX19FeHBlY3RlZF9RdWFudGl0eTJfX2MsIFNWTVhDX19FeHBlY3RlZF9SZWNlaXB0X0RhdGVfX2MgIiArDQoJCSJGUk9NIFNWTVhDX19STUFfU2hpcG1lbnRfTGluZV9fYyBXSEVSRSBTVk1YQ19fUk1BX1NoaXBtZW50X09yZGVyX19jID0gJyIgKyBQUlJNQV9STUFJZCArICInIEFORCAiICsNCgkJIlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICdPcGVuJyBBTkQgUmVjb3JkVHlwZUlkID0gJyIgKyBQUlJNQV9SZWNvcmRUeXBlSWQgKyAiJyI7DQogICAgaWYgKFBSUk1BX1JNQUxpbmVJZCkgeyBzb3FsMiA9IHNvcWwyICsgIiBBTkQgSWQgPSAnIiArIFBSUk1BX1JNQUxpbmVJZCArICInIiB9IDsNCiAgICB2YXIgcXIyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDIpOw0KICAgIGlmIChxcjIuc2l6ZSA8PSAwKQ0KCXsNCglpZiAoUFJSTUFfUk1BTGluZUlkKQ0KCQl7CQkJDQoJCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAwNyIpKSA7DQoJCX0NCgllbHNlDQoJCXsJCQkNCgkJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDA4IikpIDsNCgkJfQ0KCUNsb3NlV2luZG93KCk7DQoJcmV0dXJuOw0KCX0NCiAgICB2YXIgcm1hcmVjcyA9IG5ldyBzZm9yY2UuUXVlcnlSZXN1bHRJdGVyYXRvcihxcjIpOw0KDQogICAgdmFyIHJvd251bSA9IDA7DQogICAgdmFyIHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpc3RfdGJvZHkiKTsNCg0KICAgIFNWTVhJX1Byb2NSTUFfRHJhd0hlYWRlcih0Ym9keSk7ICANCg0KICAgIHZhciBub2xvYyA9IDA7DQogICAgd2hpbGUocm1hcmVjcy5oYXNOZXh0KCkpDQoJew0KCXZhciBybWFyZWMgPSBybWFyZWNzLm5leHQoKTsNCg0KCXZhciBybWFsaW5laWQgPSBybWFyZWMuSWQ7DQoJdmFyIHByb2RpZCA9IHJtYXJlYy5TVk1YQ19fUHJvZHVjdF9fYzsNCgl2YXIgRXhwUXR5ID0gcGFyc2VGbG9hdChybWFyZWMuU1ZNWENfX0V4cGVjdGVkX1F1YW50aXR5Ml9fYyk7DQoNCgl2YXIgdHIgPSBtYWtlUm93KG1ha2VBdHRycyhyb3dudW0sdGJvZHkpICk7DQoJdHIuc29iamVjdCA9IHJtYXJlYzsNCgl0Ym9keS5hcHBlbmRDaGlsZCh0cik7DQoNCgkJLy8gQ29sIDEuIFByb2R1Y3QgTmFtZQ0KCWNyZWF0ZVRhZyh0ciwidGgiLHsic2NvcGUiOiJyb3cifSkuaW5uZXJIVE1MID0NCgkJIjxhIHRhcmdldD1fYmxhbmsgaHJlZj1cIi8iICsgcHJvZGlkICsgIlwiPiIgKyBwcm9kaWQgPyBybWFyZWMuU1ZNWENfX1Byb2R1Y3RfX3IuTmFtZSA6ICJVbmtub3duIiArICI8L2E+IjsNCg0KCQkvLyBDb2wgMi4gRXhwZWN0ZWQgUXVhbnRpdHkNCgljcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSI8aW5wdXQgZGlzYWJsZWQ9XCJ0cnVlXCIgdHlwZT1cInRleHRcIiBpZD1cIiIgKyBybWFsaW5laWQgKyAiRXhwUXR5XCIgbmFtZT1cIiIgKyBybWFsaW5laWQgKyAiRXhwUXR5XCIgdmFsdWU9XCIiICsgRXhwUXR5ICsgIlwiPjwvaW5wdXQ+IjsNCg0KCQkvLyBDb2wgMy4gUmVjZWl2ZWQgUXVhbnRpdHkNCgljcmVhdGVUYWcodHIsInRkIiwgW10pLmlubmVySFRNTCA9DQoJCSI8aW5wdXQgdHlwZT1cInRleHRcIiBpZD1cIiIgKyBybWFsaW5laWQgKyAiUmN2UXR5XCIgbmFtZT1cIiIgKyBybWFsaW5laWQgKyAiUmN2UXR5XCIgdmFsdWU9XCIiICsgRXhwUXR5ICsgIlwiIG9uY2hhbmdlPVwiU1ZNWElfUHJvY1JNQV9WYWxpZGF0ZVF1YW50aXR5KHRoaXMpO1wiPjwvaW5wdXQ+IjsNCg0KCQkvLyBDb2wgNC4gQ2hlY2tib3gNCgljcmVhdGVUYWcodHIsInRkIix7J2NsYXNzJzonYWN0aW9uQ29sdW1uJywnYWxpZ24nOidjZW50ZXInfSkuaW5uZXJIVE1MID0NCgkJIjxpbnB1dCBjaGVja2VkPVwidHJ1ZVwiIGRpc2FibGVkPVwidHJ1ZVwiIHR5cGU9XCJjaGVja2JveFwiIGlkPVwiIiArIHJtYWxpbmVpZCArICJDaGVja2JveFwiIG5hbWU9XCJpZHNcIiB2YWx1ZT1cIiIgKyBybWFsaW5laWQgKyAiXCIgPiZuYnNwOyI7DQoNCgkJLy8gQ29sIDUuIFN0YXR1cyBNZXNzYWdlDQoJY3JlYXRlVGFnKHRyLCJ0ZCIsIFtdKS5pbm5lckhUTUwgPQ0KCQkiPGRpdiBpZD1cIiIgKyBybWFsaW5laWQgKyAiRXJyTXNnXCIgbmFtZT1cIiIgKyBybWFsaW5laWQgKyAiRXJyTXNnXCI+PC9kaXY+IjsNCg0KCXJvd251bSArPSAxOw0KCX0NCg0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YWl0bXNnJykuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nOyANCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2FpdG1zZycpLnN0eWxlLmhlaWdodCA9IDA7IA0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX1Byb2NSTUFfVmFsaWRhdGVRdWFudGl0eShjdHJsKQ0Kew0KICAgIHZhciBybWFsaW5laWQgPSBjdHJsLm5hbWUuc3Vic3RyaW5nKDAsMTgpOw0KICAgIHZhciBleHBxdHluYW1lID0gcm1hbGluZWlkICsgIkV4cFF0eSI7DQogICAgdmFyIGV4cHF0eSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGV4cHF0eW5hbWUpOw0KDQogICAgaWYocGFyc2VGbG9hdChjdHJsLnZhbHVlKSA+PSBwYXJzZUZsb2F0KGV4cHF0eS52YWx1ZSkpDQogICAgCXsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZChybWFsaW5laWQrIkNoZWNrYm94IikuY2hlY2tlZCA9IHRydWU7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocm1hbGluZWlkKyJDaGVja2JveCIpLmRpc2FibGVkID0gdHJ1ZTsNCgl9DQogICAgZWxzZQ0KICAgIAl7DQoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocm1hbGluZWlkKyJDaGVja2JveCIpLmNoZWNrZWQgPSBmYWxzZTsNCglkb2N1bWVudC5nZXRFbGVtZW50QnlJZChybWFsaW5laWQrIkNoZWNrYm94IikuZGlzYWJsZWQgPSBmYWxzZTsNCgl9DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUHJvY1JNQV9EcmF3SGVhZGVyKHRhKQ0Kew0KICAgIHZhciB0ciA9IG1ha2VSb3coeydjbGFzcyc6J2hlYWRlclJvdyd9KTsNCiAgICB0YS5hcHBlbmRDaGlsZCh0cik7DQoJDQoNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnfSkuaW5uZXJIVE1MID0NCgkgICAgIjxhIGhyZWY9XCIjXCIgdGl0bGU9XCJcIj4iK1NWTVhJX0dldE1lc3NhZ2UoJ0xBQjAwNScpKyI8L2E+IjsNCg0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnc2NvcGUnOidjb2wnLCdhbGlnbic6J3JpZ2h0J30pLmlubmVySFRNTCA9DQoJICAgICI8YSBocmVmPVwiI1wiIHRpdGxlPVwiXCI+IitTVk1YSV9HZXRNZXNzYWdlKCdMQUIwMDYnKSsiPC9hPiI7DQoNCiAgICBjcmVhdGVUYWcodHIsInRoIix7J3Njb3BlJzonY29sJywnYWxpZ24nOidyaWdodCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgnTEFCMDA3JykrIjwvYT4iOw0KDQogICAgY3JlYXRlVGFnKHRyLCJ0aCIseydzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPQ0KCSAgICAiPGEgaHJlZj1cIiNcIiB0aXRsZT1cIlwiPiIrU1ZNWElfR2V0TWVzc2FnZSgnTEFCMDA4JykrIjwvYT4iOw0KCQkNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9Qcm9jUk1BX1ZhbGlkYXRlQW5kUHJvY2VzcygpDQp7DQogICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1snUHJvY2Vzc1JlY2VpcHRzRm9yUk1BJ107DQoNCiAgICB2YXIgc29iamVjdExpc3QgPSBuZXcgQXJyYXkoKTsNCiAgICBmb3IgKGkgPSAwOyBpIDwgZm9ybS5lbGVtZW50cy5sZW5ndGg7IGkrKykNCgl7DQoJaWYgKGZvcm0uZWxlbWVudHNbaV0ubmFtZSA9PSAnaWRzJykNCgkgICAgew0KCSAgICB2YXIgcG4gPSBmb3JtLmVsZW1lbnRzW2ldLnBhcmVudE5vZGU7DQoJICAgIHZhciBwcG4gPSBmb3JtLmVsZW1lbnRzW2ldLnBhcmVudE5vZGUucGFyZW50Tm9kZTsNCgkgICAgaWYgKHBwbi5zb2JqZWN0KQ0KCQl7DQoJCXNvYmplY3RMaXN0LnB1c2gocHBuLnNvYmplY3QpOw0KCQl9DQoJICAgIH0NCgl9DQoNCiAgICB2YXIgdmFsaWRfcmVjZWlwdHMgPSBuZXcgQXJyYXkoKTsNCiAgICB2YXIgaW52YWxpZCA9IGZhbHNlOw0KICAgIHZhciBza2lwY250ID0gMDsNCiAgICBpbnZhbGlkID0gZmFsc2U7DQogICAgZm9yICh2YXIgayA9IDA7IGsgPCBzb2JqZWN0TGlzdC5sZW5ndGg7IGsrKykNCiAgICAJew0KCXZhciByZWNfaW52YWxpZCA9IGZhbHNlOw0KCXZhciByZWMgPSBzb2JqZWN0TGlzdFtrXTsNCgl2YXIgUmN2UXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIlJjdlF0eSIpLnZhbHVlKTsNCgl2YXIgRXhwUXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkV4cFF0eSIpLnZhbHVlKTsNCgl2YXIgY2hlY2tlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiQ2hlY2tib3giKS5jaGVja2VkOw0KCQ0KCXZhciBFcnJNc2cgPSAiIjsNCglpZiAoaXNOYU4oUmN2UXR5KSB8fCBSY3ZRdHkgPCAwKQ0KCSAgICB7DQoJICAgIEVyck1zZyA9IFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxMSIpOw0KCSAgICBpbnZhbGlkID0gdHJ1ZTsNCgkgICAgcmVjX2ludmFsaWQgPSB0cnVlOw0KCSAgICB9DQoJZWxzZSBpZiAoIWNoZWNrZWQgJiYgUmN2UXR5ID09IDApDQoJICAgIHsNCgkgICAgc2tpcGNudCArPSAxOw0KCSAgICB9DQoJZWxzZSBpZihSY3ZRdHkgPiBFeHBRdHkpDQoJICAgIHsNCgkgICAgRXJyTXNnID1TVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTIiKTsNCgkgICAgaW52YWxpZCA9IHRydWU7DQoJICAgIHJlY19pbnZhbGlkID0gdHJ1ZTsNCgkgICAgfQ0KCWlmIChyZWNfaW52YWxpZCkNCgkgICAgew0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkVyck1zZyIpLnN0eWxlLmJvcmRlciA9ICIjRkYwMDAwIDJweCBzb2xpZCI7DQoJICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiRXJyTXNnIikuaW5uZXJIVE1MID0gRXJyTXNnOw0KCSAgICB9DQoJZWxzZQ0KCSAgICB7DQoJICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiRXJyTXNnIikuc3R5bGUuYm9yZGVyID0gIjAiOw0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZWMuSWQrIkVyck1zZyIpLmlubmVySFRNTCA9ICIiOw0KCSAgICB9DQoJaWYgKCFyZWNfaW52YWxpZCAmJiBSY3ZRdHkgPiAwKQ0KCSAgICB2YWxpZF9yZWNlaXB0cy5wdXNoKHJlYyk7DQoJfQ0KDQogICAgaWYoaW52YWxpZCkgeyByZXR1cm47IH0NCg0KICAgIGlmKHNraXBjbnQgPT0gc29iamVjdExpc3QubGVuZ3RoKQ0KCXsJCQkNCglhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMDkiKSk7DQoJcmV0dXJuOw0KCX0NCiAgICBQUlJNQV9SZWNlaXB0cyA9IHZhbGlkX3JlY2VpcHRzOw0KICAgIFNWTVhJX1Byb2NSTUFfUHJvY2Vzc1JlY2VpcHRzKCk7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfUHJvY1JNQV9Qcm9jZXNzUmVjZWlwdHMoKQ0Kew0KICAgIHZhciBQcm9kQXJyYXkgPSBTVk1YSV9NdWx0aURpbWVuc2lvbmFsQXJyYXkoUFJSTUFfUmVjZWlwdHMubGVuZ3RoLCA2KTsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IFBSUk1BX1JlY2VpcHRzLmxlbmd0aDsgaSsrKQ0KCXsNCgl2YXIgUmN2UXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUlJNQV9SZWNlaXB0c1tpXS5JZCsiUmN2UXR5IikudmFsdWUpOw0KCVByb2RBcnJheVtpXVswXSA9IFBSUk1BX1JlY2VpcHRzW2ldLlNWTVhDX19Qcm9kdWN0X19jOw0KCVByb2RBcnJheVtpXVsxXSA9IFJjdlF0eTsNCglQcm9kQXJyYXlbaV1bMl0gPSBQUlJNQV9EZXN0TG9jSWQ7DQoJUHJvZEFycmF5W2ldWzNdID0gIkluIFRyYW5zaXQiOw0KCVByb2RBcnJheVtpXVs0XSA9IFBSUk1BX0Rlc3RMb2NJZDsNCglQcm9kQXJyYXlbaV1bNV0gPSAiQXZhaWxhYmxlIjsNCgl9DQogICAgLy8gQ2FsbCBzZXJpYWwgc2VsZWN0aW9uIHV0aWxpdHkuIEl0IHdpbGwgY2FwdHVyZSBzZXJpYWwgbnVtYmVycyB3aGVyZSBhcHBsaWNhYmxlIGFuZA0KICAgIC8vIGNhbGwgYmFjayB0aGUgcm91dGluZSBiZWxvdyB3aXRoIHRoZSBzZWxlY3RlZCBzZXJpYWxzDQogICAgd2luZG93LmJsdXIoKTsNCiAgICB2YXIgcmV0dXJuVmFsID0gU1ZNWElfRG9TZXJpYWxTZWxlY3Rpb24oUHJvZEFycmF5LCAiUk1BIFJlY2VpcHQiLCBQUlJNQV9STUFOdW1iZXIsIFBSUk1BX1VzZXJJZCwgUFJSTUFfU2Vzc2lvbklkKTsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9DYWxsYmFja19Qcm9jZXNzUk1BUmVjZWlwdHMoU2VyaWFsU2VsZWN0U3RhdHVzLCBTZXJpYWxDb3VudCwgU2VyaWFsQXJyYXkpDQp7DQogICAgd2luZG93LmZvY3VzKCk7DQogICAgaWYgKCFTZXJpYWxTZWxlY3RTdGF0dXMpDQogICAgCXsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybiBmYWxzZTsNCgl9DQogICAgdmFyIHRvdHEgPSAwOw0KICAgIHZhciBTZXJpYWxTYXZlQXJyYXkgPSBTVk1YSV9NdWx0aURpbWVuc2lvbmFsQXJyYXkoU2VyaWFsQ291bnQsIDQpOw0KDQogICAgZm9yICh2YXIgaiA9IDA7IGogPCBQUlJNQV9SZWNlaXB0cy5sZW5ndGg7IGorKykNCiAgICAJew0KCXZhciBQcm9kSWQgPSBQUlJNQV9SZWNlaXB0c1tqXS5TVk1YQ19fUHJvZHVjdF9fYzsNCgl2YXIgUmN2UXR5ID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUlJNQV9SZWNlaXB0c1tqXS5JZCsiUmN2UXR5IikudmFsdWUpOw0KDQoJLy8gSWYgdGFyZ2V0IGxvY2F0aW9uIGlzIGNvc3RlZCBhdCB2YWx1ZSwgc2V0IHRoZSBzdG9jayBzdGF0dXMgYXMgQXZhaWxhYmxlLg0KCS8vIElmIHRhcmdldCBsb2NhdGlvbiBpcyBOT1QgY29zdGVkIGF0IHZhbHVlLCBzZXQgdGhlIHN0b2NrIHN0YXR1cyBhcyBTY3JhcC4NCglpZiAoUFJSTUFfRGVzdENvc3RlZEF0VmFsdWUpDQoJICAgIHZhciBUb1N0b2NrQXJyID0gU1ZNWElfRG9TdG9ja1VwZGF0ZShQcm9kSWQsIFBSUk1BX0Rlc3RMb2NJZCwgIkF2YWlsYWJsZSIsIFJjdlF0eSwgIlJNQSBSZWNlaXB0IiwgUFJSTUFfUk1BTnVtYmVyLCAiSW5jcmVhc2UiLCBQUlJNQV9STUFJZCwgUFJSTUFfUmVjZWlwdHNbal0uSWQsIFBSUk1BX1VzZXJJZCk7DQoJZWxzZQ0KCSAgICB2YXIgVG9TdG9ja0FyciA9IFNWTVhJX0RvU3RvY2tVcGRhdGUoUHJvZElkLCBQUlJNQV9EZXN0TG9jSWQsICJTY3JhcCIsIFJjdlF0eSwgIlJNQSBSZWNlaXB0IiwgUFJSTUFfUk1BTnVtYmVyLCAiSW5jcmVhc2UiLCBQUlJNQV9STUFJZCwgUFJSTUFfUmVjZWlwdHNbal0uSWQsIFBSUk1BX1VzZXJJZCk7DQoJaWYgKCFUb1N0b2NrQXJyWzBdKQ0KCSAgICB7CSAgIA0KCSAgICBhbGVydChTVk1YSV9HZXRNZXNzYWdlKCJNU0cwMTMiKSsiXG4iICsgVG9TdG9ja0Fycls0XSk7DQoJICAgIENsb3NlV2luZG93KCk7DQoJICAgIHJldHVybiBmYWxzZTsNCgkgICAgfQ0KCXZhciBGcm9tUHJvZFN0b2NrSWQgPSBUb1N0b2NrQXJyWzFdOw0KCXZhciBUb1Byb2RTdG9ja0lkID0gVG9TdG9ja0FyclsxXTsNCg0KCS8vIEJ1aWxkIHNlcmlhbCBudW1iZXIgYXJyYXkgZm9yIHRoZSByZWNlaXZlZCBxdWFudGl0eQ0KCWlmIChTZXJpYWxDb3VudCA+IDApDQoJICAgIHsNCgkgICAgZm9yICh2YXIgayA9IDA7IGsgPCBTZXJpYWxDb3VudDsgaysrKQ0KCQl7DQoJCWlmIChTZXJpYWxBcnJheVtrXVswXSA9PSBQcm9kSWQpDQoJCSAgICB7DQoJCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bMF0gPSBQcm9kSWQ7DQoJCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bMV0gPSBGcm9tUHJvZFN0b2NrSWQ7DQoJCSAgICBTZXJpYWxTYXZlQXJyYXlbdG90cV1bMl0gPSBUb1Byb2RTdG9ja0lkOw0KCQkgICAgU2VyaWFsU2F2ZUFycmF5W3RvdHFdWzNdID0gU2VyaWFsQXJyYXlba11bN107DQoJCSAgICB0b3RxKys7DQoJCSAgICB9DQoJCX0NCgkgICAgfQ0KCX0NCg0KICAgIC8vIFVwZGF0ZSBzZXJpYWwgbnVtYmVycyBmb3IgdGhlIHJlY2VpdmVkIHF1YW50aXR5DQogICAgaWYgKFNlcmlhbENvdW50ID4gMCkgeyB2YXIgcmV0dXJuVmFsID0gU1ZNWElfRG9TZXJpYWxTYXZlKFNlcmlhbFNhdmVBcnJheSwgUFJSTUFfVXNlcklkKTsgfQ0KDQogICAgdmFyIG5ld2NudCA9IDA7DQogICAgdmFyIGN1cmRhdGUgPSBuZXcgRGF0ZSgpOw0KICAgIHZhciBybWFsaW5lc3VwZCA9IG5ldyBBcnJheSgpOw0KICAgIHZhciBybWFsaW5lc2lucyA9IG5ldyBBcnJheSgpOw0KICAgIGZvciAodmFyIG0gPSAwOyBtIDwgUFJSTUFfUmVjZWlwdHMubGVuZ3RoOyBtKyspDQogICAgCXsNCgl2YXIgcm1hbGluZXVwZCA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1JNQV9TaGlwbWVudF9MaW5lX19jIik7DQoJdmFyIHJlYyA9IFBSUk1BX1JlY2VpcHRzW21dOw0KCXZhciBSY3ZRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiUmN2UXR5IikudmFsdWUpOw0KCXZhciBFeHBRdHkgPSBwYXJzZUZsb2F0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJlYy5JZCsiRXhwUXR5IikudmFsdWUpOw0KCXZhciBjaGVja2VkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVjLklkKyJDaGVja2JveCIpLmNoZWNrZWQ7DQoNCglybWFsaW5ldXBkLklkID0gcmVjLklkOw0KCXJtYWxpbmV1cGQuU1ZNWENfX0FjdHVhbF9RdWFudGl0eTJfX2MgPSBSY3ZRdHk7DQoJcm1hbGluZXVwZC5TVk1YQ19fQWN0dWFsX1JlY2VpcHRfRGF0ZV9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoNCglpZiAoY2hlY2tlZCAmJiBSY3ZRdHkgPT0gMCkNCgkgICAgew0KCSAgICBybWFsaW5ldXBkLlNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICJDYW5jZWxlZCI7DQoJICAgIHJtYWxpbmV1cGQuU1ZNWENfX0NhbmNlbGVkX09uX19jID0gU1ZNWElfR2V0Q3VycmVudFRpbWUoKTsNCgkgICAgcm1hbGluZXVwZC5TVk1YQ19fQ2FuY2VsZWRfQnlfX2MgPSBQUlJNQV9Vc2VySWQ7DQoJICAgIH0NCgllbHNlIGlmIChSY3ZRdHkgPiAwKQ0KCSAgICB7DQoJICAgIHJtYWxpbmV1cGQuU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gIkNvbXBsZXRlZCI7DQoJICAgIHJtYWxpbmV1cGQuU1ZNWENfX0Nsb3NlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoJICAgIHJtYWxpbmV1cGQuU1ZNWENfX0Nsb3NlZF9CeV9fYyA9IFBSUk1BX1VzZXJJZDsNCgkgICAgcm1hbGluZXVwZC5TVk1YQ19fUG9zdGVkX1RvX0ludmVudG9yeV9fYyA9ICJ0cnVlIjsNCgkgICAgfQ0KCXJtYWxpbmVzdXBkLnB1c2gocm1hbGluZXVwZCk7DQoNCgkvLyBQYXJ0IGlzIHBhcnRpYWxseSByZWNlaXZlZCBhbmQgdXNlciBkb2VzIG5vdCB3YW50IHRvIGNsb3NlIHRoZSBSTUEgbGluZSB5ZXQuIENyZWF0ZSBhIG5ldyBsaW5lIGZvciByZW1haW5pbmcgcXR5Lg0KCWlmICghY2hlY2tlZCAmJiBSY3ZRdHkgPCBFeHBRdHkpDQoJICAgIHsNCgkgICAgdmFyIHJtYWxpbmVpbnMgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19STUFfU2hpcG1lbnRfTGluZV9fYyIpOw0KCSAgICBybWFsaW5laW5zLlJlY29yZFR5cGVJZCA9IFBSUk1BX1JlY29yZFR5cGVJZDsNCgkgICAgcm1hbGluZWlucy5TVk1YQ19fUk1BX1NoaXBtZW50X09yZGVyX19jID0gUFJSTUFfUk1BSWQ7DQoJICAgIHJtYWxpbmVpbnMuU1ZNWENfX1Byb2R1Y3RfX2MgPSByZWMuU1ZNWENfX1Byb2R1Y3RfX2M7DQoJICAgIHJtYWxpbmVpbnMuU1ZNWENfX0V4cGVjdGVkX1F1YW50aXR5Ml9fYyA9IEV4cFF0eSAtIFJjdlF0eTsNCgkgICAgcm1hbGluZWlucy5TVk1YQ19fRXhwZWN0ZWRfUmVjZWlwdF9EYXRlX19jID0gcmVjLlNWTVhDX19FeHBlY3RlZF9SZWNlaXB0X0RhdGVfX2M7DQoJICAgIHJtYWxpbmVpbnMuU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gIk9wZW4iOw0KCSAgICBybWFsaW5laW5zLlNWTVhDX19Qb3N0ZWRfVG9fSW52ZW50b3J5X19jID0gImZhbHNlIjsNCgkgICAgcm1hbGluZXNpbnMucHVzaChybWFsaW5laW5zKTsNCgkgICAgbmV3Y250ICs9IDE7DQoJICAgIH0NCgl9DQoNCiAgICB0cnkgew0KCXNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShybWFsaW5lc3VwZCk7DQoJfQ0KICAgIGNhdGNoIChlKSB7CQ0KCWFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxNCIpKyJcbiIgKyBlKTsNCglDbG9zZVdpbmRvdygpOw0KCXJldHVybiBmYWxzZTsNCiAgICAJfQ0KDQogICAgaWYgKG5ld2NudCA+IDApDQogICAgCXsNCgl0cnkgew0KCSAgICBzZm9yY2UuY29ubmVjdGlvbi5jcmVhdGUocm1hbGluZXNpbnMpOw0KCSAgICB9DQoJY2F0Y2ggKGUpIHsJICAgDQoJICAgIGFsZXJ0KFNWTVhJX0dldE1lc3NhZ2UoIk1TRzAxNSIpKyJcbiIgKyBlKTsNCgkgICAgQ2xvc2VXaW5kb3coKTsNCgkgICAgcmV0dXJuIGZhbHNlOw0KCSAgICB9DQoJfQ0KICAgIGVsc2UNCiAgICAJew0KCS8vIFRvIHVwZGF0ZSBSTUEgaGVhZGVyIHN0YXR1cy4uLg0KCS8vIGNoZWNrIGlmIGFsbCBsaW5lcyBoYXZlIGJlZW4gY29tcGxldGVkIG9yIGNhbmNlbGVkIGJ5IGNvbXBhcmluZyBjb3VudHMNCgl2YXIgc29xbDIgPSAiU0VMRUNUIENvdW50KCkgRlJPTSBTVk1YQ19fUk1BX1NoaXBtZW50X0xpbmVfX2MgV0hFUkUgU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYyA9ICciICsgUFJSTUFfUk1BSWQgKyAiJyI7DQoJcXIyID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDIpOw0KDQoJdmFyIHNvcWwzID0gIlNFTEVDVCBDb3VudCgpIEZST00gU1ZNWENfX1JNQV9TaGlwbWVudF9MaW5lX19jIFdIRVJFIFNWTVhDX19STUFfU2hpcG1lbnRfT3JkZXJfX2MgPSAnIiArIFBSUk1BX1JNQUlkICsgIicgQU5EIFNWTVhDX19MaW5lX1N0YXR1c19fYyA9ICdDb21wbGV0ZWQnIjsNCglxcjMgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsMyk7DQoNCgl2YXIgc29xbDQgPSAiU0VMRUNUIENvdW50KCkgRlJPTSBTVk1YQ19fUk1BX1NoaXBtZW50X0xpbmVfX2MgV0hFUkUgU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYyA9ICciICsgUFJSTUFfUk1BSWQgKyAiJyBBTkQgU1ZNWENfX0xpbmVfU3RhdHVzX19jID0gJ0NhbmNlbGVkJyI7DQoJcXI0ID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbDQpOw0KDQoJdmFyIHJtYWhkciA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1JNQV9TaGlwbWVudF9PcmRlcl9fYyIpOw0KCXJtYWhkci5JZCA9IFBSUk1BX1JNQUlkOw0KDQoJdmFyIGhkcnVwZCA9IGZhbHNlOw0KCWlmIChxcjIuc2l6ZSA9PSBxcjMuc2l6ZSkJCS8vIEFsbCBsaW5lcyBjb21wbGV0ZWQNCgkgICAgew0KCSAgICBybWFoZHIuU1ZNWENfX09yZGVyX1N0YXR1c19fYyA9ICJDbG9zZWQiOw0KCSAgICBybWFoZHIuU1ZNWENfX0Nsb3NlZF9Pbl9fYyA9IFNWTVhJX0dldEN1cnJlbnRUaW1lKCk7DQoJICAgIHJtYWhkci5TVk1YQ19fQ2xvc2VkX0J5X19jID0gUFBSUl9Vc2VySWQ7DQoJICAgIGhkcnVwZCA9IHRydWU7DQoJICAgIH0NCgllbHNlIGlmIChxcjIuc2l6ZSA9PSBxcjQuc2l6ZSkJLy8gQWxsIGxpbmVzIENhbmNlbGVkDQoJICAgIHsNCgkgICAgcm1haGRyLlNWTVhDX19PcmRlcl9TdGF0dXNfX2MgPSAiQ2FuY2VsZWQiOw0KCSAgICBybWFoZHIuU1ZNWENfX0NhbmNlbGVkX09uX19jID0gU1ZNWElfR2V0Q3VycmVudFRpbWUoKTsNCgkgICAgcm1haGRyLlNWTVhDX19DYW5jZWxlZF9CeV9fYyA9IFBQUlJfVXNlcklkOw0KCSAgICBoZHJ1cGQgPSB0cnVlOw0KCSAgICB9DQoJaWYgKGhkcnVwZCkNCgkgICAgew0KCSAgICB0cnkgew0KCQlzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUoW3JtYWhkcl0pOw0KCQl9DQoJICAgIGNhdGNoIChlKSB7CQkNCgkJYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE2IikrIlxuIiArIGUpOw0KCQlDbG9zZVdpbmRvdygpOw0KCQlyZXR1cm4gZmFsc2U7DQoJCX0NCgkgICAgfQ0KCX0gICAgDQogICAgYWxlcnQoU1ZNWElfR2V0TWVzc2FnZSgiTVNHMDE3IikpOw0KICAgIHdpbmRvdy5vcGVuZXIubG9jYXRpb24ucmVsb2FkKHRydWUpOw0KICAgIENsb3NlV2luZG93KCk7DQp9DQoNCi8qPT09PT09PT09ICAgR0VORVJJQyBVVElMSVRJRVMgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KLyo9PT09PT09PT09PT09PT09PSBTVEFSVCBSZWxlYXNlIDIuMCBjaGFuZ2VzIGZvciB0cmFuc2xhdGlvbiA9PT09PT09PT09PT09PT09PSovDQovLyBCdWlsZCBhIGdsb2JhbCBoYXNoIHRhYmxlIG9mIG1lc3NhZ2UgbnVtYmVycyBhbmQgbWVzc2FnZXMuDQovLyBUaGlzIGFycmF5IHdpbGwgYmUgdXNlZCBmb3IgZGlzcGxheWluZyBpbmZvL3dhcm5pbmcvZXJyb3IgbWVzc2FnZXMgdG8gdGhlIHVzZXIuDQovLyBOT1RFOiBUaGUgY2FsbGluZyBtb2R1bGUgc2hvdWxkIGhhdmUgTXNnTGlzdCBkZWNsYXJlZCBhcyBhbiBhcnJheQ0KZnVuY3Rpb24gU1ZNWElfSW5pdE1lc3NhZ2VMaXN0KHN1Ym1vZHVsZWlkKQ0Kew0KICAgIHZhciBmb3VuZCA9IGZhbHNlOw0KDQogICAgdmFyIExhbmdMaXN0ID0gbmV3IEFycmF5KCk7DQoNCiAgICAJCS8vIEhhc2ggKE1hcCkgb2YgU0ZEQyBsYW5ndWFnZSBJU08gY29kZSB0byBMYW5ndWFnZSBwaWNrbGlzdCBpbiBTZXJ2aWNlTWF4IHRhZ3Mgb2JqZWN0DQogICAgTGFuZ0xpc3RbImVuX1VTIl0gPSAiRW5nbGlzaCI7DQogICAgTGFuZ0xpc3RbImRlIl0gPSAiR2VybWFuIjsNCiAgICBMYW5nTGlzdFsiZXMiXSA9ICJTcGFuaXNoIjsNCiAgICBMYW5nTGlzdFsiZnIiXSA9ICJGcmVuY2giOw0KICAgIExhbmdMaXN0WyJpdCJdID0gIkl0YWxpYW4iOw0KICAgIExhbmdMaXN0WyJqYSJdID0gIkphcGFuZXNlIjsNCiAgICBMYW5nTGlzdFsic3YiXSA9ICJTd2VkaXNoIjsNCiAgICBMYW5nTGlzdFsia28iXSA9ICJLb3JlYW4iOw0KICAgIExhbmdMaXN0WyJ6aF9UVyJdID0gIkNoaW5lc2UgKFRyYWRpdGlvbmFsKSI7DQogICAgTGFuZ0xpc3RbInpoX0NOIl0gPSAiQ2hpbmVzZSAoU2ltcGxpZmllZCkiOw0KICAgIExhbmdMaXN0WyJwdF9CUiJdID0gIlBvcnR1Z3Vlc2UgKEJyYXppbGlhbikiOw0KICAgIExhbmdMaXN0WyJubF9OTCJdID0gIkR1dGNoIjsNCiAgICBMYW5nTGlzdFsiZGEiXSA9ICJEYW5pc2giOw0KICAgIExhbmdMaXN0WyJ0aCJdID0gIlRoYWkiOw0KICAgIExhbmdMaXN0WyJmaSJdID0gIkZpbm5pc2giOw0KICAgIExhbmdMaXN0WyJydSJdID0gIlJ1c3NpYW4iOw0KDQogICAgdmFyIFVzZXJMYW5nID0gc2ZvcmNlLmNvbm5lY3Rpb24uZ2V0VXNlckluZm8oKS51c2VyTGFuZ3VhZ2U7CS8vIElTTyBjb2RlIG9mIHRoZSB1c2VyJ3MgbGFuZ3VhZ2UNCg0KICAgIGlmICghTGFuZ0xpc3RbVXNlckxhbmddKSB7IFVzZXJMYW5nID0gIkVuZ2xpc2giOyB9CQkvLyBpZiB1c2VyJ3MgbGFuZ3VhZ2UgaXMgbm90IGZvdW5kLCBkZWZhdWx0IGl0IHRvIEVuZ2xpc2gNCiAgICBlbHNlIHsgVXNlckxhbmcgPSBMYW5nTGlzdFtVc2VyTGFuZ107IH0NCg0KICAgIHZhciBsaXN0TXNncyA9IHNmb3JjZS5hcGV4LmV4ZWN1dGUoJ1NWTVhDLkNPTU1fVGFnV2ViU2VydmljZXMnLCdUYWdkYXRhZm9yU3VibW9kdWxlJyx7dGV4dDpzdWJtb2R1bGVpZH0pOyANCglpZihsaXN0TXNncy5sZW5ndGg+MCkNCgl7DQoJCWZvciAodmFyIGludE1zZ0NvdW50PTA7aW50TXNnQ291bnQ8bGlzdE1zZ3MubGVuZ3RoO2ludE1zZ0NvdW50KyspDQoJCXsNCgkJCXZhciBLZXk9bGlzdE1zZ3NbaW50TXNnQ291bnRdLktleTsNCgkJCXZhciBWYWx1ZT1saXN0TXNnc1tpbnRNc2dDb3VudF0uVmFsdWU7CQkJDQoJCQlNc2dMaXN0W0tleV09VmFsdWU7DQoJCX0NCgkJZm91bmQ9dHJ1ZTsNCgl9DQoNCiAgICBpZiAoIWZvdW5kKQ0KCXsNCglpZiAoc3VibW9kdWxlaWQgPT0gIlBSRVFTQzEiKQ0KCSAgICB7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMCddID0gJ0NhbmNlbCBQYXJ0cyBSZXF1ZXN0JzsNCgkgICAgTXNnTGlzdFsnTEFCMDAxJ10gPSAnQ2FuY2VsIFBhcnRzIFJlcXVlc3QgJzsJICAgIA0KCSAgICBNc2dMaXN0WydNU0cwMDEnXSA9ICdBbiBpbnRlcm5hbCBlcnJvciBvY2N1cnJlZCB3aGVuIHNhdmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDAyJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiByZXRyaWV2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDAzJ10gPSAnQXJlIHlvdSBzdXJlPyAnOw0KCSAgICBNc2dMaXN0WydNU0cwMDQnXSA9ICdUaGlzIFBhcnRzIFJlcXVlc3QgaGFzIGJlZW4gcHJvY2Vzc2VkIGFscmVhZHkuIENhbm5vdCBjYW5jZWwuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA1J10gPSAnVGhpcyBQYXJ0cyBSZXF1ZXN0IGhhcyBiZWVuIGNhbmNlbGVkIGFscmVhZHkuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA2J10gPSAnU29tZSBpdGVtcyBpbiB0aGlzIFBhcnRzIFJlcXVlc3QgaGF2ZSBiZWVuIHByb2Nlc3NlZCBwYXJ0aWFsbHkuJzsJICAgIA0KCSAgICBNc2dMaXN0WydNU0cwMDcnXSA9ICdQbGVhc2Ugb3BlbiB0aGUgcGVuZGluZyByZXF1ZXN0IGxpbmVzIHRvIGNhbmNlbCBpbmRpdmlkdWFsbHkuJzsNCgkgICAgTXNnTGlzdFsnTVNHOTk5J10gPSAnSW5mb3JtYXRpb24geW91IGVudGVyZWQgaGVyZSB3aWxsIG5vdCBiZSBzYXZlZC4gQXJlIHlvdSBzdXJlPyc7DQoJICAgIH0NCgllbHNlIGlmIChzdWJtb2R1bGVpZCA9PSAiUE9SRFNDMSIpDQoJICAgIHsNCgkgICAgTXNnTGlzdFsnTEFCMDAwJ10gPSAnQ2FuY2VsIFNoaXBtZW50IE9yZGVyJzsNCgkgICAgTXNnTGlzdFsnTEFCMDAxJ10gPSAnQ2FuY2VsIFNoaXBtZW50IE9yZGVyJzsJICAgIA0KCSAgICBNc2dMaXN0WydNU0cwMDEnXSA9ICdBbiBpbnRlcm5hbCBlcnJvciBvY2N1cnJlZCB3aGVuIHNhdmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDAyJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiByZXRyaWV2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDAzJ10gPSAnVGhpcyBTaGlwbWVudCBPcmRlciBoYXMgYmVlbiBjbG9zZWQgYWxyZWFkeS4gQ2Fubm90IGNhbmNlbC4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDQnXSA9ICdUaGlzIFNoaXBtZW50IE9yZGVyIGhhcyBiZWVuIGNhbmNlbGVkIGFscmVhZHkuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA1J10gPSAnU29tZSBpdGVtcyBpbiB0aGlzIHNoaXBtZW50IG9yZGVyIGhhdmUgYmVlbiBwcm9jZXNzZWQgcGFydGlhbGx5Lic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwNiddID0gJ1BsZWFzZSBvcGVuIHRoZSBwZW5kaW5nIHNoaXBtZW50IGxpbmVzIHRvIGNhbmNlbCBpbmRpdmlkdWFsbHkuJzsJICAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzk5OSddID0gJ0luZm9ybWF0aW9uIHlvdSBlbnRlcmVkIGhlcmUgd2lsbCBub3QgYmUgc2F2ZWQuIEFyZSB5b3Ugc3VyZT8nOw0KCSAgICB9CQkNCgllbHNlIGlmIChzdWJtb2R1bGVpZCA9PSAiV09SRFNDMSIpDQoJICAgIHsNCgkgICAgTXNnTGlzdFsnTEFCMDAwJ10gPSAnQ2FuY2VsIFdvcmsgT3JkZXIgUGFydCBSZXF1ZXN0cyc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMSddID0gJ0NhbmNlbCBQYXJ0cyBSZXF1ZXN0cyBpbiBXb3JrIE9yZGVyICc7CSAgICANCgkgICAgTXNnTGlzdFsnTVNHMDAxJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiBzYXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwMiddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gcmV0cmlldmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwMyddID0gJ1RoaXMgV29yayBPcmRlciBoYXMgYmVlbiBjbG9zZWQgYWxyZWFkeS4gQ2Fubm90IGNhbmNlbCBwYXJ0cyByZXF1ZXN0cy4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDQnXSA9ICdUaGlzIFdvcmsgT3JkZXIgaGFzIGJlZW4gY2FuY2VsZWQgYWxyZWFkeS4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDUnXSA9ICdSZWNvcmQgVHlwZSBkZWZpbml0aW9uIGlzIG1pc3NpbmcuIFRoaXMgaXMgYW4gaW50ZXJuYWwgZXJyb3IuIFBsZWFzZSByZXBvcnQgdGhpcyBlcnJvciB0byBTZXJ2aWNlTWF4IHN1cHBvcnQuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA2J10gPSAnVGhpcyBwYXJ0IHJlcXVlc3QgaGFzIGJlZW4gcHJvY2Vzc2VkIHBhcnRpYWxseS4nOwkgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNyddID0gJ0Nhbm5vdCBjYW5jZWwuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA4J10gPSAnU29tZSBwYXJ0cyByZXF1ZXN0cyBpbiB0aGlzIFdvcmsgT3JkZXIgaGF2ZSBiZWVuIHByb2Nlc3NlZCBwYXJ0aWFsbHkuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA5J10gPSAnUGxlYXNlIG9wZW4gdGhlIHBlbmRpbmcgcmVxdWVzdCBsaW5lcyB0byBjYW5jZWwgaW5kaXZpZHVhbGx5Lic7DQoJICAgIE1zZ0xpc3RbJ01TRzAxMCddID0gJ0FsbCBQYXJ0cyByZXF1ZXN0cyBjYW5jZWxlZCBzdWNjZXNzZnVsbHkhJzsNCgkgICAgTXNnTGlzdFsnTVNHOTk5J10gPSAnSW5mb3JtYXRpb24geW91IGVudGVyZWQgaGVyZSB3aWxsIG5vdCBiZSBzYXZlZC4gQXJlIHlvdSBzdXJlPyc7DQoJICAgIH0NCgllbHNlIGlmIChzdWJtb2R1bGVpZCA9PSAiUFJFUVNDMiIpDQoJICAgIHsNCgkgICAgTXNnTGlzdFsnTEFCMDAwJ10gPSAnTmV3IFNoaXBtZW50IGZyb20gUGFydHMgUmVxdWVzdCc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMSddID0gJ0NyZWF0ZSBTaGlwbWVudCBPcmRlciBmb3IgUGFydHMgUmVxdWVzdCc7ICAgIA0KCSAgICBNc2dMaXN0WydMQUIwMDInXSA9ICdFbnRlciBRdWFudGl0eSBUbyBCZSBTaGlwcGVkJzsgICAgDQoJICAgIE1zZ0xpc3RbJ0xBQjAwMyddID0gJ1N1Ym1pdCc7ICAgIA0KCSAgICBNc2dMaXN0WydMQUIwMDQnXSA9ICdDYW5jZWwnOyAgDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNSddID0gJ1Byb2R1Y3QgTmFtZSc7ICAgIA0KCSAgICBNc2dMaXN0WydMQUIwMDYnXSA9ICdRdWFudGl0eSBSZW1haW5pbmcnOyAgDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNyddID0gJ1F1YW50aXR5IFRvIEJlIFNoaXBwZWQnOyAgICANCgkgICAgTXNnTGlzdFsnTVNHMDAxJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiBzYXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwMiddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gcmV0cmlldmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwMyddID0gJ1RoaXMgUGFydHMgUmVxdWVzdCBpcyBjb21wbGV0ZWQgYWxyZWFkeS4nOyAgICANCgkgICAgTXNnTGlzdFsnTVNHMDA0J10gPSAnVGhpcyBQYXJ0cyBSZXF1ZXN0IGhhcyBiZWVuIGNhbmNlbGVkLiBDYW5ub3QgY3JlYXRlIHNoaXBtZW50IG9yZGVyLic7ICAgIA0KCSAgICBNc2dMaXN0WydNU0cwMDUnXSA9ICdUaGVyZSBhcmUgbm8gcGVuZGluZyBwYXJ0cyByZXF1ZXN0IGxpbmVzIHRvIHByb2Nlc3MuJzsgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNiddID0gJ1RoaXMgaXMgbm90IGEgdmFsaWQgdmFsdWUgZm9yIHF1YW50aXR5IHRvIGJlIHNoaXBwZWQuJzsgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNyddID0gJ1F1YW50aXR5IHRvIGJlIHNoaXBwZWQgY2Fubm90IGV4Y2VlZCByZW1haW5pbmcgcXVhbnRpdHkuJzsgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwOCddID0gJ1lvdSBoYXZlIG5vdCBlbnRlcmVkIGVub3VnaCBpbmZvcm1hdGlvbiB0byBjcmVhdGUgYSBzaGlwbWVudCBvcmRlci4nOyAgICANCgkgICAgTXNnTGlzdFsnTVNHMDA5J10gPSAnU2hpcG1lbnQgT3JkZXIgY3JlYXRlZCBzdWNjZXNzZnVsbHkhJzsgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAxMCddID0gJ1JlY29yZCBUeXBlIGRlZmluaXRpb24gaXMgbWlzc2luZy4gVGhpcyBpcyBhbiBpbnRlcm5hbCBlcnJvci4gUGxlYXNlIHJlcG9ydCB0aGlzIGVycm9yIHRvIFNlcnZpY2VNYXggc3VwcG9ydC4nOyAgICANCgkgICAgTXNnTGlzdFsnTVNHMDExJ10gPSAnQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiBjcmVhdGluZyBTaGlwbWVudCBIZWFkZXIuIFBsZWFzZSByZXBvcnQgdGhpcyBlcnJvciB0byBTZXJ2aWNlTWF4IHN1cHBvcnQuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDEyJ10gPSAnQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiBjcmVhdGluZyBTaGlwbWVudCBsaW5lcy4gUGxlYXNlIHJlcG9ydCB0aGlzIGVycm9yIHRvIFNlcnZpY2VNYXggc3VwcG9ydC4nOw0KCSAgICBNc2dMaXN0WydNU0c5OTknXSA9ICdJbmZvcm1hdGlvbiB5b3UgZW50ZXJlZCBoZXJlIHdpbGwgbm90IGJlIHNhdmVkLiBBcmUgeW91IHN1cmU/JzsNCgkgICAgfQkJDQoJZWxzZSBpZiAoc3VibW9kdWxlaWQgPT0gIldPUkRTQzUiKQ0KCSAgICB7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMCddID0gJ05ldyBTaGlwbWVudCBmcm9tIFdvcmsgT3JkZXInOw0KCSAgICBNc2dMaXN0WydMQUIwMDEnXSA9ICdDcmVhdGUgU2hpcG1lbnQgT3JkZXIgZm9yIFdvcmsgT3JkZXInOyANCgkgICAgTXNnTGlzdFsnTEFCMDAyJ10gPSAnRW50ZXIgUXVhbnRpdHkgVG8gQmUgU2hpcHBlZCBmcm9tOic7IA0KCSAgICBNc2dMaXN0WydMQUIwMDMnXSA9ICdTdWJtaXQnOyANCgkgICAgTXNnTGlzdFsnTEFCMDA0J10gPSAnQ2FuY2VsJzsgDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNSddID0gJ1Byb2R1Y3QgTmFtZSc7ICAgIA0KCSAgICBNc2dMaXN0WydMQUIwMDYnXSA9ICdRdWFudGl0eSBSZW1haW5pbmcnOyANCgkgICAgTXNnTGlzdFsnTEFCMDA3J10gPSAnUXVhbnRpdHkgVG8gQmUgU2hpcHBlZCc7ICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwMSddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gc2F2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDInXSA9ICdBbiBpbnRlcm5hbCBlcnJvciBvY2N1cnJlZCB3aGVuIHJldHJpZXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMDMnXSA9ICdUaGlzIFdvcmsgT3JkZXIgaXMgY2xvc2VkIGFscmVhZHkuIENhbm5vdCBjcmVhdGUgc2hpcG1lbnQgb3JkZXIuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNCddID0gJ1RoaXMgV29yayBPcmRlciBoYXMgYmVlbiBjYW5jZWxlZC4gQ2Fubm90IGNyZWF0ZSBzaGlwbWVudCBvcmRlci4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDA1J10gPSAnVGhlcmUgYXJlIG5vIHBlbmRpbmcgcGFydCByZXF1ZXN0IGxpbmVzIHRvIHByb2Nlc3MuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNiddID0gJ1JlcXVlc3RlZCBGcm9tIGxvY2F0aW9uIGhhcyBub3QgYmVlbiBmaWxsZWQgZm9yIGFueSBvcGVuIHJlcXVlc3RzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMDcnXSA9ICdSZXF1aXJlZCBBdCBsb2NhdGlvbiBoYXMgbm90IGJlZW4gZmlsbGVkIGZvciBhbnkgb3BlbiByZXF1ZXN0cy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDA4J10gPSAnVGhlcmUgYXJlIG5vIHBlbmRpbmcgcGFydHMgcmVxdWVzdCBsaW5lcyBmb3IgdGhpcyBsb2NhdGlvbi4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDEwJ10gPSAnUmVjb3JkIFR5cGUgZGVmaW5pdGlvbiBpcyBtaXNzaW5nLiBUaGlzIGlzIGFuIGludGVybmFsIGVycm9yLiBQbGVhc2UgcmVwb3J0IHRoaXMgZXJyb3IgdG8gU2VydmljZU1heCBzdXBwb3J0Lic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTEnXSA9ICdQbGVhc2Ugc2VsZWN0IGEgdmFsaWQgbG9jYXRpb24gZmlyc3QuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxMiddID0gJ1RoaXMgaXMgbm90IGEgdmFsaWQgdmFsdWUgZm9yIHF1YW50aXR5IHRvIGJlIHNoaXBwZWQuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxMyddID0gJ1F1YW50aXR5IHRvIGJlIHNoaXBwZWQgY2Fubm90IGV4Y2VlZCByZW1haW5pbmcgcXVhbnRpdHkuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxNCddID0gJ1lvdSBoYXZlIG5vdCBlbnRlcmVkIGVub3VnaCBpbmZvcm1hdGlvbiB0byBjcmVhdGUgYSBzaGlwbWVudCBvcmRlci4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDE1J10gPSAnU2hpcG1lbnQgT3JkZXIgY3JlYXRlZCBzdWNjZXNzZnVsbHkhJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxNiddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gY3JlYXRpbmcgU2hpcG1lbnQgSGVhZGVyLiBQbGVhc2UgcmVwb3J0IHRoaXMgZXJyb3IgdG8gU2VydmljZU1heCBzdXBwb3J0Lic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTcnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIGNyZWF0aW5nIFNoaXBtZW50IGxpbmVzLiBQbGVhc2UgcmVwb3J0IHRoaXMgZXJyb3IgdG8gU2VydmljZU1heCBzdXBwb3J0Lic7IA0KCSAgICBNc2dMaXN0WydNU0c5OTknXSA9ICdJbmZvcm1hdGlvbiB5b3UgZW50ZXJlZCBoZXJlIHdpbGwgbm90IGJlIHNhdmVkLiBBcmUgeW91IHN1cmU/JzsNCgkgICAgfQ0KCWVsc2UgaWYgKHN1Ym1vZHVsZWlkID09ICJTQURKU0MxIikNCgkgICAgew0KCSAgICBNc2dMaXN0WydMQUIwMDAnXSA9ICdQb3N0IFN0b2NrIEFkanVzdG1lbnQgVG8gSW52ZW50b3J5JzsNCgkgICAgTXNnTGlzdFsnTEFCMDAxJ10gPSAnUG9zdCBTdG9jayBBZGp1c3RtZW50JzsgDQoJICAgIE1zZ0xpc3RbJ0xBQjAwMiddICAgPSAnIHRvIGludmVudG9yeSc7IA0KCSAgICBNc2dMaXN0WydNU0cwMDEnXSA9ICdBbiBpbnRlcm5hbCBlcnJvciBvY2N1cnJlZCB3aGVuIHNhdmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDAyJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiByZXRyaWV2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDAzJ10gPSAnU2VydmljZU1heCBJbnZlbnRvcnkgbW9kdWxlIGlzIG5vdCBlbmFibGVkIGZvciB5b3VyIG9yZ2FuaXphdGlvbi4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDA0J10gPSAnVGhpcyBzdG9jayBhZGp1c3RtZW50IGhhcyBiZWVuIHBvc3RlZCB0byBpbnZlbnRvcnkgYWxyZWFkeS4nOyAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNSddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gdXBkYXRpbmcgc3RvY2suJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNiddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gZGVsZXRpbmcgc2VyaWFsIG51bWJlcnMuIFBsZWFzZSByZXBvcnQgdGhpcyBlcnJvciB0byBTZXJ2aWNlTWF4IHN1cHBvcnQuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNyddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gdXBkYXRpbmcgU3RvY2sgQWRqdXN0bWVudC4gUGxlYXNlIHJlcG9ydCB0aGlzIGVycm9yIHRvIFNlcnZpY2VNYXggc3VwcG9ydC4nOyANCgkgICAgfQ0KCWVsc2UgaWYgKHN1Ym1vZHVsZWlkID09ICJTWEZSU0MxIikNCgkgICAgew0KCSAgICBNc2dMaXN0WydMQUIwMDAnXSA9ICdQb3N0IFN0b2NrIFRyYW5zZmVyIFRvIEludmVudG9yeSc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMSddID0gJ1Bvc3QgU3RvY2sgVHJhbnNmZXInOyAgICANCgkgICAgTXNnTGlzdFsnTEFCMDAyJ10gPSAnIHRvIGludmVudG9yeSc7ICAgICAgCQkNCgkgICAgTXNnTGlzdFsnTVNHMDAxJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiBzYXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwMiddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gcmV0cmlldmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwMyddID0gJ1NlcnZpY2VNYXggSW52ZW50b3J5IG1vZHVsZSBpcyBub3QgZW5hYmxlZCBmb3IgeW91ciBvcmdhbml6YXRpb24uJzsgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNCddID0gJ0FuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQgd2hlbiByZXRyaWV2aW5nIHN0b2NrIHRyYW5zZmVyIHJlY29yZC4nOyAgICANCgkgICAgTXNnTGlzdFsnTVNHMDA1J10gPSAnOiBUcmFuc2ZlciBxdWFudGl0eSBleGNlZWRzIGF2YWlsYWJsZSBxdWFudGl0eS4nOyAgICANCgkgICAgTXNnTGlzdFsnTVNHMDA2J10gPSAnVGhpcyBzdG9jayB0cmFuc2ZlciBoYXMgYmVlbiBwb3N0ZWQgdG8gaW52ZW50b3J5IGFscmVhZHkuJzsgICAgCQ0KCSAgICBNc2dMaXN0WydNU0cwMDcnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIHVwZGF0aW5nIHN0b2NrLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMDgnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIHVwZGF0aW5nIFN0b2NrIFRyYW5zZmVyIGxpbmVzLic7IA0KCSAgICBNc2dMaXN0WydNU0c5OTknXSA9ICdJbmZvcm1hdGlvbiB5b3UgZW50ZXJlZCBoZXJlIHdpbGwgbm90IGJlIHNhdmVkLiBBcmUgeW91IHN1cmU/JzsNCgkgICAgfQkJDQoJZWxzZSBpZiAoc3VibW9kdWxlaWQgPT0gIldPUkRTQzciKQ0KCSAgICB7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMCddID0gJ1Bvc3QgVXNhZ2UgVG8gSW52ZW50b3J5JzsNCgkgICAgTXNnTGlzdFsnTEFCMDAxJ10gPSAnUG9zdCB1c2FnZS9jb25zdW1wdGlvbiBmb3IgV29yayBPcmRlcic7ICAgIA0KCSAgICBNc2dMaXN0WydMQUIwMDInXSA9ICcgdG8gaW52ZW50b3J5JzsgICAgICAJCQ0KCSAgICBNc2dMaXN0WydNU0cwMDEnXSA9ICdBbiBpbnRlcm5hbCBlcnJvciBvY2N1cnJlZCB3aGVuIHNhdmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDAyJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiByZXRyaWV2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDAzJ10gPSAnU2VydmljZU1heCBJbnZlbnRvcnkgbW9kdWxlIGlzIG5vdCBlbmFibGVkIGZvciB5b3VyIG9yZ2FuaXphdGlvbi4nOyAgICANCgkgICAgTXNnTGlzdFsnTVNHMDA0J10gPSAnVGhlcmUgYXJlIG5vIHVzYWdlL2NvbnN1bXB0aW9uIGxpbmVzIGluIHRoaXMgV29yayBPcmRlci4nOyAgICAgDQoJICAgIE1zZ0xpc3RbJ01TRzAwNSddID0gJ1JlY29yZCBUeXBlIGRlZmluaXRpb24gaXMgbWlzc2luZy4gVGhpcyBpcyBhbiBpbnRlcm5hbCBlcnJvci4gUGxlYXNlIHJlcG9ydCB0aGlzIGVycm9yIHRvIFNlcnZpY2VNYXggc3VwcG9ydC4nOyAgICANCgkgICAgTXNnTGlzdFsnTVNHMDA2J10gPSAnVXNhZ2UvQ29uc3VtcHRpb24gbGluZXMgc2hvdWxkIGhhdmUgYSBsaW5lIHR5cGUgIlBhcnRzIiBhbmQgbm90IHBvc3RlZCB0byBpbnZlbnRvcnkgYWxyZWFkeS4nOyAgICANCgkgICAgTXNnTGlzdFsnTVNHMDA3J10gPSAnQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiB1cGRhdGluZyBzdG9jay4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDA4J10gPSAnQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiB1cGRhdGluZyBXb3JrIE9yZGVyIGxpbmVzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMDknXSA9ICdDb25zdW1lZCBGcm9tIExvY2F0aW9uIG11c3QgYmUgZW50ZXJlZCBmb3IgYWxsIHVzYWdlL2NvbnN1bXB0aW9uIHBhcnRzIHJlY29yZHMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzk5OSddID0gJ0luZm9ybWF0aW9uIHlvdSBlbnRlcmVkIGhlcmUgd2lsbCBub3QgYmUgc2F2ZWQuIEFyZSB5b3Ugc3VyZT8nOw0KCSAgICB9CQ0KCWVsc2UgaWYgKHN1Ym1vZHVsZWlkID09ICJXT1JEU0M5IikNCgkgICAgew0KCSAgICBNc2dMaXN0WydMQUIwMDAnXSA9ICdQcm9jZXNzIFJlY2VpcHRzIGZvciBXb3JrIE9yZGVyJzsNCgkgICAgTXNnTGlzdFsnTEFCMDAxJ10gPSAnUHJvY2VzcyBSZWNlaXB0cyBmb3IgV29yayBPcmRlcic7ICAgIA0KCSAgICBNc2dMaXN0WydMQUIwMDInXSA9ICdFbnRlciBSZWNlaXZlZCBRdWFudGl0eSBhbmQvb3IgQ2xvc2UgUmVxdWVzdHMnOyAgICAgICAgICAJCQ0KCSAgICBNc2dMaXN0WydMQUIwMDMnXSA9ICdTdWJtaXQnOyAJDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNCddID0gJ0NhbmNlbCc7ICAgCQkNCgkgICAgTXNnTGlzdFsnTEFCMDA1J10gPSAnUHJvZHVjdCBOYW1lJzsgDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNiddID0gJ1F1YW50aXR5IFJlcXVlc3RlZCc7ICAgIAkJDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNyddID0gJ1F1YW50aXR5IFJlY2VpdmVkJzsgDQoJICAgIE1zZ0xpc3RbJ0xBQjAwOCddID0gJ0Nsb3NlIFJlcXVlc3QnOyAgICANCgkgICAgTXNnTGlzdFsnTVNHMDAxJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiBzYXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwMiddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gcmV0cmlldmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwMyddID0gJ1RoaXMgaXMgbm90IGEgdmFsaWQgdmFsdWUgZm9yIHJlY2VpdmVkIHF1YW50aXR5Lic7IAkNCgkgICAgTXNnTGlzdFsnTVNHMDA0J10gPSAnUmVjZWl2ZWQgcXVhbnRpdHkgY2Fubm90IGV4Y2VlZCByZXF1ZXN0ZWQgcXVhbnRpdHkuJzsgICAgCQkNCgkgICAgTXNnTGlzdFsnTVNHMDA1J10gPSAnVGhpcyBpdGVtIGhhcyBiZWVuIHNoaXBwZWQgYWxyZWFkeS4gQ2Fubm90IHNob3J0LWNsb3NlLic7ICAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwNiddID0gJ1NoaXBtZW50IGhhcyBiZWVuIGluaXRpYXRlZCBmb3IgdGhpcyByZXF1ZXN0ISBDYW5ub3Qgc2hvcnQtY2xvc2UuJzsgICAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwNyddID0gJ1lvdSBoYXZlIG5vdCBlbnRlcmVkIGVub3VnaCBpbmZvcm1hdGlvbiB0byBwcm9jZXNzIHJlY2VpcHRzLic7IAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwOCddID0gJ1RoaXMgV29yayBPcmRlciBpcyBjbG9zZWQgYWxyZWFkeS4gQ2Fubm90IHByb2Nlc3MgcmVjZWlwdHMuJzsgCQkNCgkgICAgTXNnTGlzdFsnTVNHMDA5J10gPSAnVGhpcyBXb3JrIE9yZGVyIGhhcyBiZWVuIGNhbmNlbGVkLiBDYW5ub3QgcHJvY2VzcyByZWNlaXB0cy4nOyAJCQ0KCSAgICBNc2dMaXN0WydNU0cwMTAnXSA9ICdSZWNvcmQgVHlwZSBkZWZpbml0aW9uIGlzIG1pc3NpbmcuIFRoaXMgaXMgYW4gaW50ZXJuYWwgZXJyb3IuIFBsZWFzZSByZXBvcnQgdGhpcyBlcnJvciB0byBTZXJ2aWNlTWF4IHN1cHBvcnQuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxMSddID0gJ1RoaXMgcGFydHMgcmVxdWVzdCBsaW5lIGlzIG5vdCBvcGVuLiBDYW5ub3QgcHJvY2VlZCB0byBwcm9jZXNzIHJlY2VpcHRzJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxMiddID0gJ1RoZXJlIGFyZSBubyBvcGVuIHBhcnRzIHJlcXVlc3QgbGluZXMgdG8gcHJvY2Vzcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDEzJ10gPSAnUGFydHMgcmVxdWVzdHMgaW4gdGhpcyBXb3JrIG9yZGVyIHdpdGhvdXQgYSBGcm9tIG9yIFRvIGxvY2F0aW9uIGFyZSBub3QgbGlzdGVkIGhlcmUuIFRvIGNvcnJlY3QgdGhpcywgcGxlYXNlIGVudGVyIHRoZSBsb2NhdGlvbnMgYmVmb3JlIHByb2Nlc3NpbmcgcmVjZWlwdHMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxNCddID0gJ0Zyb20gYW5kIFRvIGxvY2F0aW9ucyBhcmUgbm90IGVudGVyZWQgZm9yIGFueSBvcGVuIHBhcnRzIHJlcXVlc3RzLiBUbyBjb3JyZWN0IHRoaXMsIHBsZWFzZSBlbnRlciB0aGUgbG9jYXRpb25zIGJlZm9yZSBwcm9jZXNzaW5nIHJlY2VpcHRzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTUnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIHVwZGF0aW5nIHN0b2NrLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTYnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIHVwZGF0aW5nIFdvcmsgT3JkZXIgbGluZXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxNyddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gY3JlYXRpbmcgV29yayBPcmRlciBsaW5lcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDE4J10gPSAnUmVjZWlwdHMgcHJvY2Vzc2luZyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5ISc7IA0KCSAgICBNc2dMaXN0WydNU0c5OTknXSA9ICdJbmZvcm1hdGlvbiB5b3UgZW50ZXJlZCBoZXJlIHdpbGwgbm90IGJlIHNhdmVkLiBBcmUgeW91IHN1cmU/JzsNCgkgICAgfQkJDQoJZWxzZSBpZiAoc3VibW9kdWxlaWQgPT0gIlBSRVFTQzMiKQ0KCSAgICB7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMCddID0gJ1Byb2Nlc3MgUmVjZWlwdHMgZm9yIFBhcnRzIFJlcXVlc3QnOw0KCSAgICBNc2dMaXN0WydMQUIwMDEnXSA9ICdQcm9jZXNzIFJlY2VpcHRzIGZvciBQYXJ0cyBSZXF1ZXN0JzsNCgkgICAgTXNnTGlzdFsnTEFCMDAyJ10gPSAnRW50ZXIgUmVjZWl2ZWQgUXVhbnRpdHkgYW5kL29yIENsb3NlIFJlcXVlc3RzJzsNCgkgICAgTXNnTGlzdFsnTEFCMDAzJ10gPSAnU3VibWl0JzsNCgkgICAgTXNnTGlzdFsnTEFCMDA0J10gPSAnQ2FuY2VsJzsNCgkgICAgTXNnTGlzdFsnTEFCMDA1J10gPSAnUHJvZHVjdCBOYW1lJzsNCgkgICAgTXNnTGlzdFsnTEFCMDA2J10gPSAnUXVhbnRpdHkgUmVxdWVzdGVkJzsNCgkgICAgTXNnTGlzdFsnTEFCMDA3J10gPSAnUXVhbnRpdHkgUmVjZWl2ZWQnOw0KCSAgICBNc2dMaXN0WydMQUIwMDgnXSA9ICdDbG9zZSBSZXF1ZXN0JzsNCgkgICAgTXNnTGlzdFsnTVNHMDAxJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiBzYXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwMiddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gcmV0cmlldmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDAzJ10gPSAnVGhpcyBQYXJ0cyBSZXF1ZXN0IGlzIGNvbXBsZXRlZCBhbHJlYWR5Lic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwNCddID0gJ1RoaXMgUGFydHMgUmVxdWVzdCBoYXMgYmVlbiBjYW5jZWxlZC4gQ2Fubm90IHByb2Nlc3MgcmVjZWlwdHMuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA1J10gPSAnRGVmYXVsdCBTdXBwbGllciBMb2NhdGlvbiBpcyBub3Qgc2V0dXAuIFRoaXMgaXMgYSBzZXR1cCBpc3N1ZS5cblBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDYnXSA9ICdUaGVyZSBhcmUgbm8gb3BlbiBwYXJ0cyByZXF1ZXN0IGxpbmVzIHRvIHByb2Nlc3MuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA3J10gPSAnVGhpcyBpcyBub3QgYSB2YWxpZCB2YWx1ZSBmb3IgcmVjZWl2ZWQgcXVhbnRpdHkuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA4J10gPSAnUmVjZWl2ZWQgcXVhbnRpdHkgY2Fubm90IGV4Y2VlZCByZXF1ZXN0ZWQgcXVhbnRpdHkuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA5J10gPSAnVGhpcyBpdGVtIGhhcyBiZWVuIHNoaXBwZWQgYWxyZWFkeS4gQ2Fubm90IHNob3J0LWNsb3NlLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAxMCddID0gJ1NoaXBtZW50IGhhcyBiZWVuIGluaXRpYXRlZCBmb3IgdGhpcyByZXF1ZXN0ISBDYW5ub3Qgc2hvcnQtY2xvc2UuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDExJ10gPSAnWW91IGhhdmUgbm90IGVudGVyZWQgZW5vdWdoIGluZm9ybWF0aW9uIHRvIHByb2Nlc3MgcmVjZWlwdHMuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDEyJ10gPSAnUmVjZWlwdHMgcHJvY2Vzc2luZyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5ISc7DQoJICAgIE1zZ0xpc3RbJ01TRzAxMyddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gdXBkYXRpbmcgc3RvY2suJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzk5OSddID0gJ0luZm9ybWF0aW9uIHlvdSBlbnRlcmVkIGhlcmUgd2lsbCBub3QgYmUgc2F2ZWQuIEFyZSB5b3Ugc3VyZT8nOw0KCSAgICB9DQoJZWxzZSBpZiAoc3VibW9kdWxlaWQgPT0gIlBPUkRTQzYiKQ0KCSAgICB7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMCddID0gJ1Byb2Nlc3MgUmVjZWlwdHMgZm9yIFJNQSc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwMSddID0gJ1Byb2Nlc3MgUmVjZWlwdHMgZm9yIFJNQSAnOyAgICANCgkgICAgTXNnTGlzdFsnTEFCMDAyJ10gPSAnRW50ZXIgUmVjZWl2ZWQgUXVhbnRpdHkgYW5kL29yIENsb3NlIExpbmVzJzsgICAgICAJCQ0KCSAgICBNc2dMaXN0WydMQUIwMDMnXSA9ICdTdWJtaXQnOyAgICAgIAkJDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNCddID0gJ0NhbmNlbCc7ICAgICAgCQkNCgkgICAgTXNnTGlzdFsnTEFCMDA1J10gPSAnUHJvZHVjdCBOYW1lJzsgICAgDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNiddID0gJ1F1YW50aXR5IEV4cGVjdGVkJzsgICAgICAJCQ0KCSAgICBNc2dMaXN0WydMQUIwMDcnXSA9ICdRdWFudGl0eSBSZWNlaXZlZCc7ICAgICAgCQkNCgkgICAgTXNnTGlzdFsnTEFCMDA4J10gPSAnQ2xvc2UgTGluZSc7ICAgICAgCQkNCgkgICAgTXNnTGlzdFsnTVNHMDAxJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiBzYXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwMiddID0gJ0FuIGludGVybmFsIGVycm9yIG9jY3VycmVkIHdoZW4gcmV0cmlldmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAwMyddID0gJ1RoaXMgUk1BIGlzIGNsb3NlZCBhbHJlYWR5LiBDYW5ub3QgcHJvY2VzcyByZWNlaXB0cy4nOyAgICAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwNCddID0gJ1RoaXMgUk1BIGhhcyBiZWVuIGNhbmNlbGVkLiBDYW5ub3QgcHJvY2VzcyByZWNlaXB0cy4nOyAgICAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwNSddID0gJ0Rlc3RpbmF0aW9uIGxvY2F0aW9uIGNhbm5vdCBiZSBibGFuay4nOyAgICAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwNiddID0gJ1RoZSBkZXN0aW5hdGlvbiBsb2NhdGlvbiBpcyBub3QgYSBzdG9ja2luZyBsb2NhdGlvbi4nOyAgICAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwNyddID0gJ1RoaXMgUk1BIGxpbmUgaXMgbm90IG9wZW4uIENhbm5vdCBwcm9jZXNzIHJlY2VpcHRzLic7ICAgICAgCQkNCgkgICAgTXNnTGlzdFsnTVNHMDA4J10gPSAnVGhlcmUgYXJlIG5vIG9wZW4gUk1BIGxpbmVzIHRvIHByb2Nlc3MuJzsgICAgICAJCQ0KCSAgICBNc2dMaXN0WydNU0cwMDknXSA9ICdZb3UgaGF2ZSBub3QgZW50ZXJlZCBlbm91Z2ggaW5mb3JtYXRpb24gdG8gcHJvY2VzcyByZWNlaXB0cy4nOyAgICAgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAxMCddID0gJ1JlY29yZCBUeXBlIGRlZmluaXRpb24gaXMgbWlzc2luZy4gVGhpcyBpcyBhbiBpbnRlcm5hbCBlcnJvci4gUGxlYXNlIHJlcG9ydCB0aGlzIGVycm9yIHRvIFNlcnZpY2VNYXggc3VwcG9ydC4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDExJ10gPSAnVGhpcyBpcyBub3QgYSB2YWxpZCB2YWx1ZSBmb3IgcmVjZWl2ZWQgcXVhbnRpdHkuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxMiddID0gJ1JlY2VpdmVkIHF1YW50aXR5IGNhbm5vdCBleGNlZWQgZXhwZWN0ZWQgcXVhbnRpdHkuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxMyddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gdXBkYXRpbmcgc3RvY2suJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxNCddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gdXBkYXRpbmcgUk1BIGxpbmVzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTUnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIGNyZWF0aW5nIFJNQSBsaW5lcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDE2J10gPSAnQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiB1cGRhdGluZyBSTUEgSGVhZGVyLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTcnXSA9ICdSZWNlaXB0cyBwcm9jZXNzaW5nIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkhJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzk5OSddID0gJ0luZm9ybWF0aW9uIHlvdSBlbnRlcmVkIGhlcmUgd2lsbCBub3QgYmUgc2F2ZWQuIEFyZSB5b3Ugc3VyZT8nOw0KCSAgICB9CQkNCgllbHNlIGlmIChzdWJtb2R1bGVpZCA9PSAiUE9SRFNDOCIpDQoJICAgIHsNCgkgICAgTXNnTGlzdFsnTEFCMDAwJ10gPSAnUHJvY2VzcyBTaGlwbWVudHMnOw0KCSAgICBNc2dMaXN0WydMQUIwMDEnXSA9ICdQcm9jZXNzIFNoaXBtZW50cyBmb3IgU2hpcG1lbnQgT3JkZXInOyAgICANCgkgICAgTXNnTGlzdFsnTEFCMDAyJ10gPSAnRW50ZXIgU2hpcHBlZCBRdWFudGl0eSBhbmQvb3IgQ2xvc2UgUmVxdWVzdHMgJzsgICAgICAJCQ0KCSAgICBNc2dMaXN0WydMQUIwMDMnXSA9ICdTdWJtaXQnOyAJDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNCddID0gJ0NhbmNlbCc7ICAgCQkNCgkgICAgTXNnTGlzdFsnTEFCMDA1J10gPSAnUHJvZHVjdCBOYW1lJzsgDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNiddID0gJ1F1YW50aXR5IFJlcXVlc3RlZCc7ICAgIAkJDQoJICAgIE1zZ0xpc3RbJ0xBQjAwNyddID0gJ1F1YW50aXR5IFNoaXBwZWQnOyAJDQoJICAgIE1zZ0xpc3RbJ0xBQjAwOCddID0gJ0Nsb3NlIFJlcXVlc3QnOyAJCQ0KCSAgICBNc2dMaXN0WydNU0cwMDEnXSA9ICdBbiBpbnRlcm5hbCBlcnJvciBvY2N1cnJlZCB3aGVuIHNhdmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDAyJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiByZXRyaWV2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDAzJ10gPSAnVGhpcyBTaGlwbWVudCBPcmRlciBpcyBjbG9zZWQgYWxyZWFkeS4nOyAgICAgCQkNCgkgICAgTXNnTGlzdFsnTVNHMDA0J10gPSAnVGhpcyBTaGlwbWVudCBPcmRlciBoYXMgYmVlbiBjYW5jZWxlZC4gQ2Fubm90IHByb2Nlc3Mgc2hpcG1lbnRzLic7ICAgICAgCQkNCgkgICAgTXNnTGlzdFsnTVNHMDA1J10gPSAnVGhlIHNvdXJjZSBsb2NhdGlvbiBpcyBibGFuayBmb3IgdGhpcyBzaGlwbWVudCBvcmRlci4gQ2Fubm90IHByb2Nlc3Mgc2hpcG1lbnRzLic7ICAgCQkNCgkgICAgTXNnTGlzdFsnTVNHMDA2J10gPSAnVGhlIGRlc3RpbmF0aW9uIGxvY2F0aW9uIGlzIGJsYW5rIGZvciB0aGlzIHNoaXBtZW50IG9yZGVyLiBDYW5ub3QgcHJvY2VzcyBzaGlwbWVudHMuJzsgICAgCQkNCgkgICAgTXNnTGlzdFsnTVNHMDA3J10gPSAnRGVmYXVsdCBDdXN0b21lciBMb2NhdGlvbiBpcyBub3Qgc2V0dXAuICc7ICAgICAJCQ0KCSAgICBNc2dMaXN0WydNU0cwMDgnXSA9ICdUaGVyZSBhcmUgbm8gb3BlbiBzaGlwbWVudCBsaW5lcyB0byBwcm9jZXNzLic7IAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAwOSddID0gJ1RoaXMgaXMgbm90IGEgdmFsaWQgdmFsdWUgZm9yIHNoaXBwZWQgcXVhbnRpdHkuJzsgIAkJDQoJICAgIE1zZ0xpc3RbJ01TRzAxMCddID0gJ1NoaXBwZWQgcXVhbnRpdHkgY2Fubm90IGV4Y2VlZCByZXF1ZXN0ZWQgcXVhbnRpdHkuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxMSddID0gJ1lvdSBoYXZlIG5vdCBlbnRlcmVkIGVub3VnaCBpbmZvcm1hdGlvbiB0byBwcm9jZXNzIHRoaXMgc2hpcG1lbnQuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxMiddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gdXBkYXRpbmcgc3RvY2suJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxMyddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gdXBkYXRpbmcgU2hpcG1lbnQgbGluZXMuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAxNCddID0gJ0FuIGVycm9yIG9jY3VycmVkIHdoZW4gdXBkYXRpbmcgUGFydHMgUmVxdWVzdCBsaW5lcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDE1J10gPSAnQW4gZXJyb3Igb2NjdXJyZWQgd2hlbiB1cGRhdGluZyBXb3JrIE9yZGVyIGxpbmVzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTYnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIGNyZWF0aW5nIFNoaXBtZW50IGxpbmVzLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTcnXSA9ICdBbiBlcnJvciBvY2N1cnJlZCB3aGVuIHVwZGF0aW5nIFNoaXBtZW50IE9yZGVyLic7IA0KCSAgICBNc2dMaXN0WydNU0cwMTgnXSA9ICdTaGlwbWVudHMgcHJvY2Vzc2luZyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5ISc7IA0KCSAgICBNc2dMaXN0WydNU0c5OTknXSA9ICdJbmZvcm1hdGlvbiB5b3UgZW50ZXJlZCBoZXJlIHdpbGwgbm90IGJlIHNhdmVkLiBBcmUgeW91IHN1cmU/JzsNCgkgICAgfQ0KCWVsc2UgaWYgKHN1Ym1vZHVsZWlkID09ICJTTEtQU0MxIikNCgkgICAgew0KCSAgICBNc2dMaXN0WydMQUIwMDAnXSA9ICdTdG9jayBMb2NhdG9yJzsNCgkgICAgTXNnTGlzdFsnTEFCMDAxJ10gPSAnU2hvdy9IaWRlIE9wdGlvbnMnOw0KCSAgICBNc2dMaXN0WydMQUIwMDInXSA9ICdZb3VyIExvY2F0aW9uOiAgJzsNCgkgICAgTXNnTGlzdFsnTEFCMDAzJ10gPSAnIFNob3cgUmVzdWx0cyBBczogJzsNCgkgICAgTXNnTGlzdFsnTEFCMDA0J10gPSAnRmluZCBTdG9jayc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwNSddID0gJ1Nob3cvSGlkZSBSZXN1bHRzJzsNCgkgICAgTXNnTGlzdFsnTEFCMDA2J10gPSAnU2hvdy9IaWRlIE1hcCc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAwNyddID0gJ1JlcXVlc3QgU3RvY2snOw0KCSAgICBNc2dMaXN0WydMQUIwMDgnXSA9ICdDYW5jZWwnOw0KCSAgICBNc2dMaXN0WydMQUIwMDknXSA9ICdMb2NhdGlvbic7DQoJICAgIE1zZ0xpc3RbJ0xBQjAxMCddID0gJ1N0cmVldCc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAxMSddID0gJ0NpdHknOw0KCSAgICBNc2dMaXN0WydMQUIwMTInXSA9ICdTdGF0ZSc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAxMyddID0gJ1ppcCc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAxNCddID0gJ0NvdW50cnknOw0KCSAgICBNc2dMaXN0WydMQUIwMTUnXSA9ICdQaG9uZSc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAxNiddID0gJ0F2YWlsYWJsZSBRdWFudGl0eSc7DQoJICAgIE1zZ0xpc3RbJ0xBQjAxNyddID0gJ0Rpc3RhbmNlJzsNCgkgICAgTXNnTGlzdFsnTEFCMDE4J10gPSAnUmVxdWVzdCc7CQkNCgkgICAgTXNnTGlzdFsnTEFCMDE5J10gPSAnTWFwLEdyaWQsQm90aCc7CQkNCgkgICAgTXNnTGlzdFsnTEFCMDIwJ10gPSAnS2lsb21ldGVycyxNaWxlcyc7CQkJDQoJICAgIE1zZ0xpc3RbJ0xBQjAyMSddID0gJ09wdGlvbnM6JzsNCgkgICAgTXNnTGlzdFsnTEFCMDIyJ10gPSAnUmFkaXVzOiAnOw0KCSAgICBNc2dMaXN0WydNU0cwMDEnXSA9ICdBbiBpbnRlcm5hbCBlcnJvciBvY2N1cnJlZCB3aGVuIHNhdmluZyBkYXRhLiBQbGVhc2UgY29udGFjdCB5b3VyIFNlcnZpY2VNYXggYWRtaW5pc3RyYXRvciB0byByZXNvbHZlIHRoaXMuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDAyJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiByZXRyaWV2aW5nIGRhdGEuIFBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDAzJ10gPSAnUGxlYXNlIHNlbGVjdCBhIHN0b2NrIGxvY2F0aW9uIHRvIHJlcXVlc3QgZnJvbS4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDQnXSA9ICdQcm9ncmFtbWluZyBlcnJvci4gSW52YWxpZCByZWNvcmQgdHlwZS4nOw0KCSAgICBNc2dMaXN0WydNU0cwMDUnXSA9ICdOb3QgQXZhaWxhYmxlLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAwNiddID0gJ0ZpbmQgc3RvY2sgZm9yOiAgJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA3J10gPSAnUmVxdWlyZWQgUXVhbnRpdHk6ICAnOw0KCSAgICBNc2dMaXN0WydNU0cwMDgnXSA9ICdVbmFibGUgdG8gZGlzcGxheSBtYXAuJzsNCgkgICAgTXNnTGlzdFsnTVNHMDA5J10gPSAnQWRkcmVzcyBmb3IgdGhlIFJlcXVpcmVkIGxvY2F0aW9uIGlzIGVpdGhlciBpbmNvcnJlY3Qgb3IgaW5jb21wbGV0ZS4gVGhlIG1hcCBtYXkgbm90IGJlIGRpc3BsYXllZCBwcm9wZXJseS4nOw0KCSAgICBNc2dMaXN0WydNU0cwMTAnXSA9ICdZb3UgYXJlIGhlcmUhJzsNCgkgICAgTXNnTGlzdFsnTVNHMDExJ10gPSAnTm8gc3RvY2sgYXZhaWxhYmxlIGluIGFueSBsb2NhdGlvbi4nOw0KCSAgICBNc2dMaXN0WydNU0cwMTInXSA9ICdEb3VibGUtY2xpY2sgdGhlIGltYWdlIHRvIHJlcXVlc3Qgc3RvY2sgZnJvbSB0aGlzIGxvY2F0aW9uLic7DQoJICAgIE1zZ0xpc3RbJ01TRzAxMyddID0gJ1Bob25lOiAgJzsNCgkgICAgTXNnTGlzdFsnTVNHMDE0J10gPSAnU3RvY2s6ICAnOw0KCSAgICBNc2dMaXN0WydNU0cwMTUnXSA9ICc6IEFyZSB5b3Ugc3VyZSB0byByZXF1ZXN0IHN0b2NrIGZyb20gdGhpcyBsb2NhdGlvbj8nOw0KCSAgICBNc2dMaXN0WydNU0cwMTcnXSA9ICdXb3JrIE9yZGVyIFBhcnQgUmVxdWVzdCB1cGRhdGVkIHN1Y2Nlc3NmdWxseS4nOw0KCSAgICBNc2dMaXN0WydNU0cwMTgnXSA9ICdFcnJvciBvY2N1cnJlZCB3aGVuIHVwZGF0aW5nIHBhcnRzIHJlcXVlc3Q6ICc7DQoJICAgIE1zZ0xpc3RbJ01TRzAxOSddID0gJ1Byb2dyYW1taW5nIGVycm9yLiBVbnN1cHBvcnRlZCBzb3VyY2UgcmVjb3JkIHR5cGUuJzsgDQoJICAgIE1zZ0xpc3RbJ01TRzAyMCddID0gJ1BhcnQgUmVxdWVzdCB1cGRhdGVkIHN1Y2Nlc3NmdWxseS4nOyANCgkgICAgTXNnTGlzdFsnTVNHMDIxJ10gPSAnVW5rbm93bic7IA0KCSAgICBNc2dMaXN0WydNU0cwMjInXSA9ICdObyBzdG9jayBhdmFpbGFibGUgd2l0aGluIHRoZSBnaXZlbiByYWRpdXMnOw0KCSAgICBNc2dMaXN0WydNU0c5OTknXSA9ICdJbmZvcm1hdGlvbiB5b3UgZW50ZXJlZCBoZXJlIHdpbGwgbm90IGJlIHNhdmVkLiBBcmUgeW91IHN1cmU/JzsNCgkgICAgfQ0KCWVsc2UNCgkgICAgYWxlcnQoIlVuc3VwcG9ydGVkIHN1Ym1vZHVsZSAiICsgc3VibW9kdWxlaWQgKyAiLiBUaGlzIGlzIGEgcHJvZ3JhbW1pbmcgZXJyb3IuIik7DQoJfQ0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQovLyBHZXQgdGhlIG1lc3NhZ2UgZm9yIHRoZSBnaXZlbiBtZXNzYWdlIG51bWJlciBmcm9tIHRoZSBnbG9iYWwgaGFzaCB0YWJsZS4NCi8vIFJldHVybiAic2V0dXAtaXNzdWUiIGlmIHRoZSBtZXNzYWdlIGlzIG5vdCBmb3VuZA0KZnVuY3Rpb24gU1ZNWElfR2V0TWVzc2FnZShNc2dOdW0pDQp7DQogICAgaWYgKCFNc2dMaXN0W01zZ051bV0pDQoJcmV0dXJuICJNZXNzYWdlIGRlZmluaXRpb24gZm9yICIgKyBNc2dOdW0gKyAiIG5vdCBmb3VuZC4gVGhpcyBpcyBhIHNldHVwIGlzc3VlLlxuUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLiI7DQoNCiAgICByZXR1cm4gTXNnTGlzdFtNc2dOdW1dOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9TZXRMYWJlbHMoZm9ybW5hbWUpDQp7DQogICAgdmFyIGxhYmVscyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdsYWJlbCcpOw0KICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGFiZWxzLmxlbmd0aDsgaSsrKQ0KCXsNCgl2YXIgZiA9IGxhYmVsc1tpXTsNCglpZiAoTXNnTGlzdFtmLm5hbWVdKQ0KCSAgICBmLmlubmVyVGV4dCA9IE1zZ0xpc3RbZi5uYW1lXTsNCgl9DQogICAgdmFyIGgxbGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoMScpOw0KICAgIGZvciAodmFyIGsgPSAwOyBrIDwgaDFsaXN0Lmxlbmd0aDsgaysrKQ0KCXsNCgl2YXIgZiA9IGgxbGlzdFtrXTsNCglpZiAoTXNnTGlzdFtmLmlkXSkNCgkgICAgZi5pbm5lckhUTUwgPSBNc2dMaXN0W2YuaWRdOw0KCX0NCiAgICB2YXIgaDJsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2gyJyk7DQogICAgZm9yICh2YXIgbSA9IDA7IG0gPCBoMmxpc3QubGVuZ3RoOyBtKyspDQoJew0KCXZhciBmID0gaDJsaXN0W21dOw0KCWlmIChNc2dMaXN0W2YuaWRdKQ0KCSAgICBmLmlubmVySFRNTCA9IE1zZ0xpc3RbZi5pZF07DQoJfQ0KICAgIHZhciBlbGVtcyA9IGRvY3VtZW50LmZvcm1zW2Zvcm1uYW1lXS5lbGVtZW50czsNCiAgICBmb3IgKHZhciBqID0gMDsgaiA8IGVsZW1zLmxlbmd0aDsgaisrKQ0KCXsNCgl2YXIgZiA9IGVsZW1zW2pdOw0KCWlmICgoZi50eXBlID09ICdidXR0b24nIHx8IGYudHlwZSA9PSAnY2hlY2tib3gnKSAmJiBNc2dMaXN0W2YubmFtZV0pDQoJCXsNCgkgICAgZi52YWx1ZSA9IE1zZ0xpc3RbZi5uYW1lXTsNCgkJCWlmIChmLnR5cGUgPT0gJ2J1dHRvbicpDQoJCQkJZi50aXRsZSA9IE1zZ0xpc3RbZi5uYW1lXTsNCgkJfQ0KCQkNCgl9DQoJIC8vdG8gcG9wdWxhdGUgcGlja2xpc3QgZmllbGQNCgkgdmFyIHNlbGVjdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2VsZWN0Jyk7DQogICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxlY3RzLmxlbmd0aDsgaisrKQ0KCXsNCgl2YXIgZiA9IHNlbGVjdHNbal07DQoNCglpZiAoTXNnTGlzdFtmLm5hbWVdKQ0KCSAgICAgew0KCQkNCgkJICAvL3ZhciBvcHRpb25zTGlzdFN0cmluZyAgPSBNc2dMaXN0W2YubmFtZV07CQkgDQoJCSAgIC8vb3B0aW9uc0xpc3QgPW9wdGlvbnNMaXN0U3RyaW5nLnNwbGl0KCcsJyk7CQkNCgkJICAvLyB2YXIgb3B0aW9uc0xpc3RTdHJpbmcgID0gTXNnTGlzdFtmLm5hbWVdOwkJIA0KCQkgICBvcHRpb25zTGlzdCA9TXNnTGlzdFtmLm5hbWVdLnNwbGl0KCcsJyk7CQ0KCQkgZm9yICh2YXIgaz0wO2s8b3B0aW9uc0xpc3QubGVuZ3RoO2srKykNCgkJCXsJCQ0KCQkJCXZhciBvcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdPUFRJT04nKTsNCgkJCQlvcHQudmFsdWUgPSBvcHRpb25zTGlzdFtrXTsNCgkJCQlvcHQudGV4dCA9IG9wdGlvbnNMaXN0W2tdOwkJLy8JCW9wdC50ZXh0ID0gKG9wdGlvbnNMaXN0W2tdPT0nbnVsbCcpPycnOm9wdGlvbnNMaXN0W2tdOwkJCQkNCgkJCQlmLm9wdGlvbnMuYWRkKG9wdCwgayk7CQkJDQoJCQl9DQoJCQlmLnNlbGVjdGVkSW5kZXggPW9wdGlvbnNMaXN0Lmxlbmd0aC0xOw0KCQkgfQ0KCX0NCglpZiAoTXNnTGlzdFsiTEFCMDAwIl0pDQoJCWRvY3VtZW50LnRpdGxlID0gTXNnTGlzdFsiTEFCMDAwIl07IA0KICAgIHJldHVybiB0cnVlOw0KfQ0KLyo9PT09PT09PT09PT09PT09PSBFTkQgUmVsZWFzZSAyLjAgY2hhbmdlcyBmb3IgdHJhbnNsYXRpb24gPT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gQ2xvc2VXaW5kb3coKQ0Kew0KICAgIHdpbmRvdy5jbG9zZSgpOw0KfQ0KDQpmdW5jdGlvbiBTVk1YSV9HZXRDdXJyZW50VGltZSgpDQp7DQogICAgdmFyIHNlcnZlclRpbWUgPSBzZm9yY2UuY29ubmVjdGlvbi5nZXRTZXJ2ZXJUaW1lc3RhbXAoKTsNCiAgICByZXR1cm4gc2VydmVyVGltZS50aW1lc3RhbXA7DQp9DQoNCmZ1bmN0aW9uIFNWTVhJX0NoZWNrQW5kQ2xvc2UoKQ0Kew0KICAgIHZhciBhbnMgPSBjb25maXJtKFNWTVhJX0dldE1lc3NhZ2UoIk1TRzk5OSIpKTsNCiAgICBpZiAoYW5zKSB7IENsb3NlV2luZG93KCk7IH0NCn0NCg0KZnVuY3Rpb24gaXNWYWxpZE51bWJlcihldnQpDQp7DQogICAgdmFyIGNoYXJDb2RlID0gKGV2dC53aGljaCkgPyBldnQud2hpY2ggOiBldmVudC5rZXlDb2RlDQogICAgaWYgKGNoYXJDb2RlID4gMzEgJiYgKGNoYXJDb2RlIDwgNDggfHwgY2hhckNvZGUgPiA1NykpDQoJcmV0dXJuIGZhbHNlOw0KDQogICAgcmV0dXJuIHRydWU7DQp9DQoNCmZ1bmN0aW9uIGRyYXdNc2codGEsbXNnKQ0Kew0KICAgIGlmICghdGEpIHRhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpc3RfdGJvZHkiKTsNCiAgICBjbGVhcl90YWJsZSggdGEgKTsNCiAgICB2YXIgdHIgPSBtYWtlUm93KHsnY2xhc3MnOidoZWFkZXJSb3cnfSk7dGEuYXBwZW5kQ2hpbGQodHIpOw0KICAgIGNyZWF0ZVRhZyh0ciwidGgiLHsnY2xhc3MnOidhY3Rpb25Db2x1bW4nLCdzY29wZSc6J2NvbCd9KS5pbm5lckhUTUwgPSBtc2c7DQp9DQoNCmZ1bmN0aW9uIGNsZWFyX3RhYmxlKHRib2R5KQ0Kew0KICAgIGlmICghdGJvZHkpIHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxpc3RfdGJvZHkiKTsNCiAgICB3aGlsZSAodGJvZHkucm93cy5sZW5ndGggPiAwKSAJeyB0Ym9keS5kZWxldGVSb3coMCk7IH0NCn0NCg0KZnVuY3Rpb24gbWFrZUF0dHJzKGksdGEpDQp7DQogICAgdmFyIGF0dHMgPSBuZXcgT2JqZWN0KCk7DQogICAgLy8gaG93IG1hbnkgcm93cyBpbiB0aGlzIHRhYmxlIHNvIGZhcg0KICAgIHRyeSB7IHRhLmV2ZW4gfSBjYXRjaCAoZSkgeyB0YS5ldmVuID0gaX07DQogICAgaWYgKGk9PTApIHsgLy8gc2tpbiBzdHVmZg0KCSAgICBhdHRzWyJjbGFzcyJdID0gImV2ZW4gZmlyc3QiOw0KICAgIH0gZWxzZSBpZiAodGEuZXZlbiA9PSB0cnVlKSB7DQoJICAgIGF0dHNbImNsYXNzIl0gPSAiZXZlbiI7DQogICAgfSBlbHNlIHsNCgkgICAgYXR0c1siY2xhc3MiXSA9ICJvZGQiOw0KICAgIH0NCiAgICB0YS5ldmVuID0gIXRhLmV2ZW47DQogICAgYXR0c1sib25tb3VzZW91dCJdID0gImlmICh0eXBlb2YoaGlPZmYpICE9ICd1bmRlZmluZWQnICYmIHRoaXMuYWN0aXZlID09IGZhbHNlKXtoaU9mZih0aGlzKTt9IjsNCiAgICBhdHRzWyJvbm1vdXNlb3ZlciJdID0gImlmICh0eXBlb2YoaGlPbikgIT0gJ3VuZGVmaW5lZCcpe2hpT24odGhpcyk7fSI7DQogICAgcmV0dXJuIGF0dHM7DQp9DQoNCmZ1bmN0aW9uIG1ha2VSb3coYXR0cykNCnsNCiAgICB2YXIgYnJvd3NlciA9IG5hdmlnYXRvci5hcHBOYW1lOw0KICAgIGlmIChicm93c2VyID09ICJNaWNyb3NvZnQgSW50ZXJuZXQgRXhwbG9yZXIiKSB7DQoJICAgIHZhciB0clRhZyA9ICI8VFIgIjsNCgkgICAgZm9yIChrZXkgaW4gYXR0cykgew0KCQkgICAgdHJUYWcgKz0ga2V5ICsgIj1cIiIgKyBhdHRzW2tleV0gKyAiXCIiOw0KCSAgICB9DQoJICAgIHRyVGFnICs9ICI+IjsNCgkgICAgdmFyIHJldCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodHJUYWcpOw0KICAgIH0gZWxzZSB7DQoJICAgIHZhciB0ciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIlRSIik7DQoJICAgIGZvciAoa2V5IGluIGF0dHMpIHsNCgkJICAgIHRyLnNldEF0dHJpYnV0ZShrZXksIGF0dHNba2V5XSk7DQoJICAgIH0NCgkgICAgdmFyIHJldCA9IHRyOw0KICAgIH0NCiAgICByZXQuYWN0aXZlID0gZmFsc2U7DQogICAgcmV0dXJuIHJldDsNCn0NCg0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogU1RSSU5HIEZ1bmN0aW9ucyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQovLyBSZW1vdmVzIGxlYWRpbmcgd2hpdGVzcGFjZXMNCmZ1bmN0aW9uIExUcmltKCB2YWx1ZSApIA0Kew0KICAgIHZhciByZSA9IC9ccyooKFxTK1xzKikqKS87DQogICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UocmUsICIkMSIpOw0KfQ0KDQovLyBSZW1vdmVzIGVuZGluZyB3aGl0ZXNwYWNlcw0KZnVuY3Rpb24gUlRyaW0oIHZhbHVlICkgDQp7DQogICAgdmFyIHJlID0gLygoXHMqXFMrKSopXHMqLzsNCiAgICByZXR1cm4gdmFsdWUucmVwbGFjZShyZSwgIiQxIik7DQp9DQoNCi8vIFJlbW92ZXMgbGVhZGluZyBhbmQgZW5kaW5nIHdoaXRlc3BhY2VzDQpmdW5jdGlvbiB0cmltKCB2YWx1ZSApIA0Kew0KICAgIHJldHVybiBMVHJpbShSVHJpbSh2YWx1ZSkpOw0KfQ0KCQ0KZnVuY3Rpb24gTGVmdChzdHIsIG4pDQp7DQogICAgaWYgKG4gPD0gMCkNCglyZXR1cm4gIiI7DQogICAgZWxzZSBpZiAobiA+IFN0cmluZyhzdHIpLmxlbmd0aCkNCglyZXR1cm4gc3RyOw0KICAgIGVsc2UNCglyZXR1cm4gU3RyaW5nKHN0cikuc3Vic3RyaW5nKDAsbik7DQp9DQpmdW5jdGlvbiBSaWdodChzdHIsIG4pDQp7DQogICAgaWYgKG4gPD0gMCkNCiAgICAgICByZXR1cm4gIiI7DQogICAgZWxzZSBpZiAobiA+IFN0cmluZyhzdHIpLmxlbmd0aCkNCiAgICAgICByZXR1cm4gc3RyOw0KICAgIGVsc2Ugew0KICAgICAgIHZhciBpTGVuID0gU3RyaW5nKHN0cikubGVuZ3RoOw0KICAgICAgIHJldHVybiBTdHJpbmcoc3RyKS5zdWJzdHJpbmcoaUxlbiwgaUxlbiAtIG4pOw0KICAgIH0NCn0NCgkNCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gIERhdGUgVXRpbGl0aWVzLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vDQoNCmZ1bmN0aW9uIENvbnZlcnREYXRlVG9TRkRDRGF0ZSh0aGVEYXRlKQ0Kew0KICAgIHZhciB0b2RheSA9IHRoZURhdGU7DQogICAgdmFyIHllYXIgPSB0b2RheS5nZXRGdWxsWWVhcigpOw0KICAgIHZhciBtb250aCA9IHBhcnNlRmxvYXQodG9kYXkuZ2V0TW9udGgoKSkgKyAxOw0KICAgIGlmIChtb250aCA8IDEwKSB7IG1vbnRoID0gIjAiICsgbW9udGg7IH0NCiAgICB2YXIgZGF5ID0gcGFyc2VGbG9hdCh0b2RheS5nZXREYXRlKCkpOw0KICAgIGlmIChkYXkgPCAxMCkgeyBkYXkgPSAiMCIgKyBkYXk7IH0NCiAgICByZXR1cm4gIHllYXIgKyAiLSIgKyBtb250aCArICItIiArIGRheTsNCn0NCg0KLyo9PT09PT09PT0gICBTVE9DSy9TRVJJQUwgVVRJTElUSUVTICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCg0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gU2VyaWFsIE51bWJlciBTQVZFID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCnZhciBzU2F2X3Byb2Nlc3NMb2cgPSAiIjsNCnZhciBzU2F2X3ZQcm9kU3RrQXI7IA0KdmFyIHNTYXZfdlVzZXI7IC8vIFN0b3JlcyBVc2VyIE5hbWUvZGVhaWxzIA0KdmFyIHNTYXZfdlVzZXJJZDsNCmZ1bmN0aW9uIFNWTVhJX0RvU2VyaWFsU2F2ZShjUHJvZFN0a0FyLCBjVXNlcklkKSANCnsJDQoJc1Nhdl92UHJvZFN0a0FyID0gY1Byb2RTdGtBcjsgLy9BbiBhcnJheSBjb250YWluaW5nOiBQcm9kdWN0IElkLCBGcm9tIFByb2R1Y3QgU3RvY2sgSUQsIFRvIFByb2R1Y3QgU3RvY2sgSUQsIFNlcmlhbCBOdW1iZXIJdmFyIHNrU2F2X3Byb2Nlc3NMb2cgPSAiIjsNCglzU2F2X3ZjdXJyZGF0ZSA9IG5ldyBEYXRlKCk7IA0KCXNTYXZfdlVzZXJJZCA9Y1VzZXJJZDsNCgl2YXIgcmVzdWx0Ow0KCXZhciByZXN1bHRBciA9IFNWTVhJX011bHRpRGltZW5zaW9uYWxBcnJheShjUHJvZFN0a0FyLmxlbmd0aCw0KTsgLy9TYW1lIFNpemUgYXMgb2YgSW5wdXQgQXJyYXkNCglmb3IgKHZhciBhPTA7IGE8c1Nhdl92UHJvZFN0a0FyLmxlbmd0aCA7YSsrKSAvL0xvb3AgdGhlIFByb2QgYXJyYXkgYW5kIGRvIFBTIFVwZGF0ZS9DcmVhdGUgU2VyaWFsJ3MgUFMgSUQNCgl7DQoJCXJlc3VsdEFyW2FdWzBdID0gdHJ1ZTsgLy9TdGF0dXMgVHJ1ZS9mYWxzZQ0KCQlyZXN1bHRBclthXVsxXSA9IHNTYXZfdlByb2RTdGtBclthXVswXTsgLy9Qcm9kdWN0IElkDQoJCXJlc3VsdEFyW2FdWzJdID0gc1Nhdl92UHJvZFN0a0FyW2FdWzNdOyAvL1NlcmlhbCBObw0KCQlyZXN1bHRBclthXVszXSA9ICIiOyAvL0Vycm9yIE1zZw0KDQoJCWlmIChzU2F2X3ZQcm9kU3RrQXJbYV1bMF0gIT0gIiIgJiYgc1Nhdl92UHJvZFN0a0FyW2FdWzJdICE9ICIiICYmIHNTYXZfdlByb2RTdGtBclthXVszXSAhPSAiIiApIC8vVmFsaWRhdGUgUHJvZEFyIEl0ZW0gaXMgbm90IGJsYW5rDQoJCXsNCgkJCXZhciBzZWxQcm9kSWQgPSBzU2F2X3ZQcm9kU3RrQXJbYV1bMF07DQoJCQl2YXIgc2VsRnJvbVBTSUQgPSBzU2F2X3ZQcm9kU3RrQXJbYV1bMV07CQkJCQ0KCQkJdmFyIHNlbFRvUFNJRCA9IHNTYXZfdlByb2RTdGtBclthXVsyXTsJCQkJDQoJCQl2YXIgc2VsU04gPSBzU2F2X3ZQcm9kU3RrQXJbYV1bM107CQkJCQ0KCQkJaWYgKFNWTVhJX3NhdmVQcm9kU2VyaWFsKHNlbFByb2RJZCxzZWxGcm9tUFNJRCxzZWxUb1BTSUQsc2VsU04pID09IGZhbHNlKQ0KCQkJew0KCQkJCXJlc3VsdEFyW2FdWzBdID0gZmFsc2U7IC8vU3RhdHVzIFRydWUvZmFsc2UNCgkJCQlyZXN1bHRBclthXVszXSA9IHNTYXZfcHJvY2Vzc0xvZzsgLy9FcnJvciBNc2cNCgkJCQlzU2F2X3Byb2Nlc3NMb2cgPSAiIjsNCgkJCX0NCgkJfQ0KCQllbHNlIA0KCQl7IA0KCQkJcmVzdWx0QXJbYV1bMF0gPSBmYWxzZTsgLy9TdGF0dXMgVHJ1ZS9mYWxzZQ0KCQkJcmVzdWx0QXJbYV1bM10gPSBTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwNSIpOyAvL0Vycm9yIE1zZw0KCQkJc1Nhdl9wcm9jZXNzTG9nID0gIiI7DQoJCX0NCgl9DQoJcmV0dXJuIHJlc3VsdEFyOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9zYXZlUHJvZFNlcmlhbChzZWxQcm9kSWQsc2VsRnJvbVBTSUQsc2VsVG9QU0lELHNlbFNOKSANCnsJDQoJdmFyIHJlc3VsdDsNCgl2YXIgc29xbCA9ICJTZWxlY3QgSWQsIE5hbWUgIiA7DQoJCXNvcWwgPSBzb3FsICsgIiBGcm9tIFNWTVhDX19Qcm9kdWN0X1NlcmlhbF9fYyAgIjsNCgkJc29xbCA9IHNvcWwgKyAiIFdIRVJFIFNWTVhDX19Qcm9kdWN0X1N0b2NrX19jICA9ICciICsgc2VsRnJvbVBTSUQgKyAiJyI7DQoJCXNvcWwgPSBzb3FsICsgIiBBbmQgTmFtZSA9ICciICsgc2VsU04gKyAiJyI7DQoJdHJ5DQoJew0KCQl2YXIgcXJQUyA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwpOyANCgl9IA0KCWNhdGNoKGUpIA0KCXsJCQkNCgkJU1ZNWElfc1Nhdl9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAyIikrZSk7DQoJCXJlc3VsdCA9IGZhbHNlOw0KCX0NCg0KCS8vIENyZWF0ZSBvciBVcGRhdGUgUHJvZC1zZXJpYWwgcmVjb3JkDQoJdmFyIHBzID0gbmV3IHNmb3JjZS5TT2JqZWN0KCJTVk1YQ19fUHJvZHVjdF9TZXJpYWxfX2MiKTsNCglpZiAocXJQUyAmJiBxclBTLnNpemUgPiAwKSAvLyBQcm9kLVNlcmlhbCBSZWNvcmQgQWxyZWFkeSBFeGlzdCBVUERBVEUgSVQNCgl7IA0KCQl2YXIgcmVjc1BTID0gcXJQUy5nZXRBcnJheSgicmVjb3JkcyIpOyANCgkgICAgcHMuSWQgPSByZWNzUFNbMF0uSWQ7IC8vIGV4aXN0aW5nIFJlY29yZHMgcHJvZC1zZXJpYWwgSUQNCgkgICAgcHMuU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX2MgICA9IHNlbFRvUFNJRDsNCgkgICAgdHJ5IHsNCgkJdmFyIHJldCA9IHNmb3JjZS5jb25uZWN0aW9uLnVwZGF0ZShbcHNdKTsgDQoJCSAgICByZXN1bHQgPSB0cnVlOw0KCQl9DQoJICAgIGNhdGNoKGUpIHsgICAgICAgIA0KCQkJU1ZNWElfc1Nhdl9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAxIikrZSk7DQoJCXJlc3VsdCA9IGZhbHNlOw0KCSAgICB9DQoJfSANCgllbHNlIC8vIFBTIFJlY29yZCBOb3QgRXhpc3Qgc28gQ3JlYXRlIEl0DQoJeyANCgkgICAgcHMuTmFtZSAgPSBzZWxTTjsNCgkgICAgcHMuU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX2MgICA9IHNlbFRvUFNJRDsNCgkJcHMuU1ZNWENfX1Byb2R1Y3RfX2MgICA9IHNlbFByb2RJZDsNCgkgICAgcHMuU1ZNWENfX0FjdGl2ZV9fYyA9ICJUcnVlIjsNCgkgICAgdHJ5IHsNCgkJdmFyIHJldCA9IHNmb3JjZS5jb25uZWN0aW9uLmNyZWF0ZShbcHNdKTsgDQoJCWlmIChyZXRbMF0uZ2V0Qm9vbGVhbigic3VjY2VzcyIpKSANCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7ICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICB9IA0KICAgICAgICAgICAgICAgIGVsc2UgDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydChyZXRbMF0uZXJyb3JzLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBmYWxzZTs7DQogICAgICAgICAgICAgICAgfQ0KCQkgICAgDQoJCX0NCgkgICAgY2F0Y2goZSkgeyAgICAgICAgCQkNCgkJCVNWTVhJX3NTYXZfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMSIpK2UpOw0KCQlyZXN1bHQgPSBmYWxzZTsNCgkgICAgfQ0KCX0gDQoJcmV0dXJuIHJlc3VsdDsNCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfc1Nhdl9QdXRQcm9jZXNzTG9nKE1zZykgDQp7IA0KCWlmIChzU2F2X3Byb2Nlc3NMb2cpIHsgc1Nhdl9wcm9jZXNzTG9nICs9ICJcbiI7IH0gDQoJc1Nhdl9wcm9jZXNzTG9nICs9IE1zZzsNCn0NCg0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gU3RvY2sgU2F2ZT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCnZhciBza1Nhdl9wcm9jZXNzTG9nID0gIiI7DQp2YXIgc2tTYXZfdlByb2Q7IC8vU3RvcmVzIFByb2R1Y3QgTmFtZS9EZXRhaWxzIChVc2VkIGluIEVtYWlsIEJvZHkpDQp2YXIgc2tTYXZfdkxvY2F0aW9uOyAvL1N0b3JlcyBMb2NhdGlvbiBOYW1lL0RldGFpbHMgKFVzZWQgaW4gRW1haWwgYm9keSkNCnZhciBza1Nhdl92VXNlcjsgLy8gU3RvcmVzIFVzZXIgTmFtZS9kZWFpbHMgOVVzZWQgaW4gRW1haWwgYm9keSkNCnZhciBza1Nhdl92UHJvZHVjdElkOw0KdmFyIHNrU2F2X3ZTaXRlSUQ7DQp2YXIgc2tTYXZfdlN0YXR1czsNCnZhciBza1Nhdl92VHJhbnNhY3Rpb25RdHk7DQp2YXIgc2tTYXZfdlRyYW5zYWN0aW9uVHlwZTsgLy8oUk1BLCBTaGlwbWVudCwgU1ZPIFJlY2VpcHQsIFNWTyBVc2FnZSwgUGFydHMgUmVjZWlwdCwgU3RvY2sgVHJhbnNmZXIsIFN0b2NrIEFkanVzdG1lbnQpDQp2YXIgc2tTYXZfdlRyYW5zYWN0aW9uTnVtYmVyOyANCnZhciBza1Nhdl92Q2hhbmdlVHlwZTsNCnZhciBza1Nhdl92SGVhZGVyUmVmSWQ7DQp2YXIgc2tTYXZfdkxpbmVSZWZlcmVuY2VJZDsNCnZhciBza1Nhdl92VXNlcklkOw0KdmFyIHNrU2F2X3ZjdXJyZGF0ZTsgDQp2YXIgc2tTYXZfdnBzSUQ7IC8vUHJvZHVjdCBTdG9jayBJZA0KdmFyIHNrU2F2X3Zwc1F0eTsgLy9FeGlzdGluZyBRdHkvQmVmb3JlIFF0eQ0KdmFyIHNrU2F2X3Zwc1VwZFF0eTsgLy8gVXBkYXRlZCBRdHkgL2FmdGVyIHF0eSAoQ291bGQgYmUgbmVnYXRpdmUsIGZvciBzZW5kaW5nIGluIGVtYWlsIG5vdGlmaWNhdGlvbiBldGMpDQp2YXIgc2tTYXZfdmVtYWlsVG9Vc2VySWQ7IC8vSWQgb2YgVXNlciB3aG8gd2lsbCBnZXQgTm90aWZpZWQuLm9uIE5lZ2F0aXZlIFN0b2NrDQp2YXIgc2tTYXZfdlByaWNlOyAvLyBUbyBTdG9yZSB0aGUgUHJpY2Ugb2YgR2l2ZW4gcHJvZHVjdA0KdmFyIHNrU2F2X3ZJbnZBY2N0ID0gIiI7IC8vIFRvIHN0b3JlIEludmVudG9yeSBBY2NvdW50IHZhbHVlIGZyb20gU2l0ZSAtIGZvciBwb3N0aW5nIGluIFN0ayBIaXN0DQp2YXIgc2tTYXZfcmVzQXJyYXkgPSBuZXcgQXJyYXkoNSk7IA0KdmFyIHNrU2F2X3ZJc29DdXJyQ29kZTsgLy8gdG8gc3RvcmUgSXNvQ29kZSwgZXh0cmFjdGluZyBmcm9tIEN1cnJlbmN5VHlwZQ0KdmFyIHNrU2F2X3ZDdXJySWQ7IC8vIFRvIFN0b3JlIEN1cnJJZCBmcm9vbSBDdXJyZW5jeVR5cGUNCnZhciBza1Nhdl92UHJpY2VCa0lkOyAvLyB0byBzdG9yZSBQcmljZUJvb2syIElkLCBNYXRjaGluZyB3aXRoIERlZmF1bHQgU2V0dGluZ3MgZ2l2ZSBpbiBTZXJ2aWNlTWF4IFNldHRpbmdzDQp2YXIgc2tTYXZfdkRlZlByaWNlQms7IC8vIHRvIHN0b3JlIERlZmF1bHQgUHJpY2VCb29rIGFzIHNwZWNpZmllZCBpbiBTZXJ2ZU1heCBTZXR0aW5ncw0KCQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfRG9TdG9ja1VwZGF0ZShjUHJvZHVjdElkLCBjU2l0ZUlELCBjU3RhdHVzLCBjVHJhbnNhY3Rpb25RdHksIGNUcmFuc2FjdGlvblR5cGUsIGNUcmFuc2FjdGlvbk51bWJlciwgY0NoYW5nZVR5cGUsIGNIZWFkZXJSZWZJZCwgY0xpbmVSZWZlcmVuY2VJZCwgY1VzZXJJZCkNCnsNCgl2YXIgcmVzOw0KCWlmIChTVk1YSV9za1NhdkdldFNlcnZpY2VNYXhTZXR0aW5ncygpKQkJLy9CeSBHTSAyM0p1bjA4IG1ldGhvZCB3YXNuJ3QgaGF2aW5nICcoKScgYWRkZWQgbm93ICAgDQoJICAgIHsNCgkgICAgaWYgKFNWTVhJX3NrU2F2SXNWYWxpZFByb2R1Y3QoY1Byb2R1Y3RJZCkpDQoJCXsNCgkJaWYgKFNWTVhJX3NrU2F2SXNWYWxpZFNpdGUoY1NpdGVJRCkpDQoJCSAgICB7DQoJCSAgICByZXMgPSBTVk1YSV9Qcm9jZXNzU3RvY2tVcGRhdGUoY1Byb2R1Y3RJZCwgY1NpdGVJRCwgY1N0YXR1cywgY1RyYW5zYWN0aW9uUXR5LCBjVHJhbnNhY3Rpb25UeXBlLCBjVHJhbnNhY3Rpb25OdW1iZXIsIGNDaGFuZ2VUeXBlLCBjSGVhZGVyUmVmSWQsIGNMaW5lUmVmZXJlbmNlSWQsIGNVc2VySWQpIDsNCgkJICAgIH0NCgkJZWxzZSANCgkJICAgIHJlcyA9IGZhbHNlOw0KCQl9DQoJICAgIGVsc2UgDQoJCXJlcyA9IGZhbHNlOw0KCSAgICB9DQoJZWxzZSANCgkgICAgcmVzID0gZmFsc2U7DQoNCgkvL0RyYXcgUmVzdWx0IGFycmF5DQoJc2tTYXZfcmVzQXJyYXlbMF0gPSByZXM7DQoJc2tTYXZfcmVzQXJyYXlbMV0gPSBza1Nhdl92cHNJRDsNCglza1Nhdl9yZXNBcnJheVsyXSA9IHBhcnNlRmxvYXQoc2tTYXZfdnBzUXR5KTsgLy9CZWZvcmUgUXR5DQoJaWYgKHBhcnNlRmxvYXQoc2tTYXZfdnBzVXBkUXR5KSA+IDApIHtza1Nhdl9yZXNBcnJheVszXSA9IHBhcnNlRmxvYXQoc2tTYXZfdnBzVXBkUXR5KTt9IC8vYWZ0ZXIgUXR5DQoJZWxzZSB7c2tTYXZfcmVzQXJyYXlbM10gPSAwO30NCglza1Nhdl9yZXNBcnJheVs0XSA9IHNrU2F2X3Byb2Nlc3NMb2c7DQoNCglyZXR1cm4gc2tTYXZfcmVzQXJyYXk7DQp9DQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV9Qcm9jZXNzU3RvY2tVcGRhdGUoY1Byb2R1Y3RJZCwgY1NpdGVJRCwgY1N0YXR1cywgY1RyYW5zYWN0aW9uUXR5LCBjVHJhbnNhY3Rpb25UeXBlLCBjVHJhbnNhY3Rpb25OdW1iZXIsIGNDaGFuZ2VUeXBlLCBjSGVhZGVyUmVmSWQsIGNMaW5lUmVmZXJlbmNlSWQsIGNVc2VySWQpIA0KewkNCglza1Nhdl92Y3VycmRhdGUgPSBuZXcgRGF0ZSgpOyANCglza1Nhdl92UHJvZHVjdElkID0gY1Byb2R1Y3RJZDsNCglza1Nhdl92U2l0ZUlEID0gY1NpdGVJRDsNCglza1Nhdl92U3RhdHVzID0gY1N0YXR1czsNCglza1Nhdl92VHJhbnNhY3Rpb25RdHkgPSBwYXJzZUZsb2F0KGNUcmFuc2FjdGlvblF0eSk7DQoJc2tTYXZfdlRyYW5zYWN0aW9uVHlwZSA9IGNUcmFuc2FjdGlvblR5cGU7DQoJc2tTYXZfdlRyYW5zYWN0aW9uTnVtYmVyID0gY1RyYW5zYWN0aW9uTnVtYmVyOyANCglza1Nhdl92Q2hhbmdlVHlwZSA9Y0NoYW5nZVR5cGU7DQoJc2tTYXZfdkhlYWRlclJlZklkID0gY0hlYWRlclJlZklkOw0KCXNrU2F2X3ZMaW5lUmVmZXJlbmNlSWQgPSBjTGluZVJlZmVyZW5jZUlkOw0KCXNrU2F2X3ZVc2VySWQgPWNVc2VySWQ7DQoJdmFyIHNvcWwgPSAiU2VsZWN0IElkLFNWTVhDX19RdWFudGl0eTJfX2MsICBTVk1YQ19fU3RhdHVzX19jLCBTVk1YQ19fUHJvZHVjdF9fYywgU1ZNWENfX0xvY2F0aW9uX19jICIgOw0KCQlzb3FsID0gc29xbCArICIgRnJvbSBTVk1YQ19fUHJvZHVjdF9TdG9ja19fYyAiOw0KCQlzb3FsID0gc29xbCArICIgV0hFUkUgU1ZNWENfX1N0YXR1c19fYyA9ICciICsgc2tTYXZfdlN0YXR1cyArICInIjsNCgkJc29xbCA9IHNvcWwgKyAiIEFuZCBTVk1YQ19fUHJvZHVjdF9fYyA9ICciICsgc2tTYXZfdlByb2R1Y3RJZCArICInIjsNCgkJc29xbCA9IHNvcWwgKyAiIEFuZCBTVk1YQ19fTG9jYXRpb25fX2MgPSAnIiArIHNrU2F2X3ZTaXRlSUQgKyAiJyI7DQoJLy9TVk1YSV9QdXRQcm9jZXNzTG9nKCJRdWVyeTogIiArIHNvcWwpOyAJDQoJdHJ5DQoJew0KCQl2YXIgcXJQUyA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwpOyANCgl9IA0KCWNhdGNoKGUpIA0KCXsJCQkNCgkJU1ZNWElfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMiIpK2UpOw0KCX0NCglpZiAocXJQUyAmJiBxclBTLnNpemUgPiAwKSAvLyBQUyBSZWNvcmQgQWxyZWFkeSBFeGlzdA0KCXsgDQoJCXZhciByZWNzUFMgPSBxclBTLmdldEFycmF5KCJyZWNvcmRzIik7IA0KCQlza1Nhdl92cHNJRCA9IHJlY3NQU1swXS5JZDsgDQoJCXNrU2F2X3Zwc1F0eSA9IHBhcnNlRmxvYXQocmVjc1BTWzBdLlNWTVhDX19RdWFudGl0eTJfX2MpOw0KCQlza1Nhdl92cHNVcGRRdHkgPSBTVk1YSV91cGRQUyhza1Nhdl92cHNJRCxza1Nhdl92cHNRdHksc2tTYXZfdlRyYW5zYWN0aW9uUXR5LHNrU2F2X3ZDaGFuZ2VUeXBlKTsNCgl9IA0KCWVsc2UgLy8gUFMgUmVjb3JkIE5vdCBFeGlzdCBzbyBDcmVhdGUgSXQNCgl7IA0KCQl2YXIgcHMgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19Qcm9kdWN0X1N0b2NrX19jIik7DQoJCXNrU2F2X3Zwc1F0eSA9MDsNCgkgICAgcHMuU1ZNWENfX0xvY2F0aW9uX19jICA9IHNrU2F2X3ZTaXRlSUQ7DQoJICAgIHBzLlNWTVhDX19Qcm9kdWN0X19jICA9IHNrU2F2X3ZQcm9kdWN0SWQ7DQoJICAgIHBzLlNWTVhDX19TdGF0dXNfX2MgID0gc2tTYXZfdlN0YXR1czsNCgkgICAgcHMuU1ZNWENfX1F1YW50aXR5Ml9fYyAgPSBza1Nhdl92cHNRdHk7DQoJICAgIHRyeSANCgkJew0KCQkJCXZhciByZXQgPSBzZm9yY2UuY29ubmVjdGlvbi5jcmVhdGUoW3BzXSk7IA0KCQkJCWlmIChyZXRbMF0uZ2V0Qm9vbGVhbigic3VjY2VzcyIpKSANCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmV0dXJuIHJldFswXS5pZDsgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgfSANCiAgICAgICAgICAgICAgICBlbHNlIA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQocmV0WzBdLmVycm9ycy5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9yZXR1cm4gbnVsbDsNCiAgICAgICAgICAgICAgICB9DQoJCQkJc2tTYXZfdnBzSUQgPSByZXRbMF0uaWQ7DQoJCQkJc2tTYXZfdnBzVXBkUXR5ID0gU1ZNWElfdXBkUFMoc2tTYXZfdnBzSUQsc2tTYXZfdnBzUXR5LHNrU2F2X3ZUcmFuc2FjdGlvblF0eSxza1Nhdl92Q2hhbmdlVHlwZSk7DQoJCX0NCgkgICAgY2F0Y2goZSkgeyAgICAgICAgCQkNCgkJCVNWTVhJX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDEiKStlKTsNCgkJcmV0dXJuIGZhbHNlOw0KCSAgICB9DQoJfSANCg0KCS8vLy8vLy8vLy9JZiB0aGUgbmV3IHF1YW50aXR5IGlzIGxlc3MgdGhhbiB6ZXJvIEdFTkVSQVRFIGFuZCBTRU5UIE5PVElGSUNBVElPTiBFbWFpbCAoVG86IGFzIHNwZWNpZmllZCBpbiBTZXJ2aWNlbWF4IHNldHRpbmdzKQ0KCWlmIChza1Nhdl92cHNVcGRRdHkgPCAwKSANCgkgICAgew0KCSAgICB2YXIgZW1haWxUbzsJLy9HZXQgRW1haWwgaWQgdG8gTm90aWZ5DQoJICAgIHZhciBzb3FsU1MgPSAiU2VsZWN0IFNWTVhDX19Ob3RpZnlfb25fTmVnYXRpdmVfU3RvY2tfX2MsU1ZNWENfX05vdGlmeV9vbl9OZWdhdGl2ZV9TdG9ja19fci5FbWFpbCAgIiA7DQoJCSAgICBzb3FsU1MgPSBzb3FsU1MgKyAiIEZyb20gU1ZNWENfX1NlcnZpY2VNYXhfU2V0dGluZ3NfX2MgICI7DQoJICAgIC8vU1ZNWElfUHV0UHJvY2Vzc0xvZygiUXVlcnk6ICIgKyBzb3FsKTsgCQ0KCSAgICB0cnkNCgkJew0KCQkJZW1haWxUbyA9ICIiOw0KCQkJdmFyIHFyU1MgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsU1MpOyANCgkJCWlmIChxclNTLnNpemUgPiAwKSAvLyBOb3RpZmljYXRpb24gRW1haWwgRm91bmQNCgkJCSAgICB7IA0KCQkJICAgIHZhciByZWNzU1MgPSBxclNTLmdldEFycmF5KCJyZWNvcmRzIik7IA0KCQkJICAgIGlmIChyZWNzU1NbMF0uU1ZNWENfX05vdGlmeV9vbl9OZWdhdGl2ZV9TdG9ja19fYykNCgkJCQl7DQoJCQkJZW1haWxUbyA9IHJlY3NTU1swXS5TVk1YQ19fTm90aWZ5X29uX05lZ2F0aXZlX1N0b2NrX19yLkVtYWlsOyANCgkJCQlza1Nhdl92ZW1haWxUb1VzZXJJZCA9IHJlY3NTU1swXS5TVk1YQ19fTm90aWZ5X29uX05lZ2F0aXZlX1N0b2NrX19jOw0KCQkJCX0NCgkJCSAgICB9IA0KDQoJCQlpZiAoZW1haWxUbyAhPSAiIikgLy8gQ29kZSB0byBzZW5kIEVtYWlsIHRvIHNzTm90aWZ5RW1haWwNCgkJCSAgICB7CQ0KCQkJCXZhciByZXF1ZXN0ID0gbmV3IHNmb3JjZS5TaW5nbGVFbWFpbE1lc3NhZ2UoKTsgDQoJCQkJdmFyIHVzZXJFbWFpbCA9IHNmb3JjZS5jb25uZWN0aW9uLmdldFVzZXJJbmZvKCkudXNlckVtYWlsOw0KCQkJCXJlcXVlc3QucmVwbHlUbyA9IHVzZXJFbWFpbDsNCgkJCQlyZXF1ZXN0LnN1YmplY3QgPSAiU2VydmljZU1heCBOZWdhdGl2ZSBzdG9jayBhbGVydCEiOw0KCQkJCXJlcXVlc3QudG9BZGRyZXNzZXMgPSBlbWFpbFRvOyANCgkJCQl2YXIgZW1haWxNc2c7DQoJCQkJdmFyIHZUOw0KCQkJCWVtYWlsTXNnID0gU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMTIiKTsNCgkJCQkvLyJUaGUgZm9sbG93aW5nIHRyYW5zYWN0aW9uIGhhcyByZXN1bHRlZCBpbiBhIG5lZ2F0aXZlIHN0b2NrIHF1YW50aXR5LiBQbGVhc2UgdmVyaWZ5IHRoYXQgeW91ciBvcmdhbml6YXRpb24gZm9sbG93cyB0aGUgbmVjZXNzYXJ5IHByb2Nlc3NlcyB0byBtYWludGFpbiBpbnRlZ3JpdHkgb2Ygc3RvY2sgaW5mb3JtYXRpb24gaW4gU2VydmljZU1heC4gSWYgeW91ciBvcmdhbml6YXRpb24gaXMgZnVsbHkgY29tcGxpYW50IHdpdGggdGhlIHByb2Nlc3MgcmVxdWlyZW1lbnRzLCByZXBvcnQgdGhpcyBpc3N1ZSB0byBTZXJ2aWNlTWF4IHN1cHBvcnQgaW1tZWRpYXRlbHkuIjsJCQkNCgkJCQllbWFpbE1zZyA9IGVtYWlsTXNnICsgIlxuIiArICJcbiI7DQoNCgkJCQlpZiAoU1ZNWElfZ2V0UHJvZHVjdERldGFpbHMoc2tTYXZfdlByb2R1Y3RJZCkgPT0gdHJ1ZSAmJg0KCQkJCQkJU1ZNWElfZ2V0U2l0ZURldGFpbHMoc2tTYXZfdlNpdGVJRCkgPT0gdHJ1ZSAmJg0KCQkJCQkJICAgIFNWTVhJX2dldFVzZXJEZXRhaWxzKHNrU2F2X3ZVc2VySWQpID09IHRydWUpDQoJCQkJICAgIHsNCgkJCQkgICAgZW1haWxNc2cgPSBlbWFpbE1zZyArIFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDE1IikgKyAiICIgKyBza1Nhdl92VHJhbnNhY3Rpb25UeXBlICsgIlxuIiAgOw0KCQkJCSAgICBlbWFpbE1zZyA9IGVtYWlsTXNnICsgU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMTYiKSArICIgIiArIHNrU2F2X3ZUcmFuc2FjdGlvbk51bWJlciArICJcbiIgIDsNCgkJCQkgICAgZW1haWxNc2cgPSBlbWFpbE1zZyArIFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDE3IikgKyAiICIgKyBza1Nhdl92UHJvZCArICJcbiIgOyAgLy9BZGQgQ29kZSB0byBHZXQgUHJvZCBOYW1lL0RldGFpbHMNCgkJCQkgICAgZW1haWxNc2cgPSBlbWFpbE1zZyArIFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDE4IikgKyAiICIgKyBza1Nhdl92TG9jYXRpb24gKyAiXG4iIDsgLy8gQWRkIENvZGUgdG8gZ2V0IFNpdGUgTmFtZS9EZXRhaWxzDQoJCQkJICAgIGVtYWlsTXNnID0gZW1haWxNc2cgKyBTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAxOSIpICsgIiAiICsgc2tTYXZfdlN0YXR1cyArICJcbiIgIDsNCgkJCQkgICAgZW1haWxNc2cgPSBlbWFpbE1zZyArIFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDIwIikgKyAiICIgKyBza1Nhdl92cHNRdHkgKyAiXG4iICA7DQoJCQkJICAgIGVtYWlsTXNnID0gZW1haWxNc2cgKyBTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAyMSIpICsgIiAiICsgc2tTYXZfdlRyYW5zYWN0aW9uUXR5ICsgIlxuIiAgOw0KCQkJCSAgICBlbWFpbE1zZyA9IGVtYWlsTXNnICsgU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMjIiKSArICIgIiArIHNrU2F2X3Zwc1VwZFF0eSArICJcbiIgIDsNCgkJCQkgICAgZW1haWxNc2cgPSBlbWFpbE1zZyArIFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDIzIikgKyAiICIgKyBza1Nhdl92VXNlciArICJcbiI7DQoJCQkJICAgIGVtYWlsTXNnID0gZW1haWxNc2cgKyBTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAyNCIpICsgIiAiICsgc2tTYXZfdmN1cnJkYXRlICsgIlxuIjsNCgkJCQkgICAgLy9TVk1YSV9QdXRQcm9jZXNzTG9nKCJlbWFpbCBCb2R5OiAiICsgZW1haWxNc2cpOw0KCQkJCSAgICByZXF1ZXN0LnBsYWluVGV4dEJvZHkgPSBlbWFpbE1zZzsNCg0KCQkJCSAgICB2YXIgc2VuZE1haWxSZXMgPSBzZm9yY2UuY29ubmVjdGlvbi5zZW5kRW1haWwoW3JlcXVlc3RdKTsgDQoJCQkJICAgIHZhciBlUmVzdWx0cyA9IGVtYWlsUmVzdWx0cyhzZW5kTWFpbFJlcyk7DQoJCQkJICAgIH0NCgkJCQllbHNlDQoJCQkJICAgIHsJCQkJCQkNCgkJCQkgICAgU1ZNWElfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAxNCIpKTsJCQkJCQkJDQoJCQkJICAgIHJldHVybiB0cnVlOyAvL0J5IEdNIDIzSnVuMDgsIE9uIEVtYWlsIGVycm9yIGNvdW50aW51ZSB3aXRob3V0IGVycm9yLglDaGFuZ2VkIEZhbHNlIHRvIFRSVUUNCgkJCQkgICAgfQ0KCQkJICAgIH0NCgkJCWVsc2UgewkJCQkNCgkJCSAgICBTVk1YSV9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDE0IikpOw0KCQkJICAgIHJldHVybiB0cnVlOyAvL0J5IEdNIDIzSnVuMDgsIE9uIEVtYWlsIGVycm9yIGNvdW50aW51ZSB3aXRob3V0IGVycm9yLiBDaGFuZ2VkIEZhbHNlIHRvIFRSVUUNCgkJCSAgICB9DQoJCX0NCgkgICAgY2F0Y2goZSkgDQoJCXsJCQkJDQoJCQlTVk1YSV9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAyIikrZSk7DQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0NCgkgICAgfS8vIFNlbmQgRW1haWwgQ0xPU0UJDQoNCglpZiAoU1ZNWElfZ2V0UHJpY2VEZXRhaWxzKHNrU2F2X3ZQcm9kdWN0SWQsIHNrU2F2X3ZTaXRlSUQpID09IHRydWUpDQoJICAgIHsNCgkgICAgaWYoU1ZNWElfdXBkYXRlUHJvZHVjdFN0b2NrQ29zdCgpID09IHRydWUpDQoJCXsNCgkJdmFyIHNoaXN0UmVzID0gCVNWTVhJX2NyZWF0ZVN0b2NrSGlzdCgpOyANCgkJcmV0dXJuIHNoaXN0UmVzOw0KCQl9DQoJICAgIH0NCgllbHNlIHsJcmV0dXJuIGZhbHNlOwl9DQp9DQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV9nZXRQcmljZURldGFpbHMocHJvZElkLCBzaXRlSWQpDQp7DQoJdmFyIHNvcWxDb3N0QXQgPSAiU2VsZWN0IFNWTVhDX19Db3N0ZWRfYXRfdmFsdWVfX2MsU1ZNWENfX0ludmVudG9yeV9BY2NvdW50X19jICBmcm9tIFNWTVhDX19TaXRlX19jIiA7DQoJc29xbENvc3RBdCArPSAiIFdoZXJlIElkID0gJyIgKyBzaXRlSWQgKyAiJyI7DQoJdHJ5DQoJew0KCQl2YXIgcXJDb3N0ID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbENvc3RBdCk7IA0KCQlpZiAocXJDb3N0LnNpemUgPiAwKSANCgkJeyANCgkJCXZhciByZWNzQ29zdCA9IHFyQ29zdC5nZXRBcnJheSgicmVjb3JkcyIpOyANCgkJCXNrU2F2X3ZJbnZBY2N0ID0gcmVjc0Nvc3RbMF0uU1ZNWENfX0ludmVudG9yeV9BY2NvdW50X19jIDsgLy9uZXcgRmllbGQgYWRkZWQgdG8gU0l0ZSwgc2hvdWxkIGNvcHkgdmFsdWUgdG8gU3RvY2stSGlzdA0KCQkJaWYgKHJlY3NDb3N0WzBdLlNWTVhDX19Db3N0ZWRfYXRfdmFsdWVfX2MgPT0gdHJ1ZSB8fCByZWNzQ29zdFswXS5TVk1YQ19fQ29zdGVkX2F0X3ZhbHVlX19jID09ICJ0cnVlIikNCgkJCXsNCgkJCQl2YXIgc29xbFByaWNlID0gIlNlbGVjdCBTVk1YQ19fUHJvZHVjdF9Db3N0X19jIGZyb20gUHJvZHVjdDIiIDsNCgkJCQlzb3FsUHJpY2UgKz0gIiBXaGVyZSBJZCA9ICciICsgcHJvZElkICsgIiciOw0KCQkJCXRyeQ0KCQkJCXsNCgkJCQkJdmFyIHFyUHJpY2UgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsUHJpY2UpOyANCgkJCQkJaWYgKHFyUHJpY2Uuc2l6ZSA+IDApIA0KCQkJCQl7IA0KCQkJCQkJdmFyIHJlY3NQcmljZSA9IHFyUHJpY2UuZ2V0QXJyYXkoInJlY29yZHMiKTsgDQoJCQkJCQlza1Nhdl92UHJpY2UgPSByZWNzUHJpY2VbMF0uU1ZNWENfX1Byb2R1Y3RfQ29zdF9fYzsNCgkJCQkJCXJldHVybiB0cnVlOw0KCQkJCQl9IA0KCQkJCQllbHNlIHtza1Nhdl92UHJpY2UgPSAwO3JldHVybiB0cnVlO30NCgkJCQkJfSANCgkJCQljYXRjaChlKSANCgkJCQl7DQoJCQkJCVNWTVhJX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDIiKStlKTsNCgkJCQkJcmV0dXJuIGZhbHNlOw0KCQkJCX0NCgkJCX0NCgkJCWVsc2Uge3NrU2F2X3ZQcmljZSA9IDA7cmV0dXJuIHRydWU7fQ0KCQl9IA0KCQllbHNlIHtza1Nhdl92UHJpY2UgPSAwO3JldHVybiB0cnVlO30NCgl9IA0KCWNhdGNoKGUpIA0KCXsJCQkNCgkJU1ZNWElfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMiIpK2UpOw0KCQlyZXR1cm4gZmFsc2U7DQoJfQ0KfQkNCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3NrU2F2SXNWYWxpZFNpdGUoY1NpdGVJRCkNCnsNCgl2YXIgc29xbFZTID0gIlNlbGVjdCBTVk1YQ19fU3RvY2tpbmdfTG9jYXRpb25fX2MgICAiIDsNCglzb3FsVlMgKz0gIiBGcm9tIFNWTVhDX19TaXRlX19jICAgIjsNCglzb3FsVlMgKz0gIiB3aGVyZSBJZCA9ICciICsgY1NpdGVJRCAgKyAiJyI7DQoJLy9zb3FsVlMgKz0gIiBBbmQgU1ZNWENfX1N0b2NraW5nX0xvY2F0aW9uX19jID0gdHJ1ZSAiOyAgIC8vTm9uLXN0b2NrYWJsZSBzaXRlICBpcyBOT1QgYW4gZXJyb3IgaW4gUmVsIDIuMAlTeWVkIDA0LzMwLzIwMDgNCgkvLyBTVk1YSV9zU2VsX1B1dFByb2Nlc3NMb2coIlF1ZXJ5OiAiICsgc29xbFNTKTsgCQ0KCXRyeQ0KCXsNCgkJdmFyIHFyVlMgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsVlMpOyANCgkJaWYgKHFyVlMuc2l6ZSA+IDApIC8vIHNpdGUgaXMgVmFsaWQgLVN0b2NrYWJsZSANCgkJeyANCgkJCXJldHVybiB0cnVlOw0KCQl9IA0KCQllbHNlIHtyZXR1cm4gZmFsc2U7fQ0KCQl9DQoJY2F0Y2goZSkgDQoJewkJCSANCgkJIFNWTVhJX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDIiKStlKTsNCgkJIHJldHVybiBmYWxzZTsNCgl9DQp9CQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfc2tTYXZJc1ZhbGlkUHJvZHVjdChjUHJvZHVjdElkKQ0Kew0KCXZhciBzb3FsVlAgPSAiU2VsZWN0IFNWTVhDX19TdG9ja2FibGVfX2MgICIgOw0KCXNvcWxWUCArPSAiIEZyb20gUHJvZHVjdDIgICI7DQoJc29xbFZQICs9ICIgd2hlcmUgSWQgPSAnIiArIGNQcm9kdWN0SWQgICsgIiciOw0KIC8vCXNvcWxWUCArPSAiIEFuZCBTVk1YQ19fU3RvY2thYmxlX19jID0gdHJ1ZSAiOwkvL05vbi1zdG9ja2FibGUgIHByb2R1Y3QgaXMgTk9UIGFuIGVycm9yIGluIFJlbCAyLjAgICBTeWVkIDA0LzMwLzIwMDgNCgkvL2FsZXJ0KHNvcWxWUCk7DQoJLy8gU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKCJRdWVyeTogIiArIHNvcWxTUyk7IAkNCgl0cnkNCgl7DQoJCXZhciBxclZQID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbFZQKTsgDQoJCWlmIChxclZQLnNpemUgPiAwKSAvLyBQcm9kdWN0IGlzIFZhbGlkIC1UcmFja2lhYmxlIA0KCQl7IA0KCQkJcmV0dXJuIHRydWU7DQoJCX0gDQoJCWVsc2Uge3JldHVybiBmYWxzZTt9DQoJCX0NCgljYXRjaChlKSANCgl7CQkJIA0KCQkgU1ZNWElfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMiIpK2UpOw0KCQkgcmV0dXJuIGZhbHNlOw0KCX0NCn0JDQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV9za1NhdkdldFNlcnZpY2VNYXhTZXR0aW5ncygpDQp7DQoJdmFyIHNvcWxTUyA9ICJTZWxlY3QgU1ZNWENfX0VuYWJsZV9JbnZlbnRvcnlfTW9kdWxlX19jLCBTVk1YQ19fRW5hYmxlX1NlcmlhbF9UcmFja2luZ19fYyxTVk1YQ19fQ2hlY2tfU2VyaWFsX1VuaXF1ZW5lc3NfX2MgICAiIDsNCglzb3FsU1MgKz0gIiBGcm9tIFNWTVhDX19TZXJ2aWNlTWF4X1NldHRpbmdzX19jICAiOw0KCS8vIHNvcWxTUyArPSAiIHdoZXJlIFNWTVhDX19FbmFibGVfSW52ZW50b3J5X01vZHVsZV9fYyA9IHRydWUiOyBIUyBDb21tZW50ZWQgb3V0IDYvMjUvMjAwOSBub3QgbmVlZGVkLg0KCS8vIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZygiUXVlcnk6ICIgKyBzb3FsU1MpOyAJDQoJdHJ5DQoJew0KCQl2YXIgcXJTUyA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWxTUyk7IA0KCQlpZiAocXJTUy5zaXplID4gMCkgLy8gU2V0dGluZ3MgRm91bmQNCgkJeyANCgkJCXJldHVybiB0cnVlOw0KCQl9IA0KCQllbHNlIHtyZXR1cm4gZmFsc2U7fQ0KCQl9DQoJY2F0Y2goZSkgDQoJew0KCQkgcmV0dXJuIGZhbHNlOw0KCQkgU1ZNWElfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMiIpKyBlKTsNCgl9DQp9CQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfdXBkYXRlUHJvZHVjdFN0b2NrQ29zdCgpDQp7DQoJdmFyIHByb2RTdG9jayA9IG5ldyBzZm9yY2UuU09iamVjdCgiU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX2MiKTsNCglwcm9kU3RvY2suSWQgID0gc2tTYXZfdnBzSUQgOw0KCXByb2RTdG9jay5TVk1YQ19fUHJvZHVjdF9Db3N0X19jICA9IHNrU2F2X3ZQcmljZTsNCgl0cnkgDQoJew0KCXZhciByZXQgPSBzZm9yY2UuY29ubmVjdGlvbi51cGRhdGUoW3Byb2RTdG9ja10pOyAgICAgICAgIAkNCgkJcmV0dXJuIHRydWU7DQoJfQ0KCWNhdGNoKGUpIA0KCXsgICAgICAgIAkNCgkJU1ZNWElfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMSIpK2UpOw0KCXJldHVybiBmYWxzZTsNCgl9DQp9CQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfY3JlYXRlU3RvY2tIaXN0KCkNCnsNCgl2YXIgc2hpc3QgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19TdG9ja19IaXN0b3J5X19jIik7DQoJc2hpc3QuU1ZNWENfX1Byb2R1Y3RfX2MgID0gc2tTYXZfdlByb2R1Y3RJZCA7DQoJc2hpc3QuU1ZNWENfX0xvY2F0aW9uX19jID0gc2tTYXZfdlNpdGVJRCA7DQoJc2hpc3QuU1ZNWENfX1N0YXR1c19fYyAgPSBza1Nhdl92U3RhdHVzIDsNCglzaGlzdC5TVk1YQ19fVHJhbnNhY3Rpb25fVHlwZV9fYyAgPSBza1Nhdl92VHJhbnNhY3Rpb25UeXBlIDsNCglzaGlzdC5TVk1YQ19fUXVhbnRpdHlfYmVmb3JlX2NoYW5nZTJfX2MgID0gcGFyc2VGbG9hdChza1Nhdl92cHNRdHkpIDsNCglzaGlzdC5TVk1YQ19fVHJhbnNhY3Rpb25fUXVhbnRpdHkyX19jICA9IHBhcnNlRmxvYXQoc2tTYXZfdlRyYW5zYWN0aW9uUXR5KSA7DQoJc2hpc3QuU1ZNWENfX0NoYW5nZV9UeXBlX19jICA9IHNrU2F2X3ZDaGFuZ2VUeXBlIDsNCglzaGlzdC5TVk1YQ19fUXVhbnRpdHlfYWZ0ZXJfY2hhbmdlMl9fYyAgPSBwYXJzZUZsb2F0KHNrU2F2X3Zwc1VwZFF0eSkgOw0KLy8Jc2hpc3QuU1ZNWENfX0RhdGVfQ2hhbmdlZF9fYyAgPSBza1Nhdl92Y3VycmRhdGUgOw0KICAgIHNoaXN0LlNWTVhDX19EYXRlX0NoYW5nZWRfX2MgID0gU1ZNWElfR2V0Q3VycmVudFRpbWUoKTsgICAvLyBVcGRhdGVkIG9uIEZlYiA2LDIwMDkgYnkgU3llZA0KCXNoaXN0LlNWTVhDX19DaGFuZ2VkX0J5X19jICA9IHNrU2F2X3ZVc2VySWQgOw0KCXNoaXN0LlNWTVhDX19Db3N0X19jICA9IHNrU2F2X3ZQcmljZSA7DQoJc2hpc3QuU1ZNWENfX0N1cnJlbmN5X19jICA9IHNrU2F2X3ZJc29DdXJyQ29kZSA7DQoJc2hpc3QuU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX2MgID0gc2tTYXZfdnBzSUQgOw0KCXNoaXN0LlNWTVhDX19JbnZlbnRvcnlfQWNjb3VudF9fYyAgPSBza1Nhdl92SW52QWNjdDsNCg0KCWlmIChza1Nhdl92VHJhbnNhY3Rpb25UeXBlID09ICJSTUEiIHx8IHNrU2F2X3ZUcmFuc2FjdGlvblR5cGUgPT0gIlJNQSBSZWNlaXB0IikNCgl7DQoJCXNoaXN0LlNWTVhDX19STUFfX2MgID0gc2tTYXZfdkhlYWRlclJlZklkIDsNCgkJc2hpc3QuU1ZNWENfX1JNQV9MaW5lX19jICA9IHNrU2F2X3ZMaW5lUmVmZXJlbmNlSWQgOw0KCX0NCg0KCWlmIChza1Nhdl92VHJhbnNhY3Rpb25UeXBlID09ICJTaGlwbWVudCIpDQoJew0KCQlzaGlzdC5TVk1YQ19fU2hpcG1lbnRfX2MgID0gc2tTYXZfdkhlYWRlclJlZklkIDsNCgkJc2hpc3QuU1ZNWENfX1NoaXBtZW50X0xpbmVfX2MgID0gc2tTYXZfdkxpbmVSZWZlcmVuY2VJZCA7DQoJfQ0KDQoJaWYgKHNrU2F2X3ZUcmFuc2FjdGlvblR5cGUgPT0gIlNWTyBSZWNlaXB0IiB8fCBza1Nhdl92VHJhbnNhY3Rpb25UeXBlID09ICAiU1ZPIFVzYWdlIikNCgl7DQoJCXNoaXN0LlNWTVhDX19TZXJ2aWNlX09yZGVyX19jICA9IHNrU2F2X3ZIZWFkZXJSZWZJZCA7DQoJCXNoaXN0LlNWTVhDX19TZXJ2aWNlX09yZGVyX0xpbmVfX2MgID0gc2tTYXZfdkxpbmVSZWZlcmVuY2VJZCA7DQoJfQ0KDQoJaWYgKHNrU2F2X3ZUcmFuc2FjdGlvblR5cGUgPT0gIlBhcnRzIFJlY2VpcHQiKQ0KCXsNCgkJc2hpc3QuU1ZNWENfX1BhcnRzX1JlcXVlc3RfX2MgID0gc2tTYXZfdkhlYWRlclJlZklkIDsNCgkJc2hpc3QuU1ZNWENfX1BhcnRzX1JlcXVlc3RfTGluZV9fYyAgPSBza1Nhdl92TGluZVJlZmVyZW5jZUlkIDsNCgl9DQoNCglpZiAoc2tTYXZfdlRyYW5zYWN0aW9uVHlwZSA9PSAiU3RvY2sgVHJhbnNmZXIiKQ0KCXsNCgkJc2hpc3QuU1ZNWENfX1N0b2NrX1RyYW5zZmVyX19jICA9IHNrU2F2X3ZIZWFkZXJSZWZJZCA7DQoJCXNoaXN0LlNWTVhDX19TdG9ja19UcmFuc2Zlcl9MaW5lX19jICA9IHNrU2F2X3ZMaW5lUmVmZXJlbmNlSWQgOw0KCX0NCg0KCWlmIChza1Nhdl92VHJhbnNhY3Rpb25UeXBlID09ICJTdG9jayBBZGp1c3RtZW50IikNCgl7DQoJCXNoaXN0LlNWTVhDX19TdG9ja19BZGp1c3RtZW50X19jICAgPSBza1Nhdl92SGVhZGVyUmVmSWQgOwkJDQoJfQ0KDQoJaWYgKHBhcnNlRmxvYXQoc2tTYXZfdnBzVXBkUXR5KSA8IDAgKSB7c2hpc3QuU1ZNWENfX05lZ2F0aXZlX1N0b2NrX19jICAgPSB0cnVlO30NCgllbHNlIHtzaGlzdC5TVk1YQ19fTmVnYXRpdmVfU3RvY2tfX2MgICA9IGZhbHNlO30NCglzaGlzdC5TVk1YQ19fTm90aWZpZWRfVXNlcl9fYyAgICA9IHNrU2F2X3ZlbWFpbFRvVXNlcklkIDsNCg0KCXRyeSANCgl7DQoJdmFyIHJldCA9IHNmb3JjZS5jb25uZWN0aW9uLmNyZWF0ZShbc2hpc3RdKTsNCglpZiAocmV0WzBdLmdldEJvb2xlYW4oInN1Y2Nlc3MiKSkgDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgfSANCiAgICAgICAgICAgICAgICBlbHNlIA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQocmV0WzBdLmVycm9ycy5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgIH0NCgkvL1NWTVhJX1B1dFByb2Nlc3NMb2coIlRyYW5zYWN0aW9uIEFkZGVkIGluIFN0b2NrIEhpc3RvcnkgT2JqZWN0OiAiKTsNCglyZXR1cm4gdHJ1ZTsNCgl9DQoJY2F0Y2goZSkgDQoJeyAgICAgICAgCQ0KCQlTVk1YSV9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAxIikrZSk7DQoJcmV0dXJuIGZhbHNlOw0KCX0NCn0JDQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV91cGRQUyhwc0lkLHBzUXR5LCBwc1RyYW5zUXR5LCBwc0NoZ1R5cCkNCnsNCgl2YXIgcmV0VXBkUXR5ID0gMDsgLy9UaGlzIGNvdWxkIGJlIE5lZ2F0aXZlIGFsc28sICdTZW5kIE5lZ2F0aXZlJw0KCWlmIChwc0NoZ1R5cCA9PSAiSW5jcmVhc2UiKXtyZXRVcGRRdHkgPSBwYXJzZUZsb2F0KHBzUXR5KSArIHBhcnNlRmxvYXQocHNUcmFuc1F0eSk7IH0NCglpZiAocHNDaGdUeXAgPT0gIkRlY3JlYXNlIil7cmV0VXBkUXR5ID0gcGFyc2VGbG9hdChwc1F0eSkgLSBwYXJzZUZsb2F0KHBzVHJhbnNRdHkpOyB9DQoJaWYgKHBzQ2hnVHlwID09ICJTZXQiKXtyZXRVcGRRdHkgPSBwYXJzZUZsb2F0KHBzVHJhbnNRdHkpOyB9DQoJLy8gVXBkYXRlIG5ldyBRdHkgaW4gUFMNCgl2YXIgcHNVcGQgPSBuZXcgc2ZvcmNlLlNPYmplY3QoIlNWTVhDX19Qcm9kdWN0X1N0b2NrX19jIik7DQoJcHNVcGQuaWQgID0gcHNJZDsNCglpZiAocmV0VXBkUXR5IDwgMCApIHtwc1VwZC5TVk1YQ19fUXVhbnRpdHkyX19jICA9IDAgO30NCgllbHNlIHtwc1VwZC5TVk1YQ19fUXVhbnRpdHkyX19jICA9IHJldFVwZFF0eTt9DQoJdHJ5IA0KCXsNCgl2YXIgcmV0ID0gc2ZvcmNlLmNvbm5lY3Rpb24udXBkYXRlKFtwc1VwZF0pOyANCgkvL1NWTVhJX1B1dFByb2Nlc3NMb2coIlVwZGF0ZWQgUFMgUXR5OiAiKTsNCgl9DQoJY2F0Y2goZSkgDQoJeyAgICAgICAgCQ0KCQlTVk1YSV9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAxIikrZSk7DQoJfQ0KCXNrU2F2X3Zwc0lEID0gcmV0WzBdLmlkOw0KCS8vaWYocHNUcmFuc1F0eSA9PSAwKSB7cmV0dXJuIDA7fQ0KCXJldHVybiByZXRVcGRRdHk7DQp9CQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfZ2V0VXNlckRldGFpbHModXNlcklkKQ0Kew0KCXZhciBzb3FsVXNlciA9ICJTZWxlY3QgTmFtZSBmcm9tIFVzZXIgIiA7DQoJc29xbFVzZXIgPSBzb3FsVXNlciArICIgV2hlcmUgSWQgPSAnIiArIHVzZXJJZCArICInIjsNCgkvL1NWTVhJX1B1dFByb2Nlc3NMb2coIlF1ZXJ5OiAiICsgc29xbFVzZXIpOyAJDQoJdHJ5DQoJCXsNCgkJCXZhciBxclVzZXIgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsVXNlcik7IA0KCQkJaWYgKHFyVXNlci5zaXplID4gMCkgDQoJCQl7IA0KCQkJCXZhciByZWNzVXNlciA9IHFyVXNlci5nZXRBcnJheSgicmVjb3JkcyIpOyANCgkJCQlza1Nhdl92VXNlciA9IHJlY3NVc2VyWzBdLk5hbWU7IA0KCQkJCXJldHVybiB0cnVlOw0KCQkJfSANCgkJCWVsc2Uge3NrU2F2X3ZVc2VyID0gIiI7cmV0dXJuIHRydWU7fQ0KCQl9IA0KCQljYXRjaChlKSANCgkJewkJCQkNCgkJCVNWTVhJX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDIiKStlKTsNCgkJCXJldHVybiBmYWxzZTsNCgkJfQ0KfQkNCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX2dldFByb2R1Y3REZXRhaWxzKHByb2RJZCkNCnsNCgl2YXIgc29xbFByb2QgPSAiU2VsZWN0IE5hbWUgZnJvbSBQcm9kdWN0MiAiIDsNCglzb3FsUHJvZCA9IHNvcWxQcm9kICsgIiBXSEVSRSBJZCA9ICciICsgcHJvZElkICsgIiciOw0KCS8vU1ZNWElfUHV0UHJvY2Vzc0xvZygiUXVlcnk6ICIgKyBzb3FsUHJvZCk7IAkNCgl0cnkNCgkJew0KCQkJdmFyIHFyUHJvZCA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWxQcm9kKTsgDQoJCQlpZiAocXJQcm9kLnNpemUgPiAwKSANCgkJCXsgDQoJCQkJdmFyIHJlY3NQcm9kID0gcXJQcm9kLmdldEFycmF5KCJyZWNvcmRzIik7IA0KCQkJCXNrU2F2X3ZQcm9kID0gcmVjc1Byb2RbMF0uTmFtZTsgDQoJCQkJcmV0dXJuIHRydWU7DQoJCQl9IA0KCQkJZWxzZSB7c2tTYXZfdlByb2QgPSAiIjtyZXR1cm4gdHJ1ZTt9DQoJCX0gDQoJCWNhdGNoKGUpIA0KCQl7CQkJCQ0KCQkJU1ZNWElfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMiIpK2UpOw0KCQkJcmV0dXJuIGZhbHNlOw0KCQl9DQp9CQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfZ2V0U2l0ZURldGFpbHMoc2l0ZUlkKQ0Kew0KCXZhciBzb3FsU2l0ZSA9ICJTZWxlY3QgTmFtZSBmcm9tIFNWTVhDX19TaXRlX19jICIgOw0KCXNvcWxTaXRlID0gc29xbFNpdGUgKyAiIFdIRVJFIElkID0gJyIgKyBzaXRlSWQgKyAiJyI7DQoJLy9TVk1YSV9QdXRQcm9jZXNzTG9nKCJRdWVyeTogIiArIHNvcWxTaXRlKTsgCQ0KCXRyeQ0KCQl7DQoJCQl2YXIgcXJTaXRlID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbFNpdGUpOyANCgkJCWlmIChxclNpdGUuc2l6ZSA+IDApIA0KCQkJeyANCgkJCQl2YXIgcmVjc1NpdGUgPSBxclNpdGUuZ2V0QXJyYXkoInJlY29yZHMiKTsgDQoJCQkJc2tTYXZfdkxvY2F0aW9uID0gcmVjc1NpdGVbMF0uTmFtZTsgDQoJCQkJcmV0dXJuIHRydWU7DQoJCQl9IA0KCQkJZWxzZSB7c2tTYXZfdkxvY2F0aW9uID0gIiI7IHJldHVybiB0cnVlO30NCg0KCQl9IA0KCQljYXRjaChlKSANCgkJewkJCQkNCgkJCVNWTVhJX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDIiKStlKTsNCgkJCXJldHVybiBmYWxzZTsNCgkJfQ0KfQkNCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIGVtYWlsUmVzdWx0cyhzZW5kRW1haWxSZXN1bHQpIA0KeyANCglpZiAoc2VuZEVtYWlsUmVzdWx0Lmxlbmd0aCA+IDApIHsNCgkJaWYgKHNlbmRFbWFpbFJlc3VsdFswXS5nZXRCb29sZWFuKCJzdWNjZXNzIikpIHsJU1ZNWElfUHV0UHJvY2Vzc0xvZygiIik7IHJldHVybiB0cnVlO30gLy9Ob3RpZmljYXRpb24gRS1tYWlsIHNlbnQNCgkJZWxzZSB7CVNWTVhJX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMTMiKSk7IHJldHVybiB0cnVlO30gLy9CeSBHTTIzSnVuMDggQ2hhbmdlZCBGYWxzZSB0byBUUlVFDQoJfSANCgllbHNlIHsgU1ZNWElfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAxMyIpKTsJcmV0dXJuIHRydWU7fSAvL0J5IEdNMjNKdW4wOCBDaGFuZ2VkIEZhbHNlIHRvIFRSVUUNCn0NCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX1B1dFByb2Nlc3NMb2coTXNnKSANCnsgDQoJaWYgKHNrU2F2X3Byb2Nlc3NMb2cpIHsgc2tTYXZfcHJvY2Vzc0xvZyArPSAiXG4iOyB9IA0KCXNrU2F2X3Byb2Nlc3NMb2cgKz0gTXNnOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQpmdW5jdGlvbiBTVk1YSV9HZXREb2N1bWVudElkKGRvY05hbWUpDQp7DQoJdmFyIHNvcWxEb2MgPSAiU2VsZWN0IElkLE5hbWUgRnJvbSBEb2N1bWVudCIgOw0KCXNvcWxEb2MgPSBzb3FsRG9jICsgIiBXaGVyZSBOYW1lID0gJyIgKyBkb2NOYW1lICsgIiciOw0KCXZhciBxckRvYyA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWxEb2MpOyANCglpZiAocXJEb2Muc2l6ZSA+IDApIA0KCXsgDQoJCQl2YXIgcmVjcyA9IHFyRG9jLmdldEFycmF5KCJyZWNvcmRzIik7IA0KCQkJcmV0dXJuIHJlY3NbMF0uSWQ7IA0KCX0gDQoJZWxzZSB7IHJldHVybiAiIjsgfQ0KfQ0KDQp2YXIgQXBpU2Vzc2lvbklkOw0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gU2VyaWFsIE51bWJlciBTZWxlY3Rpb24gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KdmFyIHNTZWxfUHJvZFF0eUFyOyAvL0FycmF5IGhhcywgUHJvZCwgUXR5LCBGcm9tU2l0ZSwgU3JvbVN0YXR1cywgVG9TaXRlLFRvIFN0YXR1cw0KdmFyIHNTZWxfVHJhbnNhY3Rpb25UeXBlOw0KdmFyIHNTZWxfVHJhbnNhY3Rpb25OdW1iZXI7IA0KdmFyIHNTZWxfVXNlcklkIDsNCnZhciBzU2VsX0RvY0lkOw0KdmFyIHNTZWxfb3BlbldpbkhkbDsNCnZhciBzU2VsX01zZ0xpc3QgPSBuZXcgQXJyYXkoKTsNCg0KLy8gQ2FsbGluZyBNZXRob2QgLSBUaGlzIHdpbGwgTGF1bmNoIEdlbmVyaWMgVXRpbGl0eSBmb3IgU2VyaWFsIE51bWJlciBzZWxlY3Rpb24NCmZ1bmN0aW9uIFNWTVhJX0RvU2VyaWFsU2VsZWN0aW9uKGNQcm9kUXR5QXIsIGNUcmFuc2FjdGlvblR5cGUsIGNUcmFuc2FjdGlvbk51bWJlciwgY1VzZXJJZCwgY0FwaVNlc3Npb25JZCkNCnsNCglzU2VsX0RvY0lkID0gIFNWTVhJX0dldERvY3VtZW50SWQoIlNWTVhJX1NlcmlhbF9TZWxlY3Rpb25fVXRpbGl0eSIpIDsgDQoJc1NlbF9Qcm9kUXR5QXIgPSBjUHJvZFF0eUFyOw0KCXNTZWxfVHJhbnNhY3Rpb25UeXBlID0gY1RyYW5zYWN0aW9uVHlwZTsNCglzU2VsX1RyYW5zYWN0aW9uTnVtYmVyID1jVHJhbnNhY3Rpb25OdW1iZXI7IA0KCXNTZWxfVXNlcklkID1jVXNlcklkOw0KCUFwaVNlc3Npb25JZCA9IGNBcGlTZXNzaW9uSWQ7DQoJU1ZNWElfc1NlbF9Jbml0TWVzc2FnZUxpc3QoIlNTRUxTQzEiKTsNCglTVk1YSV9zU2VsX1Byb2Nlc3NTZXJpYWxTZWxlY3Rpb24oc1NlbF9Qcm9kUXR5QXIsIHNTZWxfVHJhbnNhY3Rpb25UeXBlLCBzU2VsX1RyYW5zYWN0aW9uTnVtYmVyLCBzU2VsX1VzZXJJZCkgDQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX3NTZWxfU2VyaWFsU2VsZWN0aW9uUmVzdWx0cyhyZXN1bHRBciwgdHJhbnNUeXBlKQ0Kew0KCS8vIENhbGxiYWNrIEZ1bmN0aW9uLCB3b3VsZCBiZSBjYWxsZWQgb24gU3VibWl0L2NhbmNlbCBpbiBzZXJpYWwtU2VsZWN0aW9uIA0KCS8vQmFzZWQgb24gdHJhbnNhY3Rpb24gdHlwZSwgUmVzdWx0IHdpbGwgYmUgRm9yd2FkZWQNCgkvL3RyYW5zVHlwZTogUk1BLCBTaGlwbWVudCwgU1ZPIFJlY2VpcHQsIFNWTyBVc2FnZSwgUGFydHMgUmVjZWlwdCwgU3RvY2sgVHJhbnNmZXIsIFN0b2NrIEFkanVzdG1lbnQpDQoJLy9yZXN1bHRBclswXTogdHJ1ZS9mYWxzZTsgcmVzdWx0QXJbMV06UmVjb3JkQ291bnQ7IHJlc3VsdEFyWzJdOiBQcm9kQXJyYXkNCglpZiAoc1NlbF9vcGVuV2luSGRsKSB7c1NlbF9vcGVuV2luSGRsLmNsb3NlKCk7fQ0KCXN3aXRjaCh0cmFuc1R5cGUpDQoJCXsNCgkJY2FzZSAiUk1BIjoNCgkJICBTVk1YSV9DYWxsYmFja19Qcm9jZXNzUFJSZWNlaXB0cyhyZXN1bHRBclswXSxyZXN1bHRBclsxXSxyZXN1bHRBclsyXSk7DQoJCSAgYnJlYWs7ICAgIA0KCQljYXNlICJSTUEgUmVjZWlwdCI6DQoJCSAgU1ZNWElfQ2FsbGJhY2tfUHJvY2Vzc1JNQVJlY2VpcHRzKHJlc3VsdEFyWzBdLHJlc3VsdEFyWzFdLHJlc3VsdEFyWzJdKTsNCgkJICBicmVhazsgICAgDQoJCWNhc2UgIlNoaXBtZW50IjoNCgkJICBTVk1YSV9DYWxsYmFja19Qcm9jZXNzU2hpcG1lbnQocmVzdWx0QXJbMF0scmVzdWx0QXJbMV0scmVzdWx0QXJbMl0pOw0KCQkgIGJyZWFrOyAgICANCgkJY2FzZSAiU1ZPIFJlY2VpcHQiOg0KCQkgIFNWTVhJX0NhbGxiYWNrX1Byb2Nlc3NTVk9SZWNlaXB0cyhyZXN1bHRBclswXSxyZXN1bHRBclsxXSxyZXN1bHRBclsyXSk7DQoJCSAgYnJlYWs7ICAgIA0KCQljYXNlICJTVk8gVXNhZ2UiOg0KCQkgIFNWTVhJX0NhbGxiYWNrX1Bvc3RTVk9Vc2FnZShyZXN1bHRBclswXSxyZXN1bHRBclsxXSxyZXN1bHRBclsyXSk7DQoJCSAgYnJlYWs7ICAgIA0KCQljYXNlICJQYXJ0cyBSZWNlaXB0IjoNCgkJICBTVk1YSV9DYWxsYmFja19Qcm9jZXNzUFJSZWNlaXB0cyhyZXN1bHRBclswXSxyZXN1bHRBclsxXSxyZXN1bHRBclsyXSk7DQoJCSAgYnJlYWs7ICAgIA0KCQljYXNlICJTdG9jayBUcmFuc2ZlciI6DQoJCSAgU1ZNWElfQ2FsbGJhY2tfU3RvY2tUcmFuc2ZlcihyZXN1bHRBclswXSxyZXN1bHRBclsxXSxyZXN1bHRBclsyXSk7DQoJCSAgYnJlYWs7ICAgIA0KCQljYXNlICJTdG9jayBBZGp1c3RtZW50IjoNCgkJICBTVk1YSV9DYWxsYmFja19TdG9ja0FkanVzdG1lbnQocmVzdWx0QXJbMF0scmVzdWx0QXJbMV0scmVzdWx0QXJbMl0pOw0KCQkgIGJyZWFrOyAgICANCgkJZGVmYXVsdDoNCgkJfQ0KfQ0KLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8NCnZhciBzU2VsX3Byb2Nlc3NMb2cgPSAiIjsNCnZhciB2UHJvZFF0eUFyOw0KdmFyIHZVc2VyOyAvLyBTdG9yZXMgVXNlciBOYW1lL2RlYWlscyANCnZhciB2UHJvZDsgLy8gU3RvcmVzIHByb2R1Y3QgTmFtZS9kZWFpbHMgDQp2YXIgdlRyYW5zYWN0aW9uVHlwZTsgLy8oUk1BLCBTaGlwbWVudCwgU1ZPIFJlY2VpcHQsIFNWTyBVc2FnZSwgUGFydHMgUmVjZWlwdCwgU3RvY2sgVHJhbnNmZXIsIFN0b2NrIEFkanVzdG1lbnQpDQp2YXIgdlRyYW5zYWN0aW9uTnVtYmVyOyANCnZhciB2VXNlcklkOw0KdmFyIHZjdXJyZGF0ZTsgDQp2YXIgcmVzRGV0YWlsQXIgPSBuZXcgQXJyYXkoKTsgLy8gVGhpcyB3b3VsZCBiZSBvbmUgb2YgdGhlIHJldHVybiBpdGVtIGluIHJlc3VsdCBhcnJheQ0KdmFyIHJlc0FycmF5ID0gbmV3IEFycmF5KDQpOyAvL1Jlc3VsdCBBcnJheSAoT3V0cHV0KSAsIHRoaXMgd291bGQgYmUgb25lIHJldHVybiBvYmplY3QgdG8gY2FsbGluZyBtZXRob2QNCnZhciB2RW5JbnZlbnRvcnk7IC8vIHRvIHN0b3JlIElOVkVOVE9SWSBNT0RVTEUgaXMgRW5hYmxlZCBvciBOT1QNCnZhciB2RW5TZXJpYWxUcmFja2luZzsgLy8gdG8gc3RvcmUgU2VyaWFsIE5vIFRyYWNraW5nIGlzIEVuYWJsZWQgb3IgTm90DQp2YXIgdkVuU2VyaWFsVW5pcXVlbmVzczsgLy8gVG8gc3RvcmU6IFR5cGUgb2YgU2VyaWFsIE5vIFVuaXF1ZW5lc3MgZW5mb3JjZWQgDQp2YXIgcmVzU3RhdHVzID0gZmFsc2U7DQp2YXIgdlJlY0NvdW50Ow0KdmFyIHZhbGlkUHJvZEFyOyAvL0FycmF5IG9mIFZhbGlkIFNlcmlhbGl6ZSBQcmR1Y3RzIC1GaWxsZWQgaW4gcnVuLXRpbWUNCnZhciBhdGxlYXN0T25lVmFsaWRQcm9kRm91bmQ7IA0KdmFyCXNlbFByb2RJZDsgLy8gdG8gc3RvcmUgc2VsZWN0ZWQgcHJvZA0KdmFyIHNlbFByb2RRdHk7IC8vIFRvIHN0b3JlIHNlbCBwcm9kdWN0IHF0eQ0KdmFyIHNlbEZyb21TaXRlSUQ7DQp2YXIgc2VsRnJvbVN0YXR1czsNCnZhciBzZWxGcm9tUFNJRCA9IiI7IC8vRmluZCBhbmQgc3RvcmUgUyBpZCBpbiB0aGlzIHZhciwgVXNlZCB3aGlsZSByZXR1cm5pbmcgcmVzdWx0cw0KdmFyIHNlbFRvU2l0ZUlEOw0KdmFyIHNlbFRvU3RhdHVzOw0KdmFyIHNlbFRvUFNJRCA9IiI7IC8vRmluZCBhbmQgU3RvcmUgaW4gdGhpcyBWYXIsIFVzZWQgd2hpbGUgcmV0dXJuaW5nIHJlc3VsdHMNCnZhciBmcm9tU2VyaWFsczsNCnZhciB0b1NlcmlhbHM7DQp2YXIgc2VsVmFsaWRQcm9kSW5kZXg7IC8vdG8gc3RvcmUgdGhlIEluZGV4IG9mIERpc3BsYXllZCBQcm9kdWN0DQp2YXIgZXhjUXR5RXJyRGlzcGxheWVkID0gZmFsc2U7IC8vIFRvIFRyYWNrIGVyciBzaG91bGQgYmUgZGlzcGxheSBvbmx5IG9uY2Ugb24gbXVsdGlwbGUgTW92ZXMvIHF1aWNrLUFkZCBvZiBTTiANCnZhciB2RXJyID0iIjsgLy90byBTdG9yZSB0aGUgRXJyIE1zZyBvbiBTZXJpYWwgTm8gVW5pcXVlbmVzcw0KdmFyIHZFcnJMaXN0ID0iIjsgLy90byBTdG9yZSBkZXRhaWxzIG9mIExpbmUgSXRlbXMgKFNubyAtRHVwbGljYXRlcykNCnZhciB2UXR5RXJyID0iIjsNCnZhciB2UXR5RXJyTGlzdCA9ICIiOw0KdmFyIHRvdFNOcmVxID0gMDsNCnZhciBsYXN0RHJhd25JbmRleDsNCnZhciB2QXBpU2Vzc2lvbklkOw0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfc1NlbF9Qcm9jZXNzU2VyaWFsU2VsZWN0aW9uKGNQcm9kUXR5QXIsIGNUcmFuc2FjdGlvblR5cGUsIGNUcmFuc2FjdGlvbk51bWJlciwgY1VzZXJJZCkgDQp7DQogICAgdmN1cnJkYXRlID0gbmV3IERhdGUoKTsgDQogICAgdlByb2RRdHlBciA9IGNQcm9kUXR5QXI7DQogICAgdlRyYW5zYWN0aW9uVHlwZSA9IGNUcmFuc2FjdGlvblR5cGU7DQogICAgdlRyYW5zYWN0aW9uTnVtYmVyID0gY1RyYW5zYWN0aW9uTnVtYmVyOyANCiAgICB2VXNlcklkID1jVXNlcklkOw0KICAgIHRvdFNOcmVxID0gMDsNCiAgICAvL2xvb3AgSW5wdXQgQXJyYXkgYW5kIGNhbGMgdG90YWwgU04gcmVxLg0KICAgIGZvciAodmFyIGE9MDsgYTx2UHJvZFF0eUFyLmxlbmd0aDsgYSsrKQ0KICAgIHsNCgkgICAgaWYgKHZQcm9kUXR5QXJbYV1bMV0pIHsJdG90U05yZXEgKz0gICBwYXJzZUludCh2UHJvZFF0eUFyW2FdWzFdKTt9DQogICAgfQ0KICAgIHRvU2VyaWFscyA9IFNWTVhJX011bHRpRGltZW5zaW9uYWxBcnJheShwYXJzZUludCh0b3RTTnJlcSksMyk7DQogICAgaXNGaXJzdFRpbWVEcmF3biA9IGZhbHNlOw0KDQoNCiAgICBpZiAoU1ZNWElfc1NlbF9nZXRTZXJ2aWNlTWF4U2V0dGluZ3MoKSA9PSB0cnVlKQ0KCXsNCglpZiAoIHZFbkludmVudG9yeSA9PSAiZmFsc2UiIHx8IHZFblNlcmlhbFRyYWNraW5nID09ICJmYWxzZSIgKSAvL0NoZWNrIGlmIEludmVudG9yeSBNb2R1bGUgJiBTZXJpYWxUcmFja2luZyBpcyBlbmFibGVkDQoJICAgIHsJCQkJCQ0KCSAgICBTVk1YSV9zU2VsX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDMiKSk7DQoJICAgIFNWTVhJX3NTZWxfYnVpbGRSZXN1bHRBcnJheShmYWxzZSk7DQoJICAgIC8vcmV0dXJuIHRydWU7DQoJICAgIH0NCgllbHNlIC8vSW5pdGlhdGUgU2VyaWFsIFNlbGVjdGlvbg0KCSAgICB7DQoJICAgIGlmICggU1ZNWElfc1NlbF92YWxpZGF0ZUlucHV0cygpID09IHRydWUpDQoJCXsNCgkJaWYgKGF0bGVhc3RPbmVWYWxpZFByb2RGb3VuZCA9PSBmYWxzZSkgDQoJCSAgICB7IAkJCQkJCQ0KCQkgICAgU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDA0IikpOw0KCQkgICAgU1ZNWElfc1NlbF9idWlsZFJlc3VsdEFycmF5KGZhbHNlKTsgDQoJCSAgICB9DQoJCWVsc2UgDQoJCSAgICB7DQoJCSAgICB2YXIgbGVuRnJvbVNOID0wOyAvL0RlZmluaW5nIFNpemUgb2YgRnJvbSBTZXJpYWwNCgkJICAgIGZvciAodmFyIHo9MDsgejx2YWxpZFByb2RBci5sZW5ndGg7eisrKQ0KCQkJewkJCQkNCgkJCWlmKHZhbGlkUHJvZEFyW3pdWzBdICE9ICIiKQ0KCQkJICAgIHsNCgkJCSAgICBsZW5Gcm9tU04gKz0gcGFyc2VJbnQoU1ZNWElfc1NlbF9nZXRGcm9tU05jb3VudCh2YWxpZFByb2RBclt6XVswXSx2YWxpZFByb2RBclt6XVszXSx2YWxpZFByb2RBclt6XVsyXSkpOyANCgkJCSAgICB9DQoJCQl9DQoJCQlmcm9tU2VyaWFscyA9ICBTVk1YSV9NdWx0aURpbWVuc2lvbmFsQXJyYXkobGVuRnJvbVNOLDIpOwkJCQkJCQ0KCQkJLy8vLyBFeHRyYWN0IHNlcmlhbCBOb3MgZm9yIEFsbCBQcm9kdWN0cyBpbiBWYWxpZEFycmF5IGFuZCBEcmF3IHBhZ2UuDQoJCQlmb3IgKHZhciB6PTA7IHo8dmFsaWRQcm9kQXIubGVuZ3RoO3orKykNCgkJCSAgICB7DQoJCQkgICAgc2VsUHJvZElkID0gdmFsaWRQcm9kQXJbel1bMF07IC8vUHJvZHVjdCBpbiBWYWxpZCBBcnJheSANCgkJCSAgICBzZWxQcm9kUXR5ID0gdmFsaWRQcm9kQXJbel1bMV07IC8vUHJvZHVjdCdzIFF1YW50aXR5IGluIFZhbGlkIEFycmF5IA0KCQkJICAgIHNlbEZyb21TaXRlSUQgPSB2YWxpZFByb2RBclt6XVsyXTsNCgkJCSAgICBzZWxGcm9tU3RhdHVzID0gdmFsaWRQcm9kQXJbel1bM107DQoJCQkgICAgc2VsVG9TaXRlSUQgPSB2YWxpZFByb2RBclt6XVs0XTsNCgkJCSAgICBzZWxUb1N0YXR1cyA9IHZhbGlkUHJvZEFyW3pdWzVdOwkJCQkJCQ0KCQkJICAgIGlmICh2YWxpZFByb2RBclt6XVswXSAhPSAiIikNCgkJCQl7DQoJCQkJU1ZNWElfc1NlbF9jaGVja0lmRXhpc3RJblBTKHZhbGlkUHJvZEFyW3pdWzBdLHZhbGlkUHJvZEFyW3pdWzNdLHZhbGlkUHJvZEFyW3pdWzJdKSAvLyhzZWxQcm9kSWQsc2VsRnJvbVN0YXR1cyxzZWxGcm9tU2l0ZUlEKTsgCQkvLy8vZ2V0IGN1cnJlbnQgc3RvY2sgaW4gRnJvbSBTaXRlIGFuZCBGcm9tIFN0YXR1cyAoU1ZNWENfX1F1YW50aXR5Ml9fYyBmcm9tIFNWTVhDX19Qcm9kdWN0X1N0b2NrX19jKS4gDQoJCQkJfQ0KCQkJICAgIH0NCgkJCXNlbFZhbGlkUHJvZEluZGV4ID0gMDsNCgkJCXNlbFByb2RJZCA9IHZhbGlkUHJvZEFyW3NlbFZhbGlkUHJvZEluZGV4XVswXTsgLy9Qcm9kdWN0IGluIFZhbGlkIEFycmF5IA0KCQkJc2VsUHJvZFF0eSA9IHZhbGlkUHJvZEFyW3NlbFZhbGlkUHJvZEluZGV4XVsxXTsgLy9Qcm9kdWN0J3MgUXVhbnRpdHkgaW4gVmFsaWQgQXJyYXkgDQoJCQlzZWxGcm9tU2l0ZUlEID0gdmFsaWRQcm9kQXJbc2VsVmFsaWRQcm9kSW5kZXhdWzJdOw0KCQkJc2VsRnJvbVN0YXR1cyA9IHZhbGlkUHJvZEFyW3NlbFZhbGlkUHJvZEluZGV4XVszXTsNCgkJCXNlbFRvU2l0ZUlEID0gdmFsaWRQcm9kQXJbc2VsVmFsaWRQcm9kSW5kZXhdWzRdOw0KCQkJc2VsVG9TdGF0dXMgPSB2YWxpZFByb2RBcltzZWxWYWxpZFByb2RJbmRleF1bNV07DQoJCQlpc0ZpcnN0VGltZURyYXduID0gdHJ1ZTsJCQkJCQkNCgkJCWlmICh0b3RTTnJlcSA+IDApIC8vTGF1bmNoIE5ldyBXaW5kb3cgLSBpZiByZXEgU04gY291bnQgYXJlIG1vcmUgdGhhbiBaRVJPDQoJCQkgICAgew0KCQkJICAgIHNTZWxfb3BlbldpbkhkbCA9IHdpbmRvdy5vcGVuICgiL3NlcnZsZXQvc2VydmxldC5GaWxlRG93bmxvYWQ/ZmlsZT0iICsgc1NlbF9Eb2NJZCAsInNlbHNlcmlhbCIsInN0YXR1cz15ZXMsIGxvY2F0aW9uPW5vLCB0b29sYmFyPW5vLCBkaXJlY3Rvcmllcz1ubywgcmVzaXphYmxlPXllcywgd2lkdGg9NjUwLCBoZWlnaHQ9NjAwLCBzY3JvbGxiYXJzPXllcyIpOw0KCQkJICAgIH0NCgkJCWVsc2Uge1NWTVhJX3NTZWxfYnVpbGRSZXN1bHRBcnJheShmYWxzZSk7fQ0KCQkgICAgfQ0KCQl9DQoJICAgIGVsc2UgDQoJCXsgDQoJCS8vU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKCJFcnJvciBpbiBHaXZlbiBJbnB1dCBQYXJhbWV0ZXJzISIpOyANCgkJU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDA1IikpOw0KCQlTVk1YSV9zU2VsX2J1aWxkUmVzdWx0QXJyYXkoZmFsc2UpOw0KCQl9CQkNCgkgICAgfQ0KCX0NCiAgICBlbHNlIA0KCXsgCQkJDQoJU1ZNWElfc1NlbF9idWlsZFJlc3VsdEFycmF5KGZhbHNlKTsNCgl9CQkNCn0NCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3NTZWxfZ2V0RnJvbVNOY291bnQocHJvZElkLCBzdCwgc2l0ZSkNCnsNCgl2YXIgc29xbCA9ICJTZWxlY3QgSWQsIE5hbWUsIFNWTVhDX19Qcm9kdWN0X1N0b2NrX19jICAiIDsNCglzb3FsID0gc29xbCArICIgRnJvbSBTVk1YQ19fUHJvZHVjdF9TZXJpYWxfX2MgIjsNCglzb3FsID0gc29xbCArICIgV0hFUkUgU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX3IuU1ZNWENfX1N0YXR1c19fYyA9ICciICsgc3QgKyAiJyI7DQoJc29xbCA9IHNvcWwgKyAiIEFuZCBTVk1YQ19fUHJvZHVjdF9TdG9ja19fci5TVk1YQ19fUHJvZHVjdF9fYyA9ICciICsgcHJvZElkICsgIiciOw0KCXNvcWwgPSBzb3FsICsgIiBBbmQgU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX3IuU1ZNWENfX0xvY2F0aW9uX19jID0gJyIgKyBzaXRlICsgIiciOw0KCS8vIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZygiUXVlcnk6ICIgKyBzb3FsKTsgCQ0KCXRyeQ0KCXsNCgkJdmFyIHFyUFMgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsKTsgDQoJCWlmIChxclBTICYmIHFyUFMuc2l6ZSA+IDApIC8vIFBTIFJlY29yZCBFeGlzdA0KCQl7IA0KCQkJcmV0dXJuIHFyUFMuc2l6ZTsNCgkJfSANCgkJZWxzZSB7IHJldHVybiAwOyB9IC8vLy8gUFMgUmVjb3JkIE5vdCBFeGlzdA0KCX0gDQoJY2F0Y2goZSkgDQoJew0KCQkgU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAyIikrZSk7DQoJCSBzU2VsX29wZW5XaW5IZGwuU1ZNWElfc1NlbF9zaG93RXJyb3JMb2coKTsNCgl9DQp9DQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV9zU2VsX2NoZWNrSWZFeGlzdEluUFMocHJvZElkLCBzdCwgc2l0ZSkNCnsNCgl2YXIgc29xbCA9ICJTZWxlY3QgSWQsU1ZNWENfX1F1YW50aXR5Ml9fYywgIFNWTVhDX19TdGF0dXNfX2MsIFNWTVhDX19Qcm9kdWN0X19jLCBTVk1YQ19fTG9jYXRpb25fX2MgIiA7DQoJc29xbCA9IHNvcWwgKyAiIEZyb20gU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX2MgIjsNCglzb3FsID0gc29xbCArICIgV0hFUkUgU1ZNWENfX1N0YXR1c19fYyA9ICciICsgc3QgKyAiJyI7DQoJc29xbCA9IHNvcWwgKyAiIEFuZCBTVk1YQ19fUHJvZHVjdF9fYyA9ICciICsgcHJvZElkICsgIiciOw0KCXNvcWwgPSBzb3FsICsgIiBBbmQgU1ZNWENfX0xvY2F0aW9uX19jID0gJyIgKyBzaXRlICsgIiciOw0KCS8vIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZygiUXVlcnk6ICIgKyBzb3FsKTsgCQ0KCXRyeQ0KCXsNCgkJdmFyIHFyUFMgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsKTsgDQoJCWlmIChxclBTICYmIHFyUFMuc2l6ZSA+IDApIC8vIFBTIFJlY29yZCBBbHJlYWR5IEV4aXN0DQoJCXsgDQoJCQl2YXIgcmVjc1BTID0gcXJQUy5nZXRBcnJheSgicmVjb3JkcyIpOyANCgkJCWZyb21Qcm9kSWRJblBTID0gcmVjc1BTWzBdLklkOyANCgkJCWZyb21Qcm9kSW5QU3F0eSA9IHJlY3NQU1swXS5TVk1YQ19fUXVhbnRpdHkyX19jOyANCgkJCS8vaWYgKGZyb21Qcm9kSW5QU3F0eSA+IDAgKSAvLyBSZWNvcmQgZm91bmQgaW4gUFMgYW5kIEhhcyBRdHk6IEdldCBTZXJpYWwgTm8gQXJyYXkgRmlsbGVkDQoJCQkvL3sNCgkJCQl2YXIgZ2V0U04gPSAgU1ZNWElfc1NlbF9nZXRFeGlzdGluZ1NlcmlhbChmcm9tUHJvZElkSW5QUyxwcm9kSWQpIC8vZnJvbVByb2RJZEluUFM6IElkIElzIG9mIGNvcnJlc3BvbmRpbmcgUmVjIGZvdW5kIGluIFBTDQoJCQkvL30NCgkJCS8vaXNGcm9tUHJvZEV4aXN0SW5QUyA9IHRydWU7DQoJCX0gDQoJfSANCgljYXRjaChlKSANCgl7DQoJCSBTVk1YSV9zU2VsX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDIiKStlKTsNCgkJIHNTZWxfb3BlbldpbkhkbC5TVk1YSV9zU2VsX3Nob3dFcnJvckxvZygpOw0KCX0NCn0NCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCnZhciBzbkNvdW50ID0gMDsvL1RvIFN0b3JlIHRvdGFsIEZvdW5kIFNOIGZvciBhbGwgdmFsaWQgcHJvZHMNCmZ1bmN0aW9uIFNWTVhJX3NTZWxfZ2V0RXhpc3RpbmdTZXJpYWwocHNJZCxwcm9kSWQpDQp7DQoJdmFyIHNvcWxTTiA9ICJTZWxlY3QgTmFtZSBGcm9tIFNWTVhDX19Qcm9kdWN0X1NlcmlhbF9fYyIgOw0KCXNvcWxTTiA9IHNvcWxTTiArICIgV2hlcmUgU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX2MgPSAnIiArIHBzSWQgKyAiJyI7DQoJLy8gU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKCJRdWVyeTogIiArIHNvcWxTTik7IAkNCgkvL2FsZXJ0KHNvcWxTTik7DQoJdHJ5DQoJCXsNCgkJCXZhciBxclNOID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbFNOKTsgDQoJCQlpZiAocXJTTi5zaXplID4gMCkgDQoJCQl7IA0KCQkJCXZhciByZWNzU04gPSBxclNOLmdldEFycmF5KCJyZWNvcmRzIik7IA0KCQkJCWZvciAodmFyIGs9MDsgayA8IHFyU04uc2l6ZTsgaysrKQ0KCQkJCXsNCgkJCQkJZnJvbVNlcmlhbHNbc25Db3VudF1bMF0gPSBwcm9kSWQ7DQoJCQkJCWZyb21TZXJpYWxzW3NuQ291bnRdWzFdID0gcmVjc1NOW2tdLk5hbWU7DQoJCQkJCXNuQ291bnQrKzsNCgkJCQkJLy9mcm9tU2VyaWFsc1trXVsyXSA9IHBzSWQ7DQoJCQkJCS8vZnJvbVNlcmlhbHMucHVzaChyZWNzU05ba10uTmFtZSk7IA0KCQkJCX0NCgkJCQlyZXR1cm4gdHJ1ZTsNCgkJCX0gDQoJCQllbHNlIHtyZXR1cm4gdHJ1ZTt9DQoJCX0gDQoJCWNhdGNoKGUpIA0KCQl7CQkJCSANCgkJCSBTVk1YSV9zU2VsX1B1dFByb2Nlc3NMb2coU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDIiKStlKTsNCgkJCSBzU2VsX29wZW5XaW5IZGwuU1ZNWElfc1NlbF9zaG93RXJyb3JMb2coKTsNCgkJfQ0KDQp9DQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV9zU2VsX2lzU2VyaWFsaXplZFByb2QocHJvZElkKQ0Kew0KCXZhciBzb3FsUHJvZCA9ICJTZWxlY3QgTmFtZSxTVk1YQ19fRW5hYmxlX1NlcmlhbGl6ZWRfVHJhY2tpbmdfX2MgICBmcm9tIFByb2R1Y3QyICIgOw0KCXNvcWxQcm9kID0gc29xbFByb2QgKyAiIFdIRVJFIElkID0gJyIgKyBwcm9kSWQgKyAiJyI7DQoJc29xbFByb2QgPSBzb3FsUHJvZCArICIgQW5kIFNWTVhDX19FbmFibGVfU2VyaWFsaXplZF9UcmFja2luZ19fYyA9IHRydWUiOw0KDQoJLy8gU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKCJRdWVyeTogIiArIHNvcWxQcm9kKTsgCQ0KCXRyeQ0KCXsNCgkJdmFyIHFyUHJvZCA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWxQcm9kKTsgDQoJCWlmIChxclByb2Quc2l6ZSA+IDApIA0KCQl7IA0KCQkJcmV0dXJuIHRydWU7IA0KCQl9DQoJCWVsc2Uge3JldHVybiBmYWxzZTt9DQoJfSANCgljYXRjaChlKSANCgl7CQkJIA0KCQkgU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAyIikrZSk7DQoJCSBzU2VsX29wZW5XaW5IZGwuU1ZNWElfc1NlbF9zaG93RXJyb3JMb2coKTsNCgl9DQp9DQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQp2YXIgdG9TTmNvdW50ID0wOw0KZnVuY3Rpb24gU1ZNWElfc1NlbF92YWxpZGF0ZVNOKHZhbCxzbkVudHJ5VHlwZSkgLy9Mb2dpYyB0byB2YWxpZGF0ZSBoZSBnaXZlbiBTZXJpYWwgTm8gVU5JUVVFTkVTUw0KewkNCglpZiggU1ZNWElfc1NlbF9pZkV4Y2VlZFRoZVF0eSgpID09IGZhbHNlKSAvLyBsb2dpYyB0byB2ZXJpZnkgaWYgZXhjZXNzIFNOIGFyZSBub3Qgc2VsZWN0ZWQgdGhhbiByZXF1aXJlZCBmb3IgZWFjaCBwcm9kdWN0IGFuZCBzYW1lIGlzIG5vdCBhZGRlZCBUd2ljZQ0KCXsNCgkJaWYgKCBTVk1YSV9zU2VsX3VuaXFuZXNzQ2hlY2tPbmVTTih2YWwpID09IHRydWUpDQoJCXsNCgkJCXRvU2VyaWFsc1t0b1NOY291bnRdWzBdID0gc2VsUHJvZElkOwkJCQ0KCQkJdG9TZXJpYWxzW3RvU05jb3VudF1bMV0gPSB2YWw7DQoJCQl0b1NlcmlhbHNbdG9TTmNvdW50XVsyXSA9IHNuRW50cnlUeXBlOw0KCQkJdG9TTmNvdW50Kys7DQoJCQlyZXR1cm4gdHJ1ZTsNCgkJfQ0KCQllbHNlIHtyZXR1cm4gZmFsc2U7fQ0KCX0NCgllbHNlIGlmIChleGNRdHlFcnJEaXNwbGF5ZWQgPT0gZmFsc2UpIC8vRm9yIGVhY2ggUHJvZCBvbmNlLCBhcyBRdWljay1BZGQgY2FuIGxhdW5jaCBtdWx0aWxlIGFkZGl0aW9uDQoJCSB7DQoJCQlzU2VsX29wZW5XaW5IZGwuYWxlcnQoU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDYiKSk7DQoJCQlleGNRdHlFcnJEaXNwbGF5ZWQgPSB0cnVlOw0KCQkJcmV0dXJuIGZhbHNlOw0KCQkgfSANCn0NCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCnZhciBzU2VsX1NvZnRVbmlxRXJyMSA9ICIiOw0KdmFyIHNTZWxfU29mdFVuaXFFcnJMaXN0MSA9ICIiOw0KdmFyIHZFcnIxID0gIiI7DQpmdW5jdGlvbiBTVk1YSV9zU2VsX3VuaXFuZXNzQ2hlY2tPbmVTTihzbikgLy9Mb2dpYyB0byB2YWxpZGF0ZSB0aGUgZ2l2ZW4gU2VyaWFsIE5vIFVOSVFVRU5FU1MNCnsJDQp2YXIgcmVzdWx0ID0gdHJ1ZTsNCmZvciAodmFyIGI9MDsgYjx0b1NlcmlhbHMubGVuZ3RoO2IrKykgLy9sb29wIHRvU2VyaWFsIGFuZCBydW4gdW5pcXVlbmVzc2NoZWNrIGZvciBlYWNoIHNuIA0Kew0KCWlmICh0b1NlcmlhbHNbYl1bMF0gIT0gIiIgJiYgdG9TZXJpYWxzW2JdWzFdICE9ICIiKQ0KCXsNCgkJdmFyIHJlcyA9ICBTVk1YSV9zU2VsX2lmSXRlbUV4aXN0SW5BcnJheShzbik7DQoJCWlmICggcmVzID09IGZhbHNlICkge30vL2lmIER1cGxpY2F0ZSBTbm8gTk9UIEZvdW5kIGRvIG5vdGhpbmcNCgkJZWxzZSAvL0R1cGxpY2F0ZSBTbm8gRm91bmQNCgkJew0KCQkJaWYgKHZFblNlcmlhbFVuaXF1ZW5lc3MgPT0gIlN0cmljdCIgKSAvL1NlcnZpY2VNYXggU2V0dGluZ3MgZm9yIFVuaXF1ZW5lc3MgQ2hlY2sNCgkJCXsNCgkJCQl2RXJyMSA9IFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDA3IikrIlxuIjsgDQoJCQkJdkVycjEgKz0gU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDgiKSArIHNuICsgIlxuIjsgLy8gKyAiIHsiICsgU1ZNWElfc1NlbF9nZXRQcm9kdWN0RGV0YWlscyhzZWxQcm9kSWQpICsgIn0gXG4iOw0KCQkJCXJlc3VsdCA9IGZhbHNlOwkNCgkJCX0NCgkJCWlmICh2RW5TZXJpYWxVbmlxdWVuZXNzID09ICJTb2Z0IiApDQoJCQl7DQoJCQkJc1NlbF9Tb2Z0VW5pcUVycjEgPSBTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwOSIpKyJcbiI7IA0KCQkJCXJlc3VsdCA9IHRydWU7CQ0KCQkJfQ0KCQkJCWlmICh2RW5TZXJpYWxVbmlxdWVuZXNzID09ICJOb25lIiB8fCB2RW5TZXJpYWxVbmlxdWVuZXNzID09ICIiIHx8IHZFblNlcmlhbFVuaXF1ZW5lc3MgPT0gbnVsbCB8fCB2RW5TZXJpYWxVbmlxdWVuZXNzLmxlbmd0aCA8IDEpDQoJCQkJew0KCQkJCQlyZXN1bHQgPSB0cnVlOwkNCgkJCQl9DQoJCQl9DQoJCX0vL0lmIENsb3NlIDp0b1NlcmlhbCBBcnJheQ0KCX0vL0ZvciBDbG9zZSAtdG9TZXJpYWwgQXJyYXkNCg0KCWlmICh2RXJyMS5sZW5ndGggPiAwKXtzU2VsX29wZW5XaW5IZGwuYWxlcnQodkVycjEpO30NCglyZXR1cm4gcmVzdWx0Ow0KfQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfc1NlbF9idWlsZFJlc3VsdEFycmF5KHJlcykgLy9Mb2dpYyB0byB2YWxpZGF0ZSB0aGUgZ2l2ZW4gU2VyaWFsIE5vIFVOSVFVRU5FU1MNCnsJDQoJdmFyIHJlc3VsdEFyID0gbmV3IEFycmF5KCk7DQoJaWYocmVzICE9IG51bGwpDQoJew0KCQlwcm9kUmVzdWx0QXIgPSAgU1ZNWElfTXVsdGlEaW1lbnNpb25hbEFycmF5KHBhcnNlSW50KHRvdFNOcmVxKSw4KTsNCgkJdmFyIHZhbGlkUmVjSW5BciA9MDsNCgkJZm9yICh2YXIgaj0wOyBqPHRvU2VyaWFscy5sZW5ndGg7aisrKSAvL2xvb3AgdG9TZXJpYWwgZm9yIGVhY2ggdmFsaWQgZW50cnkgaW4gYXJyYXkNCgkJew0KCQkJaWYodG9TZXJpYWxzW2pdWzBdICE9ICIiKQ0KCQkJew0KCQkJCXZhbGlkUmVjSW5BcisrDQoJCQl9DQoJCX0JCQ0KCQl2YXIgcElkID0gIiI7DQoJCXZhciBjdXJyUElEID0iIjsNCgkJdmFyIHIgPTA7IC8vcmVzdWx0IENvdW50DQoJCWlmIChyZXMgPT0gdHJ1ZSkNCgkJeyANCgkJCWZvciAodmFyIGo9MDsgajx0b1NlcmlhbHMubGVuZ3RoO2orKykgLy9sb29wIHRvU2VyaWFsIGZvciBlYWNoIHNlbGVjdGVkIHNuIA0KCQkJew0KCQkJCWlmKHRvU2VyaWFsc1tqXVswXSAhPSAiIiAmJiB0b1NlcmlhbHNbal1bMV0gIT0gIiIpDQoJCQkJew0KCQkJCQlwSWQgPSB0b1NlcmlhbHNbal1bMF07DQoJCQkJCWlmIChwSWQgIT0gY3VyclBJRCkgLy9UbyBlbmZvcmNlLCBQU0lEIHJldHJpdmFsIHNob3VsZCBoYXBwZW4gb25seSBPTkNFIGZvciBlYWNoIHByb2R1Y3QgaW4gYXJyYXkNCgkJCQkJewkNCgkJCQkJCWN1cnJQSUQgPSBwSWQ7DQoJCQkJCQkvL2ZpbmQgZnJvbSAmIFRvOiAgU2l0ZSAsIFN0YXR1cyBmcm9tIHZhbGlkIHByb2QgYXJyDQoJCQkJCQlmb3IgKHZhciB4PTA7IHg8dmFsaWRQcm9kQXIubGVuZ3RoO3grKykgLy9sb29wIHRvU2VyaWFsIGZvciBlYWNoIHNlbGVjdGVkIHNuIA0KCQkJCQkJew0KCQkJCQkJCWlmKGN1cnJQSUQgPT0gdmFsaWRQcm9kQXJbeF1bMF0pDQoJCQkJCQkJew0KCQkJCQkJCQlzZWxGcm9tU2l0ZUlEID0gdmFsaWRQcm9kQXJbeF1bMl07DQoJCQkJCQkJCXNlbEZyb21TdGF0dXMgPSB2YWxpZFByb2RBclt4XVszXTsNCgkJCQkJCQkJc2VsVG9TaXRlSUQgPSB2YWxpZFByb2RBclt4XVs0XTsNCgkJCQkJCQkJc2VsVG9TdGF0dXMgPSB2YWxpZFByb2RBclt4XVs1XTsNCgkJCQkJCQl9DQoJCQkJCQl9DQoJCQkJCQlzZWxGcm9tUFNJRCA9ICBTVk1YSV9zU2VsX2dldFBTSURJZkV4aXN0KGN1cnJQSUQsc2VsRnJvbVN0YXR1cyxzZWxGcm9tU2l0ZUlEKTsNCgkJCQkJCXNlbFRvUFNJRCA9ICBTVk1YSV9zU2VsX2dldFBTSURJZkV4aXN0KGN1cnJQSUQsc2VsVG9TdGF0dXMsc2VsVG9TaXRlSUQpOw0KCQkJCQl9DQoJCQkJCXByb2RSZXN1bHRBcltyXVswXSA9IHRvU2VyaWFsc1tqXVswXTsgLy9Qcm9kdWN0SWQNCgkJCQkJcHJvZFJlc3VsdEFyW3JdWzFdID0gc2VsRnJvbVNpdGVJRDsgDQoJCQkJCXByb2RSZXN1bHRBcltyXVsyXSA9IHNlbEZyb21TdGF0dXM7IA0KCQkJCQlwcm9kUmVzdWx0QXJbcl1bM10gPSBzZWxGcm9tUFNJRDsNCgkJCQkJcHJvZFJlc3VsdEFyW3JdWzRdID0gc2VsVG9TaXRlSUQ7IA0KCQkJCQlwcm9kUmVzdWx0QXJbcl1bNV0gPSBzZWxUb1N0YXR1czsgDQoJCQkJCXByb2RSZXN1bHRBcltyXVs2XSA9IHNlbFRvUFNJRDsNCgkJCQkJcHJvZFJlc3VsdEFyW3JdWzddID0gdG9TZXJpYWxzW2pdWzFdOyAvL3NuIG5vDQoJCQkJCXIrKzsNCgkJCQl9DQoJCQl9CQkNCgkJCXJlc3VsdEFyWzBdID0gcmVzOyAvLyBUcnVlL2ZhbHNlDQoJCQlyZXN1bHRBclsxXSA9IHZhbGlkUmVjSW5BcjsgLy9SZWNvcmQgY291bnQgb2YgdG90YWwgbnVtYmVyIG9mIHNlcmlhbHMgc2VsZWN0ZWQgZm9yIHNhdmUJCQkNCgkJCXJlc3VsdEFyWzJdID0gcHJvZFJlc3VsdEFyOw0KCQl9DQoJCWVsc2UgLy8gUmV0dXJuIFRSVUUgd2l0aCBjb3VudCBaZXJvDQoJCXsNCgkJCXJlc3VsdEFyWzBdID0gdHJ1ZTsgLy8gVHJ1ZS9mYWxzZQ0KCQkJcmVzdWx0QXJbMV0gPSAwOyAvL1JlY29yZCBjb3VudCBvZiB0b3RhbCBudW1iZXIgb2Ygc2VyaWFscyBzZWxlY3RlZCBmb3Igc2F2ZSBaRVJPDQoJCQlyZXN1bHRBclsyXSA9IHNTZWxfcHJvY2Vzc0xvZzsNCgkJfQ0KCX0NCgllbHNlDQoJew0KCQlyZXN1bHRBclswXSA9IGZhbHNlOyAvLyBUcnVlL2ZhbHNlIGlmIFdpbmRvdyBDYW5jZWxlZCB0aGFuIFNlbmQgRkFMU0UNCgkJcmVzdWx0QXJbMV0gPSAwOyAvL1JlY29yZCBjb3VudCBvZiB0b3RhbCBudW1iZXIgb2Ygc2VyaWFscyBzZWxlY3RlZCBmb3Igc2F2ZSBaRVJPDQoJCXJlc3VsdEFyWzJdID0gIkNhbmNlbGxlZCI7DQoJfQ0KDQoJIFNWTVhJX3NTZWxfU2VyaWFsU2VsZWN0aW9uUmVzdWx0cyhyZXN1bHRBcix2VHJhbnNhY3Rpb25UeXBlKTsgLy8gdGhpcyBNZXRob2QgTVVTVCBiZSBhdmFpbGFibGUgaW4gQ2FsbGluZy1DbGllbnQsIE9uIFN1Ym1pdC9DYW5jZWwgYnRuIGNsaWNrIGluIFNlcmlhbC1VdGlsaXQgVEhJUyB3aWxsIGJlIGNhbGxlZCANCgkJLy9hbGVydCgiUmVzdWx0OlxuIiArIHJlc3VsdEFyLnRvU3RyaW5nKCkgKTsNCgkJLy93aW5kb3cuY2xvc2UoKTsNCgkJLy9yZXR1cm4gIlN1Y2Nlc3MiOw0KfQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfc1NlbF91bmlxbmVzc0NoZWNrQWxsU04oKSAvL0xvZ2ljIHRvIHZhbGlkYXRlIGhlIGdpdmVuIFNlcmlhbCBObyBVTklRVUVORVNTDQp7CQ0KCXZhciByZXN1bHQgPSB0cnVlOw0KCWZvciAodmFyIGE9MDsgYTx2YWxpZFByb2RBci5sZW5ndGg7YSsrKSAvL0xvb3AgVmFsaWQgUHJvZHVjdHMgYXJyYXkgYW5kIHJ1biBVbmlxdW5lc3MgY2hlY2sgZm9yIGVhY2ggcHJvZA0KCXsNCgkJaWYgKHZhbGlkUHJvZEFyW2FdWzBdICE9ICIiKQ0KCQl7DQoJCQl2YXIgcHJvZElkID0gdmFsaWRQcm9kQXJbYV1bMF07DQoJCQlmb3IgKHZhciBiPTA7IGI8dG9TZXJpYWxzLmxlbmd0aDtiKyspIC8vbG9vcCB0b1NlcmlhbCBhbmQgcnVuIHVuaXF1ZW5lc3NjaGVjayBmb3IgZWFjaCBzbiANCgkJCXsNCgkJCQlpZiAodG9TZXJpYWxzW2JdWzBdICE9ICIiICYmIHRvU2VyaWFsc1tiXVswXSA9PSBwcm9kSWQgJiYgdG9TZXJpYWxzW2JdWzFdICE9ICIiKQ0KCQkJCXsNCgkJCQkJdmFyIHNuID0gdG9TZXJpYWxzW2JdWzFdOw0KCQkJCQlpZiAoU1ZNWElfc1NlbF9pZlNOaXNEdXBsaWNhdGUoc24scHJvZElkKSkgLy9pZiBEdXBsaWNhdGUgU25vIEZvdW5kDQoJCQkJCXsNCgkJCQkJCWlmICh2RW5TZXJpYWxVbmlxdWVuZXNzID09ICJTdHJpY3QiICkgLy9TZXJ2aWNlTWF4IFNldHRpbmdzIGZvciBVbmlxdWVuZXNzIENoZWNrDQoJCQkJCQl7DQoJCQkJCQkJdkVyciA9IFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDA3IikrIlxuIjsgDQoJCQkJCQkJdkVyckxpc3QgKz0gU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMDgiKSsgc24gKyAiIHsiICsgIFNWTVhJX3NTZWxfZ2V0UHJvZHVjdERldGFpbHMocHJvZElkKSArICJ9IFxuIjsNCgkJCQkJCQlyZXN1bHQgPSBmYWxzZTsJDQoJCQkJCQl9DQoJCQkJCQlpZiAodkVuU2VyaWFsVW5pcXVlbmVzcyA9PSAiU29mdCIgKQ0KCQkJCQkJew0KCQkJCQkJCXZFcnIgPSBTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwOSIpKyJcbiI7IA0KCQkJCQkJCXZFcnJMaXN0ICs9IFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDA4IikgKyBzbiArICIgeyIgKyAgU1ZNWElfc1NlbF9nZXRQcm9kdWN0RGV0YWlscyhwcm9kSWQpICsgIn0gXG4iOw0KCQkJCQkJCXJlc3VsdCA9IHRydWU7CQ0KCQkJCQkJfQ0KCQkJCQkJaWYgKHZFblNlcmlhbFVuaXF1ZW5lc3MgPT0gIk5vbmUiIHx8IHZFblNlcmlhbFVuaXF1ZW5lc3MgPT0gIiIgfHwgdkVuU2VyaWFsVW5pcXVlbmVzcyA9PSBudWxsIHx8IHZFblNlcmlhbFVuaXF1ZW5lc3MubGVuZ3RoIDwgMSkNCgkJCQkJCXsNCgkJCQkJCQlyZXN1bHQgPSB0cnVlOwkNCgkJCQkJCX0NCgkJCQkJfQ0KCQkJCX0vL0lmIENsb3NlIDp0b1NlcmlhbCBBcnJheQ0KCQkJfS8vRm9yIENsb3NlIC10b1NlcmlhbCBBcnJheQ0KCQl9IC8vSUYgQ2xvc2UgLVZhbGlkIHByb2QgYXJyYXkNCgl9Ly9Gb3IgY2xvc2UgOiB2YWxpZCBwcm9kIEFycmF5DQoNCglyZXR1cm4gcmVzdWx0Ow0KfQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfc1NlbF9pZlNOaXNEdXBsaWNhdGUoc05vLCBwcm9kSWQpDQp7DQoJLy9DaGVjayBpZiB0aGUgY29tYmluYXRpb24gb2Ygc2VyaWFsIG51bWJlciBhbmQgcHJvZHVjdCBudW1iZXIgaXMgcHJlc2VudCBpbiBTVk1YSV9Qcm9kdWN0X1NlcmlhbF9fYyBvYmplY3QNCgl2YXIgc29xbFNOID0gIlNlbGVjdCBOYW1lLCBTVk1YQ19fUHJvZHVjdF9fYywgU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX2MsIiA7DQoJc29xbFNOICs9ICIgU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX3IuU1ZNWENfX0xvY2F0aW9uX19jLFNWTVhDX19Qcm9kdWN0X1N0b2NrX19yLlNWTVhDX19TdGF0dXNfX2MiOw0KCXNvcWxTTiArPSAiIGZyb20gU1ZNWENfX1Byb2R1Y3RfU2VyaWFsX19jICIgOw0KCXNvcWxTTiArPSAiIFdoZXJlIFNWTVhDX19Qcm9kdWN0X19jID0gJyIgKyBwcm9kSWQgKyAiJyI7IA0KCXNvcWxTTiArPSAiIEFuZCBOYW1lID0gJyIgKyBzTm8gKyAiJyI7DQoJc29xbFNOICs9ICIgQW5kIFNWTVhDX19Qcm9kdWN0X1N0b2NrX19yLlNWTVhDX19TdGF0dXNfX2MgIT0gJ1NjcmFwJyAiOw0KCXNvcWxTTiArPSAiIEFuZCBTVk1YQ19fUHJvZHVjdF9TdG9ja19fci5TVk1YQ19fTG9jYXRpb25fX2MgIT0gJyIgKyBzZWxGcm9tU2l0ZUlEICsgIiciOw0KCS8vIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZygiUXVlcnk6ICIgKyBzb3FsU04pOyAJDQoJdHJ5DQoJCXsNCgkJCXZhciBxclNOID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbFNOKTsgDQoJCQlpZiAocXJTTi5zaXplID4gMCkgDQoJCQl7IA0KCQkJCS8vRHVwbGljYXRlIGZvdW5kIA0KCQkJCXJldHVybiB0cnVlOyANCgkJCX0NCgkJCWVsc2Uge3JldHVybiBmYWxzZTt9DQoJCX0gDQoJCWNhdGNoKGUpIA0KCQl7DQoJCQkgU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAyIikrIGUpOw0KCQkJIHNTZWxfb3BlbldpbkhkbC5TVk1YSV9zU2VsX3Nob3dFcnJvckxvZygpOw0KCQl9DQp9DQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV9zU2VsX3ZhbGlkYXRlU2VsU05xdHkoKSAvLyBUaGlzIENoZWNrcyBmb3IgQWxsIHByb2R1Y3RzIGluIFZhbGlkIEFycmF5DQp7DQoJdmFyIHJlc3VsdCA9IHRydWU7DQoJLy9Mb29wIFZhbGlkIFByb2R1Y3RzIGFycmF5IGFuZCBmaW5kIENoZWNrIFJlcSBTTiBxdHkgaXMgcHJvdmlkZWQNCglmb3IgKHZhciBhPTA7IGE8dmFsaWRQcm9kQXIubGVuZ3RoO2ErKykNCgl7DQoJCWlmICh2YWxpZFByb2RBclthXVswXSAhPSAiIikNCgkJew0KCQkJLy8xLmNoZWNrIGlmIHRoZSBudW1iZXIgb2Ygc2VyaWFsIG51bWJlcnMgZW50ZXJlZCBtYXRjaGVzIHRoZSByZWNlaXZlZCBxdWFudGl0eSBmb3IgYWxsIHByb2R1Y3RzDQoJCQl2YXIgcHJvZCA9IHZhbGlkUHJvZEFyW2FdWzBdOw0KCQkJdmFyIHJlcVNOY291bnQgID0gdmFsaWRQcm9kQXJbYV1bMV07IC8vZm9yIFNlbGVjdCBQcm9kdWN0IA0KCQkJdmFyIHNlbFNOY291bnQgPSAwOw0KDQoJCQlmb3IgKHZhciB6PTA7IHo8dG9TZXJpYWxzLmxlbmd0aDt6KyspDQoJCQl7DQoJCQkJaWYgKHRvU2VyaWFsc1t6XVswXSA9PSBwcm9kICYmIHRvU2VyaWFsc1t6XVsxXSAhPSAiIil7IHNlbFNOY291bnQrKzt9DQoJCQl9DQoJCQlpZiAoc2VsU05jb3VudCAhPSByZXFTTmNvdW50ICkgDQoJCQl7DQoJCQkJdlF0eUVyciA9IFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDEwIik7CS8vIlRoZSBudW1iZXIgb2Ygc2VyaWFsIG51bWJlcnMgeW91IGVudGVyZWQgZG9lcyBub3QgbWF0Y2ggdGhlIHJlY2VpdmVkIHF1YW50aXR5LiI7DQoJCQkJdlF0eUVyckxpc3QgKz0gU1ZNWElfc1NlbF9HZXRNZXNzYWdlKCJNU0cwMTEiKSArICcgJyArIFNWTVhJX3NTZWxfZ2V0UHJvZHVjdERldGFpbHMocHJvZCkgKyAiXG4iOw0KCQkJCXJlc3VsdCA9IGZhbHNlOw0KCQkJfQ0KCQl9CQkJDQoJfQkJDQoJcmV0dXJuIHJlc3VsdDsNCn0NCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3NTZWxfaWZFeGNlZWRUaGVRdHkoKSAvL1RoaXMgY2hlY2tzIEZvciBTZWxlY3RlZCBwcm9kdWN0IE9OTFkNCnsNCgkvL0FkZCBMb2dpYyB0byB2ZXJpZnkgdGhlIHNlbGVjdGVkIGNvdW50IG9mIFNOIGFnYWluc3QgUXR5DQoJdmFyIHJlcVNOY291bnQgID0gdmFsaWRQcm9kQXJbc2VsVmFsaWRQcm9kSW5kZXhdWzFdOyAvL2ZvciBTZWxlY3QgUHJvZHVjdCANCgl2YXIgc2VsU05jb3VudCA9MDsNCglmb3IgKHZhciB6PTA7IHo8dG9TZXJpYWxzLmxlbmd0aDt6KyspDQoJew0KCQlpZiAodG9TZXJpYWxzW3pdWzBdID09IHNlbFByb2RJZCAmJiB0b1NlcmlhbHNbel1bMV0gIT0gIiIpeyBzZWxTTmNvdW50Kys7fQ0KCX0NCglpZiAoc2VsU05jb3VudCA8IHJlcVNOY291bnQgKSB7cmV0dXJuIGZhbHNlO30gLy9Ob3QgZXhjZWVkZWQNCgllbHNlIHtyZXR1cm4gdHJ1ZTt9IC8vZXhjZWVkIHRoZSBhbGxvd2VkIGxpbWl0DQp9DQoNCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3NTZWxfaWZJdGVtRXhpc3RJbkFycmF5KHZhbFRvRmluZCkNCnsNCgl2YXIgcmVzdWx0ID0gZmFsc2U7DQoJdmFyIGFyID0gdG9TZXJpYWxzOw0KCWZvciAodmFyIHo9MDsgejxhci5sZW5ndGg7eisrKQ0KCXsNCgkJaWYgKGFyW3pdWzFdID09IHZhbFRvRmluZCApIC8vYXJbel1bMF0gPT0gc2VsUHJvZElkICYmIA0KCQl7IA0KCQlyZXN1bHQgPSB0cnVlOw0KCQl9DQoJfQ0KCXJldHVybiByZXN1bHQ7DQp9DQoNCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3NTZWxfdmFsaWRhdGVJbnB1dHMoKQ0Kew0KCWF0bGVhc3RPbmVWYWxpZFByb2RGb3VuZCA9IGZhbHNlOw0KCXZhciB4ID0wOw0KCWZvciAodmFyIGk9MDsgaTx2UHJvZFF0eUFyLmxlbmd0aDsgaSsrKSANCgkgICAgewkNCgkgICAgaWYgKHZQcm9kUXR5QXJbaV1bMF0udG9TdHJpbmcoKSAhPSAiIikNCgkJew0KCQlpZiAoU1ZNWElfc1NlbF9pc1NlcmlhbGl6ZWRQcm9kKHZQcm9kUXR5QXJbaV1bMF0pID09IHRydWUpDQoJCSAgICB7DQoJCSAgICBhdGxlYXN0T25lVmFsaWRQcm9kRm91bmQgPSB0cnVlOw0KCQkgICAgeCA9IHgrMTsNCgkJICAgIH0NCgkJfQ0KCSAgICB9DQoNCgkJLy8vL0ZvciBlYWNoIHByb2R1Y3QgaW4gdGhlIGlucHV0IGFycmF5LGNoZWNrIGlmIFNWTVhDX19TZXJpYWxpemVkX1RyYWNraW5nX19jIGlzIHRydWUgaW4gUHJvZHVjdDIgb2JqZWN0DQoJdmFsaWRQcm9kQXIgPSAgU1ZNWElfTXVsdGlEaW1lbnNpb25hbEFycmF5KHgsIDYpOyANCgl4PTA7DQoJZm9yICh2YXIgaT0wOyBpPHZQcm9kUXR5QXIubGVuZ3RoOyBpKyspIA0KCSAgICB7DQoJICAgIGlmICh2UHJvZFF0eUFyW2ldWzBdLnRvU3RyaW5nKCkgIT0gIiIpDQoJCXsNCgkJaWYgKCBTVk1YSV9zU2VsX2lzU2VyaWFsaXplZFByb2QodlByb2RRdHlBcltpXVswXSkgPT0gdHJ1ZSkgLy8vL1B1c2ggVmFsaWQgU2VyaWFsaXplZCBwcm9kdWN0IHRvIG5ldyBhcnJheS4NCgkJICAgIHsNCgkJICAgIHZhbGlkUHJvZEFyW3hdWzBdID0gdlByb2RRdHlBcltpXVswXTsNCgkJICAgIHZhbGlkUHJvZEFyW3hdWzFdID0gcGFyc2VJbnQodlByb2RRdHlBcltpXVsxXSk7DQoJCSAgICB2YWxpZFByb2RBclt4XVsyXSA9IHZQcm9kUXR5QXJbaV1bMl07DQoJCSAgICB2YWxpZFByb2RBclt4XVszXSA9IHZQcm9kUXR5QXJbaV1bM107DQoJCSAgICB2YWxpZFByb2RBclt4XVs0XSA9IHZQcm9kUXR5QXJbaV1bNF07DQoJCSAgICB2YWxpZFByb2RBclt4XVs1XSA9IHZQcm9kUXR5QXJbaV1bNV07DQoJCSAgICB4ID0geCsxOw0KCQkgICAgfQ0KCQl9DQoJICAgIH0NCgkvLy8vLyBGUk9NIC8vQ2hlY2sgaWYgYSByZWNvcmQgZXhpc3RzIGZvciB0aGUgZ2l2ZW4gcHJvZHVjdCwgdG8gc2l0ZSBhbmQgdG8gc3RhdHVzIGNvbWJpbmF0aW9uIGluIFNWTVhDX19Qcm9kdWN0X1N0b2NrX19jIG9iamVjdA0KCS8vdmFyIHZGcm9tUFNJRCA9ICBTVk1YSV9zU2VsX2dldFBTSURJZkV4aXN0KHByb2RJZCx2RnJvbVN0YXR1cyx2RnJvbVNpdGVJRCk7DQoNCgkvLy8vLyBUTyAvL0NoZWNrIGlmIGEgcmVjb3JkIGV4aXN0cyBmb3IgdGhlIGdpdmVuIHByb2R1Y3QsIGZyb20gc2l0ZSBhbmQgZnJvbSBzdGF0dXMgY29tYmluYXRpb24gaW4gU1ZNWENfX1Byb2R1Y3RfU3RvY2tfX2Mgb2JqZWN0DQoJLy92YXIgdlRvUFNJRCA9ICBTVk1YSV9zU2VsX2dldFBTSURJZkV4aXN0KHByb2RJZCx2VG9TdGF0dXMsdlRvU2l0ZUlEKTsNCg0KCXJldHVybiB0cnVlOwkJCQ0KfQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfc1NlbF9nZXRTZXJ2aWNlTWF4U2V0dGluZ3MoKQ0Kew0KCXZhciBzb3FsU1MgPSAiU2VsZWN0IFNWTVhDX19FbmFibGVfSW52ZW50b3J5X01vZHVsZV9fYywgU1ZNWENfX0VuYWJsZV9TZXJpYWxfVHJhY2tpbmdfX2MsU1ZNWENfX0NoZWNrX1NlcmlhbF9VbmlxdWVuZXNzX19jICAgIiA7DQoJc29xbFNTID0gc29xbFNTICsgIiBGcm9tIFNWTVhDX19TZXJ2aWNlTWF4X1NldHRpbmdzX19jICAiOw0KCQkvLyBTVk1YSV9zU2VsX1B1dFByb2Nlc3NMb2coIlF1ZXJ5OiAiICsgc29xbFNTKTsgCQ0KCQl0cnkNCgkJew0KCQkJdmFyIHFyU1MgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsU1MpOyANCgkJCWlmIChxclNTLnNpemUgPiAwKSAvLyBTZXR0aW5ncyBGb3VuZA0KCQkJeyANCgkJCQl2YXIgcmVjc1NTID0gcXJTUy5nZXRBcnJheSgicmVjb3JkcyIpOyANCgkJCQl2RW5JbnZlbnRvcnkgPSByZWNzU1NbMF0uU1ZNWENfX0VuYWJsZV9JbnZlbnRvcnlfTW9kdWxlX19jOyANCgkJCQl2RW5TZXJpYWxUcmFja2luZyA9IHJlY3NTU1swXS5TVk1YQ19fRW5hYmxlX1NlcmlhbF9UcmFja2luZ19fYzsNCgkJCQl2RW5TZXJpYWxVbmlxdWVuZXNzID0gcmVjc1NTWzBdLlNWTVhDX19DaGVja19TZXJpYWxfVW5pcXVlbmVzc19fYzsNCgkJCQlyZXR1cm4gdHJ1ZTsNCgkJCX0gDQoJCQllbHNlIHt2RW5JbnZlbnRvcnkgPSBmYWxzZTsgdkVuU2VyaWFsVHJhY2tpbmcgPSBmYWxzZTsgdkVuU2VyaWFsVW5pcXVlbmVzcyA9IGZhbHNlOyByZXR1cm4gdHJ1ZTt9DQoJCX0NCgkJY2F0Y2goZSkgDQoJCXsNCgkJCVNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMiIpK2UpOw0KCQkJIHNTZWxfb3BlbldpbkhkbC5TVk1YSV9zU2VsX3Nob3dFcnJvckxvZygpOw0KCQl9DQp9CQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfc1NlbF9pc1NOSW5Gcm9tTGlzdChuZXdTTikgLy9UaGlzIGNoZWNrcyBGb3IgU2VsZWN0IHByb2R1Y3QgT05MWQ0Kew0KCXZhciByZXN1bHQgPSBmYWxzZTsNCglmb3IgKHZhciB6PTA7IHo8ZnJvbVNlcmlhbHMubGVuZ3RoO3orKykNCgl7DQoJCWlmICgoZnJvbVNlcmlhbHNbel1bMV0gPT0gbmV3U04pICYmIChmcm9tU2VyaWFsc1t6XVswXSAhPSAiIikgJiYgKGZyb21TZXJpYWxzW3pdWzFdICE9ICIiKSkNCgkJeyANCgkJCXJlc3VsdCA9IHRydWU7IC8vbmV3U04gYWxyZWFkeSBleGlzdHMgaW4gRnJvbVNlcmlhbHMgTGlzdA0KCQl9DQoJfQ0KCXJldHVybiByZXN1bHQ7IA0KfQ0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfc1NlbF9nZXRQU0lESWZFeGlzdChwcm9kSWQsIHN0LCBzaXRlKQ0Kew0KCXZhciBzb3FsID0gIlNlbGVjdCBJZCxTVk1YQ19fUXVhbnRpdHkyX19jLCAgU1ZNWENfX1N0YXR1c19fYywgU1ZNWENfX1Byb2R1Y3RfX2MsIFNWTVhDX19Mb2NhdGlvbl9fYyAiIDsNCglzb3FsID0gc29xbCArICIgRnJvbSBTVk1YQ19fUHJvZHVjdF9TdG9ja19fYyAiOw0KCXNvcWwgPSBzb3FsICsgIiBXSEVSRSBTVk1YQ19fU3RhdHVzX19jID0gJyIgKyBzdCArICInIjsNCglzb3FsID0gc29xbCArICIgQW5kIFNWTVhDX19Qcm9kdWN0X19jID0gJyIgKyBwcm9kSWQgKyAiJyI7DQoJc29xbCA9IHNvcWwgKyAiIEFuZCBTVk1YQ19fTG9jYXRpb25fX2MgPSAnIiArIHNpdGUgKyAiJyI7DQoJLy8gU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKCJRdWVyeTogIiArIHNvcWwpOyAJDQoJdmFyIHJlc3VsdCA9ICIiOw0KCXRyeQ0KCXsNCgkJdmFyIHFyUFMgPSBzZm9yY2UuY29ubmVjdGlvbi5xdWVyeShzb3FsKTsgDQoJCWlmIChxclBTICYmIHFyUFMuc2l6ZSA+IDApIC8vIFBTIFJlY29yZCBBbHJlYWR5IEV4aXN0DQoJCXsgDQoJCQl2YXIgcmVjc1BTID0gcXJQUy5nZXRBcnJheSgicmVjb3JkcyIpOyANCgkJCXJlc3VsdCA9IHJlY3NQU1swXS5JZDsgDQoJCX0gDQoJCWVsc2UgeyByZXN1bHQgPSAiIjsgfSAvLy8vIFBTIFJlY29yZCBOb3QgRXhpc3QNCglyZXR1cm4gcmVzdWx0Ow0KCX0gDQoJY2F0Y2goZSkgDQoJew0KCQkgU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKFNWTVhJX3NTZWxfR2V0TWVzc2FnZSgiTVNHMDAyIikrIGUpOyANCgkJIHNTZWxfb3BlbldpbkhkbC5TVk1YSV9zU2VsX3Nob3dFcnJvckxvZygpOw0KCX0NCn0NCi8vLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovLwkNCmZ1bmN0aW9uIFNWTVhJX3NTZWxfZ2V0UHJvZHVjdERldGFpbHMocHJvZElkKQ0Kew0KCXZhciBzb3FsUHJvZCA9ICJTZWxlY3QgTmFtZSBmcm9tIFByb2R1Y3QyICIgOw0KCXNvcWxQcm9kID0gc29xbFByb2QgKyAiIFdIRVJFIElkID0gJyIgKyBwcm9kSWQgKyAiJyI7DQoJLy8gU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKCJRdWVyeTogIiArIHNvcWxQcm9kKTsgCQ0KCXRyeQ0KCQl7DQoJCQl2YXIgcXJQcm9kID0gc2ZvcmNlLmNvbm5lY3Rpb24ucXVlcnkoc29xbFByb2QpOyANCgkJCWlmIChxclByb2Quc2l6ZSA+IDApIA0KCQkJeyANCgkJCQl2YXIgcmVjc1Byb2QgPSBxclByb2QuZ2V0QXJyYXkoInJlY29yZHMiKTsgDQoJCQkJdlByb2QgPSByZWNzUHJvZFswXS5OYW1lOyANCgkJCQlyZXR1cm4gdlByb2Q7DQoJCQl9IA0KCQkJZWxzZSB7dlByb2QgPSAiIjtyZXR1cm4gdlByb2Q7fQ0KCQl9IA0KCQljYXRjaChlKSANCgkJew0KCQkJIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMiIpICsgZSk7DQoJCQkgc1NlbF9vcGVuV2luSGRsLlNWTVhJX3NTZWxfc2hvd0Vycm9yTG9nKCk7DQoJCX0NCn0JDQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8JDQpmdW5jdGlvbiBTVk1YSV9zU2VsX2dldFNpdGVEZXRhaWxzKHNpdGVJZCkNCnsNCgl2YXIgc29xbFNpdGUgPSAiU2VsZWN0IE5hbWUgZnJvbSBTVk1YQ19fU2l0ZV9fYyAiIDsNCglzb3FsU2l0ZSA9IHNvcWxTaXRlICsgIiBXSEVSRSBJZCA9ICciICsgc2l0ZUlkICsgIiciOw0KCS8vIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZygiUXVlcnk6ICIgKyBzb3FsU2l0ZSk7IAkNCgl0cnkNCgkJew0KCQkJdmFyIHFyU2l0ZSA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWxTaXRlKTsgDQoJCQlpZiAocXJTaXRlLnNpemUgPiAwKSANCgkJCXsgDQoJCQkJdmFyIHJlY3NTaXRlID0gcXJTaXRlLmdldEFycmF5KCJyZWNvcmRzIik7IA0KCQkJCXZhciB2TG9jYXRpb24gPSByZWNzU2l0ZVswXS5OYW1lOyANCgkJCQlyZXR1cm4gdkxvY2F0aW9uOw0KCQkJfSANCgkJCWVsc2Uge3ZMb2NhdGlvbiA9ICIiOyByZXR1cm4gdkxvY2F0aW9uO30NCg0KCQl9IA0KCQljYXRjaChlKSANCgkJew0KCQkJIFNWTVhJX3NTZWxfUHV0UHJvY2Vzc0xvZyhTVk1YSV9zU2VsX0dldE1lc3NhZ2UoIk1TRzAwMiIpICsgZSk7DQoJCQkgc1NlbF9vcGVuV2luSGRsLlNWTVhJX3NTZWxfc2hvd0Vycm9yTG9nKCk7DQoJCX0NCn0JDQovLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLy8NCmZ1bmN0aW9uIFNWTVhJX011bHRpRGltZW5zaW9uYWxBcnJheShpUm93cyxpQ29scykgDQp7IA0KCS8vYWxlcnQoaVJvd3MgKyAiOiIgK2lDb2xzKTsNCgl2YXIgaTsgDQoJdmFyIGo7IA0KCXZhciBhID0gbmV3IEFycmF5KGlSb3dzKTsgDQoJZm9yIChpPTA7IGkgPCBpUm93czsgaSsrKSANCgl7IA0KCQlhW2ldID0gbmV3IEFycmF5KGlDb2xzKTsgDQoJCWZvciAoaj0wOyBqIDwgaUNvbHM7IGorKykgDQoJCXsgDQogICAgICAgICAgIGFbaV1bal0gPSAiIjsgDQoJCX0gDQoJfSANCiAgIHJldHVybihhKTsgDQp9IA0KLy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8vCQ0KZnVuY3Rpb24gU1ZNWElfc1NlbF9QdXRQcm9jZXNzTG9nKE1zZykgDQp7IA0KCWlmIChzU2VsX3Byb2Nlc3NMb2cpIHsgc1NlbF9wcm9jZXNzTG9nICs9ICAiXG4iOyB9IA0KCXNTZWxfcHJvY2Vzc0xvZyArPSBNc2c7DQp9DQovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8NCmZ1bmN0aW9uIFNWTVhJX3NTZWxfSW5pdE1lc3NhZ2VMaXN0KHN1Ym1vZHVsZWlkKQ0Kew0KICAgIHZhciBmb3VuZCA9IGZhbHNlOw0KDQogICAgdmFyIExhbmdMaXN0ID0gbmV3IEFycmF5KCk7DQoNCiAgICAJCS8vIEhhc2ggKE1hcCkgb2YgU0ZEQyBsYW5ndWFnZSBJU08gY29kZSB0byBMYW5ndWFnZSBwaWNrbGlzdCBpbiBTZXJ2aWNlTWF4IHRhZ3Mgb2JqZWN0DQogICAgTGFuZ0xpc3RbImVuX1VTIl0gPSAiRW5nbGlzaCI7DQogICAgTGFuZ0xpc3RbImRlIl0gPSAiR2VybWFuIjsNCiAgICBMYW5nTGlzdFsiZXMiXSA9ICJTcGFuaXNoIjsNCiAgICBMYW5nTGlzdFsiZnIiXSA9ICJGcmVuY2giOw0KICAgIExhbmdMaXN0WyJpdCJdID0gIkl0YWxpYW4iOw0KICAgIExhbmdMaXN0WyJqYSJdID0gIkphcGFuZXNlIjsNCiAgICBMYW5nTGlzdFsic3YiXSA9ICJTd2VkaXNoIjsNCiAgICBMYW5nTGlzdFsia28iXSA9ICJLb3JlYW4iOw0KICAgIExhbmdMaXN0WyJ6aF9UVyJdID0gIkNoaW5lc2UgKFRyYWRpdGlvbmFsKSI7DQogICAgTGFuZ0xpc3RbInpoX0NOIl0gPSAiQ2hpbmVzZSAoU2ltcGxpZmllZCkiOw0KICAgIExhbmdMaXN0WyJwdF9CUiJdID0gIlBvcnR1Z3Vlc2UgKEJyYXppbGlhbikiOw0KICAgIExhbmdMaXN0WyJubF9OTCJdID0gIkR1dGNoIjsNCiAgICBMYW5nTGlzdFsiZGEiXSA9ICJEYW5pc2giOw0KICAgIExhbmdMaXN0WyJ0aCJdID0gIlRoYWkiOw0KICAgIExhbmdMaXN0WyJmaSJdID0gIkZpbm5pc2giOw0KICAgIExhbmdMaXN0WyJydSJdID0gIlJ1c3NpYW4iOw0KDQogICAgdmFyIFVzZXJMYW5nID0gc2ZvcmNlLmNvbm5lY3Rpb24uZ2V0VXNlckluZm8oKS51c2VyTGFuZ3VhZ2U7CS8vIElTTyBjb2RlIG9mIHRoZSB1c2VyJ3MgbGFuZ3VhZ2UNCg0KICAgIGlmICghTGFuZ0xpc3RbVXNlckxhbmddKSB7IFVzZXJMYW5nID0gIkVuZ2xpc2giOyB9CQkvLyBpZiB1c2VyJ3MgbGFuZ3VhZ2UgaXMgbm90IGZvdW5kLCBkZWZhdWx0IGl0IHRvIEVuZ2xpc2gNCiAgICBlbHNlIHsgVXNlckxhbmcgPSBMYW5nTGlzdFtVc2VyTGFuZ107IH0NCg0KICAgIHZhciBzb3FsID0gIlNFTEVDVCBJZCwgTmFtZSwgU1ZNWENfX1RhZ19UZXh0X19jLCBTVk1YQ19fTGFuZ3VhZ2VfX2MgIiArDQogICAgCQkiRlJPTSBTVk1YQ19fU2VydmljZU1heF9UYWdzX19jICIgKw0KCQkiV0hFUkUgU1ZNWENfX1N1Ym1vZHVsZUlEX19jID0gJyIgKyBzdWJtb2R1bGVpZCArICInICIgKw0KCQkiQU5EIFNWTVhDX19MYW5ndWFnZV9fYyBJTiAoJ01hc3RlcicsICciICsgVXNlckxhbmcgKyAiJykiOw0KICAgIHZhciBxciA9IHNmb3JjZS5jb25uZWN0aW9uLnF1ZXJ5KHNvcWwpOw0KICAgIHZhciB0YWdyZWNzID0gbmV3IHNmb3JjZS5RdWVyeVJlc3VsdEl0ZXJhdG9yKHFyKTsNCiAgICB3aGlsZSAodGFncmVjcy5oYXNOZXh0KCkpDQogICAgCXsNCiAgICAgICAgdmFyIHRhZ3JlYyA9IHRhZ3JlY3MubmV4dCgpOw0KCXZhciBUYWdJZCA9IHRhZ3JlYy5OYW1lOw0KCXZhciBUYWdUZXh0ID0gdGFncmVjLlNWTVhDX19UYWdfVGV4dF9fYzsNCgl2YXIgTGFuZyA9IHRhZ3JlYy5TVk1YQ19fTGFuZ3VhZ2VfX2M7DQoJaWYgKExhbmcgPT0gIk1hc3RlciIgJiYgIXNTZWxfTXNnTGlzdFtUYWdJZF0pDQoJICAgIHNTZWxfTXNnTGlzdFtUYWdJZF0gPSBUYWdUZXh0Ow0KCWVsc2UgaWYgKExhbmcgPT0gVXNlckxhbmcgJiYgVGFnVGV4dCAmJiBUYWdUZXh0Lmxlbmd0aCA+IDApCS8vIFRyYW5zbGF0aW9uIGF2YWlsYWJsZSBpbiB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UNCgkgICAgc1NlbF9Nc2dMaXN0W1RhZ0lkXSA9IFRhZ1RleHQ7DQoNCglmb3VuZCA9IHRydWU7DQoJfQ0KDQogICAgaWYgKCFmb3VuZCkNCgl7DQoJc1NlbF9Nc2dMaXN0WydMQUIwMDAnXSA9ICdTZXJ2aWNlTWF4OiBTZXJpYWwgU2VsZWN0aW9uJzsNCglzU2VsX01zZ0xpc3RbJ0xBQjAwMSddID0gJ1NlcmlhbCBOdW1iZXIgU2VsZWN0aW9uJzsNCglzU2VsX01zZ0xpc3RbJ0xBQjAwMiddID0gJ0FkZCc7DQoJc1NlbF9Nc2dMaXN0WydMQUIwMDMnXSA9ICdTdWJtaXQnOw0KCXNTZWxfTXNnTGlzdFsnTEFCMDA0J10gPSAnQ2FuY2VsJzsNCglzU2VsX01zZ0xpc3RbJ0xBQjAwNSddID0gJzwgICBQcmV2JzsNCglzU2VsX01zZ0xpc3RbJ0xBQjAwNiddID0gJ05leHQgID4nOw0KCXNTZWxfTXNnTGlzdFsnTEFCMDA3J10gPSAnUXVpY2sgQWRkJzsNCglzU2VsX01zZ0xpc3RbJ0xBQjAwOCddID0gJ1RyYW5zYWN0aW9uIFR5cGU6ICAnOw0KCXNTZWxfTXNnTGlzdFsnTEFCMDA5J10gPSAnUHJvZHVjdDogICc7DQoJc1NlbF9Nc2dMaXN0WydMQUIwMTAnXSA9ICdSZXF1aXJlZCBRdWFudGl0eTogICc7DQoJc1NlbF9Nc2dMaXN0WydMQUIwMTEnXSA9ICcgICAgICAgLS1Ob25lLS0gICAgICAgICc7DQoJc1NlbF9Nc2dMaXN0WydMQUIwMTInXSA9ICdGcm9tIExvY2F0aW9uOic7DQoJc1NlbF9Nc2dMaXN0WydMQUIwMTMnXSA9ICdUbyBMb2NhdGlvbjonOw0KCXNTZWxfTXNnTGlzdFsnTEFCMDE0J10gPSAnU3RhdHVzOic7DQoJc1NlbF9Nc2dMaXN0WydMQUIwMTUnXSA9ICdSZW1vdmUnOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDAxJ10gPSAnQW4gaW50ZXJuYWwgZXJyb3Igb2NjdXJyZWQgd2hlbiBzYXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMDInXSA9ICdBbiBpbnRlcm5hbCBlcnJvciBvY2N1cnJlZCB3aGVuIHJldHJpZXZpbmcgZGF0YS4gUGxlYXNlIGNvbnRhY3QgeW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IgdG8gcmVzb2x2ZSB0aGlzLic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMDMnXSA9ICdJbnZlbnRvcnkgTW9kdWxlIG9yIFNlcmlhbGl6ZWQgVHJhY2tpbmcgb2YgaW52ZW50b3J5IGlzIG5vdCBlbmFibGVkIGluIHlvdXIgb3JnYW5pemF0aW9uJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAwNCddID0gJ1RoaXMgU2VydmljZU1heCB0cmFuc2FjdGlvbiBkaWQgbm90IGhhdmUgYW55IHNlcmlhbGl6ZWQgcHJvZHVjdHMgdG8gcHJvY2Vzcy4nOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDA1J10gPSAnVGhlcmUgd2FzIGFuIGludGVybmFsIGVycm9yIGluIGRhdGEgc2VudCBmcm9tIHRoZSBwYXJlbnQgU2VydmljZU1heCB0cmFuc2FjdGlvbi4gUGxlYXNlIHJlcG9ydCB0aGlzIHRvIFNlcnZpY2VNYXggc3VwcG9ydC4nOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDA2J10gPSAnWW91IGhhdmUgYWxyZWFkeSBlbnRlcmVkIHRoZSByZXF1aXJlZCBudW1iZXIgb2Ygc2VyaWFscyBvciB0b28gbWFueSBzZXJpYWwgbnVtYmVycyBzZWxlY3RlZC4nOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDA3J10gPSAnRHVwbGljYXRlIHNlcmlhbCBudW1iZXJzIGFyZSBub3QgYWxsb3dlZC4gUGxlYXNlIGNvcnJlY3QgeW91ciBlbnRyaWVzIGFuZCBjbGljayBTdWJtaXQgYWdhaW4uJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAwOCddID0gJ0R1cGxpY2F0ZSBTZXJpYWwgTnVtYmVyOic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMDknXSA9ICdEdXBsaWNhdGUgc2VyaWFsIG51bWJlcnMgZm91bmQuIFRoaXMgaXMgbm90IGFuIGVycm9yLiBIb3dldmVyLCBwbGVhc2UgdmVyaWZ5IGFuZCBjb25maXJtIHlvdXIgZW50cmllcyBhcmUgYWNjdXJhdGUgYW5kIGNsaWNrIFN1Ym1pdCBhZ2Fpbi4nOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDEwJ10gPSAnVGhlIG51bWJlciBvZiBzZXJpYWwgbnVtYmVycyB5b3UgZW50ZXJlZCBkb2VzIG5vdCBtYXRjaCB0aGUgcmVjZWl2ZWQgcXVhbnRpdHkuJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAxMSddID0gJ05vdCBlbm91Z2ggc2VyaWFsIG51bWJlcnMgc2VsZWN0ZWQgZm9yIHRoaXMgcHJvZHVjdDogJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAxMiddID0gJ1RoZSBmb2xsb3dpbmcgdHJhbnNhY3Rpb24gaGFzIHJlc3VsdGVkIGluIGEgbmVnYXRpdmUgc3RvY2sgcXVhbnRpdHkuIFBsZWFzZSB2ZXJpZnkgdGhhdCB5b3VyIG9yZ2FuaXphdGlvbiBmb2xsb3dzIHRoZSBuZWNlc3NhcnkgcHJvY2Vzc2VzIHRvIG1haW50YWluIGludGVncml0eSBvZiBzdG9jayBpbmZvcm1hdGlvbiBpbiBTZXJ2aWNlTWF4LiBJZiB5b3VyIG9yZ2FuaXphdGlvbiBpcyBmdWxseSBjb21wbGlhbnQgd2l0aCB0aGUgcHJvY2VzcyByZXF1aXJlbWVudHMsIHJlcG9ydCB0aGlzIGlzc3VlIHRvIFNlcnZpY2VNYXggc3VwcG9ydCBpbW1lZGlhdGVseS4nOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDEzJ10gPSAnQW4gb2NjdXJyZWQgd2hlbiBzZW5kaW5nIGVtYWlsIGFib3V0IG5lZ2F0aXZlIHN0b2NrLic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMTQnXSA9ICdFbWFpbCBhYm91dCBuZWdhdGl2ZSBzdG9jayBjb3VsZCBub3QgYmUgc2VudCBkdWUgdG8gaW5zdWZmaWNpZW50IGluZm9ybWF0aW9uLiBQbGVhc2UgcmVwb3J0IHRoaXMgdG8geW91ciBTZXJ2aWNlTWF4IGFkbWluaXN0cmF0b3IuJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAxNSddID0gJ1RyYW5zYWN0aW9uIFR5cGU6ICAnOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDE2J10gPSAnVHJhbnNhY3Rpb24gTnVtYmVyOic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMTcnXSA9ICdQcm9kdWN0OiAgJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAxOCddID0gJ0xvY2F0aW9uOic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMTknXSA9ICdTdGF0dXM6JzsNCglzU2VsX01zZ0xpc3RbJ01TRzAyMCddID0gJ1F1YW50aXR5IEJlZm9yZTonOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDIxJ10gPSAnVHJhbnNhY3Rpb24gUXVhbnRpdHk6JzsNCglzU2VsX01zZ0xpc3RbJ01TRzAyMiddID0gJ1F1YW50aXR5IEFmdGVyOic7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMjMnXSA9ICdTZXJ2aWNlTWF4IFVzZXI6JzsNCglzU2VsX01zZ0xpc3RbJ01TRzAyNCddID0gJ0RhdGUvVGltZTonOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDI1J10gPSAnRXJyb3I6IEludmFsaWQgRGF0YS48YnIvPlJldmlldyBhbGwgZXJyb3IgbWVzc2FnZXMgYmVsb3cgdG8gY29ycmVjdCB5b3VyIGRhdGEuJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAyNiddID0gJ1RoaXMgaXMgdGhlIEZpcnN0IFJlY29yZCc7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMjcnXSA9ICdUaGlzIGlzIHRoZSBMYXN0IFJlY29yZCc7DQoJc1NlbF9Nc2dMaXN0WydNU0cwMjgnXSA9ICdQbGVhc2UgZW50ZXIgYSB2YWxpZCBuZXcgc2VyaWFsIG51bWJlciwgUHJvdmlkZWQgc2VyaWFsIG51bWJlciBhbHJlYWR5IGV4aXN0cyBvbiB0aGUgbGlzdC4nOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDI5J10gPSAnUGxlYXNlIGVudGVyIGEgdmFsaWQgc2VyaWFsIG51bWJlciBhbmQgbnVtYmVyIG9mIHNlcmlhbHMgZmlyc3QuJzsNCglzU2VsX01zZ0xpc3RbJ01TRzAzMCddID0gJ1BsZWFzZSBlbnRlciBhIHZhbGlkIHNlcmlhbCBudW1iZXInOw0KCXNTZWxfTXNnTGlzdFsnTVNHMDMxJ10gPSAnRXJyb3I6JzsNCglzU2VsX01zZ0xpc3RbJ01TRzAzMiddID0gJ1BsZWFzZSBzZWxlY3Qgb25lIG9yIG1vcmUgc2VyaWFsIG51bWJlcnMuJzsNCglzU2VsX01zZ0xpc3RbJ01TRzk5OSddID0gJ0luZm9ybWF0aW9uIHlvdSBlbnRlcmVkIGhlcmUgd2lsbCBub3QgYmUgc2F2ZWQuIEFyZSB5b3Ugc3VyZT8nOw0KCX0NCn0NCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLw0KZnVuY3Rpb24gU1ZNWElfc1NlbF9HZXRNZXNzYWdlKE1zZ051bSkNCnsNCiAgICBpZiAoIXNTZWxfTXNnTGlzdFtNc2dOdW1dKQ0KCXJldHVybiAiTWVzc2FnZSBkZWZpbml0aW9uIGZvciAiICsgTXNnTnVtICsgIiBub3QgZm91bmQuIFRoaXMgaXMgYSBzZXR1cCBpc3N1ZS5cblBsZWFzZSBjb250YWN0IHlvdXIgU2VydmljZU1heCBhZG1pbmlzdHJhdG9yIHRvIHJlc29sdmUgdGhpcy4iOw0KDQogICAgcmV0dXJuIHNTZWxfTXNnTGlzdFtNc2dOdW1dOw0KfQ0KLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovDQoNCg==</fileContent>
    <fileName>SVMXC_Library.js</fileName>
    <name>SVMXC_StockLookupSVO</name>
    <supportsCaching>true</supportsCaching>
</Scontrol>
